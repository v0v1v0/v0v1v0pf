<div class="container">

<table style="width: 100%;"><tr>
<td>semimetric.projec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Projection semi-metric computation
</h2>

<h3>Description</h3>

<p>Computes the projection semi-metric between each curve in <code>data1</code> and each curve in <code>data2</code>, given a functional index <code class="reqn">\theta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semimetric.projec(data1, data2, theta, order.Bspline = 3, nknot.theta = 3,
  range.grid = NULL, nknot = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data1</code></td>
<td>

<p>Matrix containing functional data collected by row.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data2</code></td>
<td>

<p>Matrix containing functional data collected by row.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Vector containing the coefficients of <code class="reqn">\theta</code> in a B-spline basis, so that <code>length(theta)=order.Bspline+nknot.theta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.Bspline</code></td>
<td>

<p>Order of the B-spline basis functions for the B-spline representation of <code class="reqn">\theta</code>. This is the number of coefficients in each piecewise polynomial segment. The default is 3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nknot.theta</code></td>
<td>

<p>Number of regularly spaced interior knots of the B-spline basis. The default is 3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.grid</code></td>
<td>

<p>Vector of length 2 containing  the range of the discretisation of the functional data. If <code>range.grid=NULL</code>, then <code>range.grid=c(1,p)</code> is considered, where <code>p</code> is the discretization size of <code>data</code> (i.e. <code>ncol(data)</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nknot</code></td>
<td>

<p>Number of  regularly spaced interior knots for the B-spline representation of the functional data. The default value is <code>(p - order.Bspline - 1)%/%2</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code class="reqn">x_1,x_2 \in \mathcal{H}, </code>, where <code class="reqn">\mathcal{H}</code> is a separable Hilbert space, the projection semi-metric in the direction <code class="reqn">\theta\in \mathcal{H}</code> is defined as   </p>
<p style="text-align: center;"><code class="reqn">d_{\theta}(x_1,x_2)=|\langle\theta,x_1-x_2\rangle|.</code>
</p>

<p>The function <code>semimetric.projec</code> computes this projection semi-metric using the B-spline representation of the curves and <code class="reqn">\theta</code>. The dimension of the B-spline basis for <code class="reqn">\theta</code> is determined by <code>order.Bspline</code>+<code>nknot.theta</code>.
</p>


<h3>Value</h3>

<p>A matrix containing the projection semi-metrics for each pair of curves.
</p>


<h3>Author(s)</h3>

<p>German Aneiros Perez <a href="mailto:german.aneiros@udc.es">german.aneiros@udc.es</a> 
</p>
<p>Silvia Novo Diaz  <a href="mailto:snovo@est-econ.uc3m.es">snovo@est-econ.uc3m.es</a>
</p>


<h3>References</h3>

<p>Novo S., Aneiros, G., and Vieu, P., (2019) Automatic and location-adaptive estimation in functional single–index regression. <em>Journal of Nonparametric Statistics</em>, <b>31(2)</b>, 364–392, <a href="https://doi.org/10.1080/10485252.2019.1567726">doi:10.1080/10485252.2019.1567726</a>.
</p>


<h3>See Also</h3>

<p>See also <code>projec</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Tecator")
names(Tecator)
y&lt;-Tecator$fat
X&lt;-Tecator$absor.spectra

#length(theta)=6=order.Bspline+nknot.theta 
semimetric.projec(data1=X[1:5,], data2=X[5:10,],theta=c(1,0,0,1,1,-1),
  nknot.theta=3,nknot=20,range.grid=c(850,1050))

</code></pre>


</div>