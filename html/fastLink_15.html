<div class="container">

<table style="width: 100%;"><tr>
<td>emlinkMARmov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>emlinkMARmov</h2>

<h3>Description</h3>

<p>Expectation-Maximization algorithm for Record Linkage under the
Missing at Random (MAR) assumption.
</p>


<h3>Usage</h3>

<pre><code class="language-R">emlinkMARmov(patterns, nobs.a, nobs.b, p.m, iter.max,
tol, p.gamma.k.m, p.gamma.k.u, prior.lambda, w.lambda,
prior.pi, w.pi, address.field, gender.field, varnames)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>patterns</code></td>
<td>
<p>table that holds the counts for each unique agreement
pattern. This object is produced by the function: tableCounts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs.a</code></td>
<td>
<p>Number of observations in dataset A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs.b</code></td>
<td>
<p>Number of observations in dataset B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.m</code></td>
<td>
<p>probability of finding a match. Default is 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>Max number of iterations. Default is 5000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Convergence tolerance. Default is 1e-05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.gamma.k.m</code></td>
<td>
<p>probability that conditional of being in the matched set we observed a specific agreement value for field k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.gamma.k.u</code></td>
<td>
<p>probability that conditional of being in the non-matched set we observed a specific agreement value for field k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.lambda</code></td>
<td>
<p>The prior probability of finding a match, derived from auxiliary data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.lambda</code></td>
<td>
<p>How much weight to give the prior on lambda versus the data. Must range between 0 (no weight on prior) and 1 (weight fully on prior)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.pi</code></td>
<td>
<p>The prior probability of the address field not matching, conditional on being in the matched set. To be used when the
share of movers in the population is known with some certainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.pi</code></td>
<td>
<p>How much weight to give the prior on pi versus the data. Must range between 0 (no weight on prior) and 1 (weight fully on prior)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>address.field</code></td>
<td>
<p>Boolean indicators for whether a given field is an address field. Default is NULL (FALSE for all fields).
Address fields should be set to TRUE while non-address fields are set to FALSE if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gender.field</code></td>
<td>
<p>Boolean indicators for whether a given field is for gender. If so, exact match is conducted on gender.
Default is NULL (FALSE for all fields). The one gender field should be set to TRUE while all other fields are set to FALSE if provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>The vector of variable names used for matching. Automatically provided if using <code>fastLink()</code> wrapper. Used for
clean visualization of EM results in summary functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>emlinkMARmov</code> returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>zeta.j</code></td>
<td>
<p>The posterior match probabilities for each unique pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.m</code></td>
<td>
<p>The probability of a pair matching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.u</code></td>
<td>
<p>The probability of a pair not matching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.gamma.k.m</code></td>
<td>
<p>The matching probability for a specific matching field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.gamma.k.u</code></td>
<td>
<p>The non-matching probability for a specific matching field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.gamma.j.m</code></td>
<td>
<p>The probability that a pair is in the matched set given a particular agreement pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.gamma.j.u</code></td>
<td>
<p>The probability that a pair is in the unmatched set given a particular agreement pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patterns.w</code></td>
<td>
<p>Counts of the agreement patterns observed, along with the Felligi-Sunter Weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.converge</code></td>
<td>
<p>The number of iterations it took the EM algorithm to converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs.a</code></td>
<td>
<p>The number of observations in dataset A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs.b</code></td>
<td>
<p>The number of observations in dataset B.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ted Enamorado &lt;ted.enamorado@gmail.com&gt; and Kosuke Imai
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Calculate gammas
g1 &lt;- gammaCKpar(dfA$firstname, dfB$firstname)
g2 &lt;- gammaCKpar(dfA$middlename, dfB$middlename)
g3 &lt;- gammaCKpar(dfA$lastname, dfB$lastname)
g4 &lt;- gammaKpar(dfA$birthyear, dfB$birthyear)

## Run tableCounts
tc &lt;- tableCounts(list(g1, g2, g3, g4), nobs.a = nrow(dfA), nobs.b = nrow(dfB))

## Run EM
em &lt;- emlinkMARmov(tc, nobs.a = nrow(dfA), nobs.b = nrow(dfB))

## End(Not run)

</code></pre>


</div>