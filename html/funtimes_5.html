<div class="container">

<table style="width: 100%;"><tr>
<td>BICC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BIC-Based Spatio-Temporal Clustering</h2>

<h3>Description</h3>

<p>Apply the algorithm of unsupervised spatio-temporal clustering, TRUST
(Ciampi et al. 2010), with automatic selection of its
tuning parameters <code>Delta</code> and <code>Epsilon</code> based on Bayesian
information criterion, BIC (Schaeffer et al. 2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BICC(X, Alpha = NULL, Beta = NULL, Theta = 0.8, p, w, s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of time series observed within a slide (time series in columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>lower limit of the time-series domain,
passed to <code>CSlideCluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>upper limit of the time-series domain passed to <code>CSlideCluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>connectivity parameter passed to <code>CSlideCluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of layers (time-series observations) in each slide.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>number of slides in each window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>step to shift a window, calculated in the number of slides. The recommended
values are 1 (overlapping windows) or equal to <code>w</code> (non-overlapping windows).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the upper-level function for time series clustering.
It exploits the functions <code>CWindowCluster</code> and
<code>CSlideCluster</code> to cluster time series based on closeness and
homogeneity measures. Clustering is performed multiple times with a range
of equidistant values for the parameters <code>Delta</code> and <code>Epsilon</code>,
then optimal parameters <code>Delta</code> and <code>Epsilon</code> along with the
corresponding clustering results are shown
(see Schaeffer et al. 2016, for more details).
</p>
<p>The total length of time series (number of levels, i.e., <code>nrow(X)</code>)
should be divisible by <code>p</code>.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>delta.opt</code></td>
<td>
<p>optimal value for the clustering parameter <code>Delta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon.opt</code></td>
<td>
<p>optimal value for the clustering parameter <code>Epsilon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>vector of length <code>ncol(X)</code> with cluster labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC</code></td>
<td>
<p>values of the information criterion (BIC) for each considered
combination of <code>Delta</code> (rows) and <code>Epsilon</code> (columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.all</code></td>
<td>
<p>vector of considered values for <code>Delta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon.all</code></td>
<td>
<p>vector of considered values for <code>Epsilon</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ethan Schaeffer, Vyacheslav Lyubchich
</p>


<h3>References</h3>

<p>Ciampi A, Appice A, Malerba D (2010).
“Discovering trend-based clusters in spatially distributed data streams.”
In <em>International Workshop of Mining Ubiquitous and Social Environments</em>, 107–122.<br><br> Schaeffer ED, Testa JM, Gel YR, Lyubchich V (2016).
“On information criteria for dynamic spatio-temporal clustering.”
In Banerjee A, Ding W, Dy JG, Lyubchich V, Rhines A (eds.), <em>The 6th International Workshop on Climate Informatics: CI2016</em>, 5–8.
<a href="https://doi.org/10.5065/D6K072N6">doi:10.5065/D6K072N6</a>.
</p>


<h3>See Also</h3>

<p><code>CSlideCluster</code>, <code>CWindowCluster</code>, <code>purity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fix seed for reproducible simulations:
set.seed(1)

##### Example 1
# Similar to Schaeffer et al. (2016), simulate 3 years of monthly data 
#for 10 locations and apply clustering:
# 1.1 Simulation
T &lt;- 36 #total months
N &lt;- 10 #locations
phi &lt;- c(0.5) #parameter of autoregression
burn &lt;- 300 #burn-in period for simulations
X &lt;- sapply(1:N, function(x) 
    arima.sim(n = T + burn, 
              list(order = c(length(phi), 0, 0), ar = phi)))[(burn + 1):(T + burn),]
colnames(X) &lt;- paste("TS", c(1:dim(X)[2]), sep = "")

# 1.2 Clustering
# Assume that information arrives in year-long slides or data chunks
p &lt;- 12 #number of time layers (months) in a slide
# Let the upper level of clustering (window) be the whole period of 3 years, so
w &lt;- 3 #number of slides in a window
s &lt;- w #step to shift a window, but it does not matter much here as we have only one window of data
tmp &lt;- BICC(X, p = p, w = w, s = s)

# 1.3 Evaluate clustering
# In these simulations, it is known that all time series belong to one class,
#since they were all simulated the same way:
classes &lt;- rep(1, 10)
# Use the information on the classes to calculate clustering purity:
purity(classes, tmp$clusters[1,])

##### Example 2
# 2.1 Modify time series and update classes accordingly:
# Add a mean shift to a half of the time series:
X2 &lt;- X
X2[, 1:(N/2)] &lt;- X2[, 1:(N/2)] + 3
classes2 &lt;- rep(c(1, 2), each = N/2)

# 2.2 Re-apply clustering procedure and evaluate clustering purity:
tmp2 &lt;- BICC(X2, p = p, w = w, s = s)
tmp2$clusters
purity(classes2, tmp2$clusters[1,])

</code></pre>


</div>