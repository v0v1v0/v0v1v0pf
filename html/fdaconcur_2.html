<div class="container">

<table style="width: 100%;"><tr>
<td>ConcReg_Lag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional Concurrent Regression with Lag Model</h2>

<h3>Description</h3>

<p>Functional concurrent regression model with lag for dense functional responses and dense functional predictors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ConcReg_Lag(Y, X, Lag = NULL, optnsY = NULL, optnsX = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a list which contains functional responses in the form of a list LY and the time points LT at which they are observed (i.e., list(Ly = LY,Lt = LT)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a list of lists which contains the observed functional predictors list Lxj and the time points list Ltj at which they are observed. It needs to be of the form <code>list(list(Ly = Lx1,Lt = Lxt1),list(Ly = Lx2,Lt = Lxt2),...)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lag</code></td>
<td>
<p>a length <code>length(X)</code> vector denoting the lags for all predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optnsY</code></td>
<td>
<p>a list of options control parameters for the response specified by <code>list(name=value)</code>. See ‘Details’ in <code>fdapace::FPCA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optnsX</code></td>
<td>
<p>a list of options control parameters for the predictors specified by <code>list(name=value)</code>. See ‘Details’ in <code>fdapace::FPCA</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functional concurrent regression model with lag is defined as 
</p>
<p style="text-align: center;"><code class="reqn">E[Y(t)|X_1(t), \cdots, X_p(t)] = \beta_0(t) + \sum_{j=1}^p\beta_j(t)X_j(t-Lag[j])</code>
</p>
 
<p>For more details we refer to 
<cite>Şentürk, D. and Müller, H.G., (2010). Functional varying coefficient models for longitudinal data. Journal of the American Statistical Association, 105(491), pp.1256-1264.</cite>
</p>


<h3>Value</h3>

<p>A list of the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>a vector of <code>length(workGridY)</code> representing the fitted <code class="reqn">\beta_0(t)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A matrix for the concurrent regression effects, where rows correspond to different predictors and columns to different time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workGridY</code></td>
<td>
<p>a vetor representing the working grid for the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lag</code></td>
<td>
<p>a vector representing the lags for all predictors</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><cite>Şentürk, D. and Müller, H.G., (2010). Functional varying coefficient models for longitudinal data. Journal of the American Statistical Association, 105(491), pp.1256-1264.</cite>
<cite>Yao, F., Müller, H.G., Wang, J.L. (2005). Functional linear regression analysis for longitudinal data. Annals of Statistics 33, 2873–2903.</cite>
<cite>Hall, P., Horowitz, J.L. (2007). Methodology and convergence rates for functional linear regression. The Annals of Statistics, 35(1), 70–91.</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">phi1 &lt;- function(t) sin(pi*t / 5) / sqrt(5)
phi2 &lt;- function(t) cos(pi*t / 5) / sqrt(5)
lambdaX &lt;- c(10, 5)
n &lt;- 50
N &lt;- 101
Xi &lt;- matrix(rnorm(2*n), nrow = n, ncol = 2)
denseLt &lt;- list()
denseLy &lt;- list()
t0 &lt;- seq(0, 15, length.out = N)
for (i in 1:n) {
  denseLt[[i]] &lt;- t0
  denseLy[[i]] &lt;- lambdaX[1]*Xi[i, 1]*phi1(t0) + lambdaX[2]*Xi[i, 2]*phi2(t0)
}
denseX0 &lt;- list(Ly = denseLy,Lt = denseLt)

Lag &lt;- c(3)
t0_out &lt;- t0[t0&gt;=max(Lag)]
beta_1 &lt;- function(t) 5*sin(pi*t/10)
beta_0 &lt;- function(t) t^2/2
### functional response Y(t), t in t0_out ### 
denseLt &lt;- list()
denseLy &lt;- list()
for (i in 1:n) {
  denseLt[[i]] &lt;- t0_out
  denseLy[[i]] &lt;- beta_0(t0_out) +  
    denseX0$Ly[[i]][1:length(t0_out)]* beta_1(t0_out) + 
    rnorm(length(t0_out), 0, 0.1) 
}
denseY &lt;- list(Ly = denseLy, Lt = denseLt)
model = ConcReg_Lag(Y=denseY, X=list(X1 = denseX0), Lag=Lag)

print(model$workGridY) # workGrid for Y between 6 to 15
plot(beta_1(model$workGridY)) # workGrid for X1 between 3 to 12 
plot(beta_0(model$workGridY))

plot(model$beta[1,])
plot(model$beta0)
</code></pre>


</div>