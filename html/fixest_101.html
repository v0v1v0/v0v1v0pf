<div class="container">

<table style="width: 100%;"><tr>
<td>predict.fixest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for <code>fixest</code> fits</h2>

<h3>Description</h3>

<p>This function obtains prediction from a fitted model estimated with <code>femlm</code>,
<code>feols</code> or <code>feglm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'fixest'
predict(
  object,
  newdata,
  type = c("response", "link"),
  se.fit = FALSE,
  interval = "none",
  level = 0.95,
  fixef = FALSE,
  vs.coef = FALSE,
  sample = c("estimation", "original"),
  vcov = NULL,
  ssc = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>fixest</code> object. Obtained using the functions <code>femlm</code>, <code>feols</code> or <code>feglm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A data.frame containing the variables used to make the prediction.
If not provided, the fitted expected (or linear if <code>type = "link"</code>) predictors are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character either equal to <code>"response"</code> (default) or <code>"link"</code>.
If <code>type="response"</code>, then the output is at the level of the response variable, i.e.
it is the expected predictor <code class="reqn">E(Y|X)</code>. If <code>"link"</code>, then the output is at
the level of the explanatory variables, i.e. the linear predictor <code class="reqn">X\cdot \beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>Logical, default is <code>FALSE</code>. If <code>TRUE</code>, the standard-error of the predicted
value is computed and returned in a column named <code>se.fit</code>. This feature is only available
for OLS models not containing fixed-effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>Either "none" (default), "confidence" or "prediction". What type of
confidence interval to compute. Note that this feature is only available for OLS models
not containing fixed-effects (GLM/ML models are not covered).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>A numeric scalar in between 0.5 and 1, defaults to 0.95. Only used when
the argument 'interval' is requested, it corresponds to the width of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixef</code></td>
<td>
<p>Logical scalar, default is <code>FALSE</code>. If <code>TRUE</code>, a data.frame is returned,
with each column representing the fixed-effects coefficients for each observation in
<code>newdata</code> – with as many columns as fixed-effects. Note that when there are variables
with varying slopes, the slope coefficients are returned (i.e. they are not multiplied
by the variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vs.coef</code></td>
<td>
<p>Logical scalar, default is <code>FALSE</code>. Only used when <code>fixef = TRUE</code> and
when variables with varying slopes are present. If <code>TRUE</code>, the coefficients of the
variables with varying slopes are returned instead of the coefficient multiplied by the
value of the variables (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>Either "estimation" (default) or "original". This argument is only used
when arg. 'newdata' is missing, and is ignored otherwise. If equal to "estimation",
the vector returned matches the sample used for the estimation. If equal to "original",
it matches the original data set (the observations not used for the estimation being filled
with NAs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Versatile argument to specify the VCOV. In general, it is either a character
scalar equal to a VCOV type, either a formula of the form: <code>vcov_type ~ variables</code>. The
VCOV types implemented are: "iid", "hetero" (or "HC1"), "cluster", "twoway",
"NW" (or "newey_west"), "DK" (or "driscoll_kraay"), and "conley". It also accepts
object from <code>vcov_cluster</code>, <code>vcov_NW</code>, <code>NW</code>,
<code>vcov_DK</code>, <code>DK</code>, <code>vcov_conley</code> and
<code>conley</code>. It also accepts covariance matrices computed externally.
Finally it accepts functions to compute the covariances. See the <code>vcov</code> documentation
in the <a href="https://lrberge.github.io/fixest/articles/fixest_walkthrough.html#the-vcov-argument-1">vignette</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssc</code></td>
<td>
<p>An object of class <code>ssc.type</code> obtained with the function <code>ssc</code>. Represents
how the degree of freedom correction should be done.You must use the function <code>ssc</code>
for this argument. The arguments and defaults of the function <code>ssc</code> are:
<code>adj = TRUE</code>, <code>fixef.K="nested"</code>, <code>cluster.adj = TRUE</code>, <code>cluster.df = "min"</code>,
<code>t.df = "min"</code>, <code style="white-space: pre;">⁠fixef.force_exact=FALSE)⁠</code>. See the help of the function <code>ssc</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not currently used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns a numeric vector of length equal to the number of observations in argument <code>newdata</code>.
If <code>newdata</code> is missing, it returns a vector of the same length as the estimation sample,
except if <code>sample = "original"</code>, in which case the length of the vector will match the one
of the original data set (which can, but also cannot, be the estimation sample).
If <code>fixef = TRUE</code>, a <code>data.frame</code> is returned.
If <code>se.fit = TRUE</code> or <code>interval != "none"</code>, the object returned is a data.frame
with the following columns: <code>fit</code>, <code>se.fit</code>, and, if CIs are requested, <code>ci_low</code> and <code>ci_high</code>.
</p>


<h3>Author(s)</h3>

<p>Laurent Berge
</p>


<h3>See Also</h3>

<p>See also the main estimation functions <code>femlm</code>, <code>feols</code> or <code>feglm</code>. <code>update.fixest</code>, <code>summary.fixest</code>, <code>vcov.fixest</code>, <code>fixef.fixest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Estimation on iris data
res = fepois(Sepal.Length ~ Petal.Length | Species, iris)

# what would be the prediction if the data was all setosa?
newdata = data.frame(Petal.Length = iris$Petal.Length, Species = "setosa")
pred_setosa = predict(res, newdata = newdata)

# Let's look at it graphically
plot(c(1, 7), c(3, 11), type = "n", xlab = "Petal.Length",
     ylab = "Sepal.Length")

newdata = iris[order(iris$Petal.Length), ]
newdata$Species = "setosa"
lines(newdata$Petal.Length, predict(res, newdata))

# versicolor
newdata$Species = "versicolor"
lines(newdata$Petal.Length, predict(res, newdata), col=2)

# virginica
newdata$Species = "virginica"
lines(newdata$Petal.Length, predict(res, newdata), col=3)

# The original data
points(iris$Petal.Length, iris$Sepal.Length, col = iris$Species, pch = 18)
legend("topleft", lty = 1, col = 1:3, legend = levels(iris$Species))


#
# Getting the fixed-effect coefficients for each obs.
#

data(trade)
est_trade = fepois(Euros ~ log(dist_km) | Destination^Product +
                                           Origin^Product + Year, trade)
obs_fe = predict(est_trade, fixef = TRUE)
head(obs_fe)

# can we check we get the right sum of fixed-effects
head(cbind(rowSums(obs_fe), est_trade$sumFE))


#
# Standard-error of the prediction
#

base = setNames(iris, c("y", "x1", "x2", "x3", "species"))

est = feols(y ~ x1 + species, base)

head(predict(est, se.fit = TRUE))

# regular confidence interval
head(predict(est, interval = "conf"))

# adding the residual to the CI
head(predict(est, interval = "predi"))

# You can change the type of SE on the fly
head(predict(est, interval = "conf", vcov = ~species))



</code></pre>


</div>