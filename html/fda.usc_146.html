<div class="container">

<table style="width: 100%;"><tr>
<td>GCCV.S</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The generalized correlated cross-validation (GCCV) score.</h2>

<h3>Description</h3>

<p>The generalized correlated cross-validation (GCV) score.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GCCV.S(
  y,
  S,
  criteria = "GCCV1",
  W = NULL,
  trim = 0,
  draw = FALSE,
  metric = metric.lp,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vectorith length <code>n</code> or Matrix of set cases with
dimension (<code>n</code> x <code>m</code>), where <code>n</code> is the number of curves and
<code>m</code> are the points observed in each curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Smoothing matrix, see <code>S.NW</code>, <code>S.LLR</code> or
<code class="reqn">S.KNN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>The penalizing function. By default <em>"Rice"</em> criteria.
"GCCV1","GCCV2","GCCV3","GCV") Possible values are <em>"GCCV1"</em>,
<em>"GCCV2"</em>, <em>"GCCV3"</em>, <em>"GCV"</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Matrix of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>The alpha of the trimming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>=TRUE, draw the curves, the sample median and trimmed mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>Metric function, by default <code>metric.lp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p style="text-align: center;"><code class="reqn"> </code>
</p>
<p style="text-align: center;"><code class="reqn">GCCV=\frac{\sum_{i=1}^n
{y_{i}-\hat{y}_{i,b}}^2}{1-\frac{tr(C)}{n}^2} </code>
</p>
 

<p><code class="reqn">cor(\epsilon_i,\epsilon_j ) =\sigma</code><br></p>
<p>where <code class="reqn">S</code> is the smoothing matrix <code class="reqn">S</code> and:<br> A.-If <code class="reqn">C=2S\Sigma
- S\Sigma S</code> <br> B.-If <code class="reqn">C=S\Sigma</code> <br> C.-If <code class="reqn">C=S\Sigma S'</code> <br> with
<code class="reqn">\Sigma</code> is the n x n covariance matrix with
<code class="reqn">cor(\epsilon_i,\epsilon_j ) =\sigma</code>
</p>


<h3>Value</h3>

<p>Returns GCCV score calculated for input parameters.
</p>


<h3>Note</h3>

<p>Provided that <code class="reqn">C = I</code> and the smoother matrix S is symmetric and
idempotent, as is the case for many linear fitting techniques, the trace
term reduces to <code class="reqn">n - tr[S]</code>, which is proportional to the familiar
denominator in GCV.
</p>


<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Carmack, P. S., Spence, J. S., and Schucany, W. R. (2012).
Generalised correlated cross-validation. Journal of Nonparametric
Statistics, 24(2):269â€“282.
</p>
<p>Oviedo de la Fuente, M., Febrero-Bande, M., Pilar Munoz, and Dominguez, A.
Predicting seasonal influenza transmission using Functional Regression
Models with Temporal Dependence. arXiv:1610.08718.
<a href="https://arxiv.org/abs/1610.08718">https://arxiv.org/abs/1610.08718</a>
</p>


<h3>See Also</h3>

<p>See Also as <code>optim.np</code>. <br> Alternative method
(independent case): <code>GCV.S</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
x=tecator$absorp.fdata
x.d2&lt;-fdata.deriv(x,nderiv=)
tt&lt;-x[["argvals"]]
dataf=as.data.frame(tecator$y)
y=tecator$y$Fat
# plot the response
plot(ts(tecator$y$Fat))

nbasis.x=11;nbasis.b=7
basis1=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x)
basis2=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b)
basis.x=list("x.d2"=basis1)
basis.b=list("x.d2"=basis2)
ldata=list("df"=dataf,"x.d2"=x.d2)
# No correlation
res.gls=fregre.gls(Fat~x.d2,data=ldata, 
                   basis.x=basis.x,basis.b=basis.b)
# AR1 correlation                   
res.gls=fregre.gls(Fat~x.d2,data=ldata, correlation=corAR1(),
                   basis.x=basis.x,basis.b=basis.b)
GCCV.S(y,res.gls$H,"GCCV1",W=res.gls$W)
res.gls$gcv

## End(Not run)
</code></pre>


</div>