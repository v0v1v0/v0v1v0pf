<div class="container">

<table style="width: 100%;"><tr>
<td>obtain_FACF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain the autocorrelation function for a given functional time series.</h2>

<h3>Description</h3>

<p>Estimate the lagged autocorrelation function for a given
functional time series and its distribution under the
hypothesis of strong functional white noise. This graphic tool
can be used to identify seasonal patterns in the functional
data as well as auto-regressive or moving average terms.
i.i.d. bounds are included to test the presence of serial
correlation in the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">obtain_FACF(Y, v, nlags, ci = 0.95, estimation = "MC", figure = TRUE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Matrix containing the discretized values
of the functional time series. The dimension of the
matrix is <code class="reqn">(n x m)</code>, where <code class="reqn">n</code> is the
number of curves and <code class="reqn">m</code> is the number of points
observed in each curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Discretization points of the curves, by default
<code>seq(from = 0, to = 1, length.out = 100)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlags</code></td>
<td>
<p>Number of lagged covariance operators
of the functional time series that will be used
to estimate the autocorrelation function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>A value between 0 and 1 that indicates
the confidence interval for the i.i.d. bounds
of the autocorrelation function. By default
<code>ci = 0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation</code></td>
<td>
<p>Character specifying the
method to be used when estimating the distribution
under the hypothesis of functional white noise.
Accepted values are:
</p>

<ul>
<li>
<p> "MC": Monte-Carlo estimation.
</p>
</li>
<li>
<p> "Imhof": Estimation using Imhof's method.
</p>
</li>
</ul>
<p>By default, <code>estimation = "MC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>figure</code></td>
<td>
<p>Logical. If <code>TRUE</code>, plots the
estimated autocorrelation function with the
specified i.i.d. bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the <code>plot_FACF</code>
function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return a list with:
</p>

<ul>
<li> <p><code>Blueline</code>: The upper prediction
bound for the i.i.d. distribution.
</p>
</li>
<li> <p><code>rho</code>: Autocorrelation values for
each lag of the functional time series.
</p>
</li>
</ul>
<h3>References</h3>

<p>Mestre G., Portela J., Rice G., Muñoz San Roque A., Alonso E. (2021).
<em>Functional time series model identification and diagnosis by 
means of auto- and partial autocorrelation analysis.</em>
Computational Statistics &amp; Data Analysis, 155, 107108.
<a href="https://doi.org/10.1016/j.csda.2020.107108">https://doi.org/10.1016/j.csda.2020.107108</a>
</p>
<p>Mestre, G., Portela, J., Muñoz-San Roque, A., Alonso, E. (2020).
<em>Forecasting hourly supply curves in the Italian Day-Ahead 
electricity market with a double-seasonal SARMAHX model.</em>
International Journal of Electrical Power &amp; Energy Systems, 
121, 106083. <a href="https://doi.org/10.1016/j.ijepes.2020.106083">https://doi.org/10.1016/j.ijepes.2020.106083</a>
</p>
<p>Kokoszka, P., Rice, G., Shang, H.L. (2017).
<em>Inference for the autocovariance of a functional
time series under conditional heteroscedasticity</em>
Journal of Multivariate Analysis, 
162, 32–50. <a href="https://doi.org/10.1016/j.jmva.2017.08.004">https://doi.org/10.1016/j.jmva.2017.08.004</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1

N &lt;- 100
v &lt;- seq(from = 0, to = 1, length.out = 5)
sig &lt;- 2
Y &lt;- simulate_iid_brownian_bridge(N, v, sig)
obtain_FACF(Y,v,20)


# Example 2

data(elec_prices)
v &lt;- seq(from = 1, to = 24)
nlags &lt;- 30
obtain_FACF(Y = as.matrix(elec_prices), 
v = v,
nlags = nlags,
ci = 0.95,
figure = TRUE)

</code></pre>


</div>