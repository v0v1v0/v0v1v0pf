<div class="container">

<table style="width: 100%;"><tr>
<td>res2matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>One-step and multi-step residuals</h2>

<h3>Description</h3>

<p>These functions can be used to arrange residuals to reconcile temporal or
cross-temporal forecasts.
</p>
<p>res2matrix takes as input a set of temporal and cross-temporal residuals and
re-organizes them into a matrix where the rows correspond to different forecast
horizons, capturing the temporal dimension. Meanwhile, the columns are ordered
based on the specific arrangement as described in Di Fonzo and Girolimetto (2023).
</p>
<p>arrange_hres takes as input a list of multi-step residuals and is
designed to organize them in accordance with their time order (Girolimetto et al.
2023). When applied, this function ensures that the sequence of multi-step
residuals aligns with the chronological order in which they occurred.
</p>


<h3>Usage</h3>

<pre><code class="language-R">res2matrix(res, agg_order)

arrange_hres(list_res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>A (<code class="reqn">n \times N(k^\ast+m)</code>) numeric matrix (cross-temporal framework)
or an (<code class="reqn">N(k^\ast+m) \times 1</code>) numeric vector (temporal framework) representing
the in-sample residuals at all the temporal frequencies ordered from the lowest
frequency to the highest frequency (columns) for each variable (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_order</code></td>
<td>
<p>Highest available sampling frequency per seasonal cycle (max. order
of temporal aggregation, <code class="reqn">m</code>), or a vector representing a subset of <code class="reqn">p</code> factors
of <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_res</code></td>
<td>
<p>A list of <code class="reqn">H</code> multi-step residuals. Each element in the list
can be either a (<code class="reqn">T \times 1</code>) vector (temporal framework) or a (<code class="reqn">T \times n</code>)
matrix (cross-temporal framework).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">Z_t</code>, <code class="reqn">t=1,\dots,T</code>, be a univariate time series. We can define the multi-step
residuals such us
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\varepsilon}_{h,t} = Z_{t+h} - \widehat{Z}_{t+h|t} \qquad h \le t \le T-h</code>
</p>

<p>where <code class="reqn">\widehat{Z}_{t+h|t}</code> is the <code class="reqn">h</code>-step fitted value, calculated as the <code class="reqn">h</code>-step ahead
forecast condition to the information up to time <code class="reqn">t</code>. Given the list of errors at different steps
</p>
<p style="text-align: center;"><code class="reqn">\left([\widehat{\varepsilon}_{1,1}, \; \dots, \; \widehat{\varepsilon}_{1,T}], \dots, [\widehat{\varepsilon}_{H,1}, \; \dots, \; \widehat{\varepsilon}_{H,T}]\right),</code>
</p>

<p>arrange_hres returns a <code class="reqn">T</code>-vector with the residuals, organized in the following way:
</p>
<p style="text-align: center;"><code class="reqn">[\varepsilon_{1,1} \; \varepsilon_{2,2} \; \dots \; \varepsilon_{H,H} \; \varepsilon_{1,H+1} \; \dots \; \varepsilon_{H,T-H}]'</code>
</p>

<p>A similar organisation can be apply to a multivariate time series.
</p>


<h3>Value</h3>

<p>res2matrix returns a (<code class="reqn">N \times n(k^\ast + m)</code>) matrix, where <code class="reqn">n = 1</code>
for the temporal framework.
</p>
<p>arrange_hres returns a (<code class="reqn">N(k^\ast+m) \times 1</code>) vector (temporal framework)
or a (<code class="reqn">n \times N(k^\ast+m)</code>) matrix  (cross-temporal framework) of multi-step residuals.
</p>


<h3>References</h3>

<p>Di Fonzo, T. and Girolimetto, D. (2023), Cross-temporal forecast reconciliation:
Optimal combination method and heuristic alternatives, <em>International Journal
of Forecasting</em>, 39, 1, 39-57. <a href="https://doi.org/10.1016/j.ijforecast.2021.08.004">doi:10.1016/j.ijforecast.2021.08.004</a>
</p>
<p>Girolimetto, D., Athanasopoulos, G., Di Fonzo, T. and Hyndman, R.J. (2024),
Cross-temporal probabilistic forecast reconciliation: Methodological and
practical issues. <em>International Journal of Forecasting</em>, 40, 3, 1134-1151.
<a href="https://doi.org/10.1016/j.ijforecast.2023.10.003">doi:10.1016/j.ijforecast.2023.10.003</a>
</p>


<h3>See Also</h3>

<p>Utilities: 
<code>FoReco2matrix()</code>,
<code>aggts()</code>,
<code>balance_hierarchy()</code>,
<code>commat()</code>,
<code>csprojmat()</code>,
<code>cstools()</code>,
<code>ctprojmat()</code>,
<code>cttools()</code>,
<code>df2aggmat()</code>,
<code>lcmat()</code>,
<code>recoinfo()</code>,
<code>shrink_estim()</code>,
<code>teprojmat()</code>,
<code>tetools()</code>,
<code>unbalance_hierarchy()</code>
</p>


</div>