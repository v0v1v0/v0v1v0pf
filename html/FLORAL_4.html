<div class="container">

<table style="width: 100%;"><tr>
<td>simu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate data following log-ratio model</h2>

<h3>Description</h3>

<p>Simulate a dataset from log-ratio model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simu(
  n = 100,
  p = 200,
  model = "linear",
  weak = 4,
  strong = 6,
  weaksize = 0.125,
  strongsize = 0.25,
  pct.sparsity = 0.5,
  rho = 0,
  timedep_slope = NULL,
  timedep_cor = NULL,
  longitudinal_stability = TRUE,
  ncov = 0,
  betacov = 0,
  intercept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer of sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>An integer of number of features (taxa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Type of models associated with outcome variable, can be "linear", "binomial", "cox", "finegray", or "timedep" (survival endpoint with time-dependent features).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weak</code></td>
<td>
<p>Number of features with <code>weak</code> effect size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strong</code></td>
<td>
<p>Number of features with <code>strong</code> effect size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weaksize</code></td>
<td>
<p>Actual effect size for <code>weak</code> effect size. Must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strongsize</code></td>
<td>
<p>Actual effect size for <code>strong</code> effect size. Must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct.sparsity</code></td>
<td>
<p>Percentage of zero counts for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Parameter controlling the correlated structure between taxa. Ranges between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timedep_slope</code></td>
<td>
<p>If <code>model</code> is "timedep", this parameter specifies the slope for the feature trajectories. Please refer to the Simulation section of the manuscript for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timedep_cor</code></td>
<td>
<p>If <code>model</code> is "timedep", this parameter specifies the sample-wise correlations between longitudinal features. Please refer to the Simulation section of the manuscript for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitudinal_stability</code></td>
<td>
<p>If <code>model</code> is "timedep", this is a binary indicator which determines whether the trajectories are more stable (<code>TRUE</code>) or more volatile (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncov</code></td>
<td>
<p>Number of covariates that are not compositional features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betacov</code></td>
<td>
<p>Coefficients corresponding to the covariates that are not compositional features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Boolean. If TRUE, then a random intercept will be generated in the model. Only works for <code>linear</code> or <code>binomial</code> models.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with simulated count matrix <code>xcount</code>, log1p-transformed count matrix <code>x</code>, outcome (continuous <code>y</code>, continuous centered <code>y0</code>, binary <code>y</code>, or survival <code>t</code>, <code>d</code>), true coefficient vector <code>beta</code>, list of non-zero features <code>idx</code>, value of intercept <code>intercept</code> (if applicable).
</p>


<h3>Author(s)</h3>

<p>Teng Fei. Email: feit1@mskcc.org
</p>


<h3>References</h3>

<p>Fei T, Funnell T, Waters N, Raj SS et al. Enhanced Feature Selection for Microbiome Data using FLORAL: Scalable Log-ratio Lasso Regression bioRxiv 2023.05.02.538599.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(23420)
dat &lt;- simu(n=50,p=30,model="linear")

</code></pre>


</div>