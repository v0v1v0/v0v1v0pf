<div class="container">

<table style="width: 100%;"><tr>
<td>get.pi0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>pi0 Estimation</h2>

<h3>Description</h3>

<p>This function estimates the null proportion of data or pi0 value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.pi0(
  pvalues,
  set.pi0 = 1,
  zvalues = "two.sided",
  estim.method = "last.hist",
  threshold = 0.05,
  default.odds = 1,
  hist.breaks = "scott",
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>A numeric vector of raw p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.pi0</code></td>
<td>
<p>A numeric value to specify a known or assumed pi0 value in the interval <code>[0,1]</code>. Defaults to 1. Which means the assumption is that all inputted raw p-values come from the null distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zvalues</code></td>
<td>
<p>A numeric vector of z-values to be used in pi0 estimation or a string with options "two.sided", "greater" or "less". Defaults to "two.sided".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estim.method</code></td>
<td>
<p>A string used to determine which method is used to estimate the pi0 value. Defaults to "last.hist".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A numeric value in the interval <code>[0,1]</code> used in a multiple comparison hypothesis tests to determine significance from the null. Defaults to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default.odds</code></td>
<td>
<p>A numeric value determining the ratio of pi1/pi0 used in the computation of lower bound FDR. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist.breaks</code></td>
<td>
<p>A numeric or string variable representing how many breaks in the pi0 estimation histogram methods. Defaults to "scott".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A Boolean TRUE or FALSE value indicating whether NA's should be removed from the inputted raw p-value vector before further computation. Defaults to TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We run into errors or warnings when pvalues, zvalues, threshold or default.odds are not inputted correctly.
</p>


<h3>Value</h3>

<p>An estimated null proportion:
</p>
<table><tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>A numeric value representing the proportion of the given data that come from the null distribution. A value in the interval <code>[0,1]</code>.</p>
</td>
</tr></table>
<h3>References</h3>

<p>Romain Francois (2014).
<em>bibtex: bibtex parser</em>.
R package version 0.4.0.
</p>
<p>R Core Team (2016).
<em>R: A Language and Environment for Statistical Computing</em>.
R Foundation for Statistical Computing, Vienna, Austria.
ISBN 3-900051-07-0, <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</p>
<p>Storey JD, Tibshirani R (2003).
“Statistical significance for genomewide studies.”
<em>Proceedings of the National Academy of Sciences</em>, <b>100</b>(16), 9440–9445.
</p>
<p>Meinshausen N, Rice J, others (2006).
“Estimating the proportion of false null hypotheses among a large number of independently tested hypotheses.”
<em>The Annals of Statistics</em>, <b>34</b>(1), 373–393.
</p>
<p>Jiang H, Doerge RW (2008).
“Estimating the proportion of true null hypotheses for multiple comparisons.”
<em>Cancer informatics</em>, <b>6</b>, 117693510800600001.
</p>
<p>Nettleton D, Hwang JG, Caldo RA, Wise RP (2006).
“Estimating the number of true null hypotheses from a histogram of p values.”
<em>Journal of agricultural, biological, and environmental statistics</em>, <b>11</b>(3), 337.
</p>
<p>Pounds S, Morris SW (2003).
“Estimating the occurrence of false positives and false negatives in microarray studies by approximating and partitioning the empirical distribution of p-values.”
<em>Bioinformatics</em>, <b>19</b>(10), 1236–1242.
</p>
<p>Murray MH, Blume JD (2020).
“False Discovery Rate Computation: Illustrations and Modifications.”
2010.04680.
</p>


<h3>See Also</h3>

<p><code>plot.p.fdr, p.fdr, summary.p.fdr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example 1
pi0 = 0.8
pi1 = 1-pi0
n = 10000
n.0 = ceiling(n*pi0)
n.1 = n-n.0

sim.data = c(rnorm(n.1,3,1),rnorm(n.0,0,1))
sim.data.p = 2*pnorm(-abs(sim.data))

get.pi0(sim.data.p, estim.method = "last.hist")
get.pi0(sim.data.p, estim.method = "storey")
get.pi0(sim.data.p, estim.method = "set.pi0")

</code></pre>


</div>