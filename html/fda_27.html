<div class="container">

<table style="width: 100%;"><tr>
<td>cca.fd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functional Canonical Correlation Analysis
</h2>

<h3>Description</h3>

<p>Carry out a functional canonical correlation analysis with
regularization or roughness penalties on the estimated
canonical variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cca.fd(fdobj1, fdobj2=fdobj1, ncan = 2,
       ccafdPar1=fdPar(basisobj1, 2, 1e-10),
       ccafdPar2=ccafdPar1, centerfns=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdobj1</code></td>
<td>

<p>a functional data object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdobj2</code></td>
<td>

<p>a functional data object.  By default this is <code> fdobj1 </code>, in
which case the first argument must be a bivariate functional data
object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncan</code></td>
<td>

<p>the number of canonical variables and weight functions to be
computed.  The default is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccafdPar1</code></td>
<td>

<p>a functional parameter object defining the first set of canonical
weight functions.  The object may contain specifications for a
roughness penalty. The default is defined using the same basis
as that used for <code> fdobj1 </code> with a slight penalty on its
second derivative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccafdPar2</code></td>
<td>

<p>a functional parameter object defining the second set of canonical
weight functions.  The object may contain specifications for a
roughness penalty. The default is <code> ccafdParobj1 </code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerfns</code></td>
<td>

<p>if TRUE, the functions are centered prior to analysis. This is the
default.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>cca.fd</code> with the 5 slots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ccwtfd1</code></td>
<td>

<p>a functional data object for the first
canonical variate weight function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccwtfd2</code></td>
<td>

<p>a functional data object for the second
canonical variate weight function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cancorr</code></td>
<td>

<p>a vector of canonical correlations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccavar1</code></td>
<td>

<p>a matrix of scores on the first canonical variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccavar2</code></td>
<td>

<p>a matrix of scores on the second canonical variable.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), 
<em>Functional Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), 
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>plot.cca.fd</code>,
<code>varmx.cca.fd</code>,
<code>pca.fd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#  Canonical correlation analysis of knee-hip curves

gaittime  &lt;- (1:20)/21
gaitrange &lt;- c(0,1)
gaitbasis &lt;- create.fourier.basis(gaitrange,21)
lambda    &lt;- 10^(-11.5)
harmaccelLfd &lt;- vec2Lfd(c(0, 0, (2*pi)^2, 0))

gaitfd    &lt;- fda::fd(matrix(0,gaitbasis$nbasis,1), gaitbasis)
gaitfdPar &lt;- fda::fdPar(gaitfd, harmaccelLfd, lambda)
gaitfd    &lt;- fda::smooth.basis(gaittime, gait, gaitfdPar)$fd
ccafdPar  &lt;- fda::fdPar(gaitfd, harmaccelLfd, 1e-8)
ccafd0    &lt;- cca.fd(gaitfd[,1], gaitfd[,2], ncan=3, ccafdPar, ccafdPar)
#  display the canonical correlations
round(ccafd0$ccacorr[1:6],3)
#  compute a VARIMAX rotation of the canonical variables
ccafd &lt;- varmx.cca.fd(ccafd0)
#  plot the canonical weight functions
oldpar &lt;- par(no.readonly= TRUE)
plot.cca.fd(ccafd)
par(oldpar)

</code></pre>


</div>