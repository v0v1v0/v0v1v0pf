<div class="container">

<table style="width: 100%;"><tr>
<td>volcano_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Volcano Plots for Visualizing Results of Differential Expression Analysis</h2>

<h3>Description</h3>

<p>Create a “volcano” plot to visualize the
results of a differential count analysis using a topic model. Here,
the volcano plot is a scatterplot in which the posterior mean
log-fold change (LFC), estimated by running the methods implemented
in <code>de_analysis</code>, is plotted against the estimated
z-score. Variations on this volcano plot may also be created, for
example by showing f0 (the null-model estimates) instead of the
z-scores. Use <code>volcano_plotly</code> to create an interactive
volcano plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">volcano_plot(
  de,
  k,
  labels,
  y = c("z", "f0"),
  do.label = volcano_plot_do_label_default,
  ymin = 1e-06,
  ymax = Inf,
  max.overlaps = Inf,
  plot.title = paste("topic", k),
  ggplot_call = volcano_plot_ggplot_call
)

## S3 method for class 'topic_model_de_analysis'
plot(x, ...)

volcano_plotly(
  de,
  k,
  file,
  labels,
  y = c("z", "f0"),
  ymin = 1e-06,
  ymax = Inf,
  width = 500,
  height = 500,
  plot.title = paste("topic", k),
  plot_ly_call = volcano_plot_ly_call
)

volcano_plot_do_label_default(lfc, y)

volcano_plot_ggplot_call(dat, y, plot.title, max.overlaps = Inf, font.size = 9)

volcano_plot_ly_call(dat, y, plot.title, width, height)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>de</code></td>
<td>
<p>An object of class “topic_model_de_analysis”,
usually an output from <code>de_analysis</code>. It is better to
run <code>de_analysis</code> with <code>shrink.method = "ash"</code> so that
the points in the volcano plot can be coloured by their local false
sign rate (lfsr).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The topic, selected by number or name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Character vector specifying how the points in the
volcano plot are labeled. This should be a character vector with
one entry per LFC estimate (row of <code>de$postmean</code>). When not
specified, the row names of <code>de$postmean</code> are used. When
available. labels are added to the plot using
<code>geom_text_repel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of the same length as <code>lfc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.label</code></td>
<td>
<p>The function used to deetermine which LFC estimates
to label. Replace <code>volcano_plot_do_label_default</code> with your
own function to customize the labeling of points in the volcano
plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>
<p>Y-axis values less than <code>ymin</code> are shown as
<code>ymin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>Y-axis values greater than <code>ymax</code> are shown as
<code>ymax</code>. When <code>y = "z"</code>, setting <code>ymax</code> to a finite
value can improve the volcano plot when some z-scores are much
larger (in magnitude) than others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.overlaps</code></td>
<td>
<p>Argument passed to
<code>geom_text_repel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title</code></td>
<td>
<p>The title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggplot_call</code></td>
<td>
<p>The function used to create the plot. Replace
<code>volcano_plot_ggplot_call</code> with your own function to customize
the appearance of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class “topic_model_de_analysis”,
usually an output from <code>de_analysis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>volcano_plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Save the interactive volcano plot to this HTML
file using <code>saveWidget</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Width of the plot in pixels. Passed as argument
“width” to <code>plot_ly</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>Height of the plot in pixels. Passed as argument
“height” to <code>plot_ly</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_ly_call</code></td>
<td>
<p>The function used to create the plot. Replace
<code>volcano_plot_ly_call</code> with your own function to customize
the appearance of the interactive plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfc</code></td>
<td>
<p>A vector of log-fold change estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data frame passed as input to
<code>ggplot</code>, containing, at a minimum, columns
“f0”, “postmean”, “y”, “lfsr” and
“label”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.size</code></td>
<td>
<p>Font size used in plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Interactive volcano plots can be created using the
‘plotly’ package. The “hover text” shows the label
and detailed LFC statistics.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object or a <code>plotly</code> object.
</p>


<h3>See Also</h3>

<p><code>de_analysis</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See help(de_analysis) for examples.

</code></pre>


</div>