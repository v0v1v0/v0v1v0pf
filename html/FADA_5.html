<div class="container">

<table style="width: 100%;"><tr>
<td>decorrelate.train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factor Adjusted Discriminant Analysis 1: Decorrelation of the training data</h2>

<h3>Description</h3>

<p>This function decorrelates the training dataset by adjusting data for the effects of latent factors of dependence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">decorrelate.train(data.train, nbf = NULL, maxnbfactors=12, diagnostic.plot = FALSE, 
min.err = 0.001, verbose = TRUE,EM = TRUE, maxiter = 15,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.train</code></td>
<td>
<p>A list containing the training dataset with the following components: <code>x</code> is the n x p matrix of explanatory variables, where n stands for the training sample size and
p for the number of explanatory variables ; <code>y</code> is a numeric vector giving the group of each individual numbered from 1 to K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbf</code></td>
<td>
<p>Number of factors. If <code>nbf = NULL</code>, the number of factors is estimated. <code>nbf</code> can
also be set to a positive integer value. If <code>nbf = 0</code>, the data are not factor-adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxnbfactors</code></td>
<td>
<p>The maximum number of factors. Default is <code>maxnbfactors=12</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostic.plot</code></td>
<td>
<p>If <code>diagnostic.plot =TRUE</code>, the values of the variance inflation criterion are
plotted for each number of factors. Default is <code>diagnostic.plot =FALSE</code>. This option might be helpful
to manually determine the optimal number of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.err</code></td>
<td>
<p>Threshold of convergence of the algorithm criterion. Default is min.err=0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print out number of factors and values of the objective criterion along the iterations. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM</code></td>
<td>
<p>The method used to estimate the parameters of the factor model. If <code>EM=TRUE</code>, parameters are estimated by an EM algorithm. Setting <code>EM=TRUE</code> is recommended when the number of covariates exceeds the number of observations. If <code>EM=FALSE</code>, the parameters are estimated by maximum-likelihood using <code>factanal</code>. Default is <code>EM=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations for estimation of the factor model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed in the <code>cv.glmnet</code> and <code>glmnet</code> functions from glmnet package. These functions are used to estimate individual group probabilities. Modifying these parameters should not affect the decorrelation procedure. However, the argument <code>nfolds</code> in <code>cv.glmnet</code> is set to 10 by default and should be reduced (minimum 3) for large datasets, in order to decrease the computation time of <code>decorrelation.train</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>meanclass</code></td>
<td>
<p>Group means estimated after iterative decorrelation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fa.training</code></td>
<td>
<p>Decorrelated training data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>Estimation of the factor model parameters: specific variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Estimation of the factor model parameters: loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors.training</code></td>
<td>
<p>Scores of the trainings individuals on the factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Recall of group variable of training data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba.training</code></td>
<td>
<p>Internal value (estimation of individual probabilities for the training dataset)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Emeline Perthame, Chloe Friguet and David Causeur
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2010), Regularization paths for generalized linear models via coordinate descent. Journal of Statistical Software, 33, 1-22.
</p>
<p>Friguet, C., Kloareg, M. and Causeur, D. (2009), A factor model approach to multiple testing under dependence. Journal of the American Statistical Association, 104:488, 1406-1415.
</p>
<p>Perthame, E., Friguet, C. and Causeur, D. (2015), Stability of feature selection in classification issues for high-dimensional correlated data, Statistics and Computing.
</p>


<h3>See Also</h3>

<p><code>FADA-package</code> <code>FADA </code> <code>glmnet-package</code> <code>factanal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data.train)

res0 = decorrelate.train(data.train,nbf=3) #  when the number of factors is forced

res1 = decorrelate.train(data.train) #  when the optimal number of factors is unknown
</code></pre>


</div>