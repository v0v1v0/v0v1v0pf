<div class="container">

<table style="width: 100%;"><tr>
<td>Mahalanobis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mahalanobis distance</h2>

<h3>Description</h3>

<p>Returns the squared Mahalanobis distance of all rows in <code class="reqn">\bold{x}</code> and the
vector <code class="reqn">\bold{\mu}</code> = <code>center</code> with respect to <code class="reqn">\bold{\Sigma}</code> = <code>cov</code>.
This is (for vector <code class="reqn">\bold{x}</code>) defined as
</p>
<p style="text-align: center;"><code class="reqn">D^2 = (\bold{x} - \bold{\mu})^T \bold{\Sigma}^{-1} (\bold{x} - \bold{\mu})</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">Mahalanobis(x, center, cov, inverted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector or matrix of data. As usual, rows are observations and columns are
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>mean vector of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>covariance matrix (<code class="reqn">p \times p</code>) of the distribution, must
be positive definite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverted</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>cov</code> is supposed to contain the
<em>inverse</em> of the covariance matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Unlike function <code>mahalanobis</code>, the covariance matrix is factorized using the
Cholesky decomposition, which allows to assess if <code>cov</code> is positive definite.
Unsuccessful results from the underlying LAPACK code will result in an error message.
</p>


<h3>See Also</h3>

<p><code>cov</code>, <code>mahalanobis</code></p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- cbind(1:6, 1:3)
xbar &lt;- colMeans(x)
S &lt;- matrix(c(1,4,4,1), ncol = 2) # is negative definite
D2 &lt;- mahalanobis(x, center = xbar, S)
all(D2 &gt;= 0) # several distances are negative

## next command produces the following error:
## Covariance matrix is possibly not positive-definite
## Not run: D2 &lt;- Mahalanobis(x, center = xbar, S)
</code></pre>


</div>