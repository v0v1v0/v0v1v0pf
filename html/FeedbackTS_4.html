<div class="container">

<table style="width: 100%;"><tr>
<td>feedback.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of feedback and change-in-feedback for a single time series
</h2>

<h3>Description</h3>

<p>Randomization test to investigate the fragmented time directionality in a single time series and the temporal variation in the fragmented time directionality.
</p>


<h3>Usage</h3>

<pre><code class="language-R">feedback.test(object, test, operator, nb.rand, plots = TRUE, turning.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>either a KDD object or a KDD.yearly.average object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>a character string specifying the type of test, must be one of <code>"feedback"</code> or <code>"change.in.feedback"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>operator</code></td>
<td>

<p>a character string specifying the transformation of the raw values, must be one of <code>"dmv"</code> or <code>"dmpiv"</code> (see section Details in after.minus.before).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.rand</code></td>
<td>

<p>a positive integer specifying the number of randomizations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>

<p>a logical indicating if plots characterizing the test are produced (if <code>plots = TRUE</code>) or not (if <code>plots = FALSE</code>), default is TRUE. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>turning.year</code></td>
<td>

<p>an optional numeric value specifying a temporal turning point in the data series, must be provided if <code>operator = "change.in.feedback"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>plots = TRUE</code>, two plots are produced. The first plot gives the cumulative after-before difference (CABD; red curve) and for each CABD value the quantiles of order 0.025 (bottom dotted curve), 0.25 (bottom dashed curve), 0.5 (solid black curve), 0.75 (top dashed curve) and 0.975 (top dotted curve) under the null hypothesis that is tested (either no feedback or no change-in-feedback). The second plot gives the number of exits of the CABD function from the confidence intervals (red line) and the distribution of the number of exits under the null hypothesis that is tested (histogram).
</p>


<h3>Value</h3>

<p>A numeric value providing the p-value of the test.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p>KDD, KDD.yearly.average, kdd.from.raw.data, after.minus.before, rain.site.6008
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008, keyday.threshold=25, nb.days=20,
   col.series=5, col.date=c(2,3,4), na.rm=TRUE, filter=NULL)

#### test feedback and change in feedback with a single data series
## using the thresholded data series
## using difference of means of positive indicator values (i.e. rainfall occurrence)
par(mfrow=c(1,2), mar=c(5.1,4.1,4.1,2.1))
feedback.test(object=KDD, test="feedback", operator="dmpiv", nb.rand=10^3, plots=TRUE)
</code></pre>


</div>