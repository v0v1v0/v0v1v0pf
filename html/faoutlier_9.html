<div class="container">

<table style="width: 100%;"><tr>
<td>forward.search</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Forward search algorithm for outlier detection</h2>

<h3>Description</h3>

<p>The forward search algorithm begins by selecting a homogeneous subset
of cases based on a maximum likelihood criteria and continues to add individual
cases at each iteration given an acceptance criteria. By default the function
will add cases that contribute most to the likelihood function and that have
the closest robust Mahalanobis distance, however model implied residuals
may be included as well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">forward.search(
  data,
  model,
  criteria = c("GOF", "mah"),
  n.subsets = 1000,
  p.base = 0.4,
  print.messages = TRUE,
  ...
)

## S3 method for class 'forward.search'
print(x, ncases = 10, stat = "GOF", ...)

## S3 method for class 'forward.search'
plot(
  x,
  y = NULL,
  stat = "GOF",
  main = "Forward Search",
  type = c("p", "h"),
  ylab = "obs.resid",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix or data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>if a single numeric number declares number of factors to extract in
exploratory factor analysis. If <code>class(model)</code> is a sem (semmod), or lavaan (character),
then a confirmatory approach is performed instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>character strings indicating the forward search method
Can contain <code>'GOF'</code> for goodness of fit distance, <code>'mah'</code> for Mahalanobis
distance, or <code>'res'</code> for model implied residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.subsets</code></td>
<td>
<p>a scalar indicating how many samples to draw to find
a homogeneous starting base group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.base</code></td>
<td>
<p>proportion of sample size to use as the base group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.messages</code></td>
<td>
<p>logical; print how many iterations are remaining?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>forward.search</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncases</code></td>
<td>
<p>number of final cases to print in the sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>type of statistic to use. Could be 'GOF', 'RMR', or 'gCD' for
the model chi squared value, root mean square residual, or generalized Cook's distance,
respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>null</code> value ignored by <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the main title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of plot to use, default displays points and lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>the y label of the plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that <code>forward.search</code> is not limited to confirmatory factor analysis and
can apply to nearly any model being studied
where detection of influential observations is important.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data
screening and assumption testing for exploratory and confirmatory factor analysis.
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>
<p>Mavridis, D., &amp; Moustaki, I. (2008). Detecting Outliers in Factor Analysis Using the
Forward Search Algorithm. <em>Multivariate Behavioral Research, 43</em>, 453-475,
doi: <a href="https://doi.org/10.1080/00273170802285909">10.1080/00273170802285909</a>
</p>


<h3>See Also</h3>

<p><code>gCD</code>, <code>GOF</code>, <code>LD</code>,
<code>robustMD</code>, <code>setCluster</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

#run all internal gCD and GOF functions using multiple cores
setCluster()

#Exploratory
nfact &lt;- 3
(FS &lt;- forward.search(holzinger, nfact))
(FS.outlier &lt;- forward.search(holzinger.outlier, nfact))
plot(FS)
plot(FS.outlier)

#Confirmatory with sem
model &lt;- sem::specifyModel()
  F1 -&gt; Remndrs,    lam11
	  F1 -&gt; SntComp,    lam21
	  F1 -&gt; WrdMean,    lam31
	  F2 -&gt; MissNum,    lam41
	  F2 -&gt; MxdArit,    lam52
	  F2 -&gt; OddWrds,    lam62
	  F3 -&gt; Boots,      lam73
  F3 -&gt; Gloves,     lam83
	  F3 -&gt; Hatchts,    lam93
	  F1 &lt;-&gt; F1,   NA,     1
	  F2 &lt;-&gt; F2,   NA,     1
	  F3 &lt;-&gt; F3,   NA,     1


(FS &lt;- forward.search(holzinger, model))
(FS.outlier &lt;- forward.search(holzinger.outlier, model))
plot(FS)
plot(FS.outlier)

#Confirmatory with lavaan
model &lt;- 'F1 =~  Remndrs + SntComp + WrdMean
F2 =~ MissNum + MxdArit + OddWrds
F3 =~ Boots + Gloves + Hatchts'

(FS &lt;- forward.search(holzinger, model))
(FS.outlier &lt;- forward.search(holzinger.outlier, model))
plot(FS)
plot(FS.outlier)



## End(Not run)
</code></pre>


</div>