<div class="container">

<table style="width: 100%;"><tr>
<td>readFITSarray</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read an image (multi-dimensional array) from a FITS file</h2>

<h3>Description</h3>

<p>Read an image (multi-dimensional array) from an open
connection to a FITS file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">readFITSarray(zz, hdr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zz</code></td>
<td>
<p>File handle; see Example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hdr</code></td>
<td>
<p>Header card images, raw or parsed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>readFITSarray</code> reads the data from the image part of a FITS
Header and Data Unit (hdu) containing image data.  The header must be
read first by <code>readFITS</code> or <code>readFITSheader</code>;
either this header or the
parsed version from <code>parseHdr</code> are valid for the <var>hdr</var>
variable.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>imDat</code></td>
<td>
<p>Data array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axDat</code></td>
<td>
<p>Data frame with axis scaling and labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hdr</code></td>
<td>
<p>Vector with the parsed header.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Function assigns values of 1 to CRPIX, CRVAL, and CDELT if they are
unspecified in the header.
</p>
<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active devlopement with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code>readFITS</code>, <code>readFITSheader</code>,
<code>readFITSbintable</code>, <code>file</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">    require(FITSio)
    ## Make a test file.
    Z &lt;- matrix(1:15, ncol = 3)
    filename &lt;- paste(tempdir(), "test.fits", sep="")
    writeFITSim(Z, filename)
    ## Open file, read header and array, close file and delete.
    zz &lt;- file(description = filename, open = "rb")
    header &lt;- readFITSheader(zz)  # image data off primary header
    D &lt;- readFITSarray(zz, header)
    close(zz)
    ## Look at data list, header file, and parsed header
    str(D)
    image(D$imDat)
    str(header)
    str(parseHdr(header))
</code></pre>


</div>