<div class="container">

<table style="width: 100%;"><tr>
<td>functional_filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finds functional componentwise outliers</h2>

<h3>Description</h3>

<p>It finds functional componentwise outliers
as described in Capezza et al. (2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">functional_filter(
  mfdobj,
  method_pca = "ROBPCA",
  alpha = 0.95,
  fev = 0.999,
  delta = 0.1,
  alpha_binom = 0.99,
  bivariate = TRUE,
  max_proportion_componentwise = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mfdobj</code></td>
<td>
<p>A multivariate functional data object of class mfd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_pca</code></td>
<td>
<p>The method used in <code>rpca_mfd</code> to perform
robust multivariate functional principal component analysis (RoMFPCA).
See <code>rpca_mfd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Probability value such that only values of functional distances greater than
the <code>alpha</code>-quantile of the Chi-squared
distribution, with a number of degrees of freedom equal to the number
of principal components selected by <code>fev</code>, are considered
to determine the proportion of flagged componentwise outliers.
Default value is 0.95, as recommended by Agostinelli et al. (2015).
See Capezza et al. (2024) for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fev</code></td>
<td>
<p>Number between 0 and 1 denoting the fraction
of variability that must be explained by the
principal components to be selected to calculate functional distances after
applying RoMFPCA on <code>mfdobj</code>. Default is 0.999.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Number between 0 and 1 denoting the parameter of the
Binomial distribution whose <code>alpha_binom</code>-quantile
determines the threshold
used in the bivariate filter.
Given the i-th observation and the j-th functional variable,
the number of pairs flagged as functional componentwise outliers in
the i-th observation where the component (i, j) is involved
is compared against this threshold to identify additional functional
componentwise outliers to the ones found by the univariate filter.
Default is 0.1, recommended as conservative choice by Leung et al. (2017).
See Capezza et al. (2024) for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_binom</code></td>
<td>
<p>Probability value such that the <code>alpha</code>-quantile
of the Binomial distribution is considered as threshold
in the bivariate filter. See <code>delta</code> and Capezza et al. (2024)
for more details. Default value is 0.99.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bivariate</code></td>
<td>
<p>If TRUE, both univariate and bivariate filters
are applied. If FALSE, only the univariate filter is used.
Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_proportion_componentwise</code></td>
<td>
<p>If the functional filter identifies a proportion of functional
componentwise outliers larger than <code>max_proportion_componentwise</code>,
for a given observation, then it is considered as a functional casewise
outlier. Default value is 0.5.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two elements.
The first element is an <code>mfd</code> object containing
the original observation in the <code>mfdobj</code> input, but where
the basis coefficients of the components identified as functional
componentwise outliers are replaced by NA.
The second element of the list is a list of numbers, with length equal
to the number of functional variables in <code>mfdobj</code>.
Each element of this list contains the observations of the flagged
functional componentwise outliers for the corresponding functional variable.
</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A., Yohai, V. J., and Zamar, R. H. (2015).
Robust estimation of
multivariate location and scatter in the presence of cellwise and
casewise contamination.
<em>Test</em>, 24(3):441–461.
</p>
<p>Capezza, C., Centofanti, F., Lepore, A., Palumbo, B. (2024)
Robust Multivariate Functional Control Charts.
<em>Technometrics</em>, <a href="doi:10.1080/00401706.2024.2327346">doi:10.1080/00401706.2024.2327346</a>.
</p>
<p>Leung, A., Yohai, V., and Zamar, R. (2017).
Multivariate location and scatter matrix
estimation under cellwise and casewise contamination.
<em>Computational Statistics &amp; Data Analysis</em>, 111:59–76.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(funcharts)
mfdobj &lt;- get_mfd_list(air, grid = 1:24, n_basis = 13, lambda = 1e-2)
plot_mfd(mfdobj)
out &lt;- functional_filter(mfdobj)

## End(Not run)

</code></pre>


</div>