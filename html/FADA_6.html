<div class="container">

<table style="width: 100%;"><tr>
<td>FADA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factor Adjusted Discriminant Analysis 3-4 : Supervised classification on decorrelated data</h2>

<h3>Description</h3>

<p>This function performs supervised classification on factor-adjusted data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FADA(faobject, K=10,B=20, nbf.cv = NULL,method = c("glmnet", 
    "sda", "sparseLDA"), sda.method = c("lfdr", "HC"), alpha=0.1, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>faobject</code></td>
<td>
<p>An object returned by function <code>decorrelate.train</code> or <code>decorrelate.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of folds to estimate classification error rate, only when no testing data is provided. Default is <code>K=10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> Number of replications of the cross-validation. Default is <code>B=20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbf.cv</code></td>
<td>
<p>Number of factors for cross validation to compute error rate, only when no testing data is provided. By default, <code>nbf = NULL</code> and the number of factors is estimated for each fold of the cross validation. <code>nbf</code> can
also be set to a positive integer value. If <code>nbf = 0</code>, the data are not factor-adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used to perform supervised classification model. 3 options are available. If
<code>method = "glmnet"</code>, a Lasso penalized logistic regression is performed using <span class="pkg">glmnet</span> R package.
If <code>method = "sda"</code>, a LDA or DDA (see <code>diagonal</code> argument) is performed using Shrinkage Discriminant
Analysis using <span class="pkg">sda</span> R package. If <code>method = "sparseLDA"</code>, a Lasso penalized LDA is performed using
<span class="pkg">SparseLDA</span> R package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sda.method</code></td>
<td>
<p>The method used for variable selection, only if <code>method="sda"</code>. If <code>sda.method="lfdr"</code>,
variables are selected through CAT scores and False Non Discovery Rate control. If sda.method="HC", the variable selection
method is Higher Cristicism Thresholding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The proportion of the HC objective to be observed, only if method="sda" and sda.method="HC". Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Some arguments to tune the classification method. See the documentation of the chosen method (glmnet, sda or sda) for more informations about these parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Recall of the classification method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected</code></td>
<td>
<p>A vector containing index of the selected variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba.train</code></td>
<td>
<p>A matrix containing predicted group frequencies of training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba.test</code></td>
<td>
<p>A matrix containing predicted group frequencies of testing data, if a testing data set has been provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict.test</code></td>
<td>
<p>A matrix containing predicted classes of testing data, if a testing data set has been provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>A numeric value containing the average classification error, computed by cross validation, if no testing data set has been provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.error.se</code></td>
<td>
<p>A numeric value containing the standard error of the classification error, computed by cross validation, if no testing data set has been provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>The classification model performed. The class of this element is the class of a model returned by the chosen method. See the documentation of the chosen method for more details. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Emeline Perthame, Chloe Friguet and David Causeur
</p>


<h3>References</h3>

<p>Ahdesmaki, M. and Strimmer, K. (2010), Feature selection in omics prediction problems using cat scores and false non-discovery rate control. Annals of Applied Statistics, 4, 503-519.
</p>
<p>Clemmensen, L., Hastie, T. and Witten, D. and Ersboll, B. (2011), Sparse discriminant analysis. Technometrics, 53(4), 406-413.
</p>
<p>Friedman, J., Hastie, T. and Tibshirani, R. (2010), Regularization paths for generalized linear models via coordinate descent. Journal of Statistical Software, 33, 1-22.
</p>
<p>Friguet, C., Kloareg, M. and Causeur, D. (2009), A factor model approach to multiple testing under dependence. Journal of the American Statistical Association, 104:488, 1406-1415.
</p>
<p>Perthame, E., Friguet, C. and Causeur, D. (2015), Stability of feature selection in classification issues for high-dimensional correlated data, Statistics and Computing.
</p>


<h3>See Also</h3>

<p><code>FADA</code>, <code>decorrelate.train</code>, <code>decorrelate.test</code>, <code>sda</code>, <code>sda-package</code>,
<code>glmnet-package</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data.train)
data(data.test)

# When testing data set is provided
res = decorrelate.train(data.train)
res2 = decorrelate.test(res, data.test)
classif = FADA(res2,method="sda",sda.method="lfdr")

### Not run 
# When no testing data set is provided
# Classification error rate is computed by a K-fold cross validation.
# res = decorrelate.train(data.train)
# classif = FADA(res, method="sda",sda.method="lfdr")
</code></pre>


</div>