<div class="container">

<table style="width: 100%;"><tr>
<td>eval.surp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Values of a Functional Data Object Defining Surprisal Curves.</h2>

<h3>Description</h3>

<p>A surprisal vector of length <code>M</code> is minus the log to a positive integer 
base <code>M</code> of a set of <code>M</code> multinomial probabilities.  Surprisal
curves are functions of a one-dimensional index set, such that at any
value of the index set the values of the curves are a surprisal vector.
See Details below for further explanations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eval.surp(evalarg, Wfdobj, nderiv = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>evalarg</code></td>
<td>
<p>a vector or matrix of argument values at which the functional data
object is to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wfdobj</code></td>
<td>
<p>a functional data object of dimension <code>M-1</code> to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nderiv</code></td>
<td>
<p>An integer defining a derivatve of <code>Wfdobj</code> in
the set <code>c(0,1,2)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A surprisal <code>M</code>-vector is information measured in <code>M</code>-bits.
Since a multinomial probability vector must sum to one, it follows 
that the surprisal vector <code>S</code> must satisfy the constraint 
<code>log_M(sum(M^(-S)) = 0.</code> That is, surprisal vectors lie within a
curved <code>M-1</code>-dimensional manifold.
</p>
<p>Surprisal curves are defined by a set of unconstrained <code>M-1</code> B-spline 
functional data objects defined over an index set that are transformed into 
surprisal curves defined over the index set.  
</p>
<p>Let <code>C</code> be a <code>K</code> by <code>M-1</code> coefficient matrix defining the 
B-spline curves, where <code>K</code> is the number of B-spline basis functions.  
</p>
<p>Let a <code>M</code> by <code>M-1</code> matrix <code>Z</code> have orthonormal columns.
Matrices satisfying these constraints are generated by function 
<code>zerobasis()</code>.  
</p>
<p>Let <code>N</code> by <code>K</code> matrix be a matrix of B-spline basis values
evaluated at <code>N</code> evaluation points using function 
<code>eval.basis()</code>.
</p>
<p>Let <code>N</code> by <code>M</code> matrix <code>X</code> = <code>B * C * t(Z)</code>. 
</p>
<p>Then the <code>N</code> by <code>M</code> matrix <code>S</code> of surprisal values is
<code>S</code> = <code>-X + outer(log(rowSums(M^X))/log(M),rep(1,M))</code>.
</p>


<h3>Value</h3>

<p>A  <code>N</code> by <code>M</code> matrix <code>S</code> of surprisal values at points
<code>evalarg</code>, or their first or second derivatives.</p>


<h3>Author(s)</h3>

<p>Juan Li and James Ramsay</p>


<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), 
<em>Functional Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), 
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>smooth.surp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#  see example in man/smooth.surp.Rd
</code></pre>


</div>