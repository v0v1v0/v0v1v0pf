<div class="container">

<table style="width: 100%;"><tr>
<td>GSest_multireg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GS Estimates for Multivariate Regression</h2>

<h3>Description</h3>

<p>Computes GS-Estimates of multivariate regression based on Tukey's biweight 
function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'formula'
GSest_multireg(formula, data=NULL, ...)

## Default S3 method:
GSest_multireg(X, Y, int = TRUE, bdp = 0.5, control=GScontrol(...),
na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> an object of class <code>formula</code>; a symbolic description of the model to be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p> logical: if <code>TRUE</code> an intercept term is added to the model (unless it is already present in <code>X</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdp</code></td>
<td>
<p> required breakdown point. Should have <code class="reqn">0 &lt; </code> <code>bdp</code> <code class="reqn">\le 0.5</code>, the default is 0.5. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list with control parameters for tuning the computing algorithm, see <code>GScontrol</code>().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>Generalized S-estimators are defined by minimizing the determinant of a robust estimator of the scatter matrix of 
the differences of the residuals. Hence, this procedure is intercept free and only gives an estimate for the slope matrix. To estimate 
the intercept, we use the M-type estimator of location of Lopuhaa (1992) on the residuals with the residual scatter matrix 
estimate of the residuals as a preliminary estimate.  We use a fast algorithm similar to the one proposed by Salibian-Barrera
and Yohai (2006) for the regression case. See <code>GScontrol</code> for the adjustable tuning parameters of this algorithm.
</p>
<p>The returned object inherits from class <code>mlm</code> such that the standard <code>coef</code>, <code>residuals</code>, <code>fitted</code> and <code>predict</code> functions can be used.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBmultireg</code> which extends class <code>mlm</code> and contains at least the following components:
</p>
<table><tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p> GS-estimates of the regression coefficients</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma </code></td>
<td>
<p> GS-estimate of the error covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>GS-estimate of the error shape matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> GS-estimate of the size of the multivariate errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>implicit weights corresponding to the GS-estimates (i.e. final weights in the RWLS procedure for the intercept estimate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the residual exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of the responses; 0 otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b,c</code></td>
<td>
<p>tuning parameters used in Tukey biweight loss function, as determined by <code>bdp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> a list with following components: <code>est</code> = character string indicating that GS-estimates were used, and
<code>bdp</code> = a copy of the <code>bdp</code> argument </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> a copy of the <code>control</code> argument </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Ella Roelant, Gert Willems and Stefan Van Aelst</p>


<h3>References</h3>

 
<ul>
<li>
<p> H.P. Lopuhaa (1992) Highly efficient estimators of multivariate location with high breakdown point. 
<em>The Annals of Statistics</em>, <b>20</b>, 398-413. 
</p>
</li>
<li>
<p> E. Roelant, S. Van Aelst and  C. Croux (2009) Multivariate Generalized S-estimators. 
<em>Journal of Multivariate Analysis</em>, <b>100</b>, 876–887.
</p>
</li>
<li>
<p> M. Salibian-Barrera and V. Yohai (2006) A fast algorithm for S-regression estimates. 
<em>Journal of Computational and Graphical Statistics</em>, <b>15</b>, 414-427. 
</p>
</li>
<li>
<p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1–32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>FRBmultiregGS</code>, <code>GSboot_multireg</code>,  <code>Sest_multireg</code>, <code>GScontrol</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
    data(schooldata)
    school.x &lt;- data.matrix(schooldata[,1:5])
    school.y &lt;- data.matrix(schooldata[,6:8])
    GSest &lt;- GSest_multireg(school.x,school.y,nsamp=50)
    
    ## or using the formula interface
    GSests &lt;- GSest_multireg(cbind(reading,mathematics,selfesteem)~., data=schooldata)

</code></pre>


</div>