<div class="container">

<table style="width: 100%;"><tr>
<td>flux_quality</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>assessing quality of slopes calculated with flux_fitting</h2>

<h3>Description</h3>

<p>indicates if slopes should be discarded or replaced
by 0 according to quality thresholds set by user
</p>


<h3>Usage</h3>

<pre><code class="language-R">flux_quality(
  slopes_df,
  fit_type = c(),
  ambient_conc = 421,
  error = 100,
  fluxid_col = "f_fluxID",
  slope_col = "f_slope",
  weird_fluxes_id = c(),
  force_ok_id = c(),
  ratio_threshold = 0,
  pvalue_col = "f_pvalue",
  rsquared_col = "f_rsquared",
  pvalue_threshold = 0.3,
  rsquared_threshold = 0.7,
  conc_col = "f_conc",
  b_col = "f_b",
  time_col = "f_time",
  fit_col = "f_fit",
  cut_col = "f_cut",
  rmse_threshold = 25,
  cor_threshold = 0.5,
  b_threshold = 1,
  cut_arg = "cut"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>slopes_df</code></td>
<td>
<p>dataset containing slopes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_type</code></td>
<td>
<p>model fitted to the data, linear, quadratic or exponential.
Will be automatically filled if slopes_df was produced using flux_fitting()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ambient_conc</code></td>
<td>
<p>ambient gas concentration in ppm at the site of
measurement (used to detect measurement that started with a polluted setup)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>error of the setup, defines a window outside of which
the starting values indicate a polluted setup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fluxid_col</code></td>
<td>
<p>column containing unique IDs for each flux</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope_col</code></td>
<td>
<p>column containing the slope of each flux
(as calculated by the flux_fitting function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weird_fluxes_id</code></td>
<td>
<p>vector of fluxIDs that should be discarded
by the user's decision</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_ok_id</code></td>
<td>
<p>vector of fluxIDs for which the user wants to keep
the calculated slope despite a bad quality flag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_threshold</code></td>
<td>
<p>ratio of gas concentration data points over length of
measurement (in seconds) below which the measurement will be considered as
not having enough data points to be considered for calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue_col</code></td>
<td>
<p>column containing the p-value of each flux
(linear and quadratic fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsquared_col</code></td>
<td>
<p>column containing the r squared of each flux
(linear and quadratic fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue_threshold</code></td>
<td>
<p>threshold of p-value below which the change of
gas concentration over time is considered not significant
(linear and quadratic fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsquared_threshold</code></td>
<td>
<p>threshold of r squared value below which
the linear model is considered an unsatisfactory fit
(linear and quadratic fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc_col</code></td>
<td>
<p>column containing the measured gas concentration
(exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_col</code></td>
<td>
<p>column containing the b parameter of the exponential expression
(exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_col</code></td>
<td>
<p>column containing the time of each measurement in seconds
(exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_col</code></td>
<td>
<p>column containing the modeled data (exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_col</code></td>
<td>
<p>column containing the cutting information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmse_threshold</code></td>
<td>
<p>threshold for the RMSE of each flux above which
the fit is considered unsatisfactory (exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_threshold</code></td>
<td>
<p>threshold for the correlation coefficient of
gas concentration with time below which the correlation
is considered not significant (exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_threshold</code></td>
<td>
<p>threshold for the b parameter.
Defines a window with its opposite inside which the fit is
considered good enough (exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_arg</code></td>
<td>
<p>argument defining that the data point should be cut out</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>same dataframe with added quality flags and corrected slope column
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(slopes0lin)
flux_quality(slopes0lin, fit_type = "li")
data(slopes30)
flux_quality(slopes30, fit_type = "expo", slope_col = "f_slope")
</code></pre>


</div>