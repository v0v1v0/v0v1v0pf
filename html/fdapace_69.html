<div class="container">

<table style="width: 100%;"><tr>
<td>VCAM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sieve estimation:
B-spline based estimation procedure for time-varying additive models. The VCAM function can be used to perform function-to-scalar regression.</h2>

<h3>Description</h3>

<p>Sieve estimation:
B-spline based estimation procedure for time-varying additive models. The VCAM function can be used to perform function-to-scalar regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VCAM(Lt, Ly, X, optnAdd = list(), optnVc = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Lt</code></td>
<td>
<p>An <em>n</em>-dimensional list of <em>N_i</em>-dimensional vectors whose elements consist of longitudinal time points for each <em>i</em>-th subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ly</code></td>
<td>
<p>An <em>n</em>-dimensional list of <em>N_i</em>-dimensional vectors whose elements consist of longitudinal response observations of each <em>i</em>-subject corresponding to <em>Lt</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An <em>n</em> by <em>d</em> matrix whose row vectors consist of covariate vector of additive components for each subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optnAdd</code></td>
<td>
<p>A list of options controls B-spline parameters for additive components, specified by list(name=value). See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optnVc</code></td>
<td>
<p>A list of options controls B-spline parameters for varying-coefficient components, specified by list(name=value). See 'Details'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>VCAM</code> provides a simple algorithm based on B-spline basis to estimate its nonparametric additive and varying-coefficient components.
</p>
<p>Available control options for <em>optnAdd</em> are 
</p>

<dl>
<dt>nKnot</dt>
<dd>
<p>A <em>d</em>-dimensional vector which designates the number of knots for each additive component function estimation (default=10).</p>
</dd>
<dt>order</dt>
<dd>
<p>A <em>d</em>-dimensional vector which designates the order of B-spline basis for each additive component function estimation (default=3).</p>
</dd>
<dt>grid</dt>
<dd>
<p>A <em>N</em> by <em>d</em> matrix whose column vector consist of evaluation grid points for each component function estimation.</p>
</dd>
</dl>
<p>and control options for <em>optnVc</em> are 
</p>

<dl>
<dt>nKnot</dt>
<dd>
<p>A <em>(d+1)</em>-dimensional vector which designates the number of knots for overall mean function and each varying-coefficient component function estimation (default=10).</p>
</dd>
<dt>order</dt>
<dd>
<p>A <em>(d+1)</em>-dimensional vector which designates the order of B-spline basis for overall mean function and each varying-coefficient component function estimation (default=3).</p>
</dd>
<dt>grid</dt>
<dd>
<p>A <em>M</em> by <em>(d+1)</em> matrix whose column vectors consist of evaluation grid points for overall mean function and each varying-coefficient component function estimation.</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list containing the following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Lt</code></td>
<td>
<p>The same with input given by <em>Lt</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LyHat</code></td>
<td>
<p>Fitted values corresponding to <em>Ly</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiEst</code></td>
<td>
<p>An <em>N</em> by <em>d</em> matrix whose column vectors consist of estimates for each additive component function evaluated at <em>gridX</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0Est</code></td>
<td>
<p>An <em>M</em>-dimensional vector for overall mean function estimates evaluated at <em>gridT</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaEst</code></td>
<td>
<p>An <em>M</em> by <em>d</em> matrix whose column vectors consist of estimates for each varying-coefficient components evaluated at <em>gridT</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridX</code></td>
<td>
<p>The same with input given by <em>optnAdd$grid</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridT</code></td>
<td>
<p>The same with input  given by <em>optnVc$grid</em></p>
</td>
</tr>
</table>
<h3>References</h3>

<p><cite>Zhang, X. and Wang, J.-L. (2015), "Varying-coefficient additive models for functional data", Biometrika, Vol.102, No.1, p.15-32.</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(MASS)

set.seed(100)

n &lt;- 100
d &lt;- 2

Lt &lt;- list()
Ly &lt;- list()

m &lt;- rep(0,2)
S &lt;- matrix(c(1,0.5,0.5,1),nrow=2,ncol=2)
X &lt;- pnorm(mvrnorm(n,m,S))

beta0 &lt;- function(t) 1.5*sin(3*pi*(t+0.5))
beta1 &lt;- function(t) 3*(1-t)^2
beta2 &lt;- function(t) 4*t^3

phi1 &lt;- function(x) sin(2*pi*x)
phi2 &lt;- function(x) 4*x^3-1

for (i in 1:n) {
  Ni &lt;- sample(10:20,1)
  
  Lt[[i]] &lt;- sort(runif(Ni,0,1))
  Ly[[i]] &lt;- beta0(Lt[[i]]) + 
     beta1(Lt[[i]])*phi1(X[i,1]) + beta2(Lt[[i]])*phi2(X[i,2]) + rnorm(Ni,0,0.1)
  
}


vcam &lt;- VCAM(Lt,Ly,X)

op &lt;- par(no.readonly = TRUE)

par(mfrow=c(1,1))
plot(unlist(vcam$LyHat),unlist(Ly),xlab='observed Y',ylab='fitted Y')
abline(coef=c(0,1),col=8)

par(mfrow=c(1,2))
plot(vcam$gridX[,1],vcam$phiEst[,1],type='l',ylim=c(-1,1),xlab='x1',ylab='phi1')
points(vcam$gridX[,1],phi1(vcam$gridX[,1]),col=2,type='l',lty=2,lwd=2)
legend('topright',c('true','est'),lwd=2,lty=c(1,2),col=c(1,2))

plot(vcam$gridX[,2],vcam$phiEst[,2],type='l',ylim=c(-1,3),xlab='x2',ylab='phi2')
points(vcam$gridX[,2],phi2(vcam$gridX[,2]),col=2,type='l',lty=2,lwd=2)
legend('topleft',c('true','est'),lwd=2,lty=c(1,2),col=c(1,2))

par(mfrow=c(1,3))
plot(vcam$gridT,vcam$beta0Est,type='l',xlab='t',ylab='beta0')
points(vcam$gridT,beta0(vcam$gridT),col=2,type='l',lty=2,lwd=2)
legend('topright',c('true','est'),lwd=2,lty=c(1,2),col=c(1,2))

plot(vcam$gridT,vcam$betaEst[,1],type='l',xlab='t',ylab='beta1')
points(vcam$gridT,beta1(vcam$gridT),col=2,type='l',lty=2,lwd=2)
legend('topright',c('true','est'),lwd=2,lty=c(1,2),col=c(1,2))

plot(vcam$gridT,vcam$betaEst[,2],type='l',xlab='t',ylab='beta2')
points(vcam$gridT,beta2(vcam$gridT),col=2,type='l',lty=2,lwd=2)
legend('topright',c('true','est'),lwd=2,lty=c(1,2),col=c(1,2))

par(op)

</code></pre>


</div>