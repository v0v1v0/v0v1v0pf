<div class="container">

<table style="width: 100%;"><tr>
<td>LRpower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power simulation for kinship LR</h2>

<h3>Description</h3>

<p>This function uses simulations to estimate the likelihood ratio (LR)
distribution in a given kinship testing scenario. In the most general
setting, three pedigrees are involved: the two pedigrees being compared, and
the true relationship (which may differ from the other two). A subset of
individuals are available for genotyping. Some individuals may already be
genotyped; all simulations are then conditional on these.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LRpower(
  numeratorPed,
  denominatorPed,
  truePed = numeratorPed,
  ids,
  markers = NULL,
  source = "true",
  nsim = 1,
  threshold = NULL,
  disableMutations = NA,
  alleles = NULL,
  afreq = NULL,
  Xchrom = FALSE,
  knownGenotypes = NULL,
  plot = FALSE,
  plotMarkers = NULL,
  seed = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>numeratorPed, denominatorPed</code></td>
<td>
<p><code>ped</code> objects (or lists of such),
describing the two relationships under comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truePed</code></td>
<td>
<p>A <code>ped</code> object (or a list of such), describing the true
relationship. By default equal to <code>numeratorPed</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>Individuals available for genotyping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>A vector indicating the names or indices of markers attached
to the source pedigree. If NULL (default), then all markers attached to the
source pedigree are used. If <code>alleles</code> or <code>afreq</code> is non-NULL, then this
parameter is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>Either "true" (default), "numerator" or "denominator",
indicating which pedigree is used as source for marker data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>A positive integer: the number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A numeric vector with one or more positive numbers used as
LR thresholds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disableMutations</code></td>
<td>
<p>Not implemented yet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alleles, afreq, Xchrom</code></td>
<td>
<p>If these are given, they are used (together with
<code>knownGenotypes</code>) to create a marker object on the fly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knownGenotypes</code></td>
<td>
<p>A list of triplets <code style="white-space: pre;">⁠(a, b, c)⁠</code>, indicating that
individual <code>a</code> has genotype <code>b/c</code>. Ignored unless <code>alleles</code> or <code>afreq</code> is
non-NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Either a logical or the character "plotOnly". If the latter, a
plot is drawn, but no further computations are done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotMarkers</code></td>
<td>
<p>A vector of marker names or indices whose genotypes are to
be included in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer seed for the random number generator (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>LRpowerResult</code> object, which is essentially a list with the
following entries:
</p>

<ul>
<li> <p><code>LRperSim</code>: A numeric vector of length <code>nsim</code> containing the total LR for
each simulation.
</p>
</li>
<li> <p><code>meanLRperMarker</code>: The mean LR per marker, over all simulations.
</p>
</li>
<li> <p><code>meanLR</code>: The mean total LR over all simulations.
</p>
</li>
<li> <p><code>meanLogLR</code>: The mean total <code>log10(LR)</code> over all simulations.
</p>
</li>
<li> <p><code>IP</code>: A named numeric of the same length as <code>threshold</code>. For each element
of <code>threshold</code>, the fraction of simulations resulting in a LR exceeding the
given number.
</p>
</li>
<li> <p><code>time</code>: The total computation time.
</p>
</li>
<li> <p><code>params</code>: A list containing the input parameters <code>missing</code>, <code>markers</code>,
<code>nsim</code>, <code>threshold</code> and <code>disableMutations</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
# Paternity LR of siblings
ids = c("A", "B")
truth = nuclearPed(children = ids)
claim = nuclearPed(fa = "A", mo = "NN", children = "B")
unrel = singletons(ids)

# Simulation parameters
nsim = 10   # increase!
thresh = 1

# Simulation 1:
als = 1:5
afr = runif(5)
afr = afr/sum(afr)

pow1 = LRpower(claim, unrel, truth, ids = ids, nsim = nsim,
               threshold = thresh, alleles = als, afreq = afr,
               seed = 123)
pow1

# Simulation 2: Same, but using an attached marker
truth = addMarker(truth, alleles = als, afreq = afr)

pow2 = LRpower(claim, unrel, truth, ids = ids, nsim = nsim,
               threshold = thresh, markers = 1, seed = 123)

stopifnot(identical(pow1$LRperSim, pow2$LRperSim))


# True pedigree has inbred founders
truth2 = setFounderInbreeding(truth, value = 0.5)

pow3 = LRpower(claim, unrel, truth2, ids = ids, nsim = nsim,
               threshold = thresh, markers = 1, seed = 123) # plot = TRUE
pow3


</code></pre>


</div>