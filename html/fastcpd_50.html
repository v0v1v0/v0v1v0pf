<div class="container">

<table style="width: 100%;"><tr>
<td>variance_lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance estimation for linear models with change points</h2>

<h3>Description</h3>

<p>Estimate the variance for each block and then take the average.
</p>


<h3>Usage</h3>

<pre><code class="language-R">variance_lm(data, d = 1, block_size = ncol(data) - d + 1, outlier_iqr = Inf)

variance.lm(data, d = 1, block_size = ncol(data) - d + 1, outlier_iqr = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or a data frame with the response variable as the first
column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>The dimension of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_size</code></td>
<td>
<p>The size of the blocks to use for variance estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier_iqr</code></td>
<td>
<p>The number of interquartile ranges to use as a threshold
for outlier detection.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric value representing the variance.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("mvtnorm", quietly = TRUE)) {
  set.seed(1)
  n &lt;- 300
  p &lt;- 4
  x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
  theta &lt;- rbind(c(1, 3.2, -1, 0), c(-1, -0.5, 2.5, -2), c(0.8, 0, 1, 2))
  y &lt;- c(
    x[1:100, ] %*% theta[1, ] + rnorm(100, 0, 3),
    x[101:200, ] %*% theta[2, ] + rnorm(100, 0, 3),
    x[201:n, ] %*% theta[3, ] + rnorm(100, 0, 3)
  )
  (sigma2 &lt;- variance.lm(cbind(y, x)))

  set.seed(1)
  n &lt;- 300
  p &lt;- 4
  d &lt;- 2
  x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
  theta &lt;- cbind(c(1, 3.2, -1, 0), c(-1, -0.5, 2.5, -2), c(0.8, 0, 1, 2))
  theta &lt;- cbind(theta, theta)
  y &lt;- rbind(
    x[1:100, ] %*% theta[, 1:2] +
      mvtnorm::rmvnorm(100, rep(0, d), diag(3, d)),
    x[101:200, ] %*% theta[, 3:4] +
      mvtnorm::rmvnorm(100, rep(0, d), diag(3, d)),
    x[201:n, ] %*% theta[, 5:6] +
      mvtnorm::rmvnorm(100, rep(0, d), diag(3, d))
  )
  (sigma &lt;- variance.lm(cbind(y, x), d = d))
}
</code></pre>


</div>