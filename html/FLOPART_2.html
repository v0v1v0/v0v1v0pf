<div class="container">

<table style="width: 100%;"><tr>
<td>FLOPART_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert data for input to FLOPART</h2>

<h3>Description</h3>

<p>FLOPART needs at most one label per coverage data row, which may
not be the case for arbitrary coverage/labels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FLOPART_data(coverage, label)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>data frame of coverage with columns chromStart,
chromEnd, count</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>data frame of labels with with columns chromStart,
chromEnd, annotation</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>named list: coverage_dt is data table representing a
run-length encoding of the input coverage data, with additional
rows if there are label chromStart/chromEnd values not in the
set of coverage positions; label_dt is a data table with one row
per label, and additional columns firstRow/lastRow which refer
to row numbers of coverage_dt, 0-based for passing to C++ code.
</p>


<h3>Author(s)</h3>

<p>Toby Dylan Hocking
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(data.table)
d &lt;- function(chromStart, chromEnd, count){
  data.table(chromStart, chromEnd, count)
}
(cov.dt &lt;- rbind(
  d(0, 10, 53),
  d(10, 20, 124)))
l &lt;- function(chromStart, chromEnd, annotation){
  data.table(chromStart, chromEnd, annotation)
}
lab.dt &lt;- rbind(
  l(2, 7, "noPeaks"),
  l(8, 15, "peakStart"))
FLOPART::FLOPART_data(cov.dt)
FLOPART::FLOPART_data(cov.dt, lab.dt)
data("Mono27ac", package="FLOPART")
sapply(Mono27ac, dim)
converted &lt;- with(Mono27ac, FLOPART::FLOPART_data(coverage, labels))
sapply(converted, dim)
</code></pre>


</div>