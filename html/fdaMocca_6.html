<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mocca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>mocca plotting
</h2>

<h3>Description</h3>

<p>The function
takes a <code>mocca</code> object produced by <code>mocca()</code> and creates cluster means plots or covariance structure within each cluster.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mocca'
plot(x,type=1, select =NULL,transform=FALSE,covariance=TRUE,
    covariates =FALSE,lwd=2,ylab="",xlab="",main="",ylim=NULL,
    ncolors=NULL,probs=FALSE,pts=FALSE,size=50,
    years=NULL, years.names=NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a <code>mocca</code> object as produced by <code>mocca()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>determines what type of plots to print. For <code>type=1</code> (default) cluster mean curves are shown in one plot on one page together with the overall mean curve; <code>type=2</code> produces the trend of the frequencies of the different clusters, together with mean probabilites (if <code>probs=TRUE</code>), the mean value of the included covariates (if present) within each cluster (not the model estimated covariate values) are also shown, if <code>pts=TRUE</code> points of the frequency trend are plotted, cluster means are shown on separate plots; <code>type=3</code> illustrates the covariance (or correlation) structure within each cluster. <code>type=2</code> is used with annual data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>allows the plot for a single cluster mean to be selected for printing with <code>type=1</code> or <code>type=2</code>. it can also be the order of the cluster means to be printed. If <code>NULL</code> (default), the cluster mean curves are in <code>{1,2,...,K}</code> order, where <code>K</code> is the number of clusters.  If you just want the plot for the cluster mean of the second cluster set <code>select=2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>logical, informs whether svd back-transformation of the spline model matrix should be applied (see Arnqvist and Sjöstedt de Luna, 2019).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance</code></td>
<td>
<p>logical, informs whether covariance (<code>TRUE</code>) or correlation (<code>FALSE</code>) matrices should be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>logical, informs whether covariates should be added when printing the covariance structure of the spline coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>defines the line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>If supplied then this will be used as the <code>y</code> label for all plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>If supplied then this will be used as the <code>x</code> label for all plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Used as title for plots if supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>If supplied then this pair of numbers are used as the <code>y</code> limits for each plot. Default <code>ylim=c(-45, 55)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolors</code></td>
<td>
<p>defines the number of colors (<code class="reqn">\geq 1</code>) to be in the palette, used with the <code>rainbow()</code> function. 
If <code>NULL</code> (default), <code>ncolors</code> equals the number of clusters <code>K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>logical, used with <code>type=2</code>, informs whether the mean probabilites should be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>logical, used with <code>type=2</code>, if <code>TRUE</code> (default) points of the frequency trend are shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>the bin size used with <code>type=2</code> (default: 50 years), the bin size of how many of those years belong to a specific cluster.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>years</code></td>
<td>
<p>a vector of years used with annual data and needed for <code>type=2</code> plot to calculate frequencies in the bins of size provided by the <code>size</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years.names</code></td>
<td>
<p>a character vector that gives names of the years needed for <code>type=2</code> plot. This can be also supplied with <code>data</code>. With <code>varve</code> data <code>years.names</code> are supplied as rownames of the matrix of covariates. if <code>years.names=NULL</code> (default) then <code>years</code> are converted to the character vector and used as <code>years.names</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other graphics parameters to pass on to plotting commands.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function generates plots.
</p>


<h3>Author(s)</h3>

<p>Per Arnqvist, Sara Sjöstedt de Luna,  Natalya Pya Arnqvist
</p>


<h3>References</h3>

<p>Arnqvist, P., and Sjöstedt de Luna, S. (2019). Model based functional clustering of varved lake sediments. <em>arXiv preprint arXiv:1904.10265</em>.
</p>


<h3>See Also</h3>

  <p><code>mocca</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## see ?mocca help files
</code></pre>


</div>