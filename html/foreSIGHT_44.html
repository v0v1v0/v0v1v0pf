<div class="container">

<table style="width: 100%;"><tr>
<td>runSystemModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Runs a system model and outputs the system performance</h2>

<h3>Description</h3>

<p><code>runSystemModel</code> uses time series of hydroclimatic variables generated using the function <code>generateScenarios</code> as input to a systemModel and
collates the system performance for all the targets and replicates in the scenarios.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runSystemModel(sim, systemModel, systemArgs, metrics)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>list; a simulation containing the scenarios generated using the function <code>generateScenarios</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>systemModel</code></td>
<td>
<p>a function; The function runs the system model using climate data in a data.frame as input.
The function is expected to be created by the user for specific system models. <code>tankWrapper</code> is an example system model function available in this package.
<code>runSystemModel</code> calls the function <code>systemModel</code> with two arguments:
</p>

<ul>
<li> <p><code>data</code>: data.frame; the climate data in a data frame with columns named <em>year</em> <em>month</em> <em>day</em> <em>*variable_name1*</em> <em>*variable_name2*</em>. 
</p>
</li>
<li> <p><code>systemArgs</code>: list; containing the other arguments required by the system model.<code>systemModel</code> unpack the arguments from the list and uses them as required. 
</p>
</li>
<li> <p><code>metrics</code>: string vector; containing the names of the performance metrics that the system model returns. It is recommended that the
names also contain the units of the metric. See <code>viewTankMetrics()</code> for examples.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>systemArgs</code></td>
<td>
<p>a list; containing the input arguments to <code>systemModel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metrics</code></td>
<td>
<p>a string vector; the names of the performance metrics the <code>systemModel</code> function returns.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>runSystemModel</code> function code is structured to be simple and may be used as an example to create scripts that use scenarios
generated using <code>generateScenarios</code> to run system models in other programming languages. Type <code>runSystemModel</code> to view the function code.
The function <code>tankWrapper</code> in this package may be used as an example to create user defined functions for the <code>systemModel</code> argument.
Refer to <code>tankWrapper</code> to understand how the <code>systemModel</code> is expected to use <code>systemArgs</code> and return the calculated performance metrics.
The <code>systemModel</code> function is expected to return a named list of performance metrics. The elements of the vector should correspond to <code>metrics</code>.
</p>


<h3>Value</h3>

<p>The function returns a list containing the performance metrics calculated by the <code>systemModel</code>. Each element of the list corresponds to a performance metric and is named using the <code>metrics</code> argument.
Each element contains performance values calculated at all the target points in the exposure space in a matrix with nrow corresponding to the targets and ncol corresponding to the replicates.
</p>


<h3>See Also</h3>

<p><code>tankWrapper</code>, <code>generateScenarios</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example using tankWrapper as the systemModel
#=====================================================
## Not run: 
# create an exposure space
attPerturb &lt;- c("P_ann_tot_m", "P_ann_nWet_m")
attHold &lt;- c("P_Feb_tot_m", "P_SON_dyWet_m", "P_JJA_avgWSD_m", "P_MAM_tot_m",
"P_DJF_avgDSD_m", "Temp_ann_rng_m", "Temp_ann_avg_m")
attPerturbType = "regGrid"
attPerturbSamp = c(2, 2)
attPerturbMin = c(0.9, 0.9)
attPerturbMax = c(1.1, 1.1)
expSpace &lt;- createExpSpace(attPerturb = attPerturb,
                           attPerturbSamp = attPerturbSamp,
                           attPerturbMin = attPerturbMin,
                           attPerturbMax = attPerturbMax,
                           attPerturbType = attPerturbType,
                           attHold = attHold,
                           attTargetsFile = NULL)
# load example observed data available in foreSIGHT
data(tankDat)
# perform stochastic simulation
sim &lt;- generateScenarios(reference = tank_obs,
                                  expSpace = expSpace,
                                  simLengthNyrs = 30)
# use the simulation to run a system model
systemArgs &lt;- list(roofArea = 205, nPeople = 1, tankVol = 2400,
firstFlush = 2.0, write.file = FALSE)
tankMetrics &lt;- viewTankMetrics()
systemPerf = runSystemModel(sim = sim,
                            systemModel = tankWrapper,
                            systemArgs = systemArgs,
                            metrics = tankMetrics[1:2])
                            
## End(Not run)
</code></pre>


</div>