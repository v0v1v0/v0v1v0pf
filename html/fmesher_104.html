<div class="container">

<table style="width: 100%;"><tr>
<td>fm_bary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute barycentric coordinates</h2>

<h3>Description</h3>

<p>Identify knot intervals or triangles and compute barycentric coordinates
</p>


<h3>Usage</h3>

<pre><code class="language-R">fm_bary(mesh, loc, ...)

## S3 method for class 'fm_mesh_1d'
fm_bary(mesh, loc, method = c("linear", "nearest"), restricted = FALSE, ...)

## S3 method for class 'fm_mesh_2d'
fm_bary(mesh, loc, crs = NULL, ...)

## S3 method for class 'inla.mesh'
fm_bary(mesh, ...)

## S3 method for class 'inla.mesh.1d'
fm_bary(mesh, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mesh</code></td>
<td>
<p><code>fm_mesh_1d</code> or <code>fm_mesh_2d</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>Points for which to identify the containing interval/triangle, and
corresponding barycentric coordinates. May be a vector (for 1d) or a matrix
of raw coordinates, <code>sf</code>, or <code>sp</code> point information (for 2d).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments forwarded to sub-methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character; method for defining the barycentric coordinates,
"linear" (default) or "nearest"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restricted</code></td>
<td>
<p>logical, used for <code>method="linear"</code>.
If <code>FALSE</code> (default), points outside the mesh interval will be given
barycentric weights less than 0 and greater than 1, according to linear
extrapolation. If <code>TRUE</code>, the barycentric weights are clamped to the (0, 1)
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>Optional crs information for <code>loc</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements <code>t</code>; either
</p>

<ul>
<li>
<p>vector of triangle indices (triangle meshes),
</p>
</li>
<li>
<p>matrix of interval knot indices (1D meshes), or
</p>
</li>
<li>
<p>matrix of lower left box indices (2D lattices),
</p>
</li>
</ul>
<p>and <code>bary</code>, a matrix of barycentric coordinates.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>fm_bary(fm_mesh_1d)</code>: Return a list with elements
<code>t</code> (start and endpoint knot indices) and <code>bary</code> (barycentric coordinates), both
2-column matrices.
</p>
<p>For <code>method = "nearest"</code>, <code>t[,1]</code> contains the index of the nearest mesh knot,
and each row of <code>bary</code> contains <code>c(1, 0)</code>.
</p>
</li>
<li> <p><code>fm_bary(fm_mesh_2d)</code>: A list with elements <code>t</code> (vector of triangle indices) and <code>bary</code>
(3-column matrix of barycentric coordinates). Points that were not found
give <code>NA</code> entries in <code>t</code> and <code>bary</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">str(fm_bary(fmexample$mesh, fmexample$loc_sf))
str(fm_bary(fm_mesh_1d(1:4), seq(0, 5, by = 0.5)))
</code></pre>


</div>