<div class="container">

<table style="width: 100%;"><tr>
<td>fregre.glm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Functional Generalized Linear Models</h2>

<h3>Description</h3>

<p>Computes functional generalized linear model between functional covariate
<code class="reqn">X^j(t)</code> (and non functional covariate <code class="reqn">Z^j</code>) and
scalar response <code class="reqn">Y</code> using basis representation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fregre.glm(
  formula,
  family = gaussian(),
  data,
  basis.x = NULL,
  basis.b = NULL,
  subset = NULL,
  weights = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced
to that class): a symbolic description of the model to be fitted. The
details of model specification are given under <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a family
function, a family function or the result of a call to a family function.
(See <code>family</code> for details of family functions.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>List that containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.x</code></td>
<td>
<p>List of basis for functional explanatory data estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.b</code></td>
<td>
<p>List of basis for <code class="reqn">\beta(t)</code> parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is an extension of the linear regression models:
<code>fregre.lm</code> where the <code class="reqn">E[Y|X,Z]</code> is related to the linear
prediction <code class="reqn">\eta</code> via a link function <code class="reqn">g(.)</code>.
</p>
<p style="text-align: center;"><code class="reqn">E[Y|X,Z]=\eta=g^{-1}(\alpha+\sum_{j=1}^{p}\beta_{j}Z^{j}+\sum_{k=1}^{q}\frac{1}{\sqrt{T_k}}\int_{T_k}{X^{k}(t)\beta_{k}(t)dt})</code>
</p>

<p>where <code class="reqn">Z=\left[ Z^1,\cdots,Z^p \right]</code> are the
non functional covariates and <code class="reqn">X(t)=\left[ X^{1}(t_1),\cdots,X^{q}(t_q)
\right]</code> are the functional ones.
</p>
<p>The first item in the <code>data</code> list is called <em>"df"</em> and is a data
frame with the response and non functional explanatory variables, as
<code>glm</code>.<br></p>
<p>Functional covariates of class <code>fdata</code> or <code>fd</code> are introduced in
the following items in the <code>data</code> list.<br><code>basis.x</code> is a list of
basis for represent each functional covariate. The basis object can be
created by the function: <code>create.pc.basis</code>, <code>pca.fd</code>
<code>create.pc.basis</code>, <code>create.fdata.basis</code> o
<code>create.basis</code>.<br><code>basis.b</code> is a list of basis for
represent each <code class="reqn">\beta(t)</code> parameter. If <code>basis.x</code> is a list of
functional principal components basis (see <code>create.pc.basis</code> or
<code>pca.fd</code>) the argument <code>basis.b</code> is ignored.
</p>

<p>represent beta lower than the number of basis used to represent the
functional data.
</p>


<h3>Value</h3>

<p>Return <code>glm</code> object plus:
</p>
 
<ul>
<li> <p><code>basis.x</code> Basis used for <code>fdata</code> or <code>fd</code> covariates. 
</p>
</li>
<li> <p><code>basis.b</code> Basis used for beta parameter estimation. 
</p>
</li>
<li> <p><code>beta.l</code> List of estimated beta parameter of functional covariates. 
</p>
</li>
<li> <p><code>data</code> List that containing the variables in the model. 
</p>
</li>
<li> <p><code>formula</code> formula. 
</p>
</li>
</ul>
<h3>Note</h3>

<p>If the formula only contains a non functional explanatory variables
(multivariate covariates), the function compute a standard <code>glm</code>
procedure.
</p>


<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Ramsay, James O., and Silverman, Bernard W. (2006), <em>
Functional Data Analysis</em>, 2nd ed., Springer, New York.
</p>
<p>McCullagh and Nelder (1989), <em>Generalized Linear Models</em> 2nd ed.
Chapman and Hall.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied Statistics
with S</em>, New York: Springer.
</p>


<h3>See Also</h3>

<p>See Also as: <code>predict.fregre.glm</code> and
<code>summary.glm</code>.<br> Alternative method if
<code>family</code>=<em>gaussian</em>: <code>fregre.lm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
data(tecator)
x=tecator$absorp.fdata
y=tecator$y$Fat
tt=x[["argvals"]]
dataf=as.data.frame(tecator$y)
nbasis.x=11
nbasis.b=7
basis1=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x)
basis2=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b)
f=Fat~Protein+x
basis.x=list("x"=basis1)
basis.b=list("x"=basis2)
ldata=list("df"=dataf,"x"=x)
res=fregre.glm(f,family=gaussian(),data=ldata,basis.x=basis.x,
basis.b=basis.b)
summary(res)

## End(Not run)
</code></pre>


</div>