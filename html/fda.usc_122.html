<div class="container">

<table style="width: 100%;"><tr>
<td>fregre.pc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional Regression with scalar response using Principal Components
Analysis</h2>

<h3>Description</h3>

<p>Computes functional (ridge or penalized) regression between functional
explanatory variable <code class="reqn">X(t)</code> and scalar response <code class="reqn">Y</code> using Principal
Components Analysis.<br></p>
<p style="text-align: center;"><code class="reqn">Y=\big&lt;X,\beta\big&gt;+\epsilon=\int_{T}{X(t)\beta(t)dt+\epsilon}</code>
</p>
 
<p>where <code class="reqn"> \big&lt; \cdot , \cdot \big&gt;</code> denotes the inner product on
<code class="reqn">L_2</code> and <code class="reqn">\epsilon</code> are random errors with mean zero , finite
variance <code class="reqn">\sigma^2</code> and <code class="reqn">E[X(t)\epsilon]=0</code>.<br></p>


<h3>Usage</h3>

<pre><code class="language-R">fregre.pc(
  fdataobj,
  y,
  l = NULL,
  lambda = 0,
  P = c(0, 0, 1),
  weights = rep(1, len = n),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdataobj</code></td>
<td>
<p><code>fdata</code> class object or <code>fdata.comp</code> class
object created<br> by <code>create.pc.basis</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Scalar response with length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>Index of components to include in the model.If is null <code>l</code> (by
default), <code>l=1:3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Amount of penalization. Default value is 0, i.e. no
penalization is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>If <code>P</code> is a vector: <code>P</code> are coefficients to define the
penalty matrix object, see <code>P.penalty</code>. If <code>P</code> is a matrix:
P is the penalty matrix object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes the <code class="reqn">\left\{\nu_k\right\}_{k=1}^{\infty}</code> orthonormal
basis of functional principal components to represent the functional data as
<code class="reqn">X_i(t)=\sum_{k=1}^{\infty}\gamma_{ik}\nu_k</code> and the functional parameter as
<code class="reqn">\beta(t)=\sum_{k=1}^{\infty}\beta_k\nu_k</code>, where <code class="reqn">\gamma_{ik}=\Big&lt; X_i(t),\nu_k\Big&gt;</code> and
<code class="reqn">\beta_{k}=\Big&lt;\beta,\nu_k\Big&gt;</code>. <br> 
The response can be fitted by: 
</p>
 
<ul>
<li> <p><code class="reqn">\lambda=0</code>, no penalization,
</p>
<p style="text-align: center;"><code class="reqn">\hat{y}=\nu_k^{\top}(\nu_k^{\top}\nu_k)^{-1}\nu_k^{\top}y</code>
</p>
 
</li>
<li>
<p> Ridge regression, <code class="reqn">\lambda&gt;0</code> and <code class="reqn">P=1</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{y}=\nu_k^{\top}(\nu_k\top \nu_k+\lambda I)^{-1}\nu_k^{\top}y</code>
</p>

</li>
<li>
<p> Penalized regression, <code class="reqn">\lambda&gt;0</code> and <code class="reqn">P\neq0</code>. For example, <code class="reqn">P=c(0,0,1)</code> penalizes the second derivative (curvature) by <code>P=P.penalty(fdataobj["argvals"],P)</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{y}=\nu_k^{\top}(\nu_k\top \nu_k+\lambda \nu_k^{\top}
\textbf{P}\nu_k)^{-1}\nu_k^{\top}y</code>
</p>

</li>
</ul>
<h3>Value</h3>

<p>Return:
</p>

<ul>
<li> <p><code>call</code> The matched call of <code>fregre.pc</code> function. 
</p>
</li>
<li> <p><code>coefficients</code> A named vector of coefficients.
</p>
</li>
<li> <p><code>residuals</code> <code>y</code>-<code>fitted values</code>. 
</p>
</li>
<li> <p><code>fitted.values</code> Estimated scalar response. 
</p>
</li>
<li> <p><code>beta.est</code> beta coefficient estimated of class <code>fdata</code>
</p>
</li>
<li> <p><code>df.residual</code> The residual degrees of freedom. In ridge regression, <code>df(rn)</code> is the effective degrees of freedom. 
</p>
</li>
<li> <p><code>r2</code> Coefficient of determination.
</p>
</li>
<li> <p><code>sr2</code> Residual variance. 
</p>
</li>
<li> <p><code>Vp</code> Estimated covariance matrix for the parameters. 
</p>
</li>
<li> <p><code>H</code> Hat matrix.
</p>
</li>
<li> <p><code>l</code> Index of principal components selected. 
</p>
</li>
<li> <p><code>lambda</code> Amount of shrinkage. 
</p>
</li>
<li> <p><code>P</code> Penalty matrix. 
</p>
</li>
<li> <p><code>fdata.comp</code> Fitted object in <code>fdata2pc</code> function. 
</p>
</li>
<li> <p><code>lm</code> <code>lm</code> object.
</p>
</li>
<li> <p><code>fdataobj</code> Functional explanatory data. 
</p>
</li>
<li> <p><code>y</code> Scalar response.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Cai TT, Hall P. 2006. <em>Prediction in functional linear
regression</em>. Annals of Statistics 34: 2159-2179.
</p>
<p>Cardot H, Ferraty F, Sarda P. 1999. <em>Functional linear model</em>.
Statistics and Probability Letters 45: 11-22.
</p>
<p>Hall P, Hosseini-Nasab M. 2006. <em>On properties of functional principal
components analysis</em>. Journal of the Royal Statistical Society B 68:
109-126.
</p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/">https://www.jstatsoft.org/v51/i04/</a>
</p>
<p>N. Kraemer, A.-L. Boulsteix, and G. Tutz (2008). <em>Penalized Partial
Least Squares with Applications to B-Spline Transformations and Functional
Data</em>. Chemometrics and Intelligent Laboratory Systems, 94, 60 - 69.
<a href="https://doi.org/10.1016/j.chemolab.2008.06.009">doi:10.1016/j.chemolab.2008.06.009</a>
</p>


<h3>See Also</h3>

<p>See Also as: <code>fregre.pc.cv</code>,
<code>summary.fregre.fd</code> and <code>predict.fregre.fd</code>.
</p>
<p>Alternative method: <code>fregre.basis</code> and <code>fregre.np</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
absorp &lt;- tecator$absorp.fdata
ind &lt;- 1:129
x &lt;- absorp[ind,]
y &lt;- tecator$y$Fat[ind]
res &lt;- fregre.pc(x,y)
summary(res)
res2 &lt;- fregre.pc(x,y,l=c(1,3,4))
summary(res2)
# Functional Ridge Regression
res3 &lt;- fregre.pc(x,y,l=c(1,3,4),lambda=1,P=1)
summary(res3)
# Functional Regression with 2nd derivative penalization
res4 &lt;- fregre.pc(x,y,l=c(1,3,4),lambda=1,P=c(0,0,1))
summary(res4)
betas &lt;- c(res$beta.est,res2$beta.est,
           res3$beta.est,res4$beta.est)
plot(betas)

## End(Not run) 

</code></pre>


</div>