<div class="container">

<table style="width: 100%;"><tr>
<td>topup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>topup - calling FSL topup</h2>

<h3>Description</h3>

<p>A tool for estimating and correcting susceptibility 
induced distortions
</p>


<h3>Usage</h3>

<pre><code class="language-R">topup(
  infile,
  datain,
  out = NULL,
  fout = NULL,
  iout = NULL,
  logout = NULL,
  warpres = 10,
  subsamp = 1,
  fwhm = 8,
  config = NULL,
  miter = 5,
  lambda = NULL,
  ssqlambda = 1,
  regmod = c("bending_energy", "membrane_energy"),
  estmov = 1,
  minmet = c(0, 1),
  splineorder = c(3, 2),
  numprec = c("double", "float"),
  interp = c("spline", "linear"),
  scale = c(0, 1),
  regrid = c(0, 1),
  verbose = TRUE
)

fsl_topup(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>infile</code></td>
<td>
<p>name of 4D file with images</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datain</code></td>
<td>
<p>name of text file with PE directions/times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>base-name of output files (spline coefficients (Hz) and 
movement parameters)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fout</code></td>
<td>
<p>name of image file with field (Hz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iout</code></td>
<td>
<p>name of 4D image file with unwarped images</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logout</code></td>
<td>
<p>Name of log-file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warpres</code></td>
<td>
<p>(approximate) resolution (in mm) of warp basis for 
the different sub-sampling levels, default 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsamp</code></td>
<td>
<p>sub-sampling scheme, default 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fwhm</code></td>
<td>
<p>FWHM (in mm) of gaussian smoothing kernel, default 8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>config</code></td>
<td>
<p>Name of config file specifying command line arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miter</code></td>
<td>
<p>Max # of non-linear iterations, default 5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Weight of regularisation, default depending on 
<code>ssqlambda</code> and <code>regmod</code> switches. See user documentation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssqlambda</code></td>
<td>
<p>If set (=1), lambda is weighted by current ssq, default 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regmod</code></td>
<td>
<p>Model for regularisation of warp-field 
[membrane_energy bending_energy], default bending_energy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estmov</code></td>
<td>
<p>Estimate movements if set, default 1 (true)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minmet</code></td>
<td>
<p>Minimisation method 0=Levenberg-Marquardt, 1=Scaled 
Conjugate Gradient, default 0 (LM)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splineorder</code></td>
<td>
<p>Order of spline, 2-&gt;Qadratic spline, 3-&gt;Cubic 
spline. Default=3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numprec</code></td>
<td>
<p>Precision for representing Hessian, double or float. 
Default double</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interp</code></td>
<td>
<p>Image interpolation model, linear or spline. Default spline</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If set (=1), the images are individually scaled to a 
common mean, default 0 (false)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regrid</code></td>
<td>
<p>If set (=1), the calculations are done in a different 
grid, default 1 (true)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print diagnostic information while running</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>topup</code> if using <code>fsl_topup</code></p>
</td>
</tr>
</table>
</div>