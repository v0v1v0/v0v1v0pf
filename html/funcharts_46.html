<div class="container">

<table style="width: 100%;"><tr>
<td>regr_cc_sof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scalar-on-Function Regression Control Chart</h2>

<h3>Description</h3>

<p>This function is deprecated. Use <code>regr_cc_sof</code>.
This function builds a data frame needed
to plot the scalar-on-function regression control chart,
based on a fitted function-on-function linear regression model and
proposed in Capezza et al. (2020).
If <code>include_covariates</code> is <code>TRUE</code>,
it also plots the Hotelling's T2 and
squared prediction error control charts built on the
multivariate functional covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">regr_cc_sof(
  object,
  y_new,
  mfdobj_x_new,
  y_tuning = NULL,
  mfdobj_x_tuning = NULL,
  alpha = 0.05,
  parametric_limits = FALSE,
  include_covariates = FALSE,
  absolute_error = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A list obtained as output from <code>sof_pc</code>,
i.e. a fitted scalar-on-function linear regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_new</code></td>
<td>
<p>A numeric vector containing the observations of
the scalar response variable
in the phase II data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfdobj_x_new</code></td>
<td>
<p>An object of class <code>mfd</code> containing
the phase II data set of the functional covariates observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_tuning</code></td>
<td>
<p>A numeric vector containing the observations of the scalar response
variable in the tuning data set.
If NULL, the training data, i.e. the data used to
fit the scalar-on-function regression model,
are also used as the tuning data set.
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfdobj_x_tuning</code></td>
<td>
<p>An object of class <code>mfd</code> containing
the tuning set of the multivariate functional data, used to estimate the
control chart limits.
If NULL, the training data, i.e. the data used to
fit the scalar-on-function regression model,
are also used as the tuning data set.
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>If it is a number between 0 and 1,
it defines the overall type-I error probability.
If <code>include_covariates</code> is <code>TRUE</code>, i.e.,
also the Hotelling's T2 and SPE control charts are built
on the functional covariates, then the Bonferroni
correction is applied by setting the type-I error probability
in the three control charts equal to <code>alpha/3</code>.
In this last case,
if you want to set manually the Type-I error probabilities,
then the argument <code>alpha</code> must be a named list
with three elements, named <code>T2</code>, <code>spe</code> and <code>y</code>,
respectively, each containing
the desired Type I error probability of
the corresponding control chart, where <code>y</code> refers to the
regression control chart.
Default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parametric_limits</code></td>
<td>
<p>If <code>TRUE</code>, the limits are calculated based on the normal distribution
assumption on the response variable, as in Capezza et al. (2020).
If <code>FALSE</code>, the limits are calculated nonparametrically as
empirical quantiles of the distribution of the residuals calculated
on the tuning data set.
The default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_covariates</code></td>
<td>
<p>If TRUE, also functional covariates are monitored through
<code>control_charts_pca</code>,.
If FALSE, only the scalar response, conditionally on the covariates,
is monitored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absolute_error</code></td>
<td>
<p>A logical value that, if <code>include_covariates</code> is TRUE, is passed
to <code>control_charts_pca</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The training data have already been used to fit the model.
An additional tuning data set can be provided that is used to estimate
the control chart limits.
A phase II data set contains the observations to be monitored
with the built control charts.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with as many rows as the
number of functional replications in <code>mfdobj_x_new</code>,
with the following columns:
</p>

<ul>
<li> <p><code>y_hat</code>: the predictions of the response variable
corresponding to <code>mfdobj_x_new</code>,
</p>
</li>
<li> <p><code>y</code>: the same as the argument <code>y_new</code> given as input
to this function,
</p>
</li>
<li> <p><code>lwr</code>: lower limit of the <code>1-alpha</code> prediction interval
on the response,
</p>
</li>
<li> <p><code>pred_err</code>: prediction error calculated as <code>y-y_hat</code>,
</p>
</li>
<li> <p><code>pred_err_sup</code>: upper limit of the <code>1-alpha</code> prediction interval
on the prediction error,
</p>
</li>
<li> <p><code>pred_err_inf</code>: lower limit of the <code>1-alpha</code> prediction interval
on the prediction error.
</p>
</li>
</ul>
<h3>References</h3>

<p>Capezza C, Lepore A, Menafoglio A, Palumbo B, Vantini S. (2020)
Control charts for
monitoring ship operating conditions and CO2 emissions
based on scalar-on-function regression.
<em>Applied Stochastic Models in Business and Industry</em>,
36(3):477â€“500.
<a href="doi:10.1002/asmb.2507">doi:10.1002/asmb.2507</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(funcharts)
air &lt;- lapply(air, function(x) x[1:100, , drop = FALSE])
fun_covariates &lt;- c("CO", "temperature")
mfdobj_x &lt;- get_mfd_list(air[fun_covariates],
                         n_basis = 15,
                         lambda = 1e-2)
y &lt;- rowMeans(air$NO2)
y1 &lt;- y[1:80]
y2 &lt;- y[81:100]
mfdobj_x1 &lt;- mfdobj_x[1:80]
mfdobj_x2 &lt;- mfdobj_x[81:100]
mod &lt;- sof_pc(y1, mfdobj_x1)
cclist &lt;- regr_cc_sof(object = mod,
                      y_new = y2,
                      mfdobj_x_new = mfdobj_x2)
plot_control_charts(cclist)

</code></pre>


</div>