<div class="container">

<table style="width: 100%;"><tr>
<td>fipp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moments of symmetric additive functional computed over the induced prior
partitions (static/dynamic MFMs and DPM)</h2>

<h3>Description</h3>

<p><code>fipp</code> is a closure which returns a function that computes moments of a
user-specified functional over the induced prior partitions. Required
arguments are: prior distribution of the number of mixture components and its
parameters (see examples for details). Optional arguments are: the number of
moments to be evaluated (currently only up to 2 are implemented) and whether
the mean/variance or 1st/2nd moments should be printed out as a result of
computing the first two moments (default is set to print out mean/variance).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fipp(
  lfunc,
  Kplus,
  N,
  type = c("DPM", "static", "dynamic"),
  alpha = NULL,
  gamma = NULL,
  maxK = NULL,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lfunc</code></td>
<td>
<p>a logged version of the additive symmetric functional intended
to compute over the prior partition. The function should only accept one
argument N_j (= number of observations in each partition).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kplus</code></td>
<td>
<p>a numeric value that represents the number of filled clusters in
data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the number of observation in data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of model considered. Three models (static/dynamic MFMs
and DPM) are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, gamma</code></td>
<td>
<p>hyperparameters for the Dirichlet prior. For static MFM,
gamma should be specified, while alpha should be specified for all other
models (that is, for dynamic MFM and DPM).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>the maximum number of K (= the number of mixture components)
considered. Only needed for static/dynamic MFMs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, indicating whether the probability should be logged or
not</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>fipp</code> returns a function which takes two required arguments
(required only for static/dynamic MFMs) and 2 optional arguments:
</p>
 <dl>
<dt>priorK</dt>
<dd>
<p>a function with support on the positive integers.
The function serves as a prior of K (default = NULL which is for DPM).</p>
</dd>
<dt>priorKparams</dt>
<dd>
<p>a named list of prior parameters for the function
supplied in argument <code>priorK</code> (default = NULL which is for
DPM).</p>
</dd>
<dt>order</dt>
<dd>
<p>maximum number of moments to be evaluated by the
function (default = 2)</p>
</dd>
<dt>replace2ndwvar</dt>
<dd>
<p>replace 2nd moment with
variance (default = TRUE)</p>
</dd>
</dl>
<h3>References</h3>

<p>Greve, J., Grün, B., Malsiner-Walli, G., and Frühwirth-Schnatter, S. (2020)
Spying on the Prior of the Number of Data Clusters and the Partition Distribution in Bayesian Cluster Analysis.
<a href="https://arxiv.org/abs/2012.12337">https://arxiv.org/abs/2012.12337</a>
</p>
<p>Escobar, M. D., and West, M. (1995) Bayesian Density Estimation and Inference Using Mixtures.
<em>Journal of the American Statistical Association</em> <b>90</b> (430), Taylor &amp; Francis: 577-–88.
<a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476550">https://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476550</a>
</p>
<p>Miller, J. W., and Harrison, M. T. (2018) Mixture Models with a Prior on the Number of Components.
<em>Journal of the American Statistical Association</em> <b>113</b> (521), Taylor &amp; Francis: 340-–56.
<a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2016.1255636">https://www.tandfonline.com/doi/full/10.1080/01621459.2016.1255636</a>
</p>
<p>Frühwirth-Schnatter, S., Malsiner-Walli, G., and Grün, B. (2020)
Generalized mixtures of finite mixtures and telescoping sampling <a href="https://arxiv.org/abs/2005.09918">https://arxiv.org/abs/2005.09918</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Determine mean/variance of the number of singleton clusters for dynamic 
## MFM model conditional on K+ = 5, alpha = 1 with a sample size N = 100.
## We assume that K will be smaller than 30 by setting maxK = 30, please
## increase this value for more realistic analysis.
## 
## First create the function singletons():
singletons &lt;- fipp(lfunc = function(n) log(n==1), Kplus = 5, N = 100,
  type = "dynamic", alpha = 1, maxK = 30)

## Then evaluate it using a Geom(0.1) prior:
singletons(dgeom, list(prob = 0.1))

## Try a different prior, the Poisson prior Pois(1):
singletons(dpois, list(lambda = 1))

## If mean is the only thing you are interested in, try the following:
singletons(dpois, list(lambda = 1), order = 1)

## Also, if you want 1st/2nd moments instead of mean/variance, try:
singletons(dpois, list(lambda = 1), replace2ndwvar = FALSE)

</code></pre>


</div>