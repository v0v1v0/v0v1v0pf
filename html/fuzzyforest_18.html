<div class="container">

<table style="width: 100%;"><tr>
<td>wff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>WGCNA based fuzzy forest algorithm</h2>

<h3>Description</h3>

<p>Fits fuzzy forests using WGCNA to cluster features into
distinct modules.  Requires installation of WGCNA package. Note that a formula interface for
WGCNA based fuzzy forests also exists: <code>wff.formula</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
wff(X, y, Z = NULL,
  WGCNA_params = WGCNA_control(power = 6),
  screen_params = screen_control(min_ntree = 500),
  select_params = select_control(min_ntree = 500), final_ntree = 5000,
  num_processors = 1, nodesize, test_features = NULL, test_y = NULL,
  ...)

wff(X, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A data.frame. Each column corresponds to a feature
vector.  WGCNA will be used to cluster the
features in X.  As a result, the features should be
all be numeric.  Non-numeric features may be input
via Z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector.  For classification, y should be a
factor.  For regression, y should be
numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Additional features that are not to be screened out
at the screening step.  WGCNA is not carried out on
features in Z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WGCNA_params</code></td>
<td>
<p>Parameters for WGCNA.
See blockwiseModules function from WGCNA and
<code>WGCNA_control</code> for details.
<code>WGCNA_params</code> is an object of type
<code>WGCNA_control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screen_params</code></td>
<td>
<p>Parameters for screening step of fuzzy forests.
See <code>screen_control</code> for details.
<code>screen_params</code> is an object of type
<code>screen_control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_params</code></td>
<td>
<p>Parameters for selection step of fuzzy forests.
See <code>select_control</code> for details.
<code>select_params</code> is an object of type
<code>select_control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_ntree</code></td>
<td>
<p>Number of trees grown in the final random forest.
This random forest contains all selected features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_processors</code></td>
<td>
<p>Number of processors used to fit random forests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodesize</code></td>
<td>
<p>Minimum terminal nodesize. 1 if classification.
5 if regression.  If the sample size is very large,
the trees will be grown extremely deep.
This may lead to issues with memory usage and may
lead to significant increases in the time it takes
the algorithm to run.  In this case,
it may be useful to increase <code>nodesize</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_features</code></td>
<td>
<p>A data.frame containing features from a test set.
The data.frame should contain the features in both
X and Z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_y</code></td>
<td>
<p>The responses for the test set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments currently not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of type <code>fuzzy_forest</code>.  This
object is a list containing useful output of fuzzy forests.
In particular it contains a data.frame with list of selected features.
It also includes the random forest fit using the selected features.
</p>


<h3>Note</h3>

<p>This work was partially funded by NSF IIS 1251151 and AMFAR 8721SC.
</p>


<h3>References</h3>

<p>Conn, D., Ngun, T., Ramirez C.M., Li, G. (2019).
"Fuzzy Forests: Extending Random Forest Feature Selection for Correlated, High-Dimensional Data."
<em>Journal of Statistical Software</em>, <strong>91</strong>(9).
doi: <a href="https://doi.org/10.18637/jss.v091.i09">10.18637/jss.v091.i09</a>
</p>
<p>Breiman, L. (2001).
"Random Forests."
<em>Machine Learning</em>, <strong>45</strong>(1), 5-32.
doi: <a href="https://doi.org/10.1023/A:1010933404324">10.1023/A:1010933404324</a>
</p>
<p>Zhang, B. and Horvath, S. (2005).
"A General Framework for Weighted Gene Co-Expression Network Analysis."
<em>Statistical Applications in Genetics and Molecular Biology</em>, <strong>4</strong>(1).
doi: <a href="https://doi.org/10.2202/1544-6115.1128">10.2202/1544-6115.1128</a>
</p>


<h3>See Also</h3>

<p><code>wff.formula</code>,
<code>print.fuzzy_forest</code>,
<code>predict.fuzzy_forest</code>,
<code>modplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ctg)
y &lt;- ctg$NSP
X &lt;- ctg[, 2:22]
WGCNA_params &lt;- WGCNA_control(p = 6, minModuleSize = 1, nThreads = 1)
mtry_factor &lt;- 1; min_ntree &lt;- 500;  drop_fraction &lt;- .5; ntree_factor &lt;- 1
screen_params &lt;- screen_control(drop_fraction = drop_fraction,
                                keep_fraction = .25, min_ntree = min_ntree,
                                ntree_factor = ntree_factor,
                                mtry_factor = mtry_factor)
select_params &lt;- select_control(drop_fraction = drop_fraction,
                                number_selected = 5,
                                min_ntree = min_ntree,
                                ntree_factor = ntree_factor,
                                mtry_factor = mtry_factor)

library(WGCNA)
wff_fit &lt;- wff(X, y, WGCNA_params = WGCNA_params,
                screen_params = screen_params,
                select_params = select_params,
                final_ntree = 500)

#extract variable importance rankings
vims &lt;- wff_fit$feature_list

#plot results
modplot(wff_fit)

</code></pre>


</div>