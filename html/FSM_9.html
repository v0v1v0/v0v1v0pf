<div class="container">

<table style="width: 100%;"><tr>
<td>perm_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fisher's randomization test for sharp null hypothesis.</h2>

<h3>Description</h3>

<p>Performs Fisher's randomization test for sharp null hypotheses of the form 
<code class="reqn">H_0: c_1 Y_i(1) + c_2 Y_i(2) - \tau = 0</code>, for a vector of contrasts <code class="reqn">(c_1, c_2)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perm_test(
  Y_obs,
  alloc_obs,
  alloc,
  contrast = c(1, -1),
  tau = 0,
  method = "marginal mean",
  alternative = "not equal"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y_obs</code></td>
<td>
<p>Vector of observed outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alloc_obs</code></td>
<td>
<p>Vector of observed treatment assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alloc</code></td>
<td>
<p>A matrix of treatment assignments over which the randomization distribution of the test statistic
is computed. Each row of <code>alloc</code> should correspond to an assignment vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>A vector of the coefficients of the treatment contrast of interest. For example, for estimating the
average treatment effect of treatment 1 versus treatment 2, <code>contrast = c(1,-1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The value of the treatment contrast specified by the sharp null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method of computing the test statistic. If <code>method = 'marginal mean'</code>, the test statistic
is <code class="reqn">c_1 \hat{Y}_i(1) + c_2 \hat{Y}_i(2)</code>, where <code class="reqn">\hat{Y}(z)</code> 
is the mean of the observed outcome in the group <code class="reqn">Z = z</code>, for <code class="reqn">z = 0,1</code>. If <code>method = 'marginal rank'</code>, 
the test statistic is <code class="reqn">c_1 \hat{Y}_i(1) + c_2 \hat{Y}_i(2)</code>, 
where <code class="reqn">\hat{Y}(z)</code> is the mean of the rank of the observed outcome in the group <code class="reqn">Z = z</code>, for <code class="reqn">z = 0,1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>The type of alternative hypothesis used. For right-sided test, <code>alternative = 'greater'</code>.
For left-sided test, <code>alternative = 'less'</code>. For both-sided test, <code>alternative = 'not equal'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following items.
</p>
<p><code>test_stat_obs</code>: The observed value of the test statistic.
</p>
<p><code>test_stat_iter</code>: A vector of values of the test statistic across repeated randomizations.
</p>
<p><code>p_value</code>: p-value of the test.
</p>


<h3>Author(s)</h3>

<p>Ambarish Chattopadhyay, Carl N. Morris and Jose R. Zubizarreta.
</p>


<h3>References</h3>

<p>Chattopadhyay, A., Morris, C. N., and Zubizarreta, J. R. (2020), â€œRandomized and Balanced Allocation 
of Units into Treatment Groups Using the Finite Selection Model for <code>R</code>".
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Consider N = 12, n1 = n2 = 6. 
# We test the sharp null of no treatment effect under CRD.
df_sample = data.frame(index = 1:12, x = c(20,30,40,40,50,60,20,30,40,40,50,60))
# True potential outcomes.
Y_1_true = 100 + (df_sample$x - mean(df_sample$x)) + rnorm(12, 0, 4)
Y_2_true = Y_1_true + 50
# Generate the realized assignment under CRD.
fc = crd(data_frame = df_sample, n_treat = 2, treat_sizes = c(6,6), control = FALSE)
Z_crd_obs = fc$Treat
# Get the observed outcomes
Y_obs = Y_1_true
Y_obs[Z_crd_obs == 2] = Y_2_true[Z_crd_obs == 2]
# Generate 1000 assignments under CRD.
Z_crd_iter = matrix(rep(0, 1000 * 12), nrow = 1000)
for(i in 1:1000)
{
fc = crd(data_frame = df_sample, n_treat = 2, treat_sizes = c(6,6), control = FALSE)
Z_crd_iter[i,] = fc$Treat
}
# Test for the sharp null H0: Y_i(1) = Y_i(0) for all i.
# Alternative: not H0 (two-sided test).
perm = perm_test(Y_obs = Y_obs, alloc_obs = Z_crd_obs, alloc = Z_crd_iter, 
contrast = c(1,-1), tau = 0, method = "marginal mean", alternative = 'not equal')
# Obtain the p-value.
perm$p_value
</code></pre>


</div>