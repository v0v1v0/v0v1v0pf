<div class="container">

<table style="width: 100%;"><tr>
<td>detrendTimeSeries</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Algorithms for data detrending</h2>

<h3>Description</h3>

<p>Allows to perform Exponential, Polynomial or Boxcar Filter detrending over a time series vector
</p>


<h3>Usage</h3>

<pre><code class="language-R">detrendTimeSeries(f, acqTime, nIntervals, algorithm, degree, w, pois = FALSE,
 max = FALSE, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acqTime</code></td>
<td>
<p>Point acquisition rate (in seconds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIntervals</code></td>
<td>
<p>Number of intervals into which the vector will be grouped prior to the detrending process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>A character string. Choose between Exponential ("exp"), Polynomial ("poly") or Boxcar Filter ("boxcar") detrending</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>The degree of the polynomial function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Moving average time window size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pois</code></td>
<td>
<p>Logical, set to TRUE for detrending performance by adding random, uncorrelated numbers sampled from a Poisson distribution (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>Logical, set to TRUE for detrending performance based on the highest value of the original data, rather than the first one (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical, set to TRUE (default) to plot de result</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First, the binTimeSeries() function is used to obtain a binned version of 'f' of 'nIntervals' points.
</p>
<p>For exponential detrending, a model of the form (A0*e^(k*t) is adjusted to the binned vector.
</p>
<p>A polynomial function of user-specified degree is rather used for polynomial detrending.
</p>
<p>For the case of boxcar filtering, the moving average vector is calculated from the original series.
An amount of zeroes equal to (w-1) is added at the tail of 'f' to compensate for the moving average
effect when position (length(f) - w + 1) is reached.
</p>
<p>In either case, the residuals are then obtained and added a constant value for trend correction.
When 'max' is set to TRUE, said value will be the highest in the binned vector of 'f'.
</p>
<p>When 'pois' is set to FALSE (default), the trend correction value is directly added to the obtained residuals,
in a quantity that will make the average counts remain constant throughout the whole time series.
On the other hand, when 'pois = TRUE', the trend correction value is instead used as the 'lambda'
parameter for a Poisson distribution from which uncorrelated counts will be randomly sampled and
added to the whole series for trend correction. This procedure asures that only integer counts will
be obtained after detrending, at the cost of adding some noise and making the detrending process a lengthier task.
</p>


<h3>Value</h3>

<p>A vector
</p>


<h3>Author(s)</h3>

<p>Alejandro Linares, Ad?n Guerrero, Haydee Hern?ndez
</p>


<h3>See Also</h3>

<p><code>binTimeSeries</code>
</p>


</div>