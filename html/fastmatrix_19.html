<div class="container">

<table style="width: 100%;"><tr>
<td>duplication</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Duplication matrix</h2>

<h3>Description</h3>

<p>This function returns the duplication matrix of order <code class="reqn">n</code> which transforms,
for a symmetric matrix <code class="reqn">\bold{A}</code>, <code>vech</code><code class="reqn">(\bold{A})</code> into <code>vec</code><code class="reqn">(\bold{A})</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">duplication(n = 1, matrix = FALSE, condensed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> order of the duplication matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p> a logical indicating whether the duplication matrix will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condensed</code></td>
<td>
<p> logical. Information should be returned in compact form?.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a wrapper function for the function <code>dupl.info</code>. This function
provides the minimum information required to create the duplication matrix. If option
<code>matrix = FALSE</code> the duplication matrix is stored in two vectors containing the
coordinate list of indexes for rows and columns. Option <code>condensed = TRUE</code> only
returns vector of indexes for the columns of duplication matrix.
</p>
<p><b>Warning:</b> <code>matrix = TRUE</code> is <b>not</b> recommended, unless the order <code>n</code>
be small. This matrix can require a huge amount of storage.
</p>


<h3>Value</h3>

<p>Returns an <code class="reqn">n^2</code> by <code class="reqn">n(n + 1)/2</code> matrix (if requested).
</p>


<h3>References</h3>

<p>Magnus, J.R., Neudecker, H. (1980).
The elimination matrix, some lemmas and applications.
<em>SIAM Journal on Algebraic Discrete Methods</em> <b>1</b>, 422-449.
</p>
<p>Magnus, J.R., Neudecker, H. (2007).
<em>Matrix Differential Calculus with Applications in Statistics and Econometrics</em>, 3rd Edition.
Wiley, New York.
</p>


<h3>See Also</h3>

<p><code>dupl.info</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">z &lt;- duplication(n = 100, condensed = TRUE)
object.size(z) # 40.5 Kb of storage

z &lt;- duplication(n = 100, condensed = FALSE)
object.size(z) # 80.6 Kb of storage

D100 &lt;- duplication(n = 100, matrix = TRUE)
object.size(D100) # 202 Mb of storage, do not request this matrix!

# a small example
D3 &lt;- duplication(n = 3, matrix = TRUE)
a &lt;- matrix(c( 1, 2, 3,
               2, 3, 4,
               3, 4, 5), nrow = 3)
upper &lt;- vech(a)
v &lt;- D3 %*% upper
all(vec(a) == as.vector(v)) # vectors are equal!
</code></pre>


</div>