<div class="container">

<table style="width: 100%;"><tr>
<td>flexsurvcure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixture and Non-Mixture Parametric Cure Models</h2>

<h3>Description</h3>

<p>Mixture and non-mixture cure models using flexible base distributions
from the flexsurv package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flexsurvcure(
  formula,
  data,
  weights,
  bhazard,
  subset,
  dist,
  na.action,
  link = "logistic",
  mixture = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula expression in conventional R linear modeling
syntax. The response must be a survival object as returned by the
<code>Surv</code> function, and any covariates are given on the right-hand
side.  For example,
</p>
<p><code>Surv(time, dead) ~ age + sex</code>
</p>
<p><code>Surv</code> objects of <code>type="right"</code>,<code>"counting"</code>,
<code>"interval1"</code> or <code>"interval2"</code> are supported, corresponding to
right-censored, left-truncated or interval-censored observations.
</p>
<p>If there are no covariates, specify <code>1</code> on the right hand side, for
example <code>Surv(time, dead) ~ 1</code>.
</p>
<p>By default, covariates are placed on the “theta” parameter of the
distribution, representing the cure fraction, through a linear
model with the selected link function.
</p>
<p>Covariates can be placed on parameters of the base distribution by using the
name of the parameter as a “function” in the formula.  For example, in a
Weibull model, the following expresses the scale parameter in terms of age
and a treatment variable <code>treat</code>, and the shape parameter in terms of
sex and treatment.
</p>
<p><code>Surv(time, dead) ~ age + treat + shape(sex) + shape(treat)</code>
</p>
<p>However, if the names of the ancillary parameters clash with any real
functions that might be used in formulae (such as <code>I()</code>, or
<code>factor()</code>), then those functions will not work in the formula.  A
safer way to model covariates on ancillary parameters is through the
<code>anc</code> argument to <code>flexsurvreg</code>.
</p>
<p><code>survreg</code> users should also note that the function
<code>strata()</code> is ignored, so that any covariates surrounded by
<code>strata()</code> are applied to the location parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame in which to find variables supplied in
<code>formula</code>.  If not given, the variables should be in the working
environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional variable giving case weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bhazard</code></td>
<td>
<p>Optional variable giving expected hazards for relative
survival models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Vector of integers or logicals specifying the subset of the
observations to be used in the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A string representing one of the built-in distributions of flexsurv.
<code>Surv(time, dead) ~ age + treat, anc = list(shape = ~ sex + treat)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a missing-data filter function, applied after any 'subset'
argument has been used. Default is <code>options()$na.action</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>A string representing the link function to use for estimation of the
cure fraction.  Defaults to "logistic", but also supports "loglog", "probit", and "identity".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture</code></td>
<td>
<p>optional TRUE/FALSE to specify whether a mixture model should be fitted.  Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to <code>flexsurvreg</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function works as a wrapper around <code>flexsurvreg</code> by
dynamically constructing a custom distribution using wrappers to the
pdf and cdf functions.
</p>
<p>In a parametric mixture model, it is assumed that there exists a group of individuals
who experience no excess mortality, with the proportion of such individuals being given
by the cure fraction parameter, and a parametric distribution representing the excess
mortality for the remaining individuals.
</p>
<p>By contrast, a parametric non-mixture model simply rescales an existing parametric
distribution such that the probability of survival asymptotically approaches the
cure fraction parameter as time approaches infinity.
</p>


<h3>Examples</h3>

<pre><code class="language-R">flexsurvcure(Surv(rectime,censrec)~group, data=bc, dist="weibull", anc=list(scale=~group))
flexsurvcure(Surv(rectime,censrec)~group, data=bc, dist="lnorm", mixture = FALSE)
flexsurvcure(Surv(rectime,censrec)~group, data=bc, dist="weibull", link="loglog")
</code></pre>


</div>