<div class="container">

<table style="width: 100%;"><tr>
<td>FDRplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot results of FDR table generated by fdrTbl()</h2>

<h3>Description</h3>

<p>This function plots FDR point and CI estimates over a sequence of 
possible significance thresholds. Results from fdrTbl() can be plotted directly as input to FDRplot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FDRplot(
  plotdat,
  lowerbound,
  upperbound,
  ymax = 1,
  annot = "",
  xpos = 0.8,
  ypos = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>plotdat</code></td>
<td>
<p>a table that is returned from fdrTbl(), or results formated in the same way.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerbound</code></td>
<td>
<p>-log10(p-value) lower bound for the x-axis of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperbound</code></td>
<td>
<p>-log10(p-value) upper bound for the x-axis of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>upper limit for range of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annot</code></td>
<td>
<p>annotation text to be added to plot area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpos</code></td>
<td>
<p>x-axis position for annot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ypos</code></td>
<td>
<p>y-axis position for annot</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ggplot2 object
</p>


<h3>Author(s)</h3>

<p>Joshua Millstein, <a href="mailto:joshua.millstein@usc.edu">joshua.millstein@usc.edu</a>
</p>
<p>Joshua Millstein
</p>


<h3>References</h3>

<p>Millstein J, Volfson D. 2013. Computationally efficient permutation-based confidence interval estimation for tail-area FDR. Frontiers in Genetics | Statistical Genetics and Methodology 4(179):1-11.
</p>
<p>Millstein J, Volfson D. 2013. Computationally efficient
permutation-based confidence interval estimation for tail-area FDR.
Frontiers in Genetics | Statistical Genetics and Methodology 4(179):1-11.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ss = 100
nvar = 100
X = as.data.frame(matrix(rnorm(ss*nvar),nrow=ss,ncol=nvar))
e = as.data.frame(matrix(rnorm(ss*nvar),nrow=ss,ncol=nvar))
Y = .1*X + e
nperm = 10

myanalysis = function(X,Y){
	ntests = ncol(X)
	rslts = as.data.frame(matrix(NA,nrow=ntests,ncol=2))
	names(rslts) = c("ID","pvalue")
	rslts[,"ID"] = 1:ntests
	for(i in 1:ntests){
		fit = cor.test(X[,i],Y[,i],na.action="na.exclude",
			alternative="two.sided",method="pearson")
		rslts[i,"pvalue"] = fit$p.value
	}
	return(rslts)
} # End myanalysis

# Generate observed results
obs = myanalysis(X,Y)

# Generate permuted results
perml = vector('list',nperm)
for(perm in 1:nperm){
	X1 = X[order(runif(nvar)),]
	perml[[perm]] = myanalysis(X1,Y)
}

# FDR results table
myfdrtbl = fdrTbl(obs$pvalue,perml,"pvalue",nvar,0,3)
# Plot results
FDRplot(myfdrtbl,0,3,annot="A. An Example")

</code></pre>


</div>