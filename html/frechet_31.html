<div class="container">

<table style="width: 100%;"><tr>
<td>ObjCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Object Covariance</h2>

<h3>Description</h3>

<p>Calculating covariance for time varying object data
</p>


<h3>Usage</h3>

<pre><code class="language-R">ObjCov(tgrid, I, K, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tgrid</code></td>
<td>
<p>Time grid for the time varying object data and covariance function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>A four dimension array of <code>n</code> x <code>n</code> matrix of squared distances between the time point u of the ith process and process and the time point v of the jth object process, 
e.g.: <code class="reqn">I[i,j,u,v] = d^2(X_i(u) X_j(v))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Numbers of principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>Logical indicating if the smoothing is enabled when calculating the eigenvalues and eigenfunctions</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Estimated object covariance (non-smooth) on the 2D grid of dimension <code>length(tgrid)</code> X <code>length(tgrid)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sC</code></td>
<td>
<p>Estimated object covariance (smooth) on the 2D grid of dimension <code>length(tgrid)</code> X <code>length(tgrid)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tgrid</code></td>
<td>
<p>Time grid for the time varying object data and covariance function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Numbers of principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Matrix of smooth eigenfunctions (dimension: <code>length(tgrid)</code> X <code>K</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Vector of eigenvalues of dimension <code>K</code> </p>
</td>
</tr>
</table>
<h3>References</h3>

<p><cite>Dubey, P., &amp; Müller, H. G. (2020). Functional models for time‐varying random objects. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 82(2), 275-327.</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### functional covariate
phi1 &lt;- function(x) -cos(pi*x/10)/sqrt(5)
phi2 &lt;- function(x)  sin(pi*x/10)/sqrt(5)

lambdaX &lt;- c(4,2)
# training set
n &lt;- 100
N &lt;- 50
tgrid &lt;- seq(0,10,length.out = N)

Xi &lt;- matrix(rnorm(2*n),nrow=n,ncol=2)
CovX &lt;- lambdaX[1] * phi1(tgrid) %*% t(phi1(tgrid)) + lambdaX[2] * phi2(tgrid) %*% t(phi2(tgrid))
comp1 = lambdaX[1]^(1/2) * Xi[,1] %*% t(phi1(tgrid))
comp2 = lambdaX[2]^(1/2) * Xi[,2] %*% t(phi2(tgrid))
SampleX &lt;- comp1 + comp2

I &lt;- array(0, c(n,n,N,N))
for (u in 1:N){
  for (v in 1:N){
    temp1 &lt;- SampleX[,u]
   temp2 &lt;- SampleX[,v]
    I[,,u,v] &lt;- outer(temp1, temp2, function(v1,v2){
     (v1 - v2)^2
   })
 }
}

result_cov &lt;- ObjCov(tgrid, I, 2)
result_cov$lambda #4 2

sC &lt;- result_cov$sC
sum((sC-CovX)^2) / sum(sC^2)
sum((phi1(tgrid)-result_cov$phi[,1])^2)/sum(phi1(tgrid)^2)

</code></pre>


</div>