<div class="container">

<table style="width: 100%;"><tr>
<td>birthDistribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Densities of live births in Germany</h2>

<h3>Description</h3>

<p><code>birthDistribution</code> contains densities of live births in Germany over the
months per year (1950 to 2019) and sex (male and female), resulting in 140
densities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(birthDistribution, package = "FDboost")
</code></pre>


<h3>Format</h3>

<p>A list in the correct format to be passed to <code>FDboost</code> for 
density-on-scalar regression:
</p>

<dl>
<dt><code>birth_densities</code></dt>
<dd>
<p>A 140 x 12 matrix containing the birth densities
in its rows. The first 70 rows correspond to male newborns, the second 70 rows 
to female ones. Within both of these, the years are ordered increasingly 
(1950-2019), see also <code>sex</code> and <code>year</code>.</p>
</dd>
<dt><code>birth_densities_clr</code></dt>
<dd>
<p>A 140 x 12 matrix containing the clr
transformed densities in its rows. Same structure as <code>birth_densities</code>.</p>
</dd>
<dt><code>sex</code></dt>
<dd>
<p>A factor vector of length 140 with levels <code>"m"</code> (male)
and <code>"f"</code> (female), corresponding to the sex of the newborns for the rows of
<code>birth_densities</code> and <code>birth_densities_clr</code>. The first 70 elements 
are <code>"m"</code>, the second 70 <code>"f"</code>.</p>
</dd>
<dt><code>year</code></dt>
<dd>
<p>A vector of length 140 containing the integers from 1950 
to 2019 two times (<code>c(1950:2019, 1950:2019)</code>), corresponding to the years
for the rows of <code>birth_densities</code> and <code>birth_densities_clr</code>.</p>
</dd>
<dt><code>month</code></dt>
<dd>
<p>A vector containing the integers from 1 to 12, corresponding
to the months for the columns of <code>birth_densities</code> and <code>birth_densities_clr</code>
(domain <code class="reqn">\mathcal{T}</code> of the (clr-)densities).</p>
</dd>
</dl>
<p>Note that for estimating a density-on-scalar model with <code>FDboost</code>, the
clr transformed densities (<code>birth_densities_clr</code>) serve as response, see
also the vignette "FDboost_density-on-scalar_births".
The original densities (<code>birth_densities</code>) are not needed for estimation,
but still included for the sake of completeness.
</p>


<h3>Details</h3>

<p>To compensate for the different lengths of the months, the average 
number of births per day for each month (by sex and year) was used to compute
the birth shares from the absolute birth counts. The 12 shares corresponding
to one year and sex form one density in the Bayes Hilbert space 
<code class="reqn">B^2(\delta) = B^2\left( \mathcal{T}, \mathcal{A}, \delta\right)</code>,
where <code class="reqn">\mathcal{T} = \{1, \ldots, 12\}</code> corresponds
to the set of the 12 months, <code class="reqn">\mathcal{A} := \mathcal{P}(\mathcal{T})</code>
corresponds to the power set of <code class="reqn">\mathcal{T}</code>, and the reference measure
<code class="reqn">\delta := \sum_{t = 1}^{12} \delta_t</code> corresponds to the sum of dirac 
measures at <code class="reqn">t \in \mathcal{T}</code>.
</p>


<h3>Source</h3>

<p>Statistisches Bundesamt (Destatis), Genesis-Online, data set 
<a href="https://www-genesis.destatis.de/genesis//online?operation=table&amp;code=12612-0002&amp;bypass=true&amp;levelindex=0&amp;levelid=1610983595176#abreadcrumb">12612-0002</a> 
(01/18/2021); <a href="https://www.govdata.de/dl-de/by-2-0">dl-de/by-2-0</a>; 
processed by Eva-Maria Maier
</p>


<h3>References</h3>

<p>Maier, E.-M., Stoecker, A., Fitzenberger, B., Greven, S. (2021):
Additive Density-on-Scalar Regression in Bayes Hilbert Spaces with an Application to Gender Economics.
arXiv preprint arXiv:2110.11771.
</p>


<h3>See Also</h3>

<p><code>clr</code> for the (inverse) clr transformation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("birthDistribution", package = "FDboost")

# Plot densities
year_col &lt;- rainbow(70, start = 0.5, end = 1)
year_lty &lt;- c(1, 2, 4, 5)
oldpar &lt;- par(mfrow = c(1, 2))
funplot(1:12, birthDistribution$birth_densities[1:70, ], ylab = "densities", xlab = "month", 
        xaxp = c(1, 12, 11), pch = 20, col = year_col, lty = year_lty, main = "Male")
funplot(1:12, birthDistribution$birth_densities[71:140, ], ylab = "densities", xlab = "month", 
        xaxp = c(1, 12, 11), pch = 20, col = year_col, lty = year_lty, main = "Female")
par(mfrow = c(1, 1))

# fit density-on-scalar model with effects for sex and year
model &lt;- FDboost(birth_densities_clr ~ 1 + bolsc(sex, df = 1) + 
                   bbsc(year, df = 1, differences = 1),
                 # use bbsc() in timeformula to ensure integrate-to-zero constraint
                 timeformula = ~bbsc(month, df = 4, 
                                     # December is followed by January of subsequent year
                                     cyclic = TRUE, 
                                     # knots = {1, ..., 12} with additional boundary knot
                                     # 0 (coinciding with 12) due to cyclic = TRUE
                                     knots = 1:11, boundary.knots = c(0, 12), 
                                     # degree = 1 with these knots yields identity matrix 
                                     # as design matrix
                                     degree = 1),
                 data = birthDistribution, offset = 0, 
                 control = boost_control(mstop = 1000))

# Plotting 'model' yields the clr-transformed effects
par(mfrow = c(1, 3))
plot(model, n1 = 12, n2 = 12)

# Use inverse clr transformation to get effects in Bayes Hilbert space, e.g. for intercept
intercept_clr &lt;- predict(model, which = 1)[1, ]
intercept &lt;- clr(intercept_clr, w = 1, inverse = TRUE)
funplot(1:12, intercept, xlab = "month", xaxp = c(1, 12, 11), pch = 20,
        main = "Intercept", ylab = expression(hat(beta)[0]), id = rep(1, 12))

# Same with predictions
predictions_clr &lt;- predict(model)
predictions &lt;- t(apply(predictions_clr, 1, clr, inverse = TRUE))
pred_ylim &lt;- range(birthDistribution$birth_densities)
par(mfrow = c(1, 2))
funplot(1:12, predictions[1:70, ], ylab = "predictions", xlab = "month", ylim = pred_ylim,
        xaxp = c(1, 12, 11), pch = 20, col = year_col, lty = year_lty, main = "Male")
funplot(1:12, predictions[71:140, ], ylab = "predictions", xlab = "month", ylim = pred_ylim,
        xaxp = c(1, 12, 11), pch = 20, col = year_col, lty = year_lty, main = "Female")
par(oldpar)
</code></pre>


</div>