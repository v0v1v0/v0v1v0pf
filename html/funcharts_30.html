<div class="container">

<table style="width: 100%;"><tr>
<td>mfd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Define a Multivariate Functional Data Object</h2>

<h3>Description</h3>

<p>This is the constructor function for objects of the mfd class.
It is a wrapper to <code>fda::fd</code>,
but it forces the coef argument to  be
a three-dimensional array of coefficients even if
the functional data is univariate.
Moreover, it allows to include the original raw data from which
you get the smooth functional data.
Finally, it also includes the matrix of precomputed inner products
of the basis functions, which can be useful to speed up computations
when calculating inner products between functional observations
</p>


<h3>Usage</h3>

<pre><code class="language-R">mfd(coef, basisobj, fdnames = NULL, raw = NULL, id_var = NULL, B = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>A three-dimensional array of coefficients:
</p>

<ul>
<li>
<p> the first dimension corresponds to basis functions.
</p>
</li>
<li>
<p> the second dimension corresponds to the number of
multivariate functional observations.
</p>
</li>
<li>
<p> the third dimension corresponds to variables.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basisobj</code></td>
<td>
<p>A functional basis object defining the basis,
as provided to <code>fda::fd</code>, but there is no default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdnames</code></td>
<td>
<p>A list of length 3, each member being a string vector
containing labels for the levels of the corresponding dimension
of the discrete data.
</p>
<p>The first dimension is for a single character indicating the argument
values,
i.e. the variable on the functional domain.
</p>
<p>The second is for replications, i.e. it denotes the functional observations.
</p>
<p>The third is for functional variables' names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>
<p>A data frame containing the original discrete data.
Default is NULL, however, if provided, it must contain:
</p>
<p>a column (indicated by the <code>id_var</code> argument)
denoting the functional observations,
which must correspond to values in <code>fdnames[[2]]</code>,
</p>
<p>a column named as <code>fdnames[[1]]</code>,
returning the argument values of each function
</p>
<p>as many columns as the functional variables,
named as in <code>fdnames[[3]]</code>,
containing the discrete functional values for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_var</code></td>
<td>
<p>A single character value indicating the column
in the <code>raw</code> argument
containing the functional observations (as in <code>fdnames[[2]]</code>),
default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A matrix with the inner products of the basis functions.
If NULL, it is calculated from the basis object provided.
Default is NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To check that an object is of this class, use function is.mfd.
</p>


<h3>Value</h3>

<p>A multivariate functional data object
(i.e., having class <code>mfd</code>),
which is a list with components named
<code>coefs</code>, <code>basis</code>, and <code>fdnames</code>,
as for class <code>fd</code>,
with possibly in addition the components <code>raw</code> and <code>id_var</code>.
</p>


<h3>References</h3>

<p>Ramsay, James O., and Silverman, Bernard W. (2006),
<em>Functional Data Analysis</em>, 2nd ed., Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002),
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(funcharts)
library(fda)
set.seed(0)
nobs &lt;- 5
nbasis &lt;- 10
nvar &lt;- 2
coef &lt;- array(rnorm(nobs * nbasis * nvar), dim = c(nbasis, nobs, nvar))
bs &lt;- create.bspline.basis(rangeval = c(0, 1), nbasis = nbasis)
mfdobj &lt;- mfd(coef = coef, basisobj = bs)
plot_mfd(mfdobj)

</code></pre>


</div>