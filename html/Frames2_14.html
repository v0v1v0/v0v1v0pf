<div class="container">

<table style="width: 100%;"><tr>
<td>Hartley</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hartley estimator</h2>

<h3>Description</h3>

<p>Produces estimates for population totals and means using Hartley estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Hartley(ysA, ysB, pi_A, pi_B, domains_A, domains_B, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "a" and "ab".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are "b" and "ba".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hartley estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_H = \hat{Y}_a^A + \hat{\theta}\hat{Y}_{ab}^A + (1 - \hat{\theta})\hat{Y}_{ab}^B + \hat{Y}_b^B</code>
</p>

<p>where <code class="reqn">\hat{\theta} \in [0, 1]</code>. Optimum value for <code class="reqn">\hat{\theta}</code> to minimize variance of the estimator is
</p>
<p style="text-align: center;"><code class="reqn">\hat{\theta}_{opt} = \frac{\hat{V}(\hat{Y}_{ab}^B) + \widehat{Cov}(\hat{Y}_b^B, \hat{Y}_{ab}^B) - \widehat{Cov}(\hat{Y}_a^A, \hat{Y}_{ab}^A)}{\hat{V}(\hat{Y}_{ab}^A) + \hat{V}(\hat{Y}_{ab}^B)}</code>
</p>

<p>Taking into account the independence between <code class="reqn">s_A</code> and <code class="reqn">s_B</code>, an estimator for the variance of the Hartley estimator can be obtained as follows:
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_H) = \hat{V}(\hat{Y}_a^A + \hat{\theta}\hat{Y}_{ab}^A) + \hat{V}((1 - \hat{\theta})\hat{Y}_{ab}^B + \hat{Y}_b^B)</code>
</p>

<p>If both first and second order probabilities are known, variances and covariances involved in calculation of <code class="reqn">\hat{\theta}_{opt}</code> and <code class="reqn">\hat{V}(\hat{Y}_H)</code> are estimated using functions <code>VarHT</code> and <code>CovHT</code>, respectively. If
only first order probabilities are known, variances are estimated using Deville's method and covariances are estimated using following expression
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Cov}(\hat{X}, \hat{Y}) = \frac{\hat{V}(X + Y) - \hat{V}(X) - \hat{V}(Y)}{2}</code>
</p>



<h3>Value</h3>

<p><code>Hartley</code> returns an object of class "EstimatorDF" which is a list with, at least, the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td>
</tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table><tr style="vertical-align: top;">
<td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td>
</tr></table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Hartley, H. O. (1962)
<em>Multiple Frames Surveys.</em>
Proceedings of the American Statistical Association, Social Statistics Sections, 203 - 206.
</p>
<p>Hartley, H. O. (1974) 
<em>Multiple frame methodology and selected applications.</em>
Sankhya C, Vol. 36, 99 - 118.
</p>


<h3>See Also</h3>

<p><code>JackHartley</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate Hartley estimator for variable Feeding
Hartley(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate Hartley estimator and a 90% confidence interval
#for variable Leisure, considering only first order inclusion probabilities
Hartley(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$Domain, 
DatB$Domain, 0.90)
</code></pre>


</div>