<div class="container">

<table style="width: 100%;"><tr>
<td>FatTailsR-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Package FatTailsR</h2>

<h3>Description</h3>

<p>This package includes Kiener distributions K1, K2, K3, K4 and K7 and two estimation 
algorithms to characterize with a high precision symmetric or asymmetric 
distributions with left and right fat tails that appear in market finance, 
neuroscience and many other disciplines. The estimation of the distribution parameters, 
quantiles, value-at-risk and expected shortfall is usually very accurate. 
Two datasets are provided, as well as power hyperbolas and power hyperbolic 
functions which are simplified versions of symmetric distribution K1.
</p>
<p>Download the pdf cited in the references to get an overview of  
the theoretical part and several examples on stocks and indices. 
</p>
<p>A commercial package, <code>FatTailsRplot</code>, with advanced plotting functions 
and calculation of matrix of stocks over rolling windows is also developped 
by the author.
</p>


<h3>Details</h3>

<p>With so many functions, this package could look fat. But it's not! 
It's rather agile and easy to use! The various functions included in this package 
can be assigned to the following groups:
</p>

<ol>
<li>
<p> Two datasets presented in different formats:   
list, data.frame, matrix, timeSeries, xts, zoo:
</p>

<ul>
<li> <p><code>getDSdata</code>.
</p>
</li>
<li> <p><code>extractData</code>, dfData, mData, tData, xData, zData.
</p>
</li>
</ul>
</li>
<li>
<p> Functions to check the dimensions of vector, matrix, array, list:
</p>

<ul><li> <p><code>dimdim</code>, dimdim1, dimdimc.
</p>
</li></ul>
</li>
<li>
<p> Functions to calculate (positive, negative) prices to returns 
on vector, matrix, array, list, data.frame, timeSeries, xts, zoo:
</p>

<ul>
<li> <p><code>elevate</code>.
</p>
</li>
<li> <p><code>fatreturns</code>, logreturns.
</p>
</li>
</ul>
</li>
<li>
<p> Several predefined vectors of probability. One function to check them.
A conversion function from probabilities to characters 
</p>

<ul>
<li> <p><code>pprobs0</code>, pprobs1, pprobs2, ..., pprobs9.
</p>
</li>
<li> <p><code>checkquantiles</code>.
</p>
</li>
<li> <p><code>getnamesk</code>.
</p>
</li>
</ul>
</li>
<li>
<p> Miscellaneous functions related to the logistic function:
</p>

<ul><li> <p><code>logit</code>, invlogit, ltmlogis, rtmlogis, eslogis.
</p>
</li></ul>
</li>
<li>
<p> Power hyperbolas, power hyperbolic functions and their reciprocal functions: 
</p>

<ul>
<li> <p><code>exphp</code>, coshp, sinhp, tanhp, sechp, cosechp, 
cotanhp.
</p>
</li>
<li> <p><code>loghp</code>, acoshp, asinhp, atanhp, asechp, 
acosechp, acotanhp.
</p>
</li>
<li> <p><code>kashp</code>, dkashp_dx, ashp.
</p>
</li>
</ul>
</li>
<li>
<p> Logishp function, kogit and invkogit = logistic function + power hyperbolas: 
</p>

<ul>
<li>
<p> d, p, q, r, dp, dq, l, dl, ql <code>logishp</code>.
</p>
</li>
<li> <p><code>kogit</code>, invkogit.
</p>
</li>
</ul>
</li>
<li>
<p> Conversion functions between parameters related to Kiener distributions K1, K2, K3, K4:
</p>

<ul>
<li> <p><code>aw2k</code>, aw2d, aw2e, ad2e, ad2k, ad2w, ae2d, ae2k, 
ae2w, ak2e, ak2w, de2a, de2k, de2w, dk2a, dk2e, dw2a, dw2e, 
dw2k, ek2a, ak2d, ek2w, aw2a, aw2d, ew2a, aw2d, ew2k, kd2a, 
kd2e, kd2w, ke2a, ke2d, ke2w, kw2a, kw2d, kw2e.
</p>
</li>
<li> <p><code>pk2pk</code>.
</p>
</li>
</ul>
</li>
<li>
<p> Kiener distributions K1, K2, K3, K4 and the new K7 (introduced in v1.7-0):
</p>

<ul>
<li>
<p> d, p, q, r, dp, dq, l, dl, ql, var, ltm, rtm, dtmq, es <code>kiener1</code>,
</p>
</li>
<li>
<p> d, p, q, r, dp, dq, l, dl, ql, var, ltm, rtm, dtmq, es <code>kiener2</code>,
</p>
</li>
<li>
<p> d, p, q, r, dp, dq, l, dl, ql, var, ltm, rtm, dtmq, es <code>kiener3</code>,
</p>
</li>
<li>
<p> d, p, q, r, dp, dq, l, dl, ql, var, ltm, rtm, dtmq, es <code>kiener4</code>,
</p>
</li>
<li>
<p> d, p, q, r, dp, dq, l, dl, ql, var, ltm, rtm, dtmq, es <code>kiener7</code>.
</p>
</li>
</ul>
</li>
<li>
<p> Quantile (VaR) corrective function (as a multiplier of the logistic function). 
Expected shortfall corrective function (as a multiplier of the expected shortfall 
of the logistic distribution):
</p>

<ul>
<li> <p><code>ckiener1</code>, ckiener2, ckiener3, ckiener4, ckiener7.
</p>
</li>
<li> <p><code>hkiener1</code>, hkiener2, hkiener3, hkiener4, hkiener7.
</p>
</li>
</ul>
</li>
<li>
<p> Moments of the distribution estimated from the dataset and from 
the regression parameters:
</p>

<ul>
<li> <p><code>xmoments</code>.
</p>
</li>
<li> <p><code>kmoments</code>, kmoment, kcmoment, kmean, 
kstandev, kvariance, kskewness, kkurtosis, kekurtosis.
</p>
</li>
</ul>
</li>
<li>
<p> Regression and estimation functions to estimate Kiener distribution
parameters on a given dataset. <code>*fit*</code> and <code>*param*</code> 
are wrappers of algorithms <code>reg</code> and <code>estim</code>.
<code>reg</code> uses an unweighted nonlinear regression function. 
<code>estim</code> uses a fast estimation based on quantiles:
</p>

<ul>
<li> <p><code>regkienerLX</code>, <code>laplacegaussnorm</code>.
</p>
</li>
<li> <p><code>fitkienerX</code>.
</p>
</li>
<li> <p><code>paramkienerX, paramkienerX5, paramkienerX7</code>.
</p>
</li>
</ul>
</li>
<li>
<p> Functions related to <code>paramkienerX</code>:
</p>

<ul>
<li> <p><code>elevenprobs</code>, sevenprobs, fiveprobs.
</p>
</li>
<li> <p><code>estimkiener11</code>, estimkiener7, estimkiener5.
</p>
</li>
<li> <p><code>roundcoefk</code>.
</p>
</li>
<li> <p><code>checkcoefk</code>.
</p>
</li>
</ul>
</li>
<li>
<p> Predefined subsets of parameters to extract them 
from the long vector <code>fitk</code> obtained after regression/estimation 
<code>regkienerLX</code>, <code>fitkienerX</code> :
</p>

<ul><li> <p><code>exfit0</code>, ..., <code>exfit7</code>.
</p>
</li></ul>
</li>
</ol>
<p>For a quick start, jump to the functions <code>regkienerLX</code>,  
<code>fitkienerX</code> and run the examples. 
Then, download and read the documents in pdf format cited in the references 
to get an overview on the major functions. Finally, explore the other 
examples.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Patrice Kiener <a href="mailto:fattailsr@inmodelia.com">fattailsr@inmodelia.com</a> (<a href="https://orcid.org/0000-0002-0505-9920">ORCID</a>)
</p>


<h3>References</h3>

<p>P. Kiener, Explicit models for bilateral fat-tailed distributions and 
applications in finance with the package FatTailsR, 8th R/Rmetrics Workshop 
and Summer School, Paris, 27 June 2014. Download it from: 
<a href="https://www.inmodelia.com/exemples/2014-0627-Rmetrics-Kiener-en.pdf">https://www.inmodelia.com/exemples/2014-0627-Rmetrics-Kiener-en.pdf</a>
</p>
<p>P. Kiener, Fat tail analysis and package FatTailsR, 
9th R/Rmetrics Workshop and Summer School, Zurich, 27 June 2015. 
Download it from: 
<a href="https://www.inmodelia.com/exemples/2015-0627-Rmetrics-Kiener-en.pdf">https://www.inmodelia.com/exemples/2015-0627-Rmetrics-Kiener-en.pdf</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul><li> <p><a href="https://www.inmodelia.com/fattailsr-en.html">https://www.inmodelia.com/fattailsr-en.html</a>
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R">    

require(graphics)
require(minpack.lm)
require(timeSeries)

### Load the datasets and select one number (1-16)
DS     &lt;- getDSdata()
j      &lt;- 5

### and run this block
X      &lt;- DS[[j]]
nameX  &lt;- names(DS)[j]
reg    &lt;- regkienerLX(X)
lgn    &lt;- laplacegaussnorm(X)
lleg   &lt;- c("logit(0.999) = 6.9", "logit(0.99)   = 4.6", 
           "logit(0.95)   = 2.9", "logit(0.50)   = 0", 
           "logit(0.05)   = -2.9", "logit(0.01)   = -4.6", 
           "logit(0.001) = -6.9  ")
pleg   &lt;- c( paste("m =",  reg$coefr4[1]), paste("g  =", reg$coefr4[2]), 
             paste("k  =", reg$coefr4[3]), paste("e  =", reg$coefr4[4]) )

## Main plot
op     &lt;- par(mfrow = c(1,1), mgp = c(1.5,0.8,0), mar = c(3,3,2,1))
plot(reg$dfrXP, main = nameX)
legend("top", legend = pleg, cex = 0.9, inset = 0.02 )
lines(reg$dfrEP, col = 2, lwd = 2)
points(reg$dfrQkPk, pch = 3, col = 2, lwd = 2, cex = 1.5)
lines(lgn$dfrXPn, col = 7, lwd = 2)

## Plot F(X) &gt; 0,97
front = c(0.06, 0.39, 0.50, 0.95)
par(fig = front, new = TRUE, mgp = c(1.5, 0.6, 0), las = 0)
plot( reg$dfrXP[which(reg$dfrXP$P &gt; 0.97),] , pch = 1, xlab = "", ylab = "", main = "F(X) &gt; 0,97" )
lines(reg$dfrEP[which(reg$dfrEP$P &gt; 0.97),], type="l", col = 2, lwd = 3 )
lines(lgn$dfrXPn[which(lgn$dfrXPn$Pn &gt; 0.97),], type = "l", col = 7, lwd= 2 )
points(reg$dfrQkPk, pch = 3, col = 2, lwd = 2, cex = 1.5)
points(lgn$dfrQnPn, pch = 3, col = 7, lwd = 2, cex = 1)

## Plot F(X) &lt; 0,03
front = c(0.58, 0.98, 0.06, 0.61)
par(fig = front, new = TRUE, mgp = c(0.5, 0.6, 0), las = 0 )
plot( reg$dfrXP[which(reg$dfrXP$P &lt; 0.03),] , pch = 1, xlab = "", ylab = "", main = "F(X) &lt; 0,03")
lines(reg$dfrEP[which(reg$dfrEP$P &lt; 0.03),], type = "l", col = 2, lwd = 3 )
lines(lgn$dfrXPn[which(lgn$dfrXPn$Pn &lt; 0.03),], type = "l", col= 7, lwd= 2 )
points(reg$dfrQkPk, pch = 3, col = 2, lwd = 2, cex = 1.5)
points(lgn$dfrQnPn, pch = 3, col = 7, lwd = 2, cex = 1)

## Moments from the parameters (k) and from the Dataset (X)
round(cbind("k" = kmoments(reg$coefk, lengthx = nrow(reg$dfrXL)), "X" = xmoments(X)), 2)
attributes(reg)
### End block


</code></pre>


</div>