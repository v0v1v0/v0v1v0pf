<div class="container">

<table style="width: 100%;"><tr>
<td>FBN.histogramMaxima</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Local maxima of the histogram of SNP microarray data </h2>

<h3>Description</h3>

<p>Finds at most 6 of the local maxima of the histogram of the <code>inputData</code> representing the SNP microarray data. 
Firstly, the function finds all local maxima onto the histogram, 
and finally removes those that are closer than <code>minSpan</code>. 
The histogram is estimated with equi-spaced breaks (also the default), 
defined by <code>breaksData</code> (see the documentation of <code>hist</code> for more details). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">FBN.histogramMaxima(inputData, minSpan, breaksData)
FBN.histogramMaxima(inputData, minSpan = 0.2, breaksData = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputData</code></td>
<td>
<p> A vector of SNP microarray values for which the local maxima of the histogram are desired </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minSpan</code></td>
<td>
<p> The minimum distance separating consecutive local maxima. If <code>minSpan</code> is negative, then a smoothing filter is applied on the histogram to reduce its noise, and therefore, estimates the most significative maxima. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaksData</code></td>
<td>
<p> One of: </p>
 
<ul>
<li>
<p>a vector giving the breakpoints between histogram cells,
</p>
</li>
<li>
<p>a single number giving the number of cells for the histogram,
</p>
</li>
<li>
<p>a character string naming an algorithm to compute the number of cells (see the Details section of <code>hist</code>),
</p>
</li>
<li>
<p>a function to compute the number of cells.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function has been designed based on SNP microarray data and FISH resolution. As in FISH analyses high numbers of signals do not allow a correct identification of discrete CNs, an empirical number of no more than 6 local maxima is therefore imposed. These maxima are used to initialize the k-means algorithm to determine the CN clusters. 
</p>


<h3>Value</h3>

<p>Returns a vector containing at most 6 values of the <code>inputData</code> in which the histogram shows local maxima.
</p>


<h3>Author(s)</h3>

<p> Adrian Andronache <a href="mailto:adi.andronache@gmail.com">adi.andronache@gmail.com</a> <br>
Luca Agnelli <a href="mailto:luca.agnelli@gmail.com">luca.agnelli@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>hist</code>, <code>FBNormalization</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">require(stats)
require(graphics)

x = c(rnorm(1000, 1, .2), rnorm(1000, 2, .2))
y = FBN.histogramMaxima(x, minSpan = .1)
h = hist(x)
par(new = TRUE)
plot(y,vector(mode=mode(y), length = length(y)), xlim = c(min(h$breaks), 
 	max(h$breaks)), ylim = c(0,max(h$counts)), xlab = NA, ylab = NA, 
 	col = 'red' )


x = c(1, 2, 2, 3, 4, 5, 5, 5, 6, 7, 8, 9, 10, 10, 10, 11)
y = FBN.histogramMaxima(x, minSpan = 3, breaksData = 100)
h = hist(x, 100)
par(new = TRUE)
plot(y,vector(mode=mode(y), length = length(y)), xlim = c(min(h$breaks), 
 	max(h$breaks)), ylim = c(0,max(h$counts)), xlab = NA, ylab = NA, 
 	col = 'red' )
</code></pre>


</div>