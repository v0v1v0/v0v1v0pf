<div class="container">

<table style="width: 100%;"><tr>
<td>M2.StructuredFactor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-fit of bi-factor and second-order copula models for item response data</h2>

<h3>Description</h3>

<p> The limited information <code class="reqn">M_2</code> statistic (Maydeu-Olivares and Joe, 2006)  of bi-factor and second-order copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class="language-R">M2Bifactor(y,cpar, copnames1, copnames2, gl, ngrp, grpsize)
M2Second_order(y,cpar, copnames1, copnames2, gl, ngrp, grpsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpar</code></td>
<td>
<p>A list of estimated copula parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames1</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link each of the oberved variabels with the common factor. <b>For the second-order factor copula</b>: <code class="reqn">G</code>-vector with the names of bivariate copulas that link the each of the group-specific factors with the common factor, where <code class="reqn">G</code> is the number of groups of items. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{2, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames2</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. <b>For the second-order factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{2, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrp</code></td>
<td>
<p>number of non-overlapping groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">M_2</code> statistic has been developed for goodness-of-fit testing in multidimensional contingency tables by Maydeu-Olivares and Joe (2006). We use the <code class="reqn">M_2</code> to assess the overall fit for the bi-factor and second-order copula models for item resposne data (Kadhem &amp; Nikoloulopoulos, 2021).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>M2</code></td>
<td>
<p>The <code class="reqn">M_2</code> statistic which has a null asymptotic distribution that is <code class="reqn">\chi^2</code> with <code class="reqn">s-q</code> degrees of freedom, where <code class="reqn">s</code> is the number of univariate and bivariate margins that do not include the category 0 and <code class="reqn">q</code> is the number of model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p><code class="reqn">s-q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p-value</code></td>
<td>
<p>The resultant <code class="reqn">p</code>-value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br>
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132–157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>
<p>Maydeu-Olivares, A. and Joe, H. (2006).
Limited information goodness-of-fit testing in multidimensional contingency tables.
<em>Psychometrika</em>, <b>71</b>, 713–732. <a href="https://doi.org/10.1007/s11336-005-1295-9">doi:10.1007/s11336-005-1295-9</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#------------------------------------------------
# Setting quadreture points
nq &lt;- 15
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                     TAS Data
#------------------             -----------------
data(TAS)
#using a subset of the data
#group1: 1,3,6,7,9,13,14
grp1=c(1,3,6)
#group2: 2,4,11,12,17
grp2=c(2,4,11)
#group3: 5,8,10,15,16,18,19,20
grp3=c(5,8,10)
#Rearrange items within testlets
set.seed(123)
i=sample(1:nrow(TAS),500)
ydat=TAS[i,c(grp1,grp2,grp3)]

d=ncol(ydat);d
n=nrow(ydat);n

#size of each group
g1=length(grp1)
g2=length(grp2)
g3=length(grp3)

grpsize=c(g1,g2,g3)#group size
#number of groups
ngrp=length(grpsize)

#------------------------------------------------
#                       M2
#------------------------------------------------
#BI-FACTOR
tauX0 = c(0.49,0.16,0.29,#0.09,0.47,0.49,0.30,
          0.46,0.41,0.33,#0.29,0.24,
          0.10,0.16,0.14)#,0.12,0.03,0.03,0.10,0.10)
tauXg = c(0.09,0.37,0.23,#0.53,0.24,0.32,0.27,
          0.53,0.58,0.20,#0.23,0.25,0.34,0.33,
          0.30,0.19,0.24)#,0.29,0.43,0.26)
copX0 = rep("bvt2", d)
copXg = c(rep("rgum", g1), rep("bvt3", g2+g3))
#converting taus to cpars
cparX0=mapply(function(x,y) tau2par(x,y),x=copX0,y=tauX0)
cparXg=mapply(function(x,y) tau2par(x,y),x=copXg,y=tauXg)
cpar=c(cparX0,cparXg)

m2_Bifactor = M2Bifactor(y=ydat, cpar, copX0, copXg, gl, ngrp, grpsize)


</code></pre>


</div>