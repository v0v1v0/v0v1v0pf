<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.morph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimates a Smooth Warping Function Mapping an Interval into Another
</h2>

<h3>Description</h3>

<p>This function computes a smooth monotone transformation $h(t)$ of
argument $t$ such that $h(0) = 0$ and $h(TRUE) = TRUE$, where $t$ is
the upper limit of a range interval.  This function is used to 
morph one probability density function into another having a 
possibly different domain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth.morph(x, y, ylim, WfdPar, conv=1e-4, iterlim=20, dbglev=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector of argument values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a vector of data values.  This function can only smooth one set of
data at a time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>a vector of length two containing the lower and upper limits of
the target interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WfdPar</code></td>
<td>

<p>a functional parameter object that provides an initial value for the
coefficients defining function $W(t)$, and a roughness penalty on
this function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>a convergence criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>

<p>the maximum number of iterations allowed in the minimization of
error sum of squares.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbglev</code></td>
<td>

<p>either 0, 1, or 2.  This controls the amount information printed out
on each iteration, with 0 implying no output, 1 intermediate output
level, and 2 full output.  If either level 1 or 2 is specified, it
can be helpful to turn off the output buffering feature of S-PLUS.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes a increasing function mapping one closed into interval 
(defined in <code>WfdPar</code> into another (the two-value numeric vector argument
<code>ylim</code>).  
The function immediately checks that the data do not fall outside of the 
first interval, which is located in <code>WfdPar$fd$basis$rangeval</code> and 
named <code>xlim</code> in its code.
</p>
<p>A frequent problem is that the data points in argument <code>x</code> are 
outside of this origin interval.  Small escapes less than 1e-7 are 
automatically converted to the correct the right limit. But the
user should check that this constraint is met  before invoking the 
function, and especially when the function is used iteratively.
</p>


<h3>Value</h3>

<p>A named list of length eight containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Wfdobj</code></td>
<td>

<p>a functional data object defining function $W(x)$ that that
optimizes the fit to the data of the monotone function that it
defines.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>the optimal function value being minimized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad</code></td>
<td>

<p>the gradient vector at the optimal solution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmat</code></td>
<td>

<p>the Hessian matrix at the optimal solution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>

<p>the norm of the gradient vector at the optimal solution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hfine</code></td>
<td>

<p>a fine mesh of values of the estimated monotone function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iternum</code></td>
<td>

<p>the number of iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterhist</code></td>
<td>

<p>the iteration history.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), 
<em>Functional Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), 
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>cumfd</code>,
<code>smooth.monotone</code>,
<code>landmarkreg</code>,
<code>register.fd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#  see the use of smooth.morph in cumfd.R and landmarkreg.R
</code></pre>


</div>