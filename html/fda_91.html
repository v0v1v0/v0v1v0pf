<div class="container">

<table style="width: 100%;"><tr>
<td>fdPar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Define a Functional Parameter Object
</h2>

<h3>Description</h3>

<p>Functional parameter objects are used as arguments to functions that
estimate functional parameters, such as smoothing functions like
<code>smooth.basis</code>.  A functional parameter object is a functional
data object with additional slots specifying a roughness penalty, a
smoothing parameter and whether or not the functional parameter is to
be estimated or held fixed.  Functional parameter objects are used as
arguments to functions that estimate functional parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  fdPar(fdobj=NULL, Lfdobj=NULL, lambda=0, estimate=TRUE, penmat=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdobj</code></td>
<td>

<p>a functional data object, functional basis object, a functional
parameter object or a matrix.  If it a matrix, it is replaced by
fd(fdobj).  If class(fdobj) == 'basisfd', it is converted to an
object of class <code>fd</code> with a coefficient matrix consisting of a
single column of zeros.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lfdobj</code></td>
<td>

<p>either a nonnegative integer or a linear differential operator
object.
</p>
<p>If <code>NULL</code>, Lfdobj depends on fdobj[['basis']][['type']]:
</p>

<dl>
<dt>bspline</dt>
<dd>
<p>Lfdobj &lt;- int2Lfd(max(0, norder-2)), 
where norder = norder(fdobj).</p>
</dd>
<dt>fourier</dt>
<dd>
<p>Lfdobj = a harmonic acceleration operator:
<code>Lfdobj &lt;- vec2Lfd(c(0,(2*pi/diff(rng))^2,0), rng)</code>
where rng = fdobj[['basis']][['rangeval']].</p>
</dd>
<dt>anything else</dt>
<dd>
<p>Lfdobj &lt;- int2Lfd(0)</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>a nonnegative real number specifying the amount of smoothing
to be applied to the estimated functional parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>not currently used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penmat</code></td>
<td>

<p>a roughness penalty matrix.  Including this can eliminate the need
to compute this matrix over and over again in some types of
calculations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functional parameters are often needed to specify initial
values for iteratively refined estimates, as is the case in
functions <code>register.fd</code> and <code>smooth.monotone</code>.
</p>
<p>Often a list of functional parameters must be supplied to a function
as an argument, and it may be that some of these parameters are
considered known and must remain fixed during the analysis.  This is
the case for functions <code>fRegress</code> and  <code>pda.fd</code>, for
example.
</p>


<h3>Value</h3>

<p>a functional parameter object (i.e., an object of class <code>fdPar</code>),
which is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fd</code></td>
<td>

<p>a functional data object (i.e., with class <code>fd</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lfd</code></td>
<td>

<p>a linear differential operator object (i.e., with class
<code>Lfd</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>a nonnegative real number
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>not currently used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penmat</code></td>
<td>

<p>either NULL or a square, symmetric matrix with penmat[i, j] =
integral over fd[['basis']][['rangeval']] of basis[i]*basis[j]
</p>
</td>
</tr>
</table>
<h3>Source</h3>

<p>Ramsay, James O., and Silverman, Bernard W. (2006), <em>Functional
Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), <em>Applied
Functional Data Analysis</em>, Springer, New York
</p>


<h3>See Also</h3>

<p><code>cca.fd</code>,
<code>density.fd</code>,
<code>fRegress</code>,
<code>intensity.fd</code>,
<code>pca.fd</code>,
<code>smooth.fdPar</code>,
<code>smooth.basis</code>,
<code>smooth.monotone</code>,
<code>int2Lfd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">oldpar &lt;- par(no.readonly=TRUE)
##
## Simple example
##
#  set up range for density
rangeval &lt;- c(-3,3)
#  set up some standard normal data
x &lt;- rnorm(50)
#  make sure values within the range
x[x &lt; -3] &lt;- -2.99
x[x &gt;  3] &lt;-  2.99
#  set up basis for W(x)
basisobj &lt;- create.bspline.basis(rangeval, 11)
#  set up initial value for Wfdobj
Wfd0 &lt;- fd(matrix(0,11,1), basisobj)
WfdParobj &lt;- fdPar(Wfd0)

WfdP3 &lt;- fdPar(seq(-3, 3, length=11))

##
##  smooth the Canadian daily temperature data
##
#    set up the fourier basis
nbasis   &lt;- 365
dayrange &lt;- c(0,365)
daybasis &lt;- create.fourier.basis(dayrange, nbasis)
dayperiod &lt;- 365
harmaccelLfd &lt;- vec2Lfd(c(0,(2*pi/365)^2,0), dayrange)
#  Make temperature fd object
#  Temperature data are in 12 by 365 matrix tempav
#    See analyses of weather data.
#  Set up sampling points at mid days
daytime  &lt;- (1:365)-0.5
#  Convert the data to a functional data object
daybasis65 &lt;- create.fourier.basis(dayrange, nbasis, dayperiod)
templambda &lt;- 1e1
tempfdPar  &lt;- fdPar(fdobj=daybasis65, Lfdobj=harmaccelLfd,
                    lambda=templambda)

#FIXME
#tempfd &lt;- smooth.basis(CanadianWeather$tempav, daytime, tempfdPar)$fd
#  Set up the harmonic acceleration operator
Lbasis  &lt;- create.constant.basis(dayrange);
Lcoef   &lt;- matrix(c(0,(2*pi/365)^2,0),1,3)
bfdobj  &lt;- fd(Lcoef,Lbasis)
bwtlist &lt;- fd2list(bfdobj)
harmaccelLfd &lt;- Lfd(3, bwtlist)
#  Define the functional parameter object for
#  smoothing the temperature data
lambda   &lt;- 0.01  #  minimum GCV estimate
#tempPar &lt;- fdPar(daybasis365, harmaccelLfd, lambda)
#  smooth the data
#tempfd &lt;- smooth.basis(daytime, CanadialWeather$tempav, tempPar)$fd
#  plot the temperature curves
#plot(tempfd)

##
## with rangeval of class Date and POSIXct
##
par(oldpar)

</code></pre>


</div>