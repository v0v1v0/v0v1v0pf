<div class="container">

<table style="width: 100%;"><tr>
<td>fregre.gsam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Functional Generalized Spectral Additive Models</h2>

<h3>Description</h3>

<p>Computes functional GAM model between functional covariate
<code class="reqn">(X^1(t_1),\cdots,X^{q}(t_q))</code> (and non functional
covariate <code class="reqn">(Z^1,...,Z^p)</code>) and scalar response <code class="reqn">Y</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fregre.gsam(
  formula,
  family = gaussian(),
  data = list(),
  weights = NULL,
  basis.x = NULL,
  basis.b = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced
to that class): a symbolic description of the model to be fitted. The
details of model specification are given under <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a family
function, a family function or the result of a call to a family function.
(See <code>family</code> for details of family functions.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>List that containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.x</code></td>
<td>
<p>List of basis for functional explanatory data estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.b</code></td>
<td>
<p>List of basis for functional beta parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is an extension of the functional generalized linear
regression models: <code>fregre.glm</code> where the <code class="reqn">E[Y|X,Z]</code> is
related to the linear prediction <code class="reqn">\eta</code> via a link function
<code class="reqn">g(\cdot)</code> with integrated smoothness estimation by the smooth
functions <code class="reqn">f(\cdot)</code>.
</p>
<p style="text-align: center;"><code class="reqn">E[Y|X,Z])=\eta=g^{-1}(\alpha+\sum_{i=1}^{p}f_{i}(Z^{i})+\sum_{k=1}^{q}\sum_{j=1}^{k_q}{f_{j}^{k}(\xi_j^k)})</code>
</p>
<p> where
<code class="reqn">\xi_j^k</code> is the coefficient of the basis function expansion of
<code class="reqn">X^k</code>, (in PCA analysis <code class="reqn">\xi_j^k</code> is the score of the
<code class="reqn">j</code>-functional PC of <code class="reqn">X^k</code>.
</p>
<p>The smooth functions <code class="reqn">f(\cdot)</code> can be added to the right hand
side of the formula to specify that the linear predictor depends on smooth
functions of predictors using smooth terms <code>s</code> and
<code>te</code> as in <code>gam</code> (or linear functionals of these as
<code class="reqn">Z\beta</code> and <code class="reqn">\big&lt;X(t),\beta\big&gt;</code> in
<code>fregre.glm</code>).
</p>
<p>The first item in the <code>data</code> list is called <em>"df"</em> and is a data
frame with the response and non functional explanatory variables, as
<code>gam</code>.<br></p>
<p>Functional covariates of class <code>fdata</code> or <code>fd</code> are introduced in
the following items in the <code>data</code> list.<br><code>basis.x</code> is a list of
basis for represent each functional covariate. The basis object can be
created by the function: <code>create.pc.basis</code>, <code>pca.fd</code>
<code>create.pc.basis</code>, <code>create.fdata.basis</code> o
<code>create.basis</code>.<br><code>basis.b</code> is a list of basis for
represent each functional beta parameter. If <code>basis.x</code> is a list of
functional principal components basis (see <code>create.pc.basis</code> or
<code>pca.fd</code>) the argument <code>basis.b</code> is ignored.
</p>


<h3>Value</h3>

<p>Return <code>gam</code> object plus:
</p>

<ul>
<li> <p>basis.x Basis used for <code>fdata</code> or <code>fd</code> covariates. 
</p>
</li>
<li> <p>basis.b Basis used for beta parameter estimation. 
</p>
</li>
<li> <p>data List that containing the variables in the model. 
</p>
</li>
<li> <p>formula formula. 
</p>
</li>
<li> <p>y.pred predicted response by cross-validation.
</p>
</li>
</ul>
<h3>Note</h3>

<p>If the formula only contains a non functional explanatory variables
(multivariate covariates), the function compute a standard <code>glm</code>
procedure.
</p>


<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Muller HG and Stadtmuller U. (2005). <em>Generalized
functional linear models.</em> Ann. Statist.33 774-805.
</p>
<p>Wood (2001) <em>mgcv:GAMs and Generalized Ridge Regression for R</em>. R News
1(2):20-25.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2006), <em> Functional Data
Analysis</em>, 2nd ed., Springer, New York.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied Statistics
with S</em>, New York: Springer.
</p>


<h3>See Also</h3>

<p>See Also as: <code>predict.fregre.gsam</code> and
<code>summary.gam</code>.<br> Alternative methods: <code>fregre.glm</code>
and <code>fregre.gkam</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
x &lt;- tecator$absorp.fdata
x.d1 &lt;- fdata.deriv(x)
tt &lt;- x[["argvals"]]
dataf &lt;- as.data.frame(tecator$y)
nbasis.x &lt;- 11
nbasis.b &lt;- 5
basis1 &lt;- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x)
basis2 &lt;- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b)
f &lt;- Fat ~ s(Protein) + s(x)
basis.x &lt;- list("x"=basis1,"x.d1"=basis1)
basis.b &lt;- list("x"=basis2,"x.d1"=basis2)
ldat &lt;- ldata("df" = dataf, "x" = x , "x.d1" = x.d1)
res &lt;- fregre.gsam(Fat ~ Water + s(Protein) + x + s(x.d1), ldat,
                   family = gaussian(),  basis.x = basis.x,
                   basis.b = basis.b)
summary(res)
pred &lt;- predict(res,ldat)
plot(pred-res$fitted)
pred2 &lt;- predict.gam(res,res$XX)
plot(pred2-res$fitted)
plot(pred2-pred)
res2 &lt;- fregre.gsam(Fat ~ te(Protein, k = 3) + x, data =  ldat,
                     family=gaussian())
summary(res2)

##  dropind basis pc
basis.pc0 &lt;- create.pc.basis(x,c(2,4,7))
basis.pc1 &lt;- create.pc.basis(x.d1,c(1:3))
basis.x &lt;- list("x"=basis.pc0,"x.d1"=basis.pc1)
ldata &lt;- ldata("df"=dataf,"x"=x,"x.d1"=x.d1)  
res.pc &lt;- fregre.gsam(f,data=ldata,family=gaussian(),
          basis.x=basis.x,basis.b=basis.b)
summary(res.pc)
 
##  Binomial family
ldat$df$FatCat &lt;- factor(ifelse(tecator$y$Fat &gt; 20, 1, 0))
res.bin &lt;- fregre.gsam(FatCat ~ Protein + s(x),ldat,family=binomial())
summary(res.bin)
table(ldat$df$FatCat, ifelse(res.bin$fitted.values &lt; 0.5,0,1))

## End(Not run)
</code></pre>


</div>