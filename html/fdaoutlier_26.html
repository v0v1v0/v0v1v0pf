<div class="container">

<table style="width: 100%;"><tr>
<td>tvd_mss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Outlier detection using the total variation depth and modified shape similarity index.</h2>

<h3>Description</h3>

<p>Find shape and magnitude outliers  using the Total Variation Depth and Modified
Shape Similarity Index proposed in Huang and Sun (2019) <a href="https://doi.org/10.1080/00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tvd_mss(
  data,
  emp_factor_mss = 1.5,
  emp_factor_tvd = 1.5,
  central_region_tvd = 0.5
)

tvdmss(
  dts,
  emp_factor_mss = 1.5,
  emp_factor_tvd = 1.5,
  central_region_tvd = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>emp_factor_mss</code></td>
<td>
<p>The empirical factor of the classical boxplot used on the modified shape
similarity index. Defaults to 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emp_factor_tvd</code></td>
<td>
<p>The empirical factor of the functional boxplot used on the TVD of observations.
Defaults to 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>central_region_tvd</code></td>
<td>
<p>A number between 0 and 1 indicating the central region probability of
the functional boxplot used on the TVD of the observations. Defaults to 0.5. See also details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dts, data</code></td>
<td>
<p>A matrix or dataframe of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation
points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method uses a combination of total variation depth (TVD) and modified shape similarity (MSS) index
defined in Huang and Sun (2019) <a href="https://doi.org/10.1080/00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>
to find magnitude and shape outliers. The TVD and MSS of all the observations are
first computed and a classical boxplot is then applied on the MSS. Outliers detected
by the boxplot of MSS are flagged as shape outliers. The shape outliers are then removed
from the data and the TVD of the remaining observations are used in a functional boxplot
to detect magnitude outliers.  The central region
of this functional boxplot (<code>central_region_tvd</code>) is w.r.t. to the original number of curves. Thus if
8 shape outliers are found out of 100 curves, specifying <code>central_region_tvd</code> = 0.5 will ensure that
50 observations are used as the central region in the functional boxplot on the remaining 92 observations.
</p>


<h3>Value</h3>

<p>Returns a list containing the following
</p>
<table>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>the indices of the (shape and magnitude) outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape_outliers</code></td>
<td>
<p>the indices of the shape outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magnitude_outliers</code></td>
<td>
<p>the indices of the magnitude outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tvd</code></td>
<td>
<p>the total variation depths of the observations of <code>data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mss</code></td>
<td>
<p>the modified shape similarity index of the observations of <code>data</code></p>
</td>
</tr>
</table>
<h3>Functions</h3>


<ul><li> <p><code>tvd_mss()</code>: Deprecated function. Use <code>tvdmss</code> instead.
</p>
</li></ul>
<h3>Author(s)</h3>

<p>Oluwasegun Ojo
</p>


<h3>References</h3>

<p>Huang, H., &amp; Sun, Y. (2019). A decomposition of total variation depth for
understanding functional outliers. <em>Technometrics</em>, 61(4), 445-458.
</p>


<h3>See Also</h3>

<p><code>msplot</code> for outlier detection using msplot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">dt6 &lt;- simulation_model6()
res &lt;- tvdmss(dt6$data)
res$outliers

</code></pre>


</div>