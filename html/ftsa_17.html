<div class="container">

<table style="width: 100%;"><tr>
<td>farforecast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functional data forecasting through functional principal component autoregression
</h2>

<h3>Description</h3>

<p>The coefficients from the fitted object are forecasted using a multivariate time-series forecasting method.
The forecast coefficients are then multiplied by the functional principal components to obtain a forecast curve.
</p>


<h3>Usage</h3>

<pre><code class="language-R">farforecast(object, h = 10, var_type = "const", Dmax_value, Pmax_value,
	level = 80, PI = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of <code>fds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Forecast horizon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_type</code></td>
<td>
<p>Type of multivariate time series forecasting method; see <code>VAR</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dmax_value</code></td>
<td>
<p>Maximum number of components considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pmax_value</code></td>
<td>
<p>Maximum order of VAR model considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Nominal coverage probability of prediction error bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI</code></td>
<td>
<p>When <code>PI = TRUE</code>, a prediction interval will be given along with the point forecast.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>1. Decompose the smooth curves via a functional principal component analysis (FPCA).
</p>
<p>2. Fit a multivariate time-series model to the principal component score matrix.
</p>
<p>3. Forecast the principal component scores using the fitted multivariate time-series models. The order of VAR is selected optimally via an information criterion.
</p>
<p>4. Multiply the forecast principal component scores by estimated principal components to obtain forecasts of <code class="reqn">f_{n+h}(x)</code>.
</p>
<p>5. Prediction intervals are constructed by taking quantiles of the one-step-ahead forecast errors.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>point_fore</code></td>
<td>
<p>Point forecast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_select</code></td>
<td>
<p>Selected VAR order and number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI_lb</code></td>
<td>
<p>Lower bound of a prediction interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI_ub</code></td>
<td>
<p>Upper bound of a prediction interval</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Han Lin Shang
</p>


<h3>References</h3>

<p>A. Aue, D. D. Norinho and S. Hormann (2015) "On the prediction of stationary functional time series", <em>Journal of the American Statistical Association</em>, <b>110</b>(509), 378-392.
</p>
<p>J. Klepsch, C. Kl\"uppelberg and T. Wei (2017) "Prediction of functional ARMA processes with an application to traffic data", <em>Econometrics and Statistics</em>, <b>1</b>, 128-149.
</p>


<h3>See Also</h3>

<p><code>forecast.ftsm</code>, <code>forecastfplsr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sqrt_pm10 = sqrt(pm_10_GR$y)
multi_forecast_sqrt_pm10 = farforecast(object = fts(seq(0, 23.5, by = 0.5), sqrt_pm10),
	h = 1, Dmax_value = 5, Pmax_value = 3)
</code></pre>


</div>