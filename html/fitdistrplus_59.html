<div class="container">

<table style="width: 100%;"><tr>
<td>prefit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pre-fitting procedure</h2>

<h3>Description</h3>

<p>Search good starting values
</p>


<h3>Usage</h3>

<pre><code class="language-R">
prefit(data, distr, method = c("mle", "mme", "qme", "mge"), 
  feasible.par, memp=NULL, order=NULL,
  probs=NULL, qtype=7, gof=NULL, fix.arg=NULL, lower, 
  upper, weights=NULL, silent=TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A character string <code>"name"</code> naming a distribution for which the corresponding
density function <code>dname</code>, the corresponding distribution function <code>pname</code> and the 
corresponding quantile function <code>qname</code> must be defined, or directly the density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string coding for the fitting method: 
<code>"mle"</code> for 'maximum likelihood estimation', <code>"mme"</code> for 'moment matching estimation', 
<code>"qme"</code> for 'quantile matching estimation' and <code>"mge"</code> for 'maximum goodness-of-fit estimation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feasible.par</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code>mledist</code>). 
It may not be into account for closed-form formulas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A numeric vector for the moment order(s). The length of this vector must be equal
to the number of parameters to estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memp</code></td>
<td>
<p>A function implementing empirical moments, raw or centered but has to be consistent with 
<code>distr</code> argument (and <code>weights</code> argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A numeric vector of the probabilities for which the quantile matching is done.
The length of this vector must be equal to the number of parameters to estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtype</code></td>
<td>
<p>The quantile type used by the R <code>quantile</code> function to 
compute the empirical quantiles, (default 7 corresponds to the default quantile method in R).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof</code></td>
<td>
<p>A character string coding for the name of the goodness-of-fit distance used : 
"CvM" for Cramer-von Mises distance,"KS" for Kolmogorov-Smirnov distance,
"AD" for Anderson-Darling distance, "ADR", "ADL", "AD2R", "AD2L" and "AD2" for variants of
Anderson-Darling distance described by Luceno (2006).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated by this maximum likelihood procedure.
The use of this argument is not possible if <code>method="mme"</code> and a closed-form formula is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector. If non-<code>NULL</code>, 
weighted MLE is used, otherwise ordinary MLE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>A logical to remove or show warnings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower bounds on the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper bounds on the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to generic functions, or to one of the functions
<code>"mledist"</code>,  <code>"mmedist"</code>, <code>"qmedist"</code> or <code>"mgedist"</code>
depending of the chosen method. See <code>mledist</code>, <code>mmedist</code>, <code>qmedist</code>, 
<code>mgedist</code> for details on parameter estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Searching good starting values is achieved by transforming the parameters 
(from their constraint interval to the real line) of the probability distribution.
Indeed, 
</p>

<ul>
<li>
<p> positive parameters in <code class="reqn">(0,Inf)</code> are transformed using the logarithm
(typically the scale parameter <code>sd</code> of a normal distribution, see Normal), 
</p>
</li>
<li>
<p>  parameters in <code class="reqn">(1,Inf)</code> are transformed using the function <code class="reqn">log(x-1)</code>, 
</p>
</li>
<li>
<p> probability parameters in <code class="reqn">(0,1)</code> are transformed using the logit function <code class="reqn">log(x/(1-x))</code>
(typically the parameter <code>prob</code> of a geometric distribution, see Geometric), 
</p>
</li>
<li>
<p> negative probability parameters in <code class="reqn">(-1,0)</code> are transformed using the function <code class="reqn">log(-x/(1+x))</code>,
</p>
</li>
<li>
<p> real parameters are of course not transformed at all, 
typically the <code>mean</code> of a normal distribution, see Normal.
</p>
</li>
</ul>
<p>Once parameters are transformed, an optimization is carried out by a quasi-Newton algorithm (typically BFGS)
and then we transform them back to original parameter value.
</p>


<h3>Value</h3>

 
<p>A named list.
</p>


<h3>Author(s)</h3>

 
<p>Christophe Dutang and Marie-Laure Delignette-Muller.
</p>


<h3>References</h3>

 
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

<p>See <code>mledist</code>, <code>mmedist</code>, <code>qmedist</code>, 
<code>mgedist</code> for details on parameter estimation.
See <code>fitdist</code> for the main procedure.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# (1) fit of a gamma distribution by maximum likelihood estimation
#
x &lt;- rgamma(1e3, 5/2, 7/2)

prefit(x, "gamma", "mle", list(shape=3, scale=3), lower=-Inf, upper=Inf)

</code></pre>


</div>