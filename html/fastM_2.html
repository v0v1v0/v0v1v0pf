<div class="container">

<table style="width: 100%;"><tr>
<td>DUEMBGENshape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Duembgen's Shape Matrix
</h2>

<h3>Description</h3>

<p>Iterative algorithm to estimate Duembgen's shape matrix using a partial Newton-Raphson approach. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">DUEMBGENshape(X, nmax = 500, eps = 1e-06, maxiter = 100, perm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>numeric data matrix or dataframe. Missing values are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>integer, if the sample size n (number of rows of <code>X</code>) is smaller than <code>nmax</code>, then all n(n-1)/2 pairwise differences will be computed
and used in the algorithm. If n is larger, then the algorithm avoids storing all the pairwise differences and is more memory efficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergence tolerance, which means that the algorithm stops when the Frobenius norm of the gradient is smaller than eps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>logical. If TRUE the rows of <code>X</code> will be randomly permuted before starting the computations. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimate is based on the new fast algorithm described in Duembgen et al. (2016).
Note that Duembgen's shape matrix is standardized such that it has determinant 1.
</p>
<p>The function does not check if there are several identical observations. In that case the function will fail.
</p>
<p>To get a good initial value for the algorithm, the estimator is first computed based on the pairwise differences of 
successive observations. Therefore the order of the rows of <code>X</code> is supposed to be random. If this is not the case, the data
should be first permuted using the argument <code>perm</code>.
</p>
<p>In case <code>maxiter</code> is reached before convergence, the estimate at that iteration is returned and a warning is given.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>Estimated shape matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations of the algorithm.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Lutz Duembgen and Klaus Nordhausen
</p>


<h3>References</h3>

<p><cite>Duembgen, L. (1998), On Tyler's M-functional of scatter in high dimension, <em>Annals of Institute of Statistical Mathematics</em>, <b>50</b>,  471–491. </cite>
</p>
<p><cite>Duembgen, L., Nordhausen, K. and Schuhmacher, H. (2016),  New algorithms for M-estimation of multivariate location and scatter, <em>Journal of Multivariate Analysis</em>, <b>144</b>,  200–217. doi: <a href="https://doi.org/10.1016/j.jmva.2015.11.009">10.1016/j.jmva.2015.11.009</a></cite>
</p>


<h3>See Also</h3>

<p><code>tyler.shape</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">DUEMBGENshape(longley)
DUEMBGENshape(longley, nmax=10)
# compare to
# library(ICSNP)
# duembgen.shape(longley)
</code></pre>


</div>