<div class="container">

<table style="width: 100%;"><tr>
<td>fdrtool</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate (Local) False Discovery Rates For Diverse Test Statistics</h2>

<h3>Description</h3>

<p><code>fdrtool</code> takes a vector of z-scores (or of correlations, p-values,
or t-statistics), and estimates for each case both the tail area-based Fdr
as well as the density-based fdr (=q-value resp. local false discovery rate).
The parameters of the null distribution are 
estimated adaptively from the data (except for the case of p-values where
this is not necessary).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fdrtool(x, statistic=c("normal", "correlation", "pvalue"),
  plot=TRUE, color.figure=TRUE, verbose=TRUE, 
  cutoff.method=c("fndr", "pct0", "locfdr"),
  pct0=0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of the observed test statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>one of "normal" (default), "correlation", "pvalue".  
This species the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>plot a figure with estimated densities, distribution functions, 
and (local) false discovery rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print out status messages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.method</code></td>
<td>
<p>one of "fndr" (default), "pct0", "locfdr".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct0</code></td>
<td>
<p>fraction of data used for fitting null model - only if <code>cutoff.method</code>="pct0"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.figure</code></td>
<td>
<p>determines whether a color figure or a black and white
figure is produced (defaults to "TRUE", i.e. to color figure).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm implemented in this function proceeds as follows:
</p>

<ol>
<li>
<p>  A suitable cutoff point is determined.  If <code>cutoff.method</code>
is "fndr" then first an approximate null model is fitted and
subsequently a cutoff point is sought with false nondiscovery
rate as small as possible (see <code>fndr.cutoff</code>). 
If <code>cutoff.method</code> is "pct0"
then a specified quantile (default value: 0.75) of the data
is used as the cutoff point.  If <code>cutoff.method</code> equals
"locfdr" then the heuristic of the "locfdr" package (version 1.1-6)
is employed to find the cutoff (z-scores and correlations only).
</p>
</li>
<li>
<p>  The parameters of the null model are estimated from the 
data using <code>censored.fit</code>. This results
in estimates for scale parameters und and proportion
of null values (<code>eta0</code>). 
</p>
</li>
<li>
<p>  Subsequently the corresponding p-values are computed, and
a modified <code>grenander</code> algorithm is employed
to obtain the overall density and distribution function 
(note that this respects the estimated <code>eta0</code>).
</p>
</li>
<li>
<p>  Finally, q-values and local fdr values are computed for each case.
</p>
</li>
</ol>
<p>The assumed null models all have (except for p-values) one free
scale parameter.  Note that the z-scores and the correlations
are assumed to have zero mean. 
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>a vector with p-values for each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qval</code></td>
<td>
<p>a vector with q-values (Fdr) for each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfdr</code></td>
<td>
<p>a vector with local fdr values for each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the specified type of null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a vector containing the estimated parameters (the null 
proportion <code>eta0</code>  and the free parameter of the null model).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Strimmer, K. (2008a).   A unified approach to false discovery 
rate estimation. BMC Bioinformatics 9: 303.
&lt;DOI:10.1186/1471-2105-9-303&gt;
</p>
<p>Strimmer, K. (2008b). fdrtool: a versatile R package for estimating 
local and tail area- based false discovery rates.
Bioinformatics 24: 1461-1462.
&lt;DOI:10.1093/bioinformatics/btn209&gt;
</p>


<h3>See Also</h3>

<p><code>pval.estimate.eta0</code>, <code>censored.fit</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load "fdrtool" library and p-values
library("fdrtool")
data(pvalues)


# estimate fdr and Fdr from p-values

data(pvalues)
fdr = fdrtool(pvalues, statistic="pvalue")
fdr$qval # estimated Fdr values 
fdr$lfdr # estimated local fdr 

# the same but with black and white figure  
fdr = fdrtool(pvalues, statistic="pvalue", color.figure=FALSE)


# estimate fdr and Fdr from z-scores

sd.true = 2.232
n = 500
z = rnorm(n, sd=sd.true)
z = c(z, runif(30, 5, 10)) # add some contamination
fdr = fdrtool(z)

# you may change some parameters of the underlying functions
fdr = fdrtool(z, cutoff.method="pct0", pct0=0.9) 
</code></pre>


</div>