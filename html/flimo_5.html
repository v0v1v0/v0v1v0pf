<div class="container">

<table style="width: 100%;"><tr>
<td>flimoptim_R</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal flimoptim function in R mode</h2>

<h3>Description</h3>

<p>Computes several parameter inferences with R optimizer.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flimoptim_R(
  ndraw,
  data = NULL,
  dsumstats = NULL,
  simulatorQ = NULL,
  obj = NULL,
  nsim = 10,
  ninfer = 1,
  lower = 0,
  upper = 1,
  Theta0 = (lower + upper)/2,
  randomTheta0 = FALSE,
  obj_threshold = Inf,
  method = "L-BFGS-B",
  number_tries = 1,
  maxit = 1000,
  factr = 1e+07,
  pgtol = 0,
  show_trace = FALSE,
  store_quantiles = FALSE,
  par_names = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ndraw</code></td>
<td>
<p>Integer. Number of random variables to draw
for one simulation of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>1D array containing the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsumstats</code></td>
<td>
<p>Summary statistics to measure distance
between simulations and data.
R function of type dsumstats(simulations, data)
where simulations : 2D array and data : 1D array.
ncol(simulations) = length(data) mandatory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulatorQ</code></td>
<td>
<p>Simulator of the stochastic process with fixed quantiles
(see README).
Theta is the parameter set for the simulations and
quantiles are drawn in U(0,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Objective function to minimize.
Default : is directly computed from dsumstats and simulatorQ.
R function of type objective(Theta, quantiles)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Integer. Number of simulations to run for each step
of the optimization algorithm.
Computation time grows linearly with this number. Default to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ninfer</code></td>
<td>
<p>Integer. Number of independent inferences to run. Default to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>1D array. Lower bounds for parameters. Same length as upper.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>1D array. Upper bounds for parameters. Same length as lower.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta0</code></td>
<td>
<p>1D array. Initial values of the parameters.
Default : mean(lower, upper).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomTheta0</code></td>
<td>
<p>Boolean.
If True, Theta0 is randomly drawn between lower and upper bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj_threshold</code></td>
<td>
<p>Float. Threshold score. If Final value of objective is
bigger, relaunch the inference if number_tries is not reached.
The purpose is to avoid local minima. Default to Inf (no threshold).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String. Either "L-BFGS-B" (default) or any other method used by
the base function optim. Stochastic methods do not work with flimo.
If you want to provide bounds, you need to use L-BFGS-B or Brent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_tries</code></td>
<td>
<p>Integer. Number of tries (inferences) for the objective
value to reach a point lower than obj_threshold. Default to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Integer. Max number of iterations during optimization.
Default to 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factr</code></td>
<td>
<p>Float. Control parameter for L-BFGS-B method in stats::optim.
Default to 1e7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pgtol</code></td>
<td>
<p>Float. Control parameter for L-BFGS-B method in stats::optim.
Default to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_trace</code></td>
<td>
<p>Boolean. If true, shows standard trace. Default to false.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store_quantiles</code></td>
<td>
<p>Boolean.
If true, stores every quantiles used for inference, to reproduce the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_names</code></td>
<td>
<p>vector of names for parameters.
Default is "par1", ..., "parn".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Object of class flimo_result (list) containing every information
about convergence results.
</p>


</div>