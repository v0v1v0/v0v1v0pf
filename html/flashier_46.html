<div class="container">

<table style="width: 100%;"><tr>
<td>plot.flash</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot method for flash objects</h2>

<h3>Description</h3>

<p>Given a <code>flash</code> object, produces up to two figures: one showing
the proportion of variance explained per factor/loadings pair, and one that
plots posterior means for either factors or loadings (depending on the
argument to parameter <code>pm_which</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'flash'
plot(
  x,
  include_scree = TRUE,
  include_pm = TRUE,
  order_by_pve = TRUE,
  kset = NULL,
  pm_which = c("factors", "loadings"),
  pm_subset = NULL,
  pm_groups = NULL,
  pm_colors = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object inheriting from class <code>flash</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_scree</code></td>
<td>
<p>Whether to include a figure ("scree plot") showing the
proportion of variance explained by each factor/loadings pair.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_pm</code></td>
<td>
<p>Whether to include a figure showing the posterior means for
either loadings <code class="reqn">L</code> or factors <code class="reqn">F</code> (depending on the argument to
parameter <code>pm_which</code>). One plot panel is produced for each
factor/loadings pair <code class="reqn">k</code>. If argument <code>pm_groups</code>
is left unspecified, then bar plots will be produced, with each bar
corresponding to a single value <code class="reqn">\ell_{ik}</code> or <code class="reqn">f_{jk}</code>.
Otherwise, overlapping histograms will be
produced, with each histogram corresponding to one of the groups
specified by <code>pm_groups</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_by_pve</code></td>
<td>
<p>If <code>TRUE</code>, then the factor/loadings pairs will be
re-ordered according to proportion of variance explained (from
highest to lowest).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kset</code></td>
<td>
<p>A vector of integers specifying the factor/loadings pairs to be
plotted. If <code>kset = NULL</code>, then all will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm_which</code></td>
<td>
<p>Whether to plot loadings <code class="reqn">L</code> or factors <code class="reqn">F</code> in the
plots of posterior means.
This parameter is ignored when <code>include_pm = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm_subset</code></td>
<td>
<p>A vector of row indices <code class="reqn">i</code> or column indices
<code class="reqn">j</code> (depending on the argument to <code>pm_which</code>)
specifying which values <code class="reqn">\ell_{i \cdot}</code> or <code class="reqn">f_{j \cdot}</code> are
to be shown in the plots of posterior means. If the dataset has row or
column names, then names rather than indices may be specified. If
<code>pm_subset = NULL</code>, then all values will be plotted.
This parameter is ignored when <code>include_pm = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm_groups</code></td>
<td>
<p>A vector specifying the group to which each row of the data
<code class="reqn">y_{i \cdot}</code> or column <code class="reqn">y_{\cdot j}</code> belongs
(groups may be numeric indices or strings). If <code>pm_groups = NULL</code>,
then a bar plot of the ungrouped data is produced (see <code>include_pm</code>
above). Otherwise, a group must be provided for each plotted row <code class="reqn">i</code> or
column <code class="reqn">j</code>, so that
the length of <code>pm_groups</code> is exactly equal to the number of rows or
columns in the full dataset or, if <code>pm_subset</code> is specified, in the
subsetted dataset. When <code>pm_groups</code> is not <code>NULL</code>, a set of
overlapping histograms is produced for each factor/loadings pair, with
one histogram per group (again see <code>include_pm</code>).
This parameter is ignored when <code>include_pm = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm_colors</code></td>
<td>
<p>A vector specifying a color for each bar (if
<code>pm_groups = NULL</code>) or histogram (if <code>pm_groups</code> is not
<code>NULL</code>). Passed directly to parameter <code>values</code> in <strong>ggplot2</strong>
function <code>scale_color_manual</code>.
This parameter is ignored when <code>include_pm = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters are ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If arguments <code>include_scree</code> and <code>include_pm</code> specify that
only one figure be produced, then <code>plot.flash()</code> returns a
<code>ggplot2</code> object. If both figures are to be produced, then
<code>plot.flash()</code> prints both plots but does not return a value.
</p>


</div>