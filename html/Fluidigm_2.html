<div class="container">

<table style="width: 100%;"><tr>
<td>calculatePairwiseSimilarities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run plink to Calculate Pairwise Similarities</h2>

<h3>Description</h3>

<p>This function serves as a wrapper to the 'PLINK' software, which is a free, open-source whole genome association analysis toolset.
It specifically uses 'PLINK' to calculate pairwise similarities between genotypes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculatePairwiseSimilarities(
  file,
  db = NA,
  map = NA,
  out = NA,
  sexing = TRUE,
  verbose = TRUE,
  verbosity = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>A string representing the path to the filtered ped/map file pair (without ped/map file extension).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>A string representing the path to an existing genotype database. If not provided, the function will proceed with the existing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A string representing the filepath to PlateDnoY.map file. If not provided, the function will use the map file with the same name as the ped file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>A string representing the path to the output. If not provided, the output will be written to a file with the same name as the input file, appended with "_oDB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sexing</code></td>
<td>
<p>A logical value indicating whether the function should try to perform sexing. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value indicating whether the output should be verbose. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>An integer representing the level of verbosity. Set to a higher number for more detailed output. Default is 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function first checks the input parameters and sets default values if necessary. It then constructs and executes a PLINK command to merge
the genotype output with the existing genotype database if one is provided. Finally, it calculates pairwise similarities for all samples (and
database individuals) using another PLINK command. If the 'sexing' parameter is set to TRUE, the function will also attempt to determine the
sex of the individuals.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
gensim, a matrix indicating if genotypes are called correctly for replicates and/or if genotypes are missing
summs, a matrix with summary statistics
</p>


<h3>References</h3>


<ul>
<li>
<p>Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, Maller J, Sklar P, de Bakker PIW, Daly MJ &amp; Sham PC (2007)
<em>PLINK: a toolset for whole-genome association and population-based linkage analysis.</em> American Journal of Human Genetics, 81.
</p>
</li>
<li>
<p>Purcell, Shaun. PLINK. <a href="https://zzz.bwh.harvard.edu/plink/">https://zzz.bwh.harvard.edu/plink/</a></p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

  outdir &lt;- tempdir()

  calculatePairwiseSimilarities(file=file.path(outdir, "example_data.csv.GOOD"))

## End(Not run)

</code></pre>


</div>