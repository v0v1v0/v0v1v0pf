<div class="container">

<table style="width: 100%;"><tr>
<td>RegioWeissman</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile estimation: Weissman's extrapolation</h2>

<h3>Description</h3>

<p>Estimation of the p-quantile based on multiple local Hill estimators and Weissman's extrapolation formula. We assume heavy-tail homogeneity, i.e., all local EVI's are the same.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RegioWeissman(x, j = 1, p, k, k.qu = 20, type = "evopt", alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector or matrix of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>The number of the target site, i.e., if <code>j=2</code> the p-quantile of the second column of <code>x</code> is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The probability of interest; should be between <code class="reqn">1-k_j/n_j</code> and 1, where <code class="reqn">n_j</code> is the sample length of the j-th column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of relative excesses involved in the estimation of the extreme value
index gamma. If <code>k</code> is missing, it will be set to </p>

<ul>
<li> <p><code class="reqn">k=\left\lfloor 2n^{2/3}\right\rfloor</code>, where n is the
sample length of the vector <code>x</code> after removing missing values
</p>
</li>
<li> <p><code class="reqn">k=\left\lfloor \frac{2n^{2/3}}{d^{1/3}}\right\rfloor</code>, where d is the number of
columns of the matrix <code>x</code> and n the length of each column after removing missing values.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.qu</code></td>
<td>
<p>Tuning parameter for estimation of empirical variance; only needed if <code>type="opt"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Choose either <code>"evopt"</code> if extreme value dependent, <code>"ind"</code> if independent or <code>"opt"</code> for arbitrarily dependent components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Confidence level for confidence interval.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>est</code> Point estimate of p-quantile of column j
</p>
</li>
<li> <p><code>CI</code> the corresponding alpha-confidence interval
</p>
</li>
<li> <p><code>EVI</code> estimate of the extreme value index
</p>
</li>
<li> <p><code>k</code> tail sample size
</p>
</li>
<li> <p><code>p</code> a probability
</p>
</li>
<li> <p><code>u.kn</code> (n-k)-th largest observation, where n is the sample length at station j after removing missing values
</p>
</li>
<li> <p><code>description</code> a short description.</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library("evd")
# sample observations of 75 years at one station:
x &lt;- rgev(75, 0, 1, 0) # x is a vector
RegioWeissman(x=x, p=0.95)

x2 &lt;- c(NA, NA, x[1:60], NA, x[61:75]) # vector of observations with missing values
RegioWeissman(x=x2, p=0.95) # NAs will be removed

# sample observations of 100 years at 4 stations:
set.seed(1053)
x &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4)
RegioWeissman(x=x, p=0.9, j=3)

# With missing values:
x2 &lt;- x
x2[sample(100, 12),2] &lt;- NA
RegioWeissman(x=x2, p=0.9, j=3)
</code></pre>


</div>