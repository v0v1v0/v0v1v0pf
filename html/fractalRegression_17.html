<div class="container">

<table style="width: 100%;"><tr>
<td>mlra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale Lagged Regression Analysis</h2>

<h3>Description</h3>

<p>Fast function for computing multiscale lagged regression analysis (MLRA) on long time series. Combining DFA with ordinary least square regression, MLRA
is a form of fractal regression that can be used to estimate asymmetric and multiscale regression coefficients between two variables at different time-scales and temporal lags.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlra(x, y, order, scales, lags, direction)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A real valued vector (i.e., time series data) to be analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A real valued vector (i.e., time series data) to be analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>is an integer indicating the polynomial order used for 
detrending the local windows (e.g, 1 = linear, 2 = quadratic, etc.). There 
is a not pre-determined limit on the order of the polynomial order but the 
user should avoid using a large polynomial on small windows. This can result
in overfitting and non-meaningful estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>An integer vector of scales over which to compute correlation. 
Unlike univariate DFA, MRA does not require that scales be in log units.
Scale intervals can be sequential, for example, when the analysis is 
exploratory and no a priori hypotheses have been made about the scale of 
correlation. A small subset of targeted scales may also be investigated 
where scale-specific research questions exist. We have found that windows
smaller than say 8 observations create stability problems due to 
overfitting. This is espcially when the order of the fitting polynomial is 
large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>An integer indicating the maximum number of lags to include in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>A character string indicating a positive ('p') or negative ('n') lag.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mathematical treatment of the MLRA algorithm and its performance can be found in Kristoufek (2015) and Likens et al. (2019).
</p>
<p>Use of the direction parameter specifies whether the scale-wise <code class="reqn">\beta</code> coefficients for positive or negative lags will be estimated.  
</p>
<p>Note that under conditions with linear and quadratic trends, Likens et al. (2019) found that there was a systematic positive bias in the <code class="reqn">\beta</code> estimates for larger scales.
Using a polynomial detrending order of 2 or greater was shown to attenuate this bias.
</p>


<h3>Value</h3>

<p>The object returned from the mlra() function is a list containing <code>betas</code> the <code class="reqn">\beta</code> coefficients for each lag at each of the scales.
</p>


<h3>References</h3>

<p>Kristoufek, L. (2015). Detrended fluctuation analysis as a regression framework: Estimating dependence at different scales. Physical Review E, 91(2), 022802.
</p>
<p>Likens, A. D., Amazeen, P. G., West, S. G., &amp; Gibbons, C. T. (2019). Statistical properties of Multiscale Regression Analysis: Simulation and application to human postural control. Physica A: Statistical Mechanics and its Applications, 532, 121580.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Here is a simple example for running MLRA using a white noise and pink noise time series.
# For more detailed examples, see the vignette. 

noise &lt;- rnorm(5000)

pink.noise &lt;- fgn_sim(n = 5000, H = 0.9)

scales &lt;- logscale(scale_min = 10, scale_max = 1250, scale_ratio = 1.1)

mlra.out &lt;- mlra(
    x = noise, 
    y = pink.noise, 
    order = 1, 
    scales = scales, 
    lags = 100, direction = 'p')




</code></pre>


</div>