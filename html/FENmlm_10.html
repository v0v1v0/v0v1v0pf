<div class="container">

<table style="width: 100%;"><tr>
<td>fitted.femlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extracts fitted values from a femlm fit</h2>

<h3>Description</h3>

<p>This function extracts the fitted values from a model estimated with <code>femlm</code>. The fitted values that are returned are the <em>expected predictor</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'femlm'
fitted(object, type = c("response", "link"), ...)

## S3 method for class 'values.femlm'
fitted(object, type = c("response", "link"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>femlm</code>. Typically the result of a <code>femlm</code> estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character either equal to <code>"response"</code> (default) or <code>"link"</code>. If <code>type="response"</code>, then the output is at the level of the response variable, i.e. it is the expected predictor <code class="reqn">E(Y|X)</code>. If <code>"link"</code>, then the output is at the level of the explanatory variables, i.e. the linear predictor <code class="reqn">X\cdot \beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not currently used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns the <em>expected predictor</em> of a <code>femlm</code> fit. The likelihood functions are detailed in <code>femlm</code> help page.
</p>


<h3>Value</h3>

<p>It returns a numeric vector of length the number of observations used to estimate the model.
</p>
<p>If <code>type = "response"</code>, the value returned is the expected predictor, i.e. the expected value of the dependent variable for the fitted model: <code class="reqn">E(Y|X)</code>.
If <code>type = "link"</code>, the value returned is the linear predictor of the fitted model, that is <code class="reqn">X\cdot \beta</code> (remind that <code class="reqn">E(Y|X) = f(X\cdot \beta)</code>).
</p>


<h3>Author(s)</h3>

<p>Laurent Berge
</p>


<h3>See Also</h3>

<p><code>femlm</code>, <code>resid.femlm</code>, <code>predict.femlm</code>, <code>summary.femlm</code>, <code>vcov.femlm</code>, <code>getFE</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# simple estimation on iris data, clustering by "Species"
res_poisson = femlm(Sepal.Length ~ Sepal.Width + Petal.Length +
                    Petal.Width | Species, iris)

# we extract the fitted values
y_fitted_poisson = fitted(res_poisson)

# Same estimation but in OLS (Gaussian family)
res_gaussian = femlm(Sepal.Length ~ Sepal.Width + Petal.Length +
                    Petal.Width | Species, iris, family = "gaussian")

y_fitted_gaussian = fitted(res_gaussian)

# comparison of the fit for the two families
plot(iris$Sepal.Length, y_fitted_poisson)
points(iris$Sepal.Length, y_fitted_gaussian, col = 2, pch = 2)


</code></pre>


</div>