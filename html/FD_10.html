<div class="container">

<table style="width: 100%;"><tr>
<td>maxent.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Inferential Permutation Tests for Maximum Entropy Models
</h2>

<h3>Description</h3>

<p><code>maxent.test</code> performs the permutation tests proposed by Shipley (2010) for maximum entropy models.
Two different null hypotheses can be tested:
1) the information encoded in the <em>entire set</em> of constraints <code class="reqn">\mathbf{C}</code> is irrelevant for predicting the probabilities, and
2) the information encoded in <em>subset</em> <code class="reqn">\mathbf{B}</code> of the entire set of constraints <code class="reqn">\mathbf{C}=\mathbf{A}\cup{}\mathbf{B}</code> is irrelevant for predicting the probabilities.
A plot can be returned to facilitate interpretation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxent.test(model, obs, sub.c, nperm = 99, quick = TRUE,
alpha = 0.05, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>list returned by <code>maxent</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>

<p>vector, matrix or data frame of observed probabilities of the states (columns).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.c</code></td>
<td>

<p>character or numeric vector specifying the subset of constraints <code class="reqn">\mathbf{B}</code> associated with null hypothesis 2.
If missing, null hypothesis 1 is tested.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>

<p>number of permutations for the test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quick</code></td>
<td>

<p>if <code>TRUE</code>, the algorithm stops when <code>alpha</code> is outside the confidence interval of the <em>P</em>-value.
Can be useful to speed up the routine.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>desired alpha-level for the test. Only relevant if <code>quick</code> is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>if <code>TRUE</code>, a plot is returned to facilitate interpretation.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>maxent.test</code> is a direct translation of the permutation tests described by Shipley (2010). Please refer to this article for details.
</p>
<p>Using <code>quick = FALSE</code> will return the true null probability for a given <code>nperm</code>. However, if <code>nperm</code> is large (a rule-of-thumb is <code class="reqn">&gt;=999</code> permutations for allowing inference at <code class="reqn">\alpha</code> = 0.05), this can take a very long time. Using <code>quick = TRUE</code> is a much faster and highly recommended alternative if one is only interested in accepting/rejecting the null hypothesis at the specified <code class="reqn">\alpha</code>-level given by argument <code>alpha</code>.
</p>
<p>If <code>maxent</code> was run with multiple data sets (i.e. if <code>constr</code> had more than one row), then  <code>maxent.test</code> performs the test for all sets simultaneously, following the ‘omnibus’ procedure described by Shipley (2010).
</p>
<p>The following measure of fit between observed and predicted probabilities is returned:
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{fit}=1-\frac{{\displaystyle \sum_{j=1}^{D} \sum_{i=1}^{S}\left(o_{ij}-p_{ij}\right)^{2}}}{\displaystyle \sum_{j=1}^{D} \sum_{i=1}^{S}\left(o_{ij}-q_{ij}\right)^{2}}</code>
</p>

<p>where <code class="reqn">o_{ij}</code>, <code class="reqn">p_{ij}</code>, and <code class="reqn">q_{ij}</code> are the observed, predicted
and prior probabilities of state <code class="reqn">i</code> from data set <code class="reqn">j</code>, respectively, <code class="reqn">S</code> is
the number of states, and <code class="reqn">D</code> the number of data sets (i.e. rows in <code>obs</code>). A value of 1 indicates perfect predictive capacity, while a value near zero
indicates that the constraints provide no additional information beyond what is already contained in the
prior <code class="reqn">\mathbf{q}</code> (Sonnier et al. 2009).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>measure of fit giving the predictive ability of the entire set of constraints <code class="reqn">\mathbf{C}</code>,
beyond that already provided by the prior distribution. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.a</code></td>
<td>
<p>measure of fit giving the predictive ability of the subset of constraints <code class="reqn">\mathbf{A}</code>,
beyond that already provided by the prior distribution;  only returned if <code>sub.c</code> is specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>Pearson <code class="reqn">r^2</code> between observed and predicted probabilities, using
the entire set of constraints <code class="reqn">\mathbf{C}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2.a</code></td>
<td>
<p>Pearson <code class="reqn">r^2</code> between observed and predicted probabilities, using
the subset of constraints <code class="reqn">\mathbf{A}</code>; only returned if <code>sub.c</code> is specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2.q</code></td>
<td>
<p>Pearson <code class="reqn">r^2</code> between observed and prior probabilities;
only returned when <code>sub.c</code> is missing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.stat</code></td>
<td>
<p>observed statistic used for the permutation test; see Shipley (2010)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>number of permutations; can be smaller than the specified <code>nperm</code> when <code>quick</code> is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p><em>P</em>-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.pval</code></td>
<td>
<p>approximate confidence intervals of the <em>P</em>-value</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p><code>maxent.test</code> is a computationally intensive function. The tests can take a very long time when <code>nperm</code> is large and <code>quick = FALSE</code>. It is highly recommended to use <code>quick = TRUE</code> because of this, unless you are interested in obtaining the true null probability.</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a>
</p>
<p><a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a>
</p>


<h3>References</h3>

<p>Sonnier, G., Shipley, B., and M. L. Navas. 2009. Plant traits, species pools and the prediction of relative abundance in plant communities: a maximum entropy approach. <em>Journal of Vegetation Science</em> <b>in press</b>.
</p>
<p>Shipley, B. (2010) Inferential permutation tests for maximum entropy models in ecology. <em>Ecology</em> <b>in press</b>.
</p>


<h3>See Also</h3>

<p><code>maxent</code> to run the maximum entropy model that is required by <code>maxent.test</code>.
</p>
<p>Another faster version of <code>maxent.test</code> for multicore processors called <code>maxent.testMC</code> is available from Etienne Laliberté (<a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a>). It's exactly the same as <code>maxent.test</code> but makes use of the <span class="pkg">multicore</span>, <span class="pkg">doMC</span>, and <span class="pkg">foreach</span> packages. Because of this, <code>maxentMC</code> only works on POSIX-compliant OS's (essentially anything but Windows).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# example with tussock dataset
traits &lt;- tussock$trait[, c(2:7, 11)] # use only continuous traits
traits &lt;- na.omit(traits) # remove 2 species with NA's
abun &lt;- tussock$abun[, rownames(traits)] # abundance matrix
abun &lt;- t(apply(abun, 1, function(x) x / sum(x) )) # relative abundances
agg &lt;- functcomp(traits, abun) # community-aggregated traits
traits &lt;- t(traits) # transpose matrix

# run maxent on site 1 (first row of abun), all species
pred.abun &lt;- maxent(agg[1,], traits)

## Not run: 
# do the constraints give predictive ability?
maxent.test(pred.abun, obs = abun[1,], nperm = 49)

# are height, LDMC, and leaf [N] important constraints?
maxent.test(pred.abun, obs = abun[1,], sub.c = c("height",
"LDMC", "leafN"), nperm = 49)

## End(Not run)
</code></pre>


</div>