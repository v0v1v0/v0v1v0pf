<div class="container">

<table style="width: 100%;"><tr>
<td>frbs-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Getting started with the frbs package</h2>

<h3>Description</h3>

<p>Fuzzy rule-based systems (FRBSs) are based on the fuzzy concept 
proposed by Zadeh in 1965, which represents the reasoning of human experts in production 
rules (a set of IF-THEN rules) to handle real-life problems from domains 
such as control, prediction and inference, data mining, bioinformatics data processing, 
robotics, and speech recognition. FRBSs are also known as fuzzy inference systems and 
fuzzy models. When applied to specific tasks, they may also be known under specific names 
such as fuzzy associative memories or fuzzy controllers.
In this package, we consider systems with multi-inputs and single-output (MISO), 
with real-valued data.
</p>


<h3>Details</h3>

<p>FRBSs are a competitive alternative to other classic models and algorithms in order to 
solve classification and regression problems. Generally, 
an FRBS consists of four functional parts: 
</p>

<ul>
<li>
<p> a fuzzification interface which transforms the crisp inputs into degrees 
of membership functions of the linguistic term of each variable. 
See <code>fuzzifier</code>.
</p>
</li>
<li>
<p> a knowledge base consisting of a database (DB) and a rulebase (RB). While the database includes 
the fuzzy set definitions, the rulebase contains fuzzy IF-THEN rules. 
We will represent the knowledge as a set of rules. Each one has the following structure.
</p>
<p><code>IF premise (antecedent) THEN conclusion (consequent)</code>
</p>
<p>See <code>rulebase</code>.
</p>
</li>
<li>
<p> an inference engine which performs the inference operations on the fuzzy IF-THEN rules. 
There are two kinds of inference for fuzzy systems based on linguistic rules: 
The Mamdani and the Takagi Sugeno Kang model. See <code>inference</code>.
</p>
</li>
<li>
<p> a defuzzification process to obtain the crisp values from linguistic values. There are several methods for 
defuzzification such as the weighted average, centroid, etc. 
See <code>defuzzifier</code>.
</p>
</li>
</ul>
<p>Since it may be difficult to obtain information from human experts in the form required,
an alternative and effective way to acquire the knowledge is to generate 
the fuzzy IF-THEN rules automatically from the numerical training data. 
In general, when modeling an FRBS, there are two important processes which should be conducted, 
namely structure identification and parameter estimation. 
Structure identification is a process to find appropriate fuzzy IF-THEN rules
and to determine the overall number of rules. 
Parameter estimation is applied to tune parameters of membership functions.
Many approaches have been proposed 
in order to perform this modeling such as a table-lookup scheme, heuristic procedures,
neuro-fuzzy techniques, clustering methods, genetic algorithms, least squares methods,
gradient descent, etc. In this package, the following approaches to generate 
fuzzy IF-THEN rules have been implemented: 
</p>

<ol>
<li>
<p> FRBS based on space partition
</p>

<ul>
<li>
<p> Wang and Mendel's technique (<code>WM</code>): It is used to solve regression tasks. See <code>WM</code>.
</p>
</li>
<li>
<p> Chi's technique (<code>FRBCS.CHI</code>): It is used to solve classification tasks. See <code>FRBCS.CHI</code>.
</p>
</li>
<li>
<p> Ishibuchi's technique using weight factor (<code>FRBCS.W</code>): It is used to solve classification tasks. See <code>FRBCS.W</code>.
</p>
</li>
</ul>
</li>
<li>
<p> FRBS based on neural networks
</p>

<ul>
<li>
<p> The adaptive-network-based fuzzy inference system (<code>ANFIS</code>): 
It is used to solve regression tasks. See <code>ANFIS</code>.
</p>
</li>
<li>
<p> The hybrid neural fuzzy inference system (<code>HYFIS</code>): It is used to solve regression tasks. See <code>HyFIS</code>.
</p>
</li>
</ul>
</li>
<li>
<p> FRBS based on clustering approach
</p>

<ul>
<li>
<p> The subtractive clustering and fuzzy c-means (<code>SBC</code>): It is used to solve regression tasks. See <code>SBC</code>.
</p>
</li>
<li>
<p> The dynamic evolving neural-fuzzy inference system (<code>DENFIS</code>): 
It is used to solve regression tasks. See <code>DENFIS</code>.
</p>
</li>
</ul>
</li>
<li>
<p> FRBS based on genetic algorithms
</p>

<ul>
<li>
<p> The Thrift's method (<code>GFS.THRIFT</code>): It is used to solve regression tasks. See <code>GFS.Thrift</code>.
</p>
</li>
<li>
<p> The Genetic fuzzy systems for fuzzy rule learning based on the MOGUL methodology (<code>GFS.FR.MOGUL</code>):
It is used to solve regression tasks. See <code>GFS.FR.MOGUL</code>.
</p>
</li>
<li>
<p> The Ishibuchi's method based on genetic cooperative-competitive learning (<code>GFS.GCCL</code>):
It is used to solve classification tasks. See <code>GFS.GCCL</code>.
</p>
</li>
<li>
<p> The Ishibuchi's method based on hybridization of genetic cooperative-competitive learning (GCCL) and Pittsburgh (<code>FH.GBML</code>):
It is used to solve classification tasks. See <code>FH.GBML</code>.
</p>
</li>
<li>
<p> The structural learning algorithm on vague environtment (<code>SLAVE</code>):
It is used to solve classification tasks. See <code>SLAVE</code>.
</p>
</li>
<li>
<p> The genetic for lateral tuning and rule selection of linguistic fuzzy system (<code>GFS.LT.RS</code>): 
It is used to solve regression tasks. See <code>GFS.LT.RS</code>.
</p>
</li>
</ul>
</li>
<li>
<p> FRBS based on the gradient descent method
</p>

<ul>
<li>
<p> The FRBS using heuristics and gradient descent method (<code>FS.HGD</code>): 
It is used to solve regression tasks. See <code>FS.HGD</code>
</p>
</li>
<li>
<p> The fuzzy inference rules by descent method (<code>FIR.DM</code>): 
It is used to solve regression tasks. See <code>FIR.DM</code>
</p>
</li>
</ul>
</li>
</ol>
<p>The functions documented in the manual for the single methods are all called internally 
by <code>frbs.learn</code>, which is the central function of the package. 
However, in the documentation of each of the internal learning functions, 
we give some theoretical background and references to the original literature.
</p>
<p><b>Usage of the package:</b>
</p>
<p>First of all, if you have problems using the package, find a bug, or have suggestions, 
please contact the package maintainer by email, instead of writing to the general R lists 
or to other internet forums and mailing lists.
</p>
<p>The main functions of the package are the following:
</p>

<ul>
<li>
<p> The function <code>frbs.learn</code> allows to generate the model by 
creating fuzzy IF-THEN rules or cluster centers from training data. 
In other words, users just need to call this function to generate an FRBS model from 
training data. The different algorithms mentioned above are all accessible through this function. 
The outcome of the function is an <code>frbs-object</code>. 
</p>
</li>
<li>
<p> Even though the main purpose of this package is to generate 
the FRBS models from training data automatically, we provide the function <code>frbs.gen</code>, 
which can be used to build a model manually without using a learning method.
Moreover, we provide the following features: linguistic hedges, the "and" and "or" operators, 
and the "dont_care" value for representing the degree of 1. The higher degree of interpretability 
can also be achieved by using the "dont_care" value. If we want to define various length of rules
in the rulebase, we can also define the "dont_care" value. See <code>rulebase</code>.    
</p>
</li>
<li>
<p> The purpose of the function <code>predict</code> is to obtain predicted values 
according to the testing data and the model (analogous to the <code>predict</code> function 
that is implemented in many other R packages). 
</p>
</li>
<li>
<p> There exist functions <code>summary.frbs</code> and <code>plotMF</code> to 
show a summary about an <code>frbs-object</code>, and to plot the shapes of 
the membership functions.
</p>
</li>
<li>
<p> Exporting an FRBS model to the frbsPMML format can be done by executing <code>frbsPMML</code> and <code>write.frbsPMML</code>. 
The frbsPMML format is a universal framework adopted from the Predictive Model Markup Language (PMML) format. Then, 
in order to consume/import the frbsPMML format to an FRBS model, we call <code>read.frbsPMML</code>.  
</p>
</li>
</ul>
<p>To get started with the package, the user can have a look at some examples included in
the documentation of the functions <code>frbs.learn</code> and <code>frbs.gen</code> for generating models and
<code>predict</code> for the prediction phase.
</p>
<p>Also, there are many demos that ship with the package. To get a list of them, type:
</p>
<p><code>demo()</code>
</p>
<p>Then, to start a demo, type <code>demo(&lt;demo_name_here&gt;)</code>. All the demos are present as 
R scripts in the package sources in the <code>"demo"</code> subdirectory. Note that
some of them may take quite a long time which depends on specification hardwares.
</p>
<p>Currently, there are the following demos available:
</p>
<p>Regression using the Gas Furnance dataset:
</p>
<p><code>demo(WM.GasFur)</code>,
<code>demo(SBC.GasFur)</code>,
<code>demo(ANFIS.GasFur)</code>,
</p>
<p><code>demo(FS.HGD.GasFur)</code>, 
<code>demo(DENFIS.GasFur)</code>,
<code>demo(HyFIS.GasFur)</code>,
</p>
<p><code>demo(FIR.DM.GasFur)</code>,
<code>demo(GFS.FR.MOGUL.GasFur)</code>,
</p>
<p><code>demo(GFS.THRIFT.GasFur)</code>,
<code>demo(GFS.LT.RS.GasFur)</code>.
</p>
<p>Regression using the Mackey-Glass dataset:
</p>
<p><code>demo(WM.MG1000)</code>,
<code>demo(SBC.MG1000)</code>,
<code>demo(ANFIS.MG1000)</code>,
</p>
<p><code>demo(FS.HGD.MG1000)</code>, 
<code>demo(DENFIS.MG1000)</code>,
<code>demo(HyFIS.MG1000)</code>,
</p>
<p><code>demo(GFS.THRIFT.MG1000)</code>, 
<code>demo(FIR.DM.MG1000)</code>,
</p>
<p><code>demo(GFS.FR.MOGUL.MG1000)</code>,
<code>demo(GFS.LT.RS.MG1000)</code>.
</p>
<p>Classification using the Iris dataset:
</p>
<p><code>demo(FRBCS.W.Iris)</code>,
<code>demo(FRBCS.CHI.Iris)</code>,
<code>demo(GFS.GCCL.Iris)</code>,
</p>
<p><code>demo(FH.GBML.Iris)</code>,
<code>demo(SLAVE.Iris)</code>.
</p>
<p>Generating FRBS model without learning process:
</p>
<p><code>demo(FRBS.Mamdani.Manual)</code>,
<code>demo(FRBS.TSK.Manual)</code>,
<code>demo(FRBS.Manual)</code>.
</p>
<p>Exporting/importing to/from frbsPMML:
</p>
<p><code>demo(WM.GasFur.PMML)</code>,
<code>demo(ANFIS.GasFur.PMML)</code>,
<code>demo(GFS.GCCL.Iris.PMML)</code>.
</p>
<p>The Gas Furnance data and Mackey-Glass data are included in the package, 
please see <code>frbsData</code>. The Iris data is the standard Iris dataset that
ships with R.
</p>
<p>Also have a look at the package webpage <a href="http://sci2s.ugr.es/dicits/software/FRBS">http://sci2s.ugr.es/dicits/software/FRBS</a>, 
where we provide a more extensive introduction as well as additional explanations of 
the procedures.
</p>


<h3>Author(s)</h3>

<p>Lala Septem Riza <a href="mailto:lala.s.riza@decsai.ugr.es">lala.s.riza@decsai.ugr.es</a>,
</p>
<p>Christoph Bergmeir <a href="mailto:c.bergmeir@decsai.ugr.es">c.bergmeir@decsai.ugr.es</a>, 
</p>
<p>Francisco Herrera <a href="mailto:herrera@decsai.ugr.es">herrera@decsai.ugr.es</a>, 
</p>
<p>and Jose Manuel Benitez <a href="mailto:j.m.benitez@decsai.ugr.es">j.m.benitez@decsai.ugr.es</a>
</p>
<p>DiCITS Lab, SCI2S group, DECSAI, University of Granada.
</p>
<p><a href="http://sci2s.ugr.es/dicits/">http://sci2s.ugr.es/dicits/</a>, <a href="http://sci2s.ugr.es">http://sci2s.ugr.es</a>
</p>


<h3>References</h3>

<p>A. Guazzelli, M. Zeller, W.C. Lin, and G. Williams., 
"pmml: An open standard for sharing models", The R Journal, Vol. 1, No. 1, pp. 60-65 (2009).
</p>
<p>C.C. Lee, "Fuzzy Logic in control systems: Fuzzy logic controller part I", 
IEEE Trans. Syst., Man, Cybern., 
vol. 20, no. 2, pp. 404 - 418 (1990).
</p>
<p>C.C. Lee, "Fuzzy Logic in control systems: Fuzzy logic controller part II",
IEEE Trans. Syst., Man, Cybern.,
vol. 20, no. 2, pp. 419 - 435 (1990).
</p>
<p>E.H. Mamdani and S. Assilian, "An experiment in linguistic synthesis with 
a fuzzy logic controller," International Journal of Man Machine Studies, vol. 7, no. 1, 
pp. 1 - 13 (1975).
</p>
<p>W. Pedrycz, "Fuzzy Control and Fuzzy Systems," New York: Wiley (1989).
</p>
<p>L.S. Riza, C. Bergmeir, F. Herrera, and J.M. Benitez, 
"frbs: Fuzzy Rule-Based Systems for Classification and Regression in R,"
Journal of Statistical Software, vol. 65, no. 6, pp. 1 - 30 (2015).
</p>
<p>M. Sugeno and G.T. Kang, "Structure identification of fuzzy model," 
Fuzzy Sets Syst., vol. 28, pp. 15 - 33 (1988).
</p>
<p>T. Takagi and M. Sugeno, "Fuzzy identification of systems and its application to 
modelling and control", IEEE Transactions on Systems, Man and Cybernetics, vol. 15, no. 1, 
pp. 116 - 132 (1985).
</p>
<p>L.A. Zadeh, "Fuzzy sets", Information and Control, vol. 8, pp. 338 - 353 (1965).
</p>


<h3>See Also</h3>

<p><code>frbs.learn</code>, <code>frbs.gen</code>, <code>frbsPMML</code>, and <code>predict</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##################################
## I. Regression Problem
## In this example, we are using the gas furnace dataset that 
## contains two input and one output variables.
##################################

## Input data: Using the Gas Furnace dataset
## then split the data to be training and testing datasets
data(frbsData)
data.train &lt;- frbsData$GasFurnance.dt[1 : 204, ]
data.tst &lt;- frbsData$GasFurnance.dt[205 : 292, 1 : 2]
real.val &lt;- matrix(frbsData$GasFurnance.dt[205 : 292, 3], ncol = 1)

## Define interval of data
range.data &lt;-apply(data.train, 2, range)

## Set the method and its parameters,
## for example, we use Wang and Mendel's algorithm
method.type &lt;- "WM"
control &lt;- list(num.labels = 15, type.mf = "GAUSSIAN", type.defuz = "WAM", 
           type.tnorm = "MIN", type.snorm = "MAX", type.implication.func = "ZADEH",
               name = "sim-0") 

## Learning step: Generate an FRBS model
object.reg &lt;- frbs.learn(data.train, range.data, method.type, control)

## Predicting step: Predict for newdata
res.test &lt;- predict(object.reg, data.tst)

## Display the FRBS model
summary(object.reg)

## Plot the membership functions
plotMF(object.reg)

##################################
## II. Classification Problem
## In this example, we are using the iris dataset that 
## contains four input and one output variables.
##################################

## Input data: Using the Iris dataset
data(iris)
set.seed(2)

## Shuffle the data
## then split the data to be training and testing datasets
irisShuffled &lt;- iris[sample(nrow(iris)), ]
irisShuffled[, 5] &lt;- unclass(irisShuffled[, 5])
tra.iris &lt;- irisShuffled[1 : 105, ]
tst.iris &lt;- irisShuffled[106 : nrow(irisShuffled), 1 : 4]
real.iris &lt;- matrix(irisShuffled[106 : nrow(irisShuffled), 5], ncol = 1)

## Define range of input data. Note that it is only for the input variables.
range.data.input &lt;- apply(iris[, -ncol(iris)], 2, range)

## Set the method and its parameters. In this case we use FRBCS.W algorithm
method.type &lt;- "FRBCS.W"
control &lt;- list(num.labels = 7, type.mf = "GAUSSIAN", type.tnorm = "MIN", 
               type.snorm = "MAX", type.implication.func = "ZADEH")  

## Learning step: Generate fuzzy model
object.cls &lt;- frbs.learn(tra.iris, range.data.input, method.type, control)

## Predicting step: Predict newdata
res.test &lt;- predict(object.cls, tst.iris)

## Display the FRBS model
summary(object.cls)

## Plot the membership functions
plotMF(object.cls)

#################################################
## III. Constructing an FRBS model from human expert. 
## In this example, we only consider the Mamdani model for regression. However, 
## other models can be done in the same way.
## Note:
## In the examples, let us consider four input and one output variables.
#################################################

## Define a matrix representing shape and parameters of membership functions of input variables.
## The matrix has 5 rows where the first row represent the type of the membership function whereas
## others are values of its parameters.
## Detailed explanation can be seen in the fuzzifier function to construct the matrix.
varinp.mf &lt;- matrix(c(2, 0, 20, 40, NA, 4, 20, 40, 60, 80, 3, 60, 80, 100, NA,
                      2, 0, 35, 75, NA, 3, 35, 75, 100, NA,
                      2, 0, 20, 40, NA, 1, 20, 50, 80, NA, 3, 60, 80, 100, NA,
                      2, 0, 20, 40, NA, 4, 20, 40, 60, 80, 3, 60, 80, 100, NA),
                      nrow = 5, byrow = FALSE)

## Define number of linguistic terms of input variables.
## Suppose, we have 3, 2, 3, and 3 numbers of linguistic terms 
## for the first, second, third and fourth variables, respectively.
num.fvalinput &lt;- matrix(c(3, 2, 3, 3), nrow=1)

## Give the names of the linguistic terms of each input variables.
varinput.1 &lt;- c("low", "medium", "high")
varinput.2 &lt;- c("yes", "no")
varinput.3 &lt;- c("bad", "neutral", "good")
varinput.4 &lt;- c("low", "medium", "high")
names.varinput &lt;- c(varinput.1, varinput.2, varinput.3, varinput.4)

## Set interval of data.
range.data &lt;- matrix(c(0, 100, 0, 100, 0, 100, 0, 100, 0, 100), nrow = 2)

## Define inference parameters.
## Detailed information about values can be seen in the inference function.
type.defuz &lt;- "WAM"
type.tnorm &lt;- "MIN"
type.snorm &lt;- "MAX"
type.implication.func &lt;- "ZADEH"

## Give the name of simulation.
name &lt;- "Sim-0"

## Provide new data for testing. 
newdata&lt;- matrix(c(25, 40, 35, 15, 45, 75, 78, 70), nrow = 2, byrow = TRUE)
## the names of variables
colnames.var &lt;- c("input1", "input2", "input3", "input4", "output1")

## Define number of linguistic terms of output variable.
## In this case, we set the number of linguistic terms to 3.
num.fvaloutput &lt;- matrix(c(3), nrow = 1)

## Give the names of the linguistic terms of the output variable.
varoutput.1 &lt;- c("bad", "neutral", "good")
names.varoutput &lt;- c(varoutput.1)

## Define the shapes and parameters of the membership functions of the output variables.
varout.mf &lt;- matrix(c(2, 0, 20, 40, NA, 4, 20, 40, 60, 80, 3, 60, 80, 100, NA),
                      nrow = 5, byrow = FALSE)

## Set type of model which is "MAMDANI".
type.model &lt;- "MAMDANI"

## Define the fuzzy IF-THEN rules; 
## In this example we are using the Mamdani model 
## Note: e.g.,
## "a1", "and", "b1, "-&gt;", "e1" means that 
## "IF inputvar.1 is a1 and inputvar.2 is b1 THEN outputvar.1 is e1" 
## Make sure that each rule has a "-&gt;" sign. 
rule &lt;- matrix(
  c("low", "and", "yes", "and", "bad", "and", "low", "-&gt;", "bad",
    "medium", "and", "no", "and", "neutral", "and", "medium", "-&gt;", "neutral", 
    "high", "and", "no", "and", "neutral", "and", "low", "-&gt;", "good"), 
    nrow = 3, byrow = TRUE) 

## Generate a fuzzy model with frbs.gen.
object &lt;- frbs.gen(range.data, num.fvalinput, names.varinput, 
                 num.fvaloutput, varout.mf, names.varoutput, rule, 
                 varinp.mf, type.model, type.defuz, type.tnorm, 
                 type.snorm, func.tsk = NULL, colnames.var, type.implication.func, name)

## Plot the membership function.
plotMF(object)

## Predicting using new data.
res &lt;- predict(object, newdata)$predicted.val

#################################################
## IV. Specifying an FRBS model in the frbsPMML format.
## other examples can be seen in the frbsPMML function.
#################################################
## Input data
data(frbsData)
data.train &lt;- frbsData$GasFurnance.dt[1 : 204, ]
data.fit &lt;- data.train[, 1 : 2]
data.tst &lt;- frbsData$GasFurnance.dt[205 : 292, 1 : 2]
real.val &lt;- matrix(frbsData$GasFurnance.dt[205 : 292, 3], ncol = 1)
range.data&lt;-matrix(c(-2.716, 2.834, 45.6, 60.5, 45.6, 60.5), nrow = 2)

## Set the method and its parameters
method.type &lt;- "WM"
control &lt;- list(num.labels = 3, type.mf = "GAUSSIAN", type.defuz = "WAM", 
                type.tnorm = "MIN", type.snorm = "MAX", 
                type.implication.func = "ZADEH", name="sim-0") 

## Generate fuzzy model
object &lt;- frbs.learn(data.train, range.data, method.type, control)

## 2. Constructing the frbsPMML format
frbsPMML(object)
</code></pre>


</div>