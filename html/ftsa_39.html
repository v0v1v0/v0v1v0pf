<div class="container">

<table style="width: 100%;"><tr>
<td>MFPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multilevel functional principal component analysis for clustering
</h2>

<h3>Description</h3>

<p>A multilevel functional principal component analysis for performing clustering analysis
</p>


<h3>Usage</h3>

<pre><code class="language-R">MFPCA(y, M = NULL, J = NULL, N = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A data matrix containing functional responses. Each row contains measurements from a function at a set of grid points, and each column contains measurements of all functions at a particular grid point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of countries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>Number of functional responses in each country</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of grid points per function</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K1</code></td>
<td>
<p>Number of components at level 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K2</code></td>
<td>
<p>Number of components at level 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K3</code></td>
<td>
<p>Number of components at level 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>A vector containing all level 1 eigenvalues in non-increasing order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>A vector containing all level 2 eigenvalues in non-increasing order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda3</code></td>
<td>
<p>A vector containing all level 3 eigenvalues in non-increasing order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi1</code></td>
<td>
<p>A matrix containing all level 1 eigenfunctions. Each row contains an eigenfunction evaluated at the same set of grid points as the input data. The eigenfunctions are in the same order as the corresponding eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi2</code></td>
<td>
<p>A matrix containing all level 2 eigenfunctions. Each row contains an eigenfunction evaluated at the same set of grid points as the input data. The eigenfunctions are in the same order as the corresponding eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi3</code></td>
<td>
<p>A matrix containing all level 3 eigenfunctions. Each row contains an eigenfunction evaluated at the same set of grid points as the input data. The eigenfunctions are in the same order as the corresponding eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores1</code></td>
<td>
<p>A matrix containing estimated level 1 principal component scores. Each row corresponds to the level 1 scores for a particular subject in a cluster. The number of rows is the same as that of the input matrix <code>y</code>. Each column contains the scores for a level 1 component for all subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores2</code></td>
<td>
<p>A matrix containing estimated level 2 principal component scores. Each row corresponds to the level 2 scores for a particular subject in a cluster. The number of rows is the same as that of the input matrix <code>y</code>. Each column contains the scores for a level 2 component for all subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores3</code></td>
<td>
<p>A matrix containing estimated level 3 principal component scores. Each row corresponds to the level 3 scores for a particular subject in a cluster. The number of rows is the same as that of the input matrix <code>y</code>. Each column contains the scores for a level 3 component for all subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A vector containing the overall mean function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>A matrix containing the deviation from overall mean function to country-specific mean function. The number of rows is the number of countries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rj</code></td>
<td>
<p>Common trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Uij</code></td>
<td>
<p>Country-specific mean function</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chen Tang, Yanrong Yang and Han Lin Shang
</p>


<h3>See Also</h3>

<p><code>mftsc</code>
</p>


</div>