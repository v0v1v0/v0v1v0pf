<div class="container">

<table style="width: 100%;"><tr>
<td>impGenes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract genes with high importance values for random forest classification</h2>

<h3>Description</h3>

<p>This function extracts all genes with an importance value for classifying cells into a given target cluster exceeding a given threshold for at least one of the random forest iterationns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impGenes(fb, tn, ithr = 0.02, zthr = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fb</code></td>
<td>
<p>fateBias object returned by the function <code>fateBias</code>. If <code>fb</code> is provided, then a principal curve is computed and shown in the plot. Default value is <code>NULL</code>. The curve is only displayed if <code>g</code> equal <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tn</code></td>
<td>
<p>name of a target cluster, i. e. concatenation of a <code>t</code> and the number of a target cluster. Has to correspond to a column name of <code>fb$probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ithr</code></td>
<td>
<p>positive real number. Threshold for the required importance measure (mean decrease in accuracy of classification upon removal, see <span class="pkg">randomForest</span>) to include a gene into the output as important feature for classying cells in <code>tn</code>. Default value is 0.02.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zthr</code></td>
<td>
<p>positive real number. Threshold for the required z-score of the importance measure (importance divided by the standard deviation of importance) to include a gene into the output as important feature for classying cells in <code>tn</code>. Default value is 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list of two elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a data frame with mean importance values for all genes surviving the filtering by <code>ithr</code> and <code>zthr</code>. Columns correspond to random forest iterations, starting from the initial target cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a data frame with the standard deviation of importance values for all genes surviving the filtering by <code>ithr</code> and <code>zthr</code>. Columns correspond to random forest iterations, starting from the initial target cluster.</p>
</td>
</tr>
</table>
<p>The function produces a heatmap of <code>d</code> with hierarchical clustering of the rows using the function <code>pheatmap</code> from the <span class="pkg">pheatmap</span> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- intestine$x
y &lt;- intestine$y
tar &lt;- c(6,9,13)
fb &lt;- fateBias(x,y,tar,z=NULL,minnr=5,minnrh=10,nbfactor=5,use.dist=FALSE,seed=NULL,nbtree=NULL)
k &lt;- impGenes(fb,"t6",ithr=.02,zthr=2)
</code></pre>


</div>