<div class="container">

<table style="width: 100%;"><tr>
<td>MFDM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multilevel functional data method
</h2>

<h3>Description</h3>

<p>Fit a multilevel functional principal component model. The function uses two-step functional principal component decompositions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MFDM(mort_female, mort_male, mort_ave, percent_1 = 0.95, percent_2 = 0.95, fh, 
	     level = 80, alpha = 0.2, MCMCiter = 100, fmethod = c("auto_arima", "ets"), 
		   BC = c(FALSE, TRUE), lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mort_female</code></td>
<td>
<p>Female mortality (p by n matrix), where p denotes the dimension and n denotes the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mort_male</code></td>
<td>
<p>Male mortality (p by n matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mort_ave</code></td>
<td>
<p>Total mortality (p by n matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent_1</code></td>
<td>
<p>Cumulative percentage used for determining the number of common functional principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent_2</code></td>
<td>
<p>Cumulative percentage used for determining the number of sex-specific functional principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fh</code></td>
<td>
<p>Forecast horizon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Nominal coverage probability of a prediction interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>1 - Nominal coverage probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCiter</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmethod</code></td>
<td>
<p>Univariate time-series forecasting method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BC</code></td>
<td>
<p>If Box-Cox transformation is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>If <code>BC = TRUE</code>, specify a Box-Cox transformation parameter.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The basic idea of multilevel functional data method is to decompose functions from different sub-populations into an aggregated average, a sex-specific deviation from the aggregated average, a common trend, a sex-specific trend and measurement error. The common and sex-specific trends are modelled by projecting them onto the eigenvectors of covariance operators of the aggregated and sex-specific centred stochastic process, respectively.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>first_percent</code></td>
<td>
<p>Percentage of total variation explained by the first common functional principal component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>female_percent</code></td>
<td>
<p>Percentage of total variation explained by the first female functional principal component in the residual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>male_percent</code></td>
<td>
<p>Percentage of total variation explained by the first male functional principal component in the residual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mort_female_fore</code></td>
<td>
<p>Forecast female mortality in the original scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mort_male_fore</code></td>
<td>
<p>Forecast male mortality in the original scale.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It can be quite time consuming, especially when MCMCiter is large.
</p>


<h3>Author(s)</h3>

<p>Han Lin Shang
</p>


<h3>References</h3>

<p>C. M. Crainiceanu and J. Goldsmith (2010) "Bayesian functional data analysis using WinBUGS", <em>Journal of Statistical Software</em>, <b>32</b>(11).
</p>
<p>C-Z. Di and C. M. Crainiceanu and B. S. Caffo and N. M. Punjabi (2009) "Multilevel functional principal component analysis", <em>The Annals of Applied Statistics</em>, <b>3</b>(1), 458-488.
</p>
<p>V. Zipunnikov and B. Caffo and D. M. Yousem and C. Davatzikos and B. S. Schwartz and C. Crainiceanu (2015) "Multilevel functional principal component analysis for high-dimensional data", <em>Journal of Computational and Graphical Statistics</em>, <b>20</b>, 852-873.
</p>
<p>H. L. Shang, P. W. F. Smith, J. Bijak, A. Wisniowski (2016) "A multilevel functional data method for forecasting population, with an application to the United Kingdom", <em>International Journal of Forecasting</em>, <b>32</b>(3), 629-649.
</p>


<h3>See Also</h3>

<p><code>ftsm</code>, <code>forecast.ftsm</code>, <code>fplsr</code>, <code>forecastfplsr</code>
</p>


</div>