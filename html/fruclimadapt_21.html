<div class="container">

<table style="width: 100%;"><tr>
<td>phenology_sequential</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction of phenological stages using a sequential model</h2>

<h3>Description</h3>

<p>The function predicts phenological phases for a climate series
from daily chill and heat requirements and daily chill and forcing heat 
data. The sequential model used in the function considers that chilling 
and heat have independent effects. It consists of an accumulation of chill 
up to the plant requirement, followed by heat up to forcing requirement, 
with no overlap between both phases. The function is independent of the
method used to calculate chill and forcing heat, so that chill can
be supplied as chill hours, chill units or chill portions (recommended, 
particularly for warm climates or in climate change studies), forcing heat 
accumulation can be supplied either as GDD or GDH. The function allows
predicting several stages (or the same for different cultivars), by supplying
a dataframe in which each row contains chill and heat requirements for a
phenological stage.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phenology_sequential(GDH_day, Reqs, Start_chill)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>GDH_day</code></td>
<td>
<p>a dataframe with daily chilling and forcing accumulation.
It must contain the columns Year, Month, Day, DOY, Chill, GD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reqs</code></td>
<td>
<p>a dataframe in which each row contains the chilling and forcing
heat requirements of one phenological stage. It must contain the columns 
Creq (for chilling) and Freq (for forcing heat).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Start_chill</code></td>
<td>
<p>parameter indicating the day of the year when chill
accumulation is supposed to start.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>dataframe with the predicted dates of chilling requirement fulfillment
and date of occurrence of each phenological stage defined in Reqs. Columns are
Creq and Freq (chilling and forcing heat requirements for the phenological stage),
Season, Creq_Year and Creq_DOY (year and day of the year in which chill 
requirements are fulfilled), Freq_Year and Freq_DOY (year and day of the year
of occurrence the phenological stage).
</p>


<h3>Author(s)</h3>

<p>Carlos Miranda, <a href="mailto:carlos.miranda@unavarra.es">carlos.miranda@unavarra.es</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Tudela_DW)
data(Bigtop_reqs)
library(magrittr)
library(dplyr)
library(lubridate)
# Select the first two seasons in Tudela_DW example dataset
Tudela_Sel &lt;- Tudela_DW %&gt;% 
       filter (Tudela_DW$Year&lt;=2002)
# Generate hourly temperatures from the example dataset
Tudela_HT &lt;- hourly_temps(Tudela_Sel,42.13132)
# Calculate chill as chill portions, starting on DOY 305
Chill &lt;- chill_portions(Tudela_HT,305)
# Calculate forcing heat as growing degree hours (GDH) with the linear model,
# using base temperature 4.7 C and no upper thresholds
GDH &lt;- GDH_linear(Tudela_HT,4.7,999,999)
# Combine Chill and GDH values in a dataframe with a format compatible with
# the function phenology_sequential
Tudela_CH &lt;- merge(Chill,GDH) %&gt;%
  select(Date, Year, Month, Day, DOY, Chill,GDH) %&gt;%
    rename(GD=GDH)
# Obtain the predicted dates using the example dataset with requirements
Phenology_BT &lt;- phenology_sequential(Tudela_CH, Bigtop_reqs, 305)

</code></pre>


</div>