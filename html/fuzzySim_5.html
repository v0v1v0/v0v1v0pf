<div class="container">

<table style="width: 100%;"><tr>
<td>corSelect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Select among correlated variables based on a given criterion
</h2>

<h3>Description</h3>

<p>This function computes pairwise correlations among the variables in a dataset and, among each pair of variables correlated above a given threshold(or, optionally, below a given significance value), it excludes the variable with either the highest variance inflation factor (VIF), or the weakest, least significant or least informative bivariate (individual) relationship with the response variable, according to a given criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corSelect(data, sp.cols = NULL, var.cols, coeff = TRUE,
cor.thresh = ifelse(isTRUE(coeff), 0.8, 0.05),
select = ifelse(is.null(sp.cols), "VIF", "p.value"), family = "auto",
use = "pairwise.complete.obs", method = "pearson", verbosity = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the response and predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.cols</code></td>
<td>
<p>name or index number of the column of 'data' that contains the response (e.g. species) variable. Currently, only one 'sp.cols' can be used at a time, so an error message is returned if length(sp.cols) &gt; 1. If left NULL, 'select' will be "VIF" by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cols</code></td>
<td>
<p>names or index numbers of the columns of 'data' that contain the predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>logical value indicating whether two variables should be considered highly correlated based on the magnitude of their coefficient of correlation. The default is TRUE. If set to FALSE, this classification will be based on the p-value of the correlation, but mind that (with sufficient sample size) correlations can be statistically significant even if weak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.thresh</code></td>
<td>
<p>if coeff=TRUE (the default): threshold value of correlation coefficient above which (or below which, for negative correlations) two predictor variables are considered highly correlated. The default is 0.8. If coeff=FALSE: threshold value of p-value below which two predictor variables are considered highly (or significantly) correlated. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>character value indicating the criterion for excluding variables among those that are highly correlated. Can be "VIF" (the default if 'sp.cols' is NULL), "p.value" (the default if 'sp.cols' is specified), "AIC", "BIC", or "cor" (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>If 'sp.col' is not NULL, the error distribution and (optionally) the link function to use for assessing significant / informative variables (see <code>glm</code> or <code>family</code> for details). The default "auto" automatically uses "binomial" family for response variables containing only values of 0 and 1; "poisson" for positive integer responses (i.e. count data); "Gamma" for positive non-integer; and "gaussian" (i.e., linear models) otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>argument to pass to <code>cor</code> indicating what to do when there are missing values. Can be "pairwise.complete.obs" (the default here), "everything", "all.obs", "complete.obs", "na.or.complete".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>argument to pass to <code>cor</code> specifying the correlation coefficient to use. Can be "pearson" (the default, with a recommended minimum of 30 rows of data), "kendall", or "spearman" (with a recommended minimum of 10 rows of data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>integer value indicating the amount of messages to display. The default is 1, for a medium amount of messages. Use 2 for more messages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Correlations among variables are often considered problematic in multivariate models, as they inflate the variance of coefficients and thus may bias the interpretation of the effects of those variables on the response (Legendre &amp; Legendre 2012). Note, however, that the perceived problem often stems from misconceptions about the interpretation of multiple regression models, and that removing (albeit correlated) variables usually reduces predictive power (Morrissey &amp; Ruxton 2018, Gregorich et al. 2021, Vanhove 2021). Removing high correlations is, however, a way of reducing the number of variables to include in a model, when the potentially meaningful variables are still numerous and no better a priori selection criterion is available.
</p>
<p>One of the strategies to reduce correlations within a dataset consists of excluding one from each pair of highly correlated variables. However, it is not always straightforward (or ecological knowledge is not alway sufficient) to choose which variable to exclude. This function selects among correlated variables based either on their variance inflation factor (VIF: Marquardt 1970; Mansfield &amp; Helms 1982) within the variables dataset (obtained with the <code>multicol</code> function and recalculated iteratively after each variable exclusion); or on their relationship with the response, by simply computing the <code>cor</code>relation between each variable and the response and excluding the variable with the smallest absolute coefficient; or by building a bivariate generalized linear model (<code>glm</code>) of each variable against the response and excluding, among each of two correlated variables, the one with the largest (worst) p-value, AIC (Akaike's Information Criterion: Akaike, 1973) or BIC (Bayesian Information Criterion, also known as Schwarz criterion, SBC or SBIC: Schwarz, 1978), which is calculated with the <code>FDR</code> function.
</p>
<p>If 'select' is NULL, or if 'select' is other than "VIF" but 'sp.cols' is NULL, the function returns only a table showing the pairs of variables that are correlated beyond the given threshold, without selection or exclusion. If the 'select' criterion requires assessing bivariate relationships and 'sp.cols' is provided, the function uses only the rows of the dataset where 'sp.cols' (used as the response variable) contains finite values against which the predictor variables can be modelled; rows with NA or NaN in 'sp.cols' are thus excluded from the calculation of correlations among predictor variables.
</p>


<h3>Value</h3>

<p>This function returns a list of 7 elements (unless select=NULL, in which case it returns only the first of these elements):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>high.correlations</code></td>
<td>
<p>data frame showing the pairs of input variables that are correlated beyond the given threshold, their correlation coefficient and its associated p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bivariate.significance</code></td>
<td>
<p>data frame with the individual p-value, AIC, BIC and correlation coefficient (if one of these was the 'select' criterion and if 'sp.cols' was provided) of each of the highly correlated variables against the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excluded.vars</code></td>
<td>
<p>character vector containing the names of the variables to exclude (i.e., from each highly correlated pair, the variable with the worse 'select' score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.vars</code></td>
<td>
<p>character vector containing the names of the variables to select (i.e., the non-correlated variables and, from each correlated pair, the variable with the better 'select' score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.var.cols</code></td>
<td>
<p>integer vector containing the column indices of the selected variables in 'data'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strongest.remaining.corr</code></td>
<td>
<p>numerical value indicating the strongest correlation coefficient among the selected variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remaining.multicollinearity</code></td>
<td>
<p>data frame showing the <code>multicol</code>linearity among the selected variables.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>A. Marcia Barbosa</p>


<h3>References</h3>

<p>Akaike H. (1973) Information theory and an extension of the maximum likelihood principle. In: Petrov B.N. &amp; Csaki F., 2nd International Symposium on Information Theory, Tsahkadsor, Armenia, USSR, September 2-8, 1971, Budapest: Akademiai Kiado, p. 267-281.
</p>
<p>Gregorich M., Strohmaier S., Dunkler D. &amp; Heinze G. (2021) Regression with Highly Correlated Predictors: Variable Omission Is Not the Solution. Int. J. Environ. Res. Public Health, 18: 4259.
</p>
<p>Legendre P. &amp; Legendre L. (2012) Numerical ecology (3rd edition). Elsevier, Amsterdam: 990 pp.
</p>
<p>Marquardt D.W. (1970) Generalized inverses, ridge regression, biased linear estimation, and nonlinear estimation. Technometrics 12: 591-612.
</p>
<p>Mansfield E.R. &amp; Helms B.P. (1982) Detecting multicollinearity. The American Statistician 36: 158-160.
</p>
<p>Morrissey M.B. &amp; Ruxton G.D. (2018) Multiple Regression Is Not Multiple Regressions: The Meaning of Multiple Regression and the Non-Problem of Collinearity. Philosophy, Theory, and Practice in Biology, 10: 003. DOI: 10.3998/ptpbio.16039257.0010.003
</p>
<p>Schwarz, G.E. (1978) Estimating the dimension of a model. Annals of Statistics, 6 (2): 461-464.
</p>
<p>Vanhove J. (2021)  Collinearity isn't a disease that needs curing. Meta-Phsychology 5, MP.2020.2548. DOI: 10.15626/MP.2021.2548
</p>


<h3>See Also</h3>

<p><code>multicol</code>, <code>FDR</code>, <code>cor</code>; and <code>collinear</code> in package <span class="pkg">collinear</span>, which handles continuous and categorical variables
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(rotif.env)

corSelect(rotif.env, var.cols = 5:17, select = NULL)

corSelect(rotif.env, var.cols = 5:17)

corSelect(rotif.env, sp.cols = 46, var.cols = 5:17)

corSelect(rotif.env, sp.cols = 46, var.cols = 5:17, cor.thresh = 0.7)

corSelect(rotif.env, sp.cols = 46, var.cols = 5:17, select = "BIC", method = "spearman")
</code></pre>


</div>