<div class="container">

<table style="width: 100%;"><tr>
<td>marginal.cor.funeigen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate marginal correlations with response, 
from a funeigen object</h2>

<h3>Description</h3>

<p>A function for internal use.  Its main job is to be called by <code>MarginalCor</code>,
and do the technical work for calculating estimated marginal correlations. It 
uses R. A. Fisher's classic r-to-z transform to create confidence
intervals for the correlations.  This process is explained
in easy-to-follow detail by David Shen and Zaizai Lu in a technical report.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marginal.cor.funeigen(object, id, response, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of type <code>funeigen</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>The vector of subject id's. These tell which responses in <code>response</code> 
correspond to which curves in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The vector of responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The alpha level for confidence intervals (one minus the two-sided coverage)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a <code>data.frame</code> with four columns. 
The first, <code>time</code>, is the time index of the rows.  
That is, it is a grid of points t along the time axis and
these points correspond to the rows.  The next three are the 
lower bound, best estimate, and upper bound, of the 
correlation between the smoothed value of the covariate x(t)
and the response y at each of the time points t. 
We refer to the correlation function estimated here as marginal because
it ignores any other functional covariates (rather than 
trying to adjust or control for them).
</p>


<h3>Note</h3>

<p>The confidence intervals are simply based on Fisher's
r-to-z transform and do not 
take into account the uncertainty in estimating the 
smoothed value of x(t).
</p>


<h3>References</h3>

<p>Shen, D., and Lu, Z. (2006). Computation of correlation coefficient
and its confidence interval in SAS (r). SUGI 31 (March 26-29, 2006), paper 170-31. Available online at 
<a href="https://support.sas.com/resources/papers/proceedings/proceedings/sugi31/170-31.pdf">https://support.sas.com/resources/papers/proceedings/proceedings/sugi31/170-31.pdf</a>.
</p>


</div>