<div class="container">

<table style="width: 100%;"><tr>
<td>flipscores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust testing in GLMs, by sign-flipping score contributions</h2>

<h3>Description</h3>

<p>Provides robust tests for testing in GLMs, by sign-flipping score contributions. The tests are often robust against overdispersion, heteroscedasticity and, in some cases, ignored nuisance variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flipscores(formula, family, data, score_type, 
n_flips=5000, alternative ="two.sided", 
id = NULL, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>see <code>glm</code> function. It can also be a model (usually generated by a call to <code>glm</code>); in this case, any other glm-related parameter (e.g. <code>family, data, etc.</code>) are discarded, the function will make use of the ones used to generate the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>see <code>glm</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>see <code>glm</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score_type</code></td>
<td>
<p>The type of score that is computed. It can be "orthogonalized", "effective" or "basic". 
Both "orthogonalized" and "effective" take into account the nuisance estimation and they provide the same
test statistic. In case of small samples "effective score" might have a slight anti-conservative behaviour. 
"orthogonalized effective score" gives a solution for this issue.
Note that in case of a big model matrix, the "orthogonalized" may take a long time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_flips</code></td>
<td>
<p>The number of random flips of the score contributions.
When <code>n_flips</code> is equal or larger than the maximum number of possible flips (i.e. n^2), all possible flips are performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>It can be "greater", "less" or "two.sided" (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a <code>vector</code> identifying the clustered observations. If <code>NULL</code> (default) observations are assumed to be independent. If <code>id</code> is not <code>NULL</code>, only <code>score_type=="effective"</code> is allowed, yet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p><code>NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>see <code>glm</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>flipscores</code> borrow the same parameters from function <code>glm</code> (and <code>glm.nb</code>). See these helps for more details about parameters such as <code>formula</code>,
<code>data</code>, <code>family</code>. Note: in order to use Negative Binomial family, <code>family</code> reference must have quotes (i.e. <code>family="negbinom"</code>).
</p>


<h3>Value</h3>

<p>glm class object with sign-flip score test.
See also the related functions (<code>summary.flipscores</code>, <code>anova.flipscores</code>, <code>print.flipscores</code>).
</p>


<h3>Author(s)</h3>

<p>Livio Finos, Riccardo De Santis, Vittorio Giatti, Jesse Hemerik and Jelle Goeman
</p>


<h3>References</h3>

<p>"Robust testing in generalized linear models by sign-flipping score contributions" by J.Hemerik, J.Goeman and L.Finos.
</p>


<h3>See Also</h3>

<p><code>anova.flipscores</code>, <code>summary.flipscores</code>, <code>flip</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
dt=data.frame(X=rnorm(20),
   Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson")
summary(mod)

# Equivalent to:
model=glm(Y~Z+X,data=dt,family="poisson")
mod2=flipscores(model)
summary(mod2)
</code></pre>


</div>