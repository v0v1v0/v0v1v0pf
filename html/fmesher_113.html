<div class="container">

<table style="width: 100%;"><tr>
<td>fm_basis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute mapping matrix between mesh function space and points</h2>

<h3>Description</h3>

<p>Computes the basis mapping matrix between a function space on a mesh, and locations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fm_basis(x, ...)

## Default S3 method:
fm_basis(x, loc, ...)

## S3 method for class 'fm_mesh_1d'
fm_basis(x, loc, weights = NULL, derivatives = NULL, ...)

## S3 method for class 'fm_mesh_2d'
fm_basis(x, loc, weights = NULL, derivatives = NULL, ...)

## S3 method for class 'inla.mesh.1d'
fm_basis(x, loc, ...)

## S3 method for class 'inla.mesh'
fm_basis(x, loc, ...)

## S3 method for class 'fm_evaluator'
fm_basis(x, ...)

## S3 method for class 'fm_tensor'
fm_basis(x, loc, weights = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object supported by the <code>fm_evaluator()</code> class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>A set of points of a class supported by <code>fm_evaluator(x, loc = loc)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional weight vector to apply (from the left, one
weight for each row of the basis matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivatives</code></td>
<td>
<p>If non-NULL and logical, return a list, optionally
including derivative matrices.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>sparseMatrix</code>
</p>
<p>For <code>fm_mesh_1d</code>, a matrix, or if <code>derivatives</code> is <code>TRUE</code>,
a list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>A </code></td>
<td>
<p>The projection matrix, <code style="white-space: pre;">⁠u(loc_i)=sum_j A_ij w_i⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1A, d2A </code></td>
<td>
<p>Derivative weight matrices,
<code style="white-space: pre;">⁠du/dx(loc_i)=sum_j dx_ij w_i⁠</code>, etc.</p>
</td>
</tr>
</table>
<p>For <code>fm_mesh_2d</code>, a matrix, or if <code>derivatives</code> is <code>TRUE</code>,
a list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>A </code></td>
<td>
<p>The projection matrix, <code style="white-space: pre;">⁠u(loc_i)=sum_j A_ij w_i⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx, dy, dz </code></td>
<td>
<p>Derivative weight matrices, <code style="white-space: pre;">⁠du/dx(loc_i)=sum_j dx_ij w_i⁠</code>, etc.</p>
</td>
</tr>
</table>
<p>For <code>fm_tensor</code>, a matrix
</p>


<h3>See Also</h3>

<p><code>fm_raw_basis()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compute basis mapping matrix
str(fm_basis(fmexample$mesh, fmexample$loc))
</code></pre>


</div>