<div class="container">

<table style="width: 100%;"><tr>
<td>getKsPCAData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get K Functions and Compute Principal Components</h2>

<h3>Description</h3>

<p>This function computes K functions from point process data then converts it
into PCs. Note, if there are replicates, i.e. multiple observations per
unit, the K functions will be a weighted average based on the number of
the first agents.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getKsPCAData(
  data,
  outcome = colnames(data)[1],
  unit = colnames(data)[5],
  replicate = NULL,
  rCheckVals = NULL,
  nPCs = 3,
  agents_df = as.data.frame(expand.grid(unique(data[, 4]), unique(data[, 4]))),
  xRange = NULL,
  yRange = NULL,
  edgeCorrection = "isotropic",
  nbasis = 21,
  silent = FALSE,
  displayTVE = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data.frame with column titles for at least outcome, x, y, agents,
and unit. For consistency (and avoiding errors), use that order.
Additionally, replicate can be added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>(Optional) String of the column name in data indicating the
outcome or response. Default is the 1st column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>(Optional) String of the column name in data indicating a unit or
base thing. Note this unit may have replicates. Default is the 4th
column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicate</code></td>
<td>
<p>(Optional) String of the column name in data indicating the
replicate id. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rCheckVals</code></td>
<td>
<p>(Optional) Numeric vector indicating the radius to check.
Note, if not specified, this could take a lot of memory, particularly
with many units and replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPCs</code></td>
<td>
<p>(Optional) Numeric indicating the number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agents_df</code></td>
<td>
<p>(Optional) Two-column data.frame. The first for agent 1
and the second for agent 2. Both should be in data agents column. This
determines which K functions to compute. Default is to compute all, but
may be misspecified if the data is in a different order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xRange, yRange</code></td>
<td>
<p>(Optional) Two value numeric vector indicating the min
and max x/y values. Note this is re-used for all replicates. The default
just takes the min and max x from each replicate. This allows different
sized images, but the edges are defined by some agent location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeCorrection</code></td>
<td>
<p>(Optional) String indicating type of edgeCorrection(s)
to apply when computing the K functions. Options include: "border",
"bord.modif", "isotropic", "Ripley", "translate", "translation", "periodic",
"none", "best" or "all" selects all options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>(Optional) Numeric indicating number of basis functions to fit
K functions in order to compute PCA. Current implementation uses a
b-spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>(Optional) Boolean indicating if progress should be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displayTVE</code></td>
<td>
<p>(Optional) Boolean to  indicate if total variance explained
(TVE) should be displayed. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Data.frame with the outcome, unit and principle components of
computed K functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">dataPCA_pheno &lt;- getKsPCAData(
  data = TNBC_pheno, unit = "Person",
  agents_df = data.frame(rep("B", 2), c("Tumor", "Fake")),
  nPCs = 3,
  rCheckVals = seq(0, 50, 1),
  displayTVE = TRUE
)
</code></pre>


</div>