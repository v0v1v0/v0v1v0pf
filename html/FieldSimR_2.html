<div class="container">

<table style="width: 100%;"><tr>
<td>compsym_asr_output</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate genetic values based on a compound symmetry model for GxE interaction -
Simulation with 'AlphaSimR'</h2>

<h3>Description</h3>

<p>Creates a data frame of simulated genetic values in multiple environments for one or more traits
based on a compound symmetry model for genotype-by-environment (GxE) interaction. The wrapper function
<code>compsym_asr_output()</code> requires an <a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a>
population object generated with compsym_asr_input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compsym_asr_output(pop, ntraits = 1, nenvs, nreps = 1, return.effects = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>An <a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> population object
(<a href="https://gaynorr.github.io/AlphaSimR/reference/Pop-class.html">Pop-class</a> or
<a href="https://gaynorr.github.io/AlphaSimR/reference/HybridPop-class.html">HybridPop-class</a>)
generated with compsym_asr_input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>
<p>Number of traits specified in compsym_asr_input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nenvs</code></td>
<td>
<p>Number of environments specified in compsym_asr_input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>A vector defining the number of replicates in each environment. If only one value
is specified, all environments will be assigned the same number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.effects</code></td>
<td>
<p>When <code>TRUE</code> (default is <code>FALSE</code>), a list is returned with additional
entries containing the genotype main effects and GxE interaction effects for each trait.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with columns 'env', genotype 'id', and 'rep', followed by the
simulated genetic values for each trait. When <code>return.effects = TRUE</code>, a list is returned with
additional entries containing the genotype main effects and GxE interaction effects for each trait.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate genetic values with 'AlphaSimR' for two additive + dominance traits
# in two environments based on a compound symmetry model.

# 1. Define the genetic architecture of the simulated traits.
# Mean genetic values and mean dominance degrees.
mean &lt;- c(4.9, 5.4, 235.2, 228.5) # Trait 1 x 2 environments, Trait 2 x 2 environments
meanDD &lt;- c(0.4, 0.4, 0.1, 0.1) # Trait 1 and 2, same value for both environments

# Additive genetic variances and dominance degree variances.
var &lt;- c(0.08, 13) # Different values for Traits 1 and 2
varDD &lt;- 0.2 # Same value for Traits 1 and 2

# Proportion of additive and dominance degree main effect variances.
prop.main &lt;- c(0.4, 0.6) # Different values for Traits 1 and 2
prop.mainDD &lt;- 0.4 # Same value for Traits 1 and 2

# Additive and dominance degree correlations between the two simulated traits.
corA &lt;- matrix(c(
  1.0, 0.5,
  0.5, 1.0
), ncol = 2)
corDD &lt;- diag(2) # Assuming independence

input_asr &lt;- compsym_asr_input(
  ntraits = 2,
  nenvs = 2,
  mean = mean,
  var = var,
  prop.main = prop.main,
  corA = corA,
  meanDD = meanDD,
  varDD = varDD,
  prop.mainDD = prop.mainDD,
  corDD = corDD
)


# 2. Use input_asr to simulate genetic values with 'AlphaSimR' based on a
# compound symmetry model.

library("AlphaSimR")
FOUNDERPOP &lt;- quickHaplo(
  nInd = 10,
  nChr = 1,
  segSites = 20
)

SP &lt;- SimParam$new(FOUNDERPOP)



SP$addTraitAD(
  nQtlPerChr = 20,
  mean = input_asr$mean,
  var = input_asr$var,
  corA = input_asr$corA,
  meanDD = input_asr$meanDD,
  varDD = input_asr$varDD,
  corDD = input_asr$corDD,
  useVarA = TRUE
)

# By default, the variances in 'var' represent additive genetic variances.
# When useVarA = FALSE, the values represent total genetic variances.

pop &lt;- newPop(FOUNDERPOP)


# 3. Create a data frame with simulated genetic values for the two traits in
# the two environments, with two replicates of each genotype.

gv_ls &lt;- compsym_asr_output(
  pop = pop,
  ntraits = 2,
  nenvs = 2,
  nreps = 2,
  return.effects = TRUE
)

</code></pre>


</div>