<div class="container">

<table style="width: 100%;"><tr>
<td>fsia-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Import and Analysis of OMR Data from FormScanner</h2>

<h3>Description</h3>

<p>Import data of tests and questionnaires from FormScanner. 
FormScanner is an open source software that converts scanned images 
to data using optical mark recognition (OMR) and it can be downloaded from 
&lt;http://sourceforge.net/projects/formscanner/&gt;. 
The spreadsheet file created by FormScanner is imported in a convenient 
format to perform the analyses provided by the package. 
These analyses include the conversion of multiple responses to binary (correct/incorrect) data, 
the computation of the number of corrected responses for each subject or item, 
scoring using weights,
the computation and the graphical representation of the frequencies of the responses 
to each item and the report of the responses of a few subjects.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> fsia</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.1.1</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2017-06-23</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3
</td>
</tr>
</table>
<p>Data of questionnaires and tests are often collected on paper forms.
FormScanner is an open source software that converts scanned images 
to data using optical mark recognition (OMR). 
Function <code>read.formscanner</code> of the fsia package 
can be used to import data from FormScanner in R.
The correct response (key) can be specified using function 
<code>addkey</code>.
It is also possible to specify weights for each response using
function <code>addweights</code>.
If items have a key, data can be converted
to binary variables using function <code>resp2binary</code>.
In this case, the number of corrected responses for each person
and for each item can also be computed by using functions
<code>person.stat</code> and <code>item.stat</code>.
These functions can also be used to compute a score using the 
weights previously specified.
Function <code>freq</code> calculates the absolute or percentage 
frequencies of the responses to each item. The frequencies can
be printed on screen or plotted on a graph. In both cases, the
true responses (if any) are highlighted.
The responses given by one or a few subjects can be displayed 
on a graph by using function <code>report</code>.
The key is shown on the right and wrong responses can be immediately
identified by the red colour.
</p>
<p>The package includes two data sets for illustrative purposes.
Data sets <code>test</code> and <code>questionnaire</code>
contain the result of importing csv files with function <code>read.formscanner</code>.
Data set <code>key</code> contains the correct responses of the 
items of the test data sets. Data set <code>weights</code> contains
the weights of each correct response, while data set <code>weights_multiple</code>
contains the weights of each response.
</p>


<h3>Author(s)</h3>

<p>Michela Battauz
</p>
<p>Maintainer: Michela Battauz &lt;michela.battauz@uniud.it&gt;
</p>


<h3>References</h3>

<p>Borsetta, A. (2017). FormScanner [Computer Software],
URL http://sourceforge.net/projects/formscanner/.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# IMPORT DATA FROM FORMSCANNER
# find the directory with package fsia
dir_pkg &lt;- find.package("fsia")
# the example files are in the directory examples
# create the path
questionnaire_path &lt;- file.path(dir_pkg, "examples", "scan_results_questionnaire.csv")
test_path &lt;- file.path(dir_pkg, "examples", "scan_results_test.csv")
# import file "scan_results_questionnaire.csv"
questionnaire_imp&lt;-read.formscanner(questionnaire_path, dummy = "Q5.sources")
questionnaire_imp
# questionnaire_imp is equal to the data questionnaire
# import file "scan_results_test.csv"
test_imp &lt;- read.formscanner(test_path, conc = paste("id", 1:6, sep = ""), id = "id1")
test_imp
# test_imp is equal to the data test

# ADD THE KEY
# create the path for file "key.csv"
key_path &lt;- file.path(dir_pkg, "examples", "key.csv")
# add the key 
testk &lt;- addkey(test_imp, keyfile = key_path)
testk$key

# ADD WEIGHTS
# create the path for file "weights.csv"
weights_path &lt;- file.path(dir_pkg, "examples", "weights.csv")
# specify the weights for each correct response
testw &lt;- addweights(testk, weightsfile = weights_path)
testw$weights
# create the path for file "weights_multiple.csv"
weights_mult_path &lt;- file.path(dir_pkg, "examples", "weights_multiple.csv")
# specify the weights for each response
testwm &lt;- addweights(test_imp, weightsfile = weights_mult_path)
testwm$weights

# CONVERT DATA TO BINARY VARIABLES
resp01 &lt;- resp2binary(obj = testk, col = 2:41)
resp01[, 2:5]

# ASSIGN WEIGHTS TO RESPONSES
resps &lt;- resp2scores(obj = testw, col =2:41)
resps[, 2:5]

# ASSIGN WEIGHTS TO RESPONSES (MULTIPLE WEIGHTS)
resps &lt;- resp2scores(obj = testwm, col =2:41)
resps[, 2:5]

# PERSON STATISTICS (selected only 4 items)
pst &lt;- person.stat(obj = testk, col = 2:5)
pst
pst &lt;- person.stat(obj = testw, col = 2:5, weights = TRUE)
pst
pst &lt;- person.stat(obj = testwm, col = 2:5, weights = TRUE)
pst

# ITEM STATISTICS
ist &lt;- item.stat(obj = testk, col = 2:41)
head(ist)
ist &lt;- item.stat(obj = testw, col = 2:41, weights = TRUE)
head(ist)
ist &lt;- item.stat(obj = testwm, col = 2:41, weights = TRUE)
head(ist)

# FREQUENCIES OF THE RESPONSES
fr &lt;- freq(obj = testk, col = c("Question03", "Question04"))
fr
par(mfrow = c(1, 2))
plot(fr, ask = FALSE)

# RESPONSES OF TWO SUBJECTS
par(mfrow = c(1, 2))
report(obj = testk, col = 2:11, whichid = c("102344", "245784"))
report(obj = testw, col = 2:11, whichid = c("102344", "245784"), weights = TRUE)
par(mfrow = c(1, 1))
report(obj = testwm, col = 2:11, whichid = c("102344", "245784"), weights = TRUE)
</code></pre>


</div>