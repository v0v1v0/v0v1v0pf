<div class="container">

<table style="width: 100%;"><tr>
<td>predict,fgpm-method</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction from a <code>fgpm</code> Gaussian process model</h2>

<h3>Description</h3>

<p>This method enables prediction based on a <code>fgpm</code> model, at any given set of
points. Check <code>fgpm</code> for information on how to create <code>fgpm</code> models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'fgpm'
predict(object, sIn.pr = NULL, fIn.pr = NULL, detail = c("light", "full"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class fgpm corresponding to the funGp model that should be used
to predict the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sIn.pr</code></td>
<td>
<p>An optional matrix of scalar input coordinates at which the output values should be
predicted. Each column is interpreted as a scalar input variable and each row as a coordinate.
Either scalar input coordinates (sIn.pr), functional input coordinates (fIn.pr), or both must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fIn.pr</code></td>
<td>
<p>An optional list of functional input coordinates at which the output values should be
predicted. Each element of the list is interpreted as a functional input variable. Every functional input
variable should be provided as a matrix with one curve per row. Either scalar input coordinates (sIn.pr),
functional input coordinates (fIn.pr), or both must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detail</code></td>
<td>
<p>An optional character specifying the extent of information that should be delivered
by the method, to be chosen between <code>"light"</code> (default) and <code>"full"</code>.
<em>Light</em> predictions produce a list including
the predicted mean, standard deviation and limits of the 95% confidence intervals at the prediction
points. <em>Full</em> predictions produce the same information as light ones, in addition to the
training-prediction cross-covariance matrix and the prediction auto-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"list"</code> containing the data structures linked to predictions. For
<em>light</em> predictions, the list will include the mean, standard deviation and limits of the 95%
confidence intervals at the prediction points. For <em>full</em> predictions, it will include the same
information, plus the training-prediction cross-covariance matrix and the prediction auto-covariance
matrix.
</p>


<h3>Author(s)</h3>

<p>José Betancourt, François Bachoc, Thierry Klein and Jérémy Rohmer
</p>


<h3>See Also</h3>

<p><strong>*</strong> plot.predict.fgpm for the prediction plot of a <code>fgpm</code> model;
</p>
<p><strong>*</strong> simulate,fgpm-method for simulations based on a <code>fgpm</code> model;
</p>
<p><strong>*</strong> plot.simulate.fgpm for the simulation plot of a <code>fgpm</code> model.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># light predictions________________________________________________________________________
# building the model
set.seed(100)
n.tr &lt;- 25
sIn &lt;- expand.grid(x1 = seq(0,1,length = sqrt(n.tr)), x2 = seq(0,1,length = sqrt(n.tr)))
fIn &lt;- list(f1 = matrix(runif(n.tr*10), ncol = 10), f2 = matrix(runif(n.tr*22), ncol = 22))
sOut &lt;- fgp_BB3(sIn, fIn, n.tr)
m1 &lt;- fgpm(sIn = sIn, fIn = fIn, sOut = sOut)

# generating input data for prediction
n.pr &lt;- 100
sIn.pr &lt;- as.matrix(expand.grid(x1 = seq(0,1,length = sqrt(n.pr)),
                                x2 = seq(0,1,length = sqrt(n.pr))))
fIn.pr &lt;- list(f1 = matrix(runif(n.pr*10), ncol = 10), matrix(runif(n.pr*22), ncol = 22))

# making predictions
m1.preds &lt;- predict(m1, sIn.pr = sIn.pr, fIn.pr = fIn.pr)

# checking content of the list
summary(m1.preds)

# ~R output:~
#         Length Class  Mode
# mean    100    -none- numeric
# sd      100    -none- numeric
# lower95 100    -none- numeric
# upper95 100    -none- numeric

# plotting predictions
plot(m1.preds)


# comparison against true output___________________________________________________________
# building the model
set.seed(100)
n.tr &lt;- 25
sIn &lt;- expand.grid(x1 = seq(0,1,length = sqrt(n.tr)), x2 = seq(0,1,length = sqrt(n.tr)))
fIn &lt;- list(f1 = matrix(runif(n.tr*10), ncol = 10), f2 = matrix(runif(n.tr*22), ncol = 22))
sOut &lt;- fgp_BB3(sIn, fIn, n.tr)
m1 &lt;- fgpm(sIn = sIn, fIn = fIn, sOut = sOut)

# making predictions
n.pr &lt;- 100
sIn.pr &lt;- as.matrix(expand.grid(x1 = seq(0,1,length = sqrt(n.pr)),
                                x2 = seq(0,1,length = sqrt(n.pr))))
fIn.pr &lt;- list(f1 = matrix(runif(n.pr*10), ncol = 10), matrix(runif(n.pr*22), ncol = 22))
m1.preds &lt;- predict(m1, sIn.pr = sIn.pr, fIn.pr = fIn.pr)

# generating output data for validation
sOut.pr &lt;- fgp_BB3(sIn.pr, fIn.pr, n.pr)

# plotting predictions along with true output values
plot(m1.preds, sOut.pr)


# full predictions_________________________________________________________________________
# building the model
set.seed(100)
n.tr &lt;- 25
sIn &lt;- expand.grid(x1 = seq(0,1,length = sqrt(n.tr)), x2 = seq(0,1,length = sqrt(n.tr)))
fIn &lt;- list(f1 = matrix(runif(n.tr*10), ncol = 10), f2 = matrix(runif(n.tr*22), ncol = 22))
sOut &lt;- fgp_BB3(sIn, fIn, n.tr)
m1 &lt;- fgpm(sIn = sIn, fIn = fIn, sOut = sOut)

# making full predictions
n.pr &lt;- 100
sIn.pr &lt;- as.matrix(expand.grid(x1 = seq(0,1,length = sqrt(n.pr)),
                                x2 = seq(0,1,length = sqrt(n.pr))))
fIn.pr &lt;- list(f1 = matrix(runif(n.pr*10), ncol = 10), matrix(runif(n.pr*22), ncol = 22))
m1.preds_f &lt;- predict(m1, sIn.pr = sIn.pr, fIn.pr = fIn.pr, detail = "full")

# checking content of the list
summary(m1.preds_f)

# ~R output:~
#         Length Class  Mode
# mean      100  -none- numeric
# sd        100  -none- numeric
# K.tp     2500  -none- numeric
# K.pp    10000  -none- numeric
# lower95   100  -none- numeric
# upper95   100  -none- numeric

# plotting predictions
plot(m1.preds)

</code></pre>


</div>