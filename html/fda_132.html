<div class="container">

<table style="width: 100%;"><tr>
<td>Lfd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Define a Linear Differential Operator Object
</h2>

<h3>Description</h3>

<p>A linear differential operator of order $m$ is defined,
usually to specify a roughness penalty.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Lfd(nderiv=0, bwtlist=vector("list", 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nderiv</code></td>
<td>

<p>a nonnegative integer specifying the order $m$ of the
highest order derivative in the operator
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwtlist</code></td>
<td>

<p>a list of length $m$.  Each member contains a
functional data object that acts as a weight function for a
derivative.  The first member weights the function, the
second the first derivative, and so on up to order $m-1$.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To check that an object is of this class, use functions <code>is.Lfd</code>
or <code>int2Lfd</code>.
</p>
<p>Linear differential operator objects are often used to define
roughness penalties for smoothing towards a "hypersmooth" function that
is annihilated by the operator.  For example, the harmonic acceleration
operator used in the analysis of the Canadian daily weather data
annihilates linear combinations of $1, sin(2 pi t/365)$ and $cos(2 pi
t/365)$, and the larger the smoothing parameter, the closer the smooth
function will be to a function of this shape.
</p>
<p>Function <code>pda.fd</code> estimates a linear differential operator object
that comes as close as possible to annihilating a functional data
object.
</p>
<p>A linear differential operator of order $m$ is a linear combination of
the derivatives of a functional data object up to order $m$.  The
derivatives of orders 0, 1, ..., $m-1$ can each be multiplied by a
weight function $b(t)$ that may or may not vary with argument $t$.
</p>
<p>If the notation $D^j$ is taken to mean "take the derivative of order
$j$", then a linear differental operator $L$ applied to function $x$
has the expression
</p>
<p>$Lx(t) = b_0(t) x(t) + b_1(t)Dx(t) + ... + b_{m-1}(t) D^{m-1} x(t)
+ D^mx(t)$
</p>
<p>There are <code>print</code>, <code>summary</code>, and <code>plot</code> methods for
objects of class <code>Lfd</code>.
</p>


<h3>Value</h3>

<p>a linear differential operator object
</p>


<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), 
<em>Functional Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), 
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>int2Lfd</code>,
<code>vec2Lfd</code>,
<code>fdPar</code>,
<code>pda.fd</code>
<code>plot.Lfd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#  Set up the harmonic acceleration operator
dayrange  &lt;- c(0,365)
Lbasis  &lt;- create.constant.basis(dayrange,
                  axes=list("axesIntervals"))
Lcoef   &lt;- matrix(c(0,(2*pi/365)^2,0),1,3)
bfdobj  &lt;- fd(Lcoef,Lbasis)
bwtlist &lt;- fd2list(bfdobj)
harmaccelLfd &lt;- Lfd(3, bwtlist)
</code></pre>


</div>