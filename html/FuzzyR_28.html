<div class="container">

<table style="width: 100%;"><tr>
<td>anfis.optimise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ANFIS optimiser</h2>

<h3>Description</h3>

<p>To optimise the performance of a given ANFIS model by learning the parameters in L1 and L4.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anfis.optimise(
  anfis,
  data.trn,
  data.chk = NULL,
  epoch.total = 100,
  stepsize = 0.1,
  rate.inc = 1.1,
  rate.dec = 0.9,
  method = c("gradient", "lse"),
  err.log = F,
  online = 0,
  lambda = 1,
  opt.by = "err.opt",
  err.trn.fix = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>anfis</code></td>
<td>
<p>The given ANFIS model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.trn</code></td>
<td>
<p>The input and output data pairs as training data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.chk</code></td>
<td>
<p>The input and output data pairs as checking (validation) data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epoch.total</code></td>
<td>
<p>The total training epochs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize</code></td>
<td>
<p>The initial stepsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.inc</code></td>
<td>
<p>increasing rate of the stepsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.dec</code></td>
<td>
<p>decrasing rate of the stepsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The learning algorithms for Layer 1 and Layer 4 respectively. default method=c("gradient", "lse")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.log</code></td>
<td>
<p>T or F, the flag indicate whether to save the error log.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>online</code></td>
<td>
<p>0 – batch; 1 – online; 2 – semi-online</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The forgetting rate for the LSE algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.by</code></td>
<td>
<p>To optimise the ANFIS model by: err.opt – optimisation error; err.trn – training error; err.chk – checking (validation) error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.trn.fix</code></td>
<td>
<p>T or F. When KM defuzzification is used for IT2 ANFIS, err.trn is not equal to err.opt. Hence, this flag is used for users to choose whether to fix this issue. The default value is set to T for the compatibility with previous built IT2 models. For T1 ANFIS, this flag can be set to F for speed improvement.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The optimised ANFIS model.
</p>


<h3>Author(s)</h3>

<p>Chao Chen
</p>


<h3>References</h3>

<p>[1] C. Chen, R. John, J. Twycross, and J. M. Garibaldi, “An extended ANFIS architecture and its learning properties for type-1 and interval type-2 models,” in Proceedings IEEE International Conference on Fuzzy Systems, 2016, pp. 602–609. <br>
doi: <a href="https://doi.org/10.1109/FUZZ-IEEE.2016.7737742">10.1109/FUZZ-IEEE.2016.7737742</a>
</p>
<p>[2] C. Chen, R. John, J. Twycross, and J. M. Garibaldi, “Type-1 and interval type-2 ANFIS: a comparison,” in Proceedings IEEE International Conference on Fuzzy Systems, 2017, pp. 1–6.  <br>
doi: <a href="https://doi.org/10.1109/FUZZ-IEEE.2017.8015555">10.1109/FUZZ-IEEE.2017.8015555</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fis &lt;- anfis.tipper()
anfis &lt;- anfis.builder(fis)
data.num &lt;- 5
input.num &lt;- length(fis$input)
input.stack &lt;- matrix(rnorm(data.num*input.num), ncol=input.num)
y &lt;- matrix(rnorm(data.num))
data.trn &lt;- cbind(input.stack, y)
anfis.eval(anfis, input.stack)
anfis.final &lt;- anfis.optimise(anfis, data.trn, epoch.total=500,
                                 stepsize=0.01, rate.inc=1.1, rate.dec=0.9)
</code></pre>


</div>