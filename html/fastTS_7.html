<div class="container">

<table style="width: 100%;"><tr>
<td>fastTS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast time series modeling with ranked sparsity</h2>

<h3>Description</h3>

<p>Uses penalized regression to quickly fit time series models with
potentially complex seasonal patterns and exogenous variables.
Based on methods described in Peterson &amp; Cavanaugh (2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fastTS(
  y,
  X = NULL,
  n_lags_max,
  gamma = c(0, 2^(-2:4)),
  ptrain = 0.8,
  pf_eps = 0.01,
  w_endo,
  w_exo,
  weight_type = c("pacf", "parametric"),
  m = NULL,
  r = c(rep(0.1, length(m)), 0.01),
  plot = FALSE,
  ncvreg_args = list(penalty = "lasso", returnX = FALSE, lambda.min = 0.001)
)

## S3 method for class 'fastTS'
plot(x, log.l = TRUE, ...)

## S3 method for class 'fastTS'
coef(object, choose = c("AICc", "BIC"), ...)

## S3 method for class 'fastTS'
print(x, ...)

## S3 method for class 'fastTS'
summary(object, choose = c("AICc", "BIC"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>univariate time series outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of predictors (no intercept)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_lags_max</code></td>
<td>
<p>maximum number of lags to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>vector of exponent for weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrain</code></td>
<td>
<p>prop. to leave out for test data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pf_eps</code></td>
<td>
<p>penalty factors below this will be set to zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_endo</code></td>
<td>
<p>optional pre-specified weights for endogenous terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_exo</code></td>
<td>
<p>optional pre-specified weights for exogenous terms (details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_type</code></td>
<td>
<p>type of weights to use for endogenous terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>mode(s) for seasonal lags (used if weight_type = "parametric")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>penalty factors for seasonal + local scaling functions (used if
weight_type = "parametric")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; whether to plot the penalty functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncvreg_args</code></td>
<td>
<p>additional args to pass through to ncvreg</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fastTS object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.l</code></td>
<td>
<p>Should the x-axis (lambda) be logged?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to downstream functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fastTS object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choose</code></td>
<td>
<p>which criterion to use for lambda selection (AICc or BIC)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default weights for exogenous features will be chosen based on a
similar approach to the adaptive lasso (using bivariate OLS estimates). For
lower dimensional X, it's advised to set <code>w_exo="unpenalized"</code>,
because this allows for statistical inference on exogenous variable
coefficients via the <code>summary</code> function.
</p>
<p>By default, a seasonal frequency <code>m</code> must not be specified and the
PACF is used to estimate the weights for endogenous terms. A parametric
version is also available, which allows for a penalty scaling function that
penalizes seasonal and recent lags less according to the penalty scaling
functions described in Peterson &amp; Cavanaugh (2024). See the
<code>penalty_scaler</code> function for more details, and to plot the penalty
function for various values of <code>m</code> and <code>r</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>fastTS</code> with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fits</code></td>
<td>
<p>a list of lasso fits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncvreg_args</code></td>
<td>
<p>arguments passed to
ncvreg</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>the (negative) exponent on the penalty weights, one
for each fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_lags_max</code></td>
<td>
<p>the maximum number of lags</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the utilized matrix of exogenous features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oos_results</code></td>
<td>
<p>results on test data using best of fits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>train_idx</code></td>
<td>
<p>index of observations used in training data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_type</code></td>
<td>
<p>the type of weights used for endogenous terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>the mode(s) for seasonal lags (used if weight_type =
"parametric")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>penalty factors for seasonal + local scaling
functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrain</code></td>
<td>
<p>the proportion used to train the model</p>
</td>
</tr>
</table>
<p>x invisibly
</p>
<p>a vector of model coefficients
</p>
<p>x (invisibly)
</p>
<p>the summary object produced by ncvreg
evaluated at the best tuning parameter combination
(best AICc).
</p>


<h3>References</h3>

<p>Breheny, P. and Huang, J. (2011) Coordinate descent algorithms
for nonconvex penalized regression, with applications to biological feature
selection. Ann. Appl. Statist., 5: 232-253.
</p>
<p>Peterson, R.A., Cavanaugh, J.E. (2022) Ranked sparsity: a cogent
regularization framework for selecting and estimating feature interactions
and polynomials. AStA Adv Stat Anal.
https://doi.org/10.1007/s10182-021-00431-7
</p>
<p>Peterson, R.A., Cavanaugh, J.E. (2024). Fast, effective, and coherent time
series modeling using the sparsity-ranked lasso. Statistical Modelling
(accepted). DOI: https://doi.org/10.48550/arXiv.2211.01492
</p>


<h3>See Also</h3>

<p>predict.fastTS
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("LakeHuron")
fit_LH &lt;- fastTS(LakeHuron)
fit_LH
coef(fit_LH)
plot(fit_LH)

</code></pre>


</div>