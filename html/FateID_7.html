<div class="container">

<table style="width: 100%;"><tr>
<td>getPart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inference of a cell type partition</h2>

<h3>Description</h3>

<p>This function performs an inference of a cell type partition based on the expression of marker genes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getPart(x, FMarker, fthr = NULL, n = 25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>expression data frame with genes as rows and cells as columns. Gene IDs should be given as row names and cell IDs should be given as column names. This can be a reduced expression table only including the features (genes) to be used in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FMarker</code></td>
<td>
<p>list of vectors of gene IDs corresponding to valid rownames of <code>x</code>. The gene IDs within each component of <code>FMarker</code> are considered as marker genes of one of the cell types in the dataset. The aggregated expression of the genes for each component is compared to a threshold defined by the input argument <code>fthr</code> or <code>n</code>. All cells exceeding this threshold are assigned to a cluster representing cells with expression of the respective marker genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fthr</code></td>
<td>
<p>vector of real positive numbers. This vector has to have the same length as the list <code>FMarker</code> and contains a threshold for the aggregated expression of all genes in the corresponding component of <code>FMarker</code>. If NULL then a threshold is inferred from the <code>n</code> top-expressing cells for the genes in the respective component of <code>FMarker</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>positive integer number. For each component of <code>FMarker</code> the expression of all genes is aggregated in every cell and the <code>n</code> top-expressing cells are extracted. The average expression across these cell defines the expression threshold applied to infer the partitioning. Default value is 25.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following three components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>A vector with a partitioning, i. e. cluster assignment for each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tar</code></td>
<td>
<p>A vector with the numbers of target clusters. Cluster 1 comprises all cells with no enrichment of marker genes. The remaining clusters correspond to cell types up-regulating the markers in the list <code>FMarker</code> in the same order as in this list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr</code></td>
<td>
<p>A vector with expression threshold values applied for each component in the list <code>FMarker</code> in the same order as in this list.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">x &lt;- intestine$x
y &lt;- intestine$y

FMarker &lt;- list(c("Defa20__chr8","Defa24__chr8"), "Clca3__chr3", "Alpi__chr1")
xf &lt;- getPart(x,FMarker,fthr=NULL,n=5)

</code></pre>


</div>