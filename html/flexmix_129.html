<div class="container">

<table style="width: 100%;"><tr>
<td>FLXMRlmer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>FlexMix Interface to Linear Mixed Models</h2>

<h3>Description</h3>

<p>This is a driver which allows fitting of mixtures of linear models
with random effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FLXMRlmm(formula = . ~ ., random, lm.fit = c("lm.wfit",
          "smooth.spline"), varFix = c(Random = FALSE, Residual =
          FALSE), ...)
FLXMRlmer(formula = . ~ ., random, weighted = TRUE,
          control = list(), eps = .Machine$double.eps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula which is interpreted relative to the formula
specified in the call to <code>flexmix</code> using
<code>update.formula</code>. Default is to use the original
<code>flexmix</code> model
formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>A formula for specifying the random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>A logical indicating if the model should be estimated
with weighted ML.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control parameters. See
<code>lmer</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Observations with a component-specific posterior smaller
than <code>eps</code> are omitted in the M-step for this component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm.fit</code></td>
<td>
<p>A character string indicating if the coefficients should
be fitted using either a linear model or the function
<code>smooth.spline</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varFix</code></td>
<td>
<p>Named logical vector of length 2 indicating if the
variance of the random effects and the residuals are fixed over the
components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to <code>smooth.spline</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>FLXMRlmm</code> allows only one random effect. <code>FLXMRlmer</code> allows
an arbitrary number of random effects if <code>weighted = FALSE</code>; a
certain structure of the model matrix of the random effects has to be
given for weighted ML estimation, i.e. where <code>weighted = TRUE</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>FLXMRlmer</code> and <code>FLXMRlmm</code>
inheriting from <code>FLXMRglm</code> and <code>FLXMR</code>, respectively.
</p>


<h3>Warning</h3>

<p>For <code>FLXMRlmer</code> the weighted ML estimation is only correct if the
covariate matrix of the random effects is the same for each
observation. By default weighted ML estimation is made and the
condition on the covariate matrix of the random effects is checked. If
this fails, only estimation with <code>weighted = FALSE</code> is possible
which will maximize the classification likelihood.
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>Examples</h3>

<pre><code class="language-R">id &lt;- rep(1:50, each = 10)
x &lt;- rep(1:10, 50)
sample &lt;- data.frame(y = rep(rnorm(unique(id)/2, 0, c(5, 2)), each = 10) +
                         rnorm(length(id), rep(c(3, 8), each = 10)) +
                         rep(c(0, 3), each = 10) * x,
                     x = x,
                     id = factor(id))
fitted &lt;- flexmix(.~.|id, k = 2, model = FLXMRlmm(y ~ x, random = ~ 1),
                  data = sample, control = list(tolerance = 10^-3),
                  cluster = rep(rep(1:2, each = 10), 25))
parameters(fitted)

fitted1 &lt;- flexmix(.~.|id, k = 2, model = FLXMRlmer(y ~ x, random = ~ 1),
                  data = sample, control = list(tolerance = 10^-3),
                  cluster = rep(rep(1:2, each = 10), 25))
parameters(fitted1)

fitted2 &lt;- flexmix(.~.|id, k = 2,
                   model = FLXMRlmm(y ~ 0 + x, random = ~ 1,
                     lm.fit = "smooth.spline"),
                  data = sample, control = list(tolerance = 10^-3),
                  cluster = rep(rep(1:2, each = 10), 25))
parameters(fitted2)
</code></pre>


</div>