<div class="container">

<table style="width: 100%;"><tr>
<td>fitfrail</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a shared frailty model</h2>

<h3>Description</h3>

<p>Fit an extended Cox proportional hazards model with unobserved shared frailty variate and unspecified baseline hazard function, using a semiparametric estimation technique. See Gorfine et al.~(2006) and Zucker et al.~(2008) for details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitfrail(formula, dat, control, frailty, weights = NULL, se = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>formula</code> object, where the lhs is the response as a <code>Surv</code> object and rhs contain the terms, including a <code>cluster</code> term for the cluster identifier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>data.frame that provides context for the formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>control parameters in the form of a <code>fitfrail.control</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frailty</code></td>
<td>
<p>string name of the shared frailty distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of cluster weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>logical value, whether the standard errors of the regression coefficient and frailty distribution parameter estimates should be calculated. These are obtained using the <code>vcov.fitfrail</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments will be passed to <code>fitfrail.control</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A fitfrail object representing the shared frailty model.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the estimated regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the estimated frailty distribution parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>a <code>data.frame</code> with the estimated baseline hazard at each failure time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>a <code>data.frame</code> with the estimated baseline hazard at all observed times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda.fun</code></td>
<td>
<p>a function of time that returns the estimated baseline</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>the parameter trace during estimation</p>
</td>
</tr>
</table>
<h3>Convergence</h3>

<p>The initial values of the regression coefficients are provided by <code>coxph</code>. Convergence is reached when either the relative reduction or absolute reduction in loglikelihood or score equations (depending on the fitmethod used) are below a threshold. If the maxit iterations are performed before convergence, then the algorithm terminates with a warning.
</p>


<h3>Author(s)</h3>

<p>The estimation method was developed by Malka Gorfine, Li Hsu, and David Zucker; implemented by John V. Monaco.
</p>


<h3>References</h3>

<p>Gorfine M, Zucker DM, Hsu L (2006)
Prospective survival analysis with a general semiparametric shared frailty model: A pseudo full likelihood approach.
<em>Biometrika</em>, <b>93</b>(3), 735-741.
</p>
<p>Monaco JV, Gorfine M, Hsu L (2018)
General Semiparametric Shared Frailty Model: Estimation and Simulation with frailtySurv
<em>Journal of Statistical Software</em>, <b>86</b>(4), 1-42
</p>
<p>Zucker DM, Gorfine M, Hsu L (2008)
Pseudo-full likelihood estimation for prospective survival analysis with a general semiparametric shared frailty model: Asymptotic theory.
<em>Journal of Statistical Planning and Inference</em>, <b>138</b>(7), 1998-2016.
</p>


<h3>See Also</h3>

<p><code>vcov.fitfrail</code>, <code>genfrail</code>, <code>simfrail</code>,
<code>survfit</code>, <code>coxph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# 
# Generate synthetic survival data with regression coefficients 
# beta = c(log(2),log(3)) and theta = 2, where the shared frailty 
# values from a gamma distribution with expectation 1 and variance theta.
# 
dat &lt;- genfrail(N=300, K=2, beta=c(log(2),log(3)), 
                frailty="gamma", theta=2,
                censor.rate=0.35,
                Lambda_0=function(t, tau=4.6, C=0.01) (C*t)^tau)

# Fit a shared frailty model
fit &lt;- fitfrail(Surv(time, status) ~ Z1 + Z2 + cluster(family), 
                dat, frailty="gamma")
fit

# The Lambda.fun function can give the estimated cumulative baseline hazard at
# any time
fit$Lambda.fun(seq(0, 100, by=10))

# Fit the DRS data, clustered on patient
data(drs)
fit.drs &lt;- fitfrail(Surv(time, status) ~ treated + cluster(subject_id), 
                    drs, frailty="gamma")
fit.drs

## End(Not run)

# 
# A small example with c(log(2),log(3)) coefficients, Gamma(2) frailty, and
# 0.10 censorship.
# 
dat &lt;- genfrail(N=30, K=2, beta=c(log(2),log(3)), 
                frailty="gamma", theta=2,
                censor.rate=0.10,
                Lambda_0=function(t, tau=4.6, C=0.01) (C*t)^tau)

# Fit a shared frailty model
fit &lt;- fitfrail(Surv(time, status) ~ Z1 + Z2 + cluster(family), 
                dat, frailty="gamma", se=TRUE)
fit

# Summarize the survival curve
head(summary(fit))
</code></pre>


</div>