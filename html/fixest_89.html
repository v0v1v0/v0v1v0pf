<div class="container">

<table style="width: 100%;"><tr>
<td>model.matrix.fixest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Design matrix of a <code>fixest</code> object</h2>

<h3>Description</h3>

<p>This function creates the left-hand-side or the right-hand-side(s) of a <code>femlm</code>,
<code>feols</code> or <code>feglm</code> estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'fixest'
model.matrix(
  object,
  data,
  type = "rhs",
  na.rm = TRUE,
  subset = FALSE,
  as.matrix = FALSE,
  as.df = FALSE,
  collin.rm = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>fixest</code> object. Obtained using the functions <code>femlm</code>, <code>feols</code> or <code>feglm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If missing (default) then the original data is obtained by evaluating
the <code>call</code>. Otherwise, it should be a <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character vector or one sided formula, default is "rhs". Contains the type of
matrix/data.frame to be returned. Possible values are: "lhs", "rhs", "fixef", "iv.rhs1"
(1st stage RHS), "iv.rhs2" (2nd stage RHS), "iv.endo" (endogenous vars.), "iv.exo"
(exogenous vars), "iv.inst" (instruments).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Default is <code>TRUE</code>. Should observations with NAs be removed from the matrix?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Logical or character vector. Default is <code>FALSE</code>. If <code>TRUE</code>, then the
matrix created will be restricted only to the variables contained in the argument <code>data</code>,
which can then contain a subset of the variables used in the estimation. If a
character vector, then only the variables matching the elements of the vector via
regular expressions will be created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.matrix</code></td>
<td>
<p>Logical scalar, default is <code>FALSE</code>. Whether to coerce the result to a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.df</code></td>
<td>
<p>Logical scalar, default is <code>FALSE</code>. Whether to coerce the result to a data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collin.rm</code></td>
<td>
<p>Logical scalar, default is <code>TRUE</code>. Whether to remove variables that were
found to be collinear during the estimation. Beware: it does not perform a
collinearity check.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not currently used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns either a vector, a matrix or a data.frame. It returns a vector for the
dependent variable ("lhs"), a data.frame for the fixed-effects ("fixef") and a matrix
for any other type.
</p>


<h3>Author(s)</h3>

<p>Laurent Berge
</p>


<h3>See Also</h3>

<p>See also the main estimation functions <code>femlm</code>, <code>feols</code> or <code>feglm</code>. <code>formula.fixest</code>, <code>update.fixest</code>, <code>summary.fixest</code>, <code>vcov.fixest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
base = iris
names(base) = c("y", "x1", "x2", "x3", "species")

est = feols(y ~ poly(x1, 2) + x2, base)
head(model.matrix(est))

# Illustration of subset

# subset =&gt; character vector
head(model.matrix(est, subset = "x1"))

# subset =&gt; TRUE, only works with data argument!!
head(model.matrix(est, data = base[, "x1", drop = FALSE], subset = TRUE))



</code></pre>


</div>