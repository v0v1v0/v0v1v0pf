<div class="container">

<table style="width: 100%;"><tr>
<td>estimateErrors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Errors in 'PLINK‚Äù ped files</h2>

<h3>Description</h3>

<p>This function processes the 'PLINK' ped files and estimates errors. It also performs sex assignment and species marker analysis if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateErrors(
  file,
  outdir = NA,
  db = NA,
  appendSamplesToDB = FALSE,
  keep.rep = 1,
  y.marker = NA,
  x.marker = NA,
  sp.marker = NA,
  plots = TRUE,
  neg_controls = NA,
  allele_error = 5,
  marker_dropout = 15,
  no_marker = 50,
  male.y = 3,
  male.hetX = 0,
  female.y = 0,
  female.Xtot = 8,
  female.hetXtot = 3,
  warning.noYtot = 2,
  warning.noHetXtot = 3,
  sexing = FALSE,
  verbose = TRUE,
  verbosity = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>A string. Path to the ped input file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outdir</code></td>
<td>
<p>A string specifying the output folder. If left empty the original folder path of the input file will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>A string. Name of the used database. Default is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>appendSamplesToDB</code></td>
<td>
<p>A logical. Should new samples be added to database? Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.rep</code></td>
<td>
<p>A numeric. Keep only this n-fold replicates, default n=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.marker</code></td>
<td>
<p>A vector. Y markers for sexing. Default is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.marker</code></td>
<td>
<p>A vector. X markers for sexing. Default is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.marker</code></td>
<td>
<p>A vector. Markers used for species-identification. Default is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>A logical. Should plots be created? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg_controls</code></td>
<td>
<p>A vector. Names of negative controls. Default is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allele_error</code></td>
<td>
<p>A numeric. Threshold for RERUN on Allele errors. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_dropout</code></td>
<td>
<p>A numeric. Threshold for RERUN on Marker dropout. Default is 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_marker</code></td>
<td>
<p>A numeric. Number of markers. Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>male.y</code></td>
<td>
<p>A numeric. Threshold for sexing, male y-chromosome markers. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>male.hetX</code></td>
<td>
<p>A numeric. Threshold for sexing, heterozygote x-chr markers. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>female.y</code></td>
<td>
<p>A numeric. Threshold for sexing, female y-chromosome markers. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>female.Xtot</code></td>
<td>
<p>A numeric. Threshold for sexing, total female x-chr markers. Default is 8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>female.hetXtot</code></td>
<td>
<p>A numeric. Threshold for sexing, heterozygote x-chr markers. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warning.noYtot</code></td>
<td>
<p>A numeric. Threshold for sexing, when should warning be triggered. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warning.noHetXtot</code></td>
<td>
<p>A numeric. Threshold for sexing, when should warning be triggered. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sexing</code></td>
<td>
<p>A logical. Should sexing be performed? Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical or numeric. Should the output be verbose? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>A numeric. Level of verbosity, set to higher number for more details. Default is 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function processes the PLINK ped files and estimates errors. It checks if the first and second run of each sample have the same genotype and if both
replicates are identical. It also performs sex assignment based on the provided Y and X markers. If species marker is provided, it performs species marker
analysis. The function creates a consensus PED for all "GOOD" samples and exports it along with a .map file without the Y-markers. It also creates a
database file, if provided.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
gensim, a matrix indicating if genotypes are called correctly for replicates and/or if genotypes are missing
summs, a matrix with summary statistics
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
    # outdir is here the output directory from the fluidigm2PLINK function

    # Estimate the errors with sexing applied
    estimateErrors(file=file.path(outdir, "example_data.csv.ped"),
                   keep.rep = 2)

    # Estimate the errors and apply sexing with y and x markers defined
    estimateErrors(file=file.path(outdir, "example_data.csv.ped"),
                   keep.rep = 2,
                   sexing=TRUE,
                   y.marker = c("Y_scaffoldY158711_762",
                                "Y_scaffoldY42647_3017",
                                "Y_scaffoldY42656_3986"),
                   x.marker = c("X_scaffold11905_7659",
                                "X_scaffold17088_4621",
                                "X_scaffold1915_14108",
                                "X_scaffold4825_648",
                                "X_scaffold5374_1437",
                                "X_scaffold10171:3154"))

## End(Not run)
</code></pre>


</div>