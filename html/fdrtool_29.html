<div class="container">

<table style="width: 100%;"><tr>
<td>halfnormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Half-Normal Distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for the half-normal distribution with parameter <code>theta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dhalfnorm(x, theta=sqrt(pi/2), log = FALSE)
phalfnorm(q, theta=sqrt(pi/2), lower.tail = TRUE, log.p = FALSE)
qhalfnorm(p, theta=sqrt(pi/2), lower.tail = TRUE, log.p = FALSE)
rhalfnorm(n, theta=sqrt(pi/2))
sd2theta(sd)
theta2sd(theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length
is taken to be the number required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>parameter of half-normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>standard deviation of the zero-mean normal distribution 
that corresponds to the half-normal with parameter <code>theta</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>x = abs(z)</code> follows a half-normal distribution with
if <code>z</code> is a normal variate with zero mean. 
The half-normal distribution has density
</p>
<p style="text-align: center;"><code class="reqn">
    f(x) =
    \frac{2 \theta}{\pi} e^{-x^2 \theta^2/\pi}</code>
</p>

<p>It has mean  <code class="reqn">E(x) = \frac{1}{\theta}</code> and variance 
<code class="reqn">Var(x) = \frac{\pi-2}{2 \theta^2}</code>.
</p>
<p>The parameter <code class="reqn">\theta</code> is related to the
standard deviation <code class="reqn">\sigma</code> of the corresponding 
zero-mean normal distribution by the equation
<code class="reqn">\theta = \sqrt{\pi/2}/\sigma</code>.
</p>
<p>If <code class="reqn">\theta</code> is not specified in the above functions 
it assumes the default values of <code class="reqn">\sqrt{\pi/2}</code>, 
corresponding to <code class="reqn">\sigma=1</code>.  
</p>


<h3>Value</h3>

<p><code>dhalfnorm</code> gives the density,
<code>phalfnorm</code> gives the distribution function,
<code>qhalfnorm</code> gives the quantile function, and
<code>rhalfnorm</code> generates random deviates.
<code>sd2theta</code> computes a <code>theta</code> parameter. 
<code>theta2sd</code> computes a <code>sd</code> parameter. 
</p>


<h3>See Also</h3>

<p><code>Normal</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load "fdrtool" library
library("fdrtool")


## density of half-normal compared with a corresponding normal
par(mfrow=c(1,2))

sd.norm = 0.64
x  = seq(0, 5, 0.01)
x2 = seq(-5, 5, 0.01)
plot(x, dhalfnorm(x, sd2theta(sd.norm)), type="l", xlim=c(-5, 5), lwd=2,
   main="Probability Density", ylab="pdf(x)")
lines(x2, dnorm(x2, sd=sd.norm), col=8 )


plot(x, phalfnorm(x, sd2theta(sd.norm)), type="l", xlim=c(-5, 5),  lwd=2,
   main="Distribution Function", ylab="cdf(x)")
lines(x2, pnorm(x2, sd=sd.norm), col=8 )

legend("topleft", 
c("half-normal", "normal"), lwd=c(2,1),
col=c(1, 8), bty="n", cex=1.0)

par(mfrow=c(1,1))


## distribution function

integrate(dhalfnorm, 0, 1.4, theta = 1.234)
phalfnorm(1.4, theta = 1.234)

## quantile function
qhalfnorm(-1) # NaN
qhalfnorm(0)
qhalfnorm(.5)
qhalfnorm(1)
qhalfnorm(2) # NaN

## random numbers
theta = 0.72
hz = rhalfnorm(10000, theta)
hist(hz, freq=FALSE)
lines(x, dhalfnorm(x, theta))

mean(hz) 
1/theta  # theoretical mean

var(hz)
(pi-2)/(2*theta*theta) # theoretical variance


## relationship with two-sided normal p-values
z = rnorm(1000)

# two-sided p-values
pvl = 1- phalfnorm(abs(z))
pvl2 = 2 - 2*pnorm(abs(z)) 
sum(pvl-pvl2)^2 # equivalent
hist(pvl2, freq=FALSE)  # uniform distribution

# back to half-normal scores
hz = qhalfnorm(1-pvl)
hist(hz, freq=FALSE)
lines(x, dhalfnorm(x))
</code></pre>


</div>