<div class="container">

<table style="width: 100%;"><tr>
<td>plot.penmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot method for <code>penmodel</code>
</h2>

<h3>Description</h3>

<p>Plots penetrance curves estimated from the fitted penetrance model and overlays non-parametric penetrance curves estimated from the data without proabands.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'penmodel'
plot(x, agemax = 80, print = TRUE, mark.time = FALSE, conf.int = FALSE, 
add.KM = TRUE, MC = 100, col = c("blue", "red", "blue", "red"), lty = c(1, 1, 2, 2), 
add.legend = TRUE, add.title = TRUE, xpos = "topleft", ypos = NULL, 
xlab = "Age at onset", ylab = "Penetrance", ylim = NULL, main = NULL,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object class of <code>'penmodel'</code>, a fitted model by <code>penmodel</code> or <code>penmodelEM</code> functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agemax</code></td>
<td>

<p>Maximum age of disease onset or maximum age. Default is 80 years of age.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays parameter estimates and penetrance estimates by age 70.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark.time</code></td>
<td>
<p>Logical; if <code>TRUE</code>, curves are marked at each censoring time, otherwise, no labeling is done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays 95% confidence intervals for both parametric and non-parametric penetrance estimates for each subgroup and returns their <code>lower</code> and <code>upper</code> limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.KM</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays Kaplan-Meier curves from data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>

<p>Number of simulated samples used to calculate confidence intervals with a Monte-Carlo method. 
If <code>MC = 0</code>, no confidence intervals will be calculated. Default value is 100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>Colors of lines for male carriers, female carriers, male noncarrers, and female noncarriers. Default is <code>c("blue", "red", "blue", "red")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>Types of lines for male carriers, female carriers, male noncarriers, and female noncarriers. Default is <code>c(1, 1, 2, 2)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.legend</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays a legend in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.title</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays a title in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpos, ypos</code></td>
<td>

<p>Position of legend; see legend. Defaults are <code>xpos = "topleft", ypos = NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Title for the x-axis. Default is <code>"Age at onset"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Title for the y-axis. Default is <code>"Penetrance"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Limits for the y-axis. Default is <code>NULL</code>. If <code>NULL</code>, <code>ylim</code> will be automatically determined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title of the plot. Default is <code>NULL</code>. If <code>NULL</code>, the title will be automatically created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed through to plotting functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The 95% confidence intervals for the parametric penetrance curves are
obtained based on simulations of the parameters, assuming a multivariate normal distribution for the estimated
parameters with their variance-covariance matrix. See <code>penetrance</code> for more details.
</p>


<h3>Value</h3>

<p>Returns the following summary values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Parameter estimates of transformed baseline parameters (<code class="reqn">\lambda, \rho</code>) and regression coefficients for gender and mutation status (<code class="reqn">\beta_s, \beta_g</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen70</code></td>
<td>
<p> Penetrance estimates by age 70, specific to gender and mutation-status subgroups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.age</code></td>
<td>
<p>Vector of ages of onsest ranging from <code>agemin</code> to <code>agemax</code> years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>Penetrance estimates at each age in <code>x.age</code>, specific to gender and mutation-status subgroups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower limits of 95% confidence interval estimates for penetrance at each age in <code>x.age</code>, specific to gender and mutation status subgroups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper limits of 95% confidence interval estimates for penetrance at each age in <code>x.age</code>, specific to gender and mutation status subgroups.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yun-Hee Choi	
</p>


<h3>See Also</h3>

<p><code>penmodel, print.penmodel, penmodelEM, summary.penmodel,print.summary.penmodel</code>, 
<code>simfam	</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulated family data  

set.seed(4321)
fam &lt;- simfam(N.fam = 300, design = "pop+", base.dist = "Weibull", variation = "none",
       base.parms = c(0.01,3), vbeta = c(-1.13, 2.35), allelefreq = 0.02, agemin = 20)
 
# Fit family data

fit &lt;- penmodel(Surv(time, status) ~ gender + mgene, cluster = "famID", design = "pop+",
parms = c(0.01, 3, -1.13, 2.35), data = fam, base.dist = "Weibull", robust = TRUE)       

# Plot penetrance function curves with 95% CIs

plot(fit, agemax = 80, conf.int = TRUE)

</code></pre>


</div>