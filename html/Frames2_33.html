<div class="container">

<table style="width: 100%;"><tr>
<td>MLCDW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multinomial logistic calibration estimator under dual frame approach with auxiliary information from the whole population</h2>

<h3>Description</h3>

<p>Produces estimates for class totals and proportions using multinomial logistic regression from survey data obtained
from a dual frame sampling design using a model calibrated dual frame approach with auxiliary information from the whole population. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MLCDW (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, x, ind_sam, N_A, 
 N_B, N_ab = NULL, met = "linear", conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "a" and "ab".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are "b" and "ba".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are "linear", "raking" and "logit". Default is "linear".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multinomial logistic calibration estimator in dual frame using auxiliary information from the whole population for a proportion is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{MLCi}^{DW} = \frac{1}{N} \left(\sum_{k \in s_A \cup s_B} w_k^{\circ} z_{ki}\right), \hspace{0.3cm} i = 1,...,m</code>
</p>

<p>with <code class="reqn">m</code> the number of categories of the response variable, <code class="reqn">z_i</code> the indicator variable for the i-th category of the response variable,
and <code class="reqn">w^{\circ}</code> calibration weights which are calculated having into account a different set of constraints, depending on the case. For instance, if <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> are known, calibration constraints are
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_a}w_k^{\circ} = N_a, \sum_{k \in s_{ab}}w_k^{\circ} = \eta N_{ab}, \sum_{k \in s_{ba}}w_k^{\circ} = (1 - \eta) N_{ab}, \sum_{k \in s_{b}}w_k^{\circ} = N_{b}</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_A \cup s_B}w_k^\circ p_{ki}^{\circ} = \sum_{k \in U} p_{ki}^\circ</code>
</p>

<p>with <code class="reqn">\eta \in (0,1)</code> and </p>
<p style="text-align: center;"><code class="reqn">p_{ki}^{\circ} = \frac{exp(x_k^{'}\beta_i^{\circ})}{\sum_{r=1}^m exp(x_k^{'}\beta_r^{\circ})},</code>
</p>

<p>being <code class="reqn">\beta_i^\circ</code> the maximum likelihood parameters of the multinomial logistic model considering weights <code class="reqn">d_k^{\circ} =\left\{\begin{array}{lcc}
 d_k^A &amp; \textrm{if } k \in a\\
 \eta d_k^A &amp; \textrm{if } k \in ab\\
 (1 - \eta) d_k^B &amp; \textrm{if } k \in ba \\
 d_k^B &amp; \textrm{if } k \in b
 \end{array}
 \right.</code>.
</p>


<h3>Value</h3>

<p><code>MLCDW</code> returns an object of class "MultEstimatorDF" which is a list with, at least, the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est</code></td>
<td>
<p>class frequencies and proportions estimations for main variable(s).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>


<h3>See Also</h3>

<p><code>JackMLCDW</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DatMA)
data(DatMB)
data(DatPopM) 

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)
N_FrameA &lt;- nrow(DatPopM[DatPopM$Domain == "a" | DatPopM$Domain == "ab",])
N_FrameB &lt;- nrow(DatPopM[DatPopM$Domain == "b" | DatPopM$Domain == "ab",])
N_Domainab &lt;- nrow(DatPopM[DatPopM$Domain == "ab",])
#Let calculate proportions of categories of variable Prog using MLCDW estimator
#using Read as auxiliary variable
MLCDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, N_FrameB)

#Now, let suppose that the overlap domian size is known
MLCDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, N_FrameB, N_Domainab)

#Let obtain 95% confidence intervals together with the estimations
MLCDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, N_FrameB, N_Domainab,
conf_level = 0.95)
</code></pre>


</div>