<div class="container">

<table style="width: 100%;"><tr>
<td>fspe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimating number of factors with out-of-sample prediction error
</h2>

<h3>Description</h3>

<p>Estimates the number of factors in Exploratory Factor Analysis (EFA) by approximating the out-of-sample prediction errors using a cross-validation scheme.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fspe(data, maxK, nfold = 10, rep = 1, method = "PE",
     rotate = "oblimin", pbar = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A n x p matrix or data.frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>

<p>The largest number of factors considered. For example, if <code>maxK = 8</code>, the factors <code>1, 2, ..., 8</code> are considered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>

<p>The number of folds in the cross-validation scheme. Defaults to <code>nfold = 10</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>

<p>The number of repetitions of the cross-validation scheme. The repetiations are aggregated by averaging the prediction errors for each number of factor and subsequently selecting the number of factors that minimizes this average. Defaults to <code>rep = 1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>If <code>method = "PE"</code>, the factor estimation is based on the prediction error on the variables; If <code>method = "Cov"</code> the error is computed on the covariance matrix. Defaults to <code>method = "PE"</code> since it has performed better in simulations (see Haslbeck &amp; van Bork, 2021 below.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate</code></td>
<td>

<p>The totation being used in the underlying factor analysis models. The options are the same as in the <code>fa()</code> function in the <code>psych</code> package, which is called by <code>fpse</code>. Defaults to <code>rotate = "oblimin"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pbar</code></td>
<td>

<p>If <code>pbar = TRUE</code>, a progress bar is shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to the <code>fa()</code> function in the <code>psych</code> package.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function returns:
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nfactor</code></td>
<td>
<p>An integer indicating the estimated number of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfactor</code></td>
<td>
<p>A 4-dimensional (for the PE method: variables, candidate models, folds, repetitions) or a 3-dimensional (for the Cov method: candidate models, folds, repetitions) array containing all prediction errors.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonas Haslbeck &lt;jonashaslbeck@gmail.com&gt;
</p>


<h3>References</h3>

<p>Haslbeck &amp; van Bork (2021). Estimating the number of factors in Exploratory Factor Analysis using out-of-sample prediction errors. PsyArXiv Preprint: https://psyarxiv.com/qktsd
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(holzinger19)

fspe_out &lt;- fspe(holzinger19,
                 maxK = 10,
                 nfold = 10,
                 method = "PE")

fspe_out$nfactor # estimated factors = 4

# Plot OoS PE path
plot(fspe_out$PEs, xlab="No. Factors", ylab="OoS PE")


</code></pre>


</div>