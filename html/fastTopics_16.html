<div class="container">

<table style="width: 100%;"><tr>
<td>loglik_poisson_nmf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>NMF and Topic Model Likelihoods and Deviances</h2>

<h3>Description</h3>

<p>Compute log-likelihoods and deviances for assessing
fit of a topic model or a non-negative matrix factorization (NMF).
</p>


<h3>Usage</h3>

<pre><code class="language-R">loglik_poisson_nmf(X, fit, e = 1e-08)

loglik_multinom_topic_model(X, fit, e = 1e-08)

deviance_poisson_nmf(X, fit, e = 1e-08)

cost(X, A, B, e = 1e-08, family = c("poisson", "multinom"), version)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The n x m matrix of counts or pseudocounts. It can be a
sparse matrix (class <code>"dgCMatrix"</code>) or dense matrix (class
<code>"matrix"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A Poisson NMF or multinomial topic model fit, such as an
output from <code>fit_poisson_nmf</code> or
<code>fit_topic_model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>A small, non-negative number added to the terms inside the
logarithms to avoid computing logarithms of zero. This prevents
numerical problems at the cost of introducing a very small
inaccuracy in the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>The n x k matrix of loadings. It should be a dense matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The k x m matrix of factors. It should be a dense matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>If <code>model = "poisson"</code>, the loss function values
corresponding to the Poisson non-negative matrix factorization are
computed; if <code>model = "multinom"</code>, the multinomial topic model
loss function values are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>When <code>version == "R"</code>, the computations are
performed entirely in R; when <code>version == "Rcpp"</code>, an Rcpp
implementation is used. The R version is typically faster when
<code>X</code> is a dense matrix, whereas the Rcpp version is faster and
more memory-efficient when <code>X</code> is a large, sparse matrix. When
not specified, the most suitable version is called depending on
whether <code>X</code> is dense or sparse.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>cost</code> computes loss functions proportional
to the negative log-likelihoods, and is mainly for internal use to
quickly compute log-likelihoods and deviances; it should not be
used directly unless you know what you are doing. In particular,
little argument checking is performed by <code>cost</code>.
</p>


<h3>Value</h3>

<p>A numeric vector with one entry per row of <code>X</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate a small counts matrix.
set.seed(1)
out &lt;- simulate_count_data(10,20,3)
X   &lt;- out$X
fit &lt;- out[c("F","L")]
class(fit) &lt;- c("poisson_nmf_fit","list")

# Compute the Poisson log-likelihoods and deviances.
data.frame(loglik   = loglik_poisson_nmf(X,fit),
           deviance = deviance_poisson_nmf(X,fit))

# Compute multinomial log-likelihoods.
loglik_multinom_topic_model(X,fit)

</code></pre>


</div>