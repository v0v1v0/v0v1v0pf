<div class="container">

<table style="width: 100%;"><tr>
<td>with_cache</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cache via a file</h2>

<h3>Description</h3>

<p>If the cache exists, the object is retrieved from the cache.
Otherwise, it is evaluated and stored for subsequent retrieval.
</p>
<p>Use <code>force=TRUE</code> to ensure the object is evaluated and stored
anew in the cache.
</p>
<p>The object evaluated must be compatible with the cache type.
For example, a cache type of 'csv' or 'parquet' requires a
<code>data.frame</code> or similar type.
</p>


<h3>Usage</h3>

<pre><code class="language-R">with_cache(x, label, cache = NULL, type = NULL, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The object to store in the cache. Must be compatible
with the cache type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>A string to use as the name of the file to cache.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache</code></td>
<td>
<p>One of the following:
</p>

<ul>
<li>
<p> The path to an existing directory to use for caching.
If <code>NULL</code> (default) uses the current path, using <code>here::here()</code>.
</p>
</li>
<li>
<p> An existing cache object as generated by <code>file_cache()</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string describing the type of cache.
Must be <code>NULL</code> or one of 'rds', 'parquet', or 'csv'.
If <code>NULL</code> (default), uses 'rds'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>If <code>TRUE</code>, forces evaluation even if the cache exists.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create a temporary directory for the cache.
tf &lt;- tempfile()
dir.create(tf)

# A dummy function that logs when it's called.
get_df &lt;- function() {
  message("Getting df ...")
  return(mtcars)
}

# Use the resulting object in `with_cache()`.
# 1) The first time, the message is printed.
# 2) The second time, the object is pulled from the cache, with no message.
all.equal(with_cache(get_df(), "df", cache = tf), mtcars)
all.equal(with_cache(get_df(), "df", cache = tf), mtcars)

# `with_cache` is designed to be compatible with piping.
get_df() |&gt;
  with_cache("df", cache = tf) |&gt;
  all.equal(mtcars)


# Advanced: If desired, the `cachem` object methods can be used directly.
cache &lt;- file_cache(tf)
cache$get("df") |&gt; # Get objects previously cached using `with_cache`.
  all.equal(mtcars)
cache$set("df2", mtcars) # Set objects using `$set`.
cache$get("df2") |&gt;
  all.equal(mtcars)

unlink(tf, recursive = TRUE)
</code></pre>


</div>