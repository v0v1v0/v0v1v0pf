<div class="container">

<table style="width: 100%;"><tr>
<td>ftsm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit functional time series model</h2>

<h3>Description</h3>

<p>Fits a principal component model to a <code>fts</code> object. The
function uses optimal orthonormal principal components obtained from a
principal components decomposition.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ftsm(y, order = 6, ngrid = max(500, ncol(y$y)), method = c("classical", 
 "M", "rapca"), mean = TRUE, level = FALSE, lambda = 3, 
  weight = FALSE, beta = 0.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An object of class <code>fts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Number of principal components to fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>Number of grid points to use in calculations. Set to maximum of 500 and <code>ncol(y$y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method to use for principal components decomposition. Possibilities are “M”, “rapca” and “classical”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>If <code>mean = TRUE</code>, it will estimate mean term in the model before computing basis terms. 
If <code>mean = FALSE</code>, the mean term is assumed to be zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>If <code>mean = TRUE</code>, it will include an additional (intercept) term that depends on <code class="reqn">t</code> but not on <code class="reqn">x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Tuning parameter for robustness when <code>method = "M"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>When <code>weight = TRUE</code>, a set of geometrically decaying weights is applied to the decentralized data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>When <code>weight = TRUE</code>, the speed of geometric decay is governed by a weight parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments controlling the fitting procedure.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>method = "classical"</code>, then standard functional principal component decomposition is used, as described by
Ramsay and Dalzell (1991). 
</p>
<p>If <code>method = "rapca"</code>, then the robust principal component algorithm of Hubert, Rousseeuw and Verboven (2002) is used. 
</p>
<p>If <code>method = "M"</code>, then the hybrid algorithm of Hyndman and Ullah (2005) is used.
</p>


<h3>Value</h3>

<p>Object of class “ftsm” with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>Time period of a <code>fts</code> object, which can be obtained from <code>colnames(y$y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>
<p>Variables of a <code>fts</code> object, which can be obtained from <code>y$x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Original functional time series or sliced functional time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>Matrix of principal components evaluated at value of <code>y$x</code> (one column for each principal component).
The first column is the fitted mean or median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis2</code></td>
<td>
<p>Matrix of principal components excluded from the selected model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>Matrix of coefficients (one column for each coefficient series). The first column is all ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff2</code></td>
<td>
<p>Matrix of coefficients associated with the principal components excluded from the selected model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>An object of class <code>fts</code> containing the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>An object of class <code>fts</code> containing the regression residuals (difference between observed and fitted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varprop</code></td>
<td>
<p>Proportion of variation explained by each principal component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>Weight associated with each time period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Measure of variation for each time period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.se</code></td>
<td>
<p>Measure of standar error associated with the mean.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rob J Hyndman</p>


<h3>References</h3>

<p>J. O. Ramsay and C. J. Dalzell (1991) "Some tools for functional data analysis (with discussion)", <em>Journal of the Royal Statistical Society: Series B</em>, <b>53</b>(3), 539-572.
</p>
<p>M. Hubert and P. J. Rousseeuw and S. Verboven (2002) "A fast robust method for principal components with applications to chemometrics", <em>Chemometrics and Intelligent Laboratory Systems</em>, <b>60</b>(1-2), 101-111.
</p>
<p>B. Erbas and R. J. Hyndman and D. M. Gertig (2007) "Forecasting age-specific breast cancer mortality using functional data model", <em>Statistics in Medicine</em>, <b>26</b>(2), 458-470.
</p>
<p>R. J. Hyndman and M. S. Ullah (2007) "Robust forecasting of mortality and fertility rates: A functional data approach", <em>Computational Statistics and Data Analysis</em>, <b>51</b>(10), 4942-4956.
</p>
<p>R. J. Hyndman and H. Booth (2008) "Stochastic population forecasts using functional data models for mortality, fertility and migration", <em>International Journal of Forecasting</em>, <b>24</b>(3), 323-342.
</p>
<p>R. J. Hyndman and H. L. Shang (2009) "Forecasting functional time series (with discussion)", <em>Journal of the Korean Statistical Society</em>, <b>38</b>(3), 199-221.
</p>


<h3>See Also</h3>

<p><code>ftsmweightselect</code>, <code>forecast.ftsm</code>, <code>plot.fm</code>, <code>plot.ftsf</code>, <code>residuals.fm</code>, <code>summary.fm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># ElNino is an object of class sliced functional time series, constructed 
# from a univariate time series. 
# By default, all observations are assigned with equal weighting. 	
ftsm(y = ElNino_ERSST_region_1and2, order = 6, method = "classical", weight = FALSE)
# When weight = TRUE, geometrically decaying weights are used.
ftsm(y = ElNino_ERSST_region_1and2, order = 6, method = "classical", weight = TRUE)
</code></pre>


</div>