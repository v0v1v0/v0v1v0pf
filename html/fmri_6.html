<div class="container">

<table style="width: 100%;"><tr>
<td>fmri.design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Linear Model for FMRI Data </h2>

<h3>Description</h3>

<p>Return a design matrix for a linear model with given stimuli and
possible polynomial drift terms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  fmri.design(stimulus, order = 2, cef = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stimulus</code></td>
<td>
<p> matrix containing expected BOLD response(s) for the linear
model as columns or list of expected BOLD responses containing matrices
of dimension <code>scans, number of slices</code> as returned by function
<code>fmri.stimulus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p> order of the polynomial drift terms </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cef</code></td>
<td>
<p> confounding effects </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> Report more if <code>TRUE</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The stimuli given in <code>stimulus</code> are used as first columns in
the design matrix.
</p>
<p>The order of the polynomial drift terms is given
by <code>order</code>, which defaults to 2.
</p>
<p>Confounding effects can be included in a matrix <code>cef</code>.
</p>
<p>The polynomials are defined orthogonal to the stimuli given in
<code>stimulus</code>.
</p>


<h3>Value</h3>

<p>design matrix of the linear model
</p>


<h3>Author(s)</h3>

<p> Karsten Tabelow <a href="mailto:tabelow@wias-berlin.de">tabelow@wias-berlin.de</a>,
Joerg Polzehl <a href="mailto:polzehl@wias-berlin.de">polzehl@wias-berlin.de</a> </p>


<h3>References</h3>

<p>Polzehl, J. and Tabelow, K.(2007).
<em>fmri: A Package for Analyzing fmri Data</em>,
R News, 7:13-17 .
</p>


<h3>See Also</h3>

 <p><code>fmri.stimulus</code>, <code>fmri.lm</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # Example 1
  hrf &lt;- fmri.stimulus(107, c(18, 48, 78), 15, 2)
  z &lt;- fmri.design(hrf, 2)
  par(mfrow=c(2, 2))
  for (i in 1:4) plot(z[, i], type="l")
</code></pre>


</div>