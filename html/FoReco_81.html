<div class="container">

<table style="width: 100%;"><tr>
<td>teprojmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Projection matrix for optimal combination temporal reconciliation</h2>

<h3>Description</h3>

<p>This function computes the projection or the mapping matrix
<code class="reqn">\mathbf{M}</code> and <code class="reqn">\mathbf{G}</code>, respectively, such that
<code class="reqn">\widetilde{\mathbf{y}} = \mathbf{M}\widehat{\mathbf{y}} = \mathbf{S}_{te}\mathbf{G}\widehat{\mathbf{y}}</code>,
where <code class="reqn">\widetilde{\mathbf{y}}</code> is the vector of the reconciled forecasts,
<code class="reqn">\widehat{\mathbf{y}}</code> is the vector of the base forecasts,
<code class="reqn">\mathbf{S}_{te}</code> is the temporal structural matrix, and <code class="reqn">\mathbf{M} = \mathbf{S}_{te}\mathbf{G}</code>.
For further information regarding on the structure of these matrices,
refer to Girolimetto et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">teprojmat(agg_order, comb = "ols", res = NULL, mat = "M", tew = "sum", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>agg_order</code></td>
<td>
<p>Highest available sampling frequency per seasonal cycle (max. order
of temporal aggregation, <code class="reqn">m</code>), or a vector representing a subset of <code class="reqn">p</code> factors
of <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comb</code></td>
<td>
<p>A string specifying the reconciliation method. For a complete list, see tecov.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>A (<code class="reqn">N(k^\ast+m) \times 1</code>) optional numeric vector containing the
in-sample residuals at all the temporal frequencies ordered from the lowest frequency
to the highest frequency. This vector is used to compute come covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>A string specifying which matrix to return:
"<code>M</code>" (<em>default</em>) for <code class="reqn">\mathbf{M}</code> and "<code>G</code>" for <code class="reqn">\mathbf{G}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tew</code></td>
<td>
<p>A string specifying the type of temporal aggregation. Options include:
"<code>sum</code>" (simple summation, <em>default</em>), "<code>avg</code>" (average),
"<code>first</code>" (first value of the period), and "<code>last</code>"
(last value of the period).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed on to <code>tecov</code>
</p>

<dl>
<dt><code>mse</code></dt>
<dd>
<p>If <code>TRUE</code> (<em>default</em>) the residuals used to compute the covariance
matrix are not mean-corrected.</p>
</dd>
<dt><code>shrink_fun</code></dt>
<dd>
<p>Shrinkage function of the covariance matrix, shrink_estim (<em>default</em>)</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The projection matrix <code class="reqn">\mathbf{M}</code> (<code>mat = "M"</code>) or
the mapping matrix <code class="reqn">\mathbf{G}</code> (<code>mat = "G"</code>).
</p>


<h3>References</h3>

<p>Girolimetto, D., Athanasopoulos, G., Di Fonzo, T. and Hyndman, R.J. (2024),
Cross-temporal probabilistic forecast reconciliation: Methodological and
practical issues. <em>International Journal of Forecasting</em>, 40, 3, 1134-1151.
<a href="https://doi.org/10.1016/j.ijforecast.2023.10.003">doi:10.1016/j.ijforecast.2023.10.003</a>
</p>


<h3>See Also</h3>

<p>Utilities: 
<code>FoReco2matrix()</code>,
<code>aggts()</code>,
<code>balance_hierarchy()</code>,
<code>commat()</code>,
<code>csprojmat()</code>,
<code>cstools()</code>,
<code>ctprojmat()</code>,
<code>cttools()</code>,
<code>df2aggmat()</code>,
<code>lcmat()</code>,
<code>recoinfo()</code>,
<code>res2matrix()</code>,
<code>shrink_estim()</code>,
<code>tetools()</code>,
<code>unbalance_hierarchy()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Temporal framework (annual-quarterly)
Mte &lt;- teprojmat(agg_order = 4, comb = "ols")
Gte &lt;- teprojmat(agg_order = 4, comb = "ols", mat = "G")

</code></pre>


</div>