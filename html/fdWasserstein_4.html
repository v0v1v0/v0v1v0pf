<div class="container">

<table style="width: 100%;"><tr>
<td>gaussBary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Wasserstein barycenter between Gaussian Processes
</h2>

<h3>Description</h3>

<p>Computes the Frechet mean between covariance operators with respect to the Procrustes metrics (equivalently, a Wasserstein barycenter of centered Gaussian processes with corresponding covariances) via steepest gradient descent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gaussBary(sigma, w = rep(1, dim(sigma)[3]), gamma, sigma0.5, 
  max.iter = 30, eps = 1e-08, silent = max.iter == 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>An MxMxK array containing the K covariances. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>Optional. A vector of weights of length K. If missing, each matrix is given equal weight 1. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>Optional. Initialisation point for the gradient descent algorithm. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0.5</code></td>
<td>

<p>Optional. An array containing the square roots of the matrices in
sigma if available. The square roots are computed by
<code>gaussBary</code> if <code>sigma0.5</code> is missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>

<p>Maximum number of gradient descent iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Iterations stop when the relative decrease of the objective function in two consecutive iterations is less than 'eps'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>If <code>FALSE</code> returns a warning if maximal number of iteration is reached. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of 2 containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The MxM Frechet mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations needed to reach convergence, numeric.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>We thank Yoav Zemel for the first version of the code. 
</p>


<h3>Author(s)</h3>

<p>Valentina Masarotto, Guido Masarotto
</p>


<h3>References</h3>

<p>Masarotto, V., Panaretos, V.M. &amp; Zemel, Y. (2019) "Procrustes Metrics on
Covariance Operators and Optimal Transportation of Gaussian Processes",
<em>Sankhya A</em> <strong>81</strong>, 172-213 <a href="https://doi.org/10.1007/s13171-018-0130-1">doi:10.1007/s13171-018-0130-1</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">M &lt;- 5
K &lt;- 4

sigma &lt;- rWishart(M, df = K, Sigma = diag(K))

gaussBary(sigma) 
</code></pre>


</div>