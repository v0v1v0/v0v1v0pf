<div class="container">

<table style="width: 100%;"><tr>
<td>fitParabola</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit Data to Parabola 

</h2>

<h3>Description</h3>

<p>This function fits a data set to a parabola, including any rotation angle. 

</p>


<h3>Usage</h3>

<pre><code class="language-R">fitParabola(x, y = NULL, searchAngle = c(-pi/2, pi/2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> vector of x-values, or a Nx2 array of x and y values. In the latter case, the input <code>y</code> is ignored. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> vector of y-values. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchAngle</code></td>
<td>

<p>Optional pair of angles, in radians, defining the limits of the search range to find the rotation angle of the parabola. Usually the default range <code>-pi/2:+pi/2</code> works acceptable. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For possible future expansion to pass to additional features. 

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fitParabola</code> starts by doing a RANSAC-style search to find the optimum rotation angle. Once that is chosen, the data are rotated by that angle and a simple polynomial fit to the (rotated) vertical parabola is done.
</p>



<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>vertex </code></td>
<td>
<p> calculated vertex of the parabola</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>angle of rotation relative to a vertical parabola </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parA </code></td>
<td>
<p> the "ABCDEF" coefficients of the fitted parabola</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parQ </code></td>
<td>
<p> the coefficients of the derotated parabola's simple quadratic polynomial, highest power first</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost </code></td>
<td>
<p> final value of the "cost" parameter used for optimization</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>When the function <code>fitConic</code> is called with instructions to fit to a parabola, it passes the inputs to <code>fitParabola</code> and does nothing else. For parabolic data, then, either function will give the same result. 

</p>


<h3>Author(s)</h3>

<p>Carl Witthoft &lt;carl@witthoft.com&gt;
</p>



<h3>References</h3>

<p>Some of the code is based on <a href="https://www.mathworks.com/matlabcentral/answers/80541">https://www.mathworks.com/matlabcentral/answers/80541</a>

</p>


<h3>See Also</h3>

<p><code>createConic</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create vertical parabola with some noise
parP &lt;-c(.5,0,0,2,-1,4)
xp &lt;- seq(-5,5,by=0.05)
 partest &lt;-createConic(xp,param = parP,ranFun = rnorm, noise = 1)
 plot(partest, pch= '.',asp=TRUE, cex=3)
 # rotate the data
 partestr &lt;-xyrot(partest,theta = -.35)
 points(partestr,col='green',pch='.',cex=3)
 # do the fit
 parfit &lt;-fitParabola(partestr)
 points(parfit$vertex,pch='X',col='blue') 
 parout &lt;- createConic(xp,parfit$parA)
 lines(parout,col='red')

</code></pre>


</div>