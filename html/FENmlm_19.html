<div class="container">

<table style="width: 100%;"><tr>
<td>predict.femlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for femlm fits</h2>

<h3>Description</h3>

<p>This function obtains prediction from a fitted model estimated with <code>femlm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'femlm'
predict(object, newdata, type = c("response", "link"),
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>femlm</code>. Typically the result of a <code>femlm</code> estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A data.frame containing the variables used to make the prediction. If not provided, the fitted expected (or linear if <code>type = "link"</code>) predictors are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character either equal to <code>"response"</code> (default) or <code>"link"</code>. If <code>type="response"</code>, then the output is at the level of the response variable, i.e. it is the expected predictor <code class="reqn">E(Y|X)</code>. If <code>"link"</code>, then the output is at the level of the explanatory variables, i.e. the linear predictor <code class="reqn">X\cdot \beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not currently used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns a numeric vector of length equal to the number of observations in argument <code>newdata</code>.
</p>


<h3>Author(s)</h3>

<p>Laurent Berge
</p>


<h3>See Also</h3>

<p><code>femlm</code>, <code>update.femlm</code>, <code>summary.femlm</code>, <code>vcov.femlm</code>, <code>getFE</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Estimation on iris data
res = femlm(Sepal.Length ~ Petal.Length | Species, iris)

# what would be the prediction if the data was all setosa?
newdata = data.frame(Petal.Length = iris$Petal.Length, Species = "setosa")
pred_setosa = predict(res, newdata = newdata)

# Let's look at it graphically
plot(c(1, 7), c(3, 11), type = "n", xlab = "Petal.Length",
     ylab = "Sepal.Length")

newdata = iris[order(iris$Petal.Length), ]
newdata$Species = "setosa"
lines(newdata$Petal.Length, predict(res, newdata))

# versicolor
newdata$Species = "versicolor"
lines(newdata$Petal.Length, predict(res, newdata), col=2)

# virginica
newdata$Species = "virginica"
lines(newdata$Petal.Length, predict(res, newdata), col=3)

# The original data
points(iris$Petal.Length, iris$Sepal.Length, col = iris$Species, pch = 18)
legend("topleft", lty = 1, col = 1:3, legend = levels(iris$Species))

</code></pre>


</div>