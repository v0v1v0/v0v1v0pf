<div class="container">

<table style="width: 100%;"><tr>
<td>featureAdjustment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjust each listed variable to the provided set of covariates</h2>

<h3>Description</h3>

<p>This function fits the candidate variables to the provided model formula,for each strata, on a control population.
If the variance of the residual (the fitted observation minus the real observation) is reduced significantly, then, such residual is used in the resulting data frame.
Otherwise, the control mean is subtracted to the observation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	featureAdjustment(variableList,
	                  baseFormula,
	                  strata = NA,
	                  data,
	                  referenceframe,
	                  type = c("LM", "GLS", "RLM","NZLM","SPLINE","MARS","LOESS"),
	                  pvalue = 0.05,
	                  correlationGroup = "ID",
	                  ...
	                  )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>variableList</code></td>
<td>

<p>A data frame with two columns. The first one must have the names of the candidate variables and the other one the description of such variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseFormula</code></td>
<td>

<p>A string of the type "var1 +...+ varn" that defines the model formula to which variables will be fitted
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>

<p>The name of the column in <code>data</code> that stores the variable that will be used to stratify the fitting
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame where all variables are stored in different columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>referenceframe</code></td>
<td>

<p>A data frame similar to <code>data</code>, but with only the control population
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Fit type: linear fitting ("LM"), generalized least squares fitting ("GLS") or Robust ("RLM")
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>

<p>The maximum <em>p</em>-value, associated to the <em>F</em>-test, for the model to be allowed to reduce variability
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlationGroup</code></td>
<td>

<p>The name of the column in <code>data</code> that stores the variable to be used to group the data (only needed if <code>type</code> defined as "GLS")
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>parameters for smooth.spline,loess or mda::mars)
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame, where each input observation has been adjusted from <code>data</code> at each <code>strata</code>
</p>


<h3>Note</h3>

<p>This function prints the residuals and the <em>F</em>-statistic for all candidate variables</p>


<h3>Author(s)</h3>

<p>Jose G. Tamez-Pena and Antonio Martinez-Torteya</p>


</div>