<div class="container">

<table style="width: 100%;"><tr>
<td>nu_OPP_estimator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the degrees of freedom of a heavy-tailed t distribution based on the OPP estimator</h2>

<h3>Description</h3>

<p>This function estimates the degrees of freedom of a heavy-tailed <code class="reqn">t</code> distribution based on
the OPP estimator from paper [Ollila-Palomar-Pascal, TSP2021, Alg. 1].
Traditional nonparametric methods or likelihood methods provide erratic estimations of
the degrees of freedom unless the number of observations is very large.
The POP estimator provides a stable estimator based on random matrix theory.
A number of different versions are provided, but the default POP method will most likely
be the desired choice.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nu_OPP_estimator(var_X, trace_scatter, r2, method = c("OPP", "OPP-harmonic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var_X</code></td>
<td>
<p>Vector with the sample variance of the columns of the data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace_scatter</code></td>
<td>
<p>Trace of the scatter matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>Vector containing the values of <code>diag( Xc %*% inv(scatter) %*% t(Xc) )</code>,
where <code>Xc</code> is the centered data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String indicating the version of the OPP estimator (default is just <code>"OPP"</code>).
Other option is the variation: <code>"OPP-harmonic"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Estimated value of the degrees of freedom <code>nu</code> of a heavy-tailed <code class="reqn">t</code> distribution.
</p>


<h3>Author(s)</h3>

<p>Esa Ollila, Frédéric Pascal, and Daniel P. Palomar
</p>


<h3>References</h3>

<p>Esa Ollila, Daniel P. Palomar, and Frédéric Pascal, "Shrinking the Eigenvalues of M-estimators of Covariance Matrix,"
IEEE Trans. on Signal Processing, vol. 69, pp. 256-269, Jan. 2021. &lt;https://doi.org/10.1109/TSP.2020.3043952&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm)       # to generate heavy-tailed data
library(fitHeavyTail)

# parameters
N &lt;- 5
T &lt;- 100
nu_true &lt;- 4           # degrees of freedom
mu_true &lt;- rep(0, N)   # mean vector
Sigma_true &lt;- diag(N)  # scatter matrix

# generate data
X &lt;- rmvt(n = T, sigma = Sigma_true, delta = mu_true, df = nu_true)  # generate Student's t data
mu &lt;- colMeans(X)
Xc &lt;- X - matrix(mu, T, N, byrow = TRUE)    # center data

# usage #1
nu_OPP_estimator(var_X = 1/(T-1)*colSums(Xc^2), trace_scatter = sum(diag(Sigma_true)))

# usage #2
r2 &lt;- rowSums(Xc * (Xc %*% solve(Sigma_true)))
nu_OPP_estimator(var_X = 1/(T-1)*colSums(Xc^2), trace_scatter = sum(diag(Sigma_true)),
                 method = "OPP-harmonic", r2 = r2)

</code></pre>


</div>