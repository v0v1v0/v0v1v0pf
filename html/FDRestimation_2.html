<div class="container">

<table style="width: 100%;"><tr>
<td>p.fdr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>FDR Computation</h2>

<h3>Description</h3>

<p>This function computes FDRs and Method Adjusted p-values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.fdr(
  pvalues = NA,
  zvalues = "two.sided",
  threshold = 0.05,
  adjust.method = "BH",
  BY.corr = "positive",
  just.fdr = FALSE,
  default.odds = 1,
  estim.method = "set.pi0",
  set.pi0 = 1,
  hist.breaks = "scott",
  ties.method = "random",
  sort.results = FALSE,
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>A numeric vector of raw p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zvalues</code></td>
<td>
<p>A numeric vector of z-values to be used in pi0 estimation or a string with options "two.sided", "greater" or "less". Defaults to "two.sided".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A numeric value in the interval <code>[0,1]</code> used in a multiple comparison hypothesis tests to determine significance from the null. Defaults to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.method</code></td>
<td>
<p>A string used to identify the p-value and false discovery rate adjustment method. Defaults to <code>BH</code>. Options are <code>BH</code>, <code>BY</code>, codeBon,<code>Holm</code>, <code>Hoch</code>, and <code>Sidak</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BY.corr</code></td>
<td>
<p>A string of either "positive" or "negative" to determine which correlation is used in the BY method. Defaults to <code>positive</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>just.fdr</code></td>
<td>
<p>A Boolean TRUE or FALSE value which output only the FDR vector instead of the list output. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default.odds</code></td>
<td>
<p>A numeric value determining the ratio of pi1/pi0 used in the computation of one FDR. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estim.method</code></td>
<td>
<p>A string used to determine which method is used to estimate the null proportion or pi0 value. Defaults to <code>set.pi0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.pi0</code></td>
<td>
<p>A numeric value to specify a known or assumed pi0 value in the interval <code>[0,1]</code>. Defaults to 1. Which means the assumption is that all inputted raw p-values come from the null distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist.breaks</code></td>
<td>
<p>A numeric or string variable representing how many breaks are used in the pi0 estimation histogram methods. Defaults to "scott".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties.method</code></td>
<td>
<p>A string a character string specifying how ties are treated. Options are "first", "last", "average", "min", "max", or "random". Defaults to "random".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort.results</code></td>
<td>
<p>A Boolean TRUE or FALSE value which sorts the output in either increasing or non-increasing order dependent on the FDR vector. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A Boolean TRUE or FALSE value indicating whether NA's should be removed from the inputted raw p-value vector before further computation. Defaults to TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We run into errors or warnings when pvalues, zvalues, threshold, set.pi0, BY.corr, or default.odds are not inputted correctly.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fdrs</code></td>
<td>
<p>A numeric vector of method adjusted FDRs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Results Matrix</code></td>
<td>
<p>A numeric matrix of method adjusted FDRs, method adjusted p-values, and raw p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reject Vector</code></td>
<td>
<p>A vector containing Reject.H0 and/or FTR.H0 based off of the threshold value and hypothesis test on the adjusted p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>A numeric value for the pi0 value used in the computations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A numeric value for the threshold value used in the hypothesis tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Adjustment Method</code></td>
<td>
<p>The string with the method name used in computation(needed for the plot.fdr function).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Romain Francois (2014).
<em>bibtex: bibtex parser</em>.
R package version 0.4.0.
</p>
<p>R Core Team (2016).
<em>R: A Language and Environment for Statistical Computing</em>.
R Foundation for Statistical Computing, Vienna, Austria.
ISBN 3-900051-07-0, <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</p>
<p>Efron B (2013).
<em>Large-Scale Inference: Empirical Bayes Methods for Estimation, Testing, and Prediction</em>.
Cambridge University Press.
ISBN 9780511761362.
</p>
<p>Benjamini Y, Hochberg Y (1995).
“Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.”
<em>Journal of the Royal Statistical Society</em>, <b>57</b>(1), 289–300.
</p>
<p>Shaffer JP (1995).
“Multiple Hypothesis Testing.”
<em>Annual review of psychology</em>, <b>46</b>(1), 561–584.
</p>
<p>Storey JD, Tibshirani R (2003).
“Statistical significance for genomewide studies.”
<em>Proceedings of the National Academy of Sciences</em>, <b>100</b>(16), 9440–9445.
</p>
<p>Benjamini Y, Yekutieli D (2001).
“The control of the false discovery rate in multiple testing under dependency.”
<em>Annals of statistics</em>, 1165–1188.
</p>
<p>Meinshausen N, Rice J, others (2006).
“Estimating the proportion of false null hypotheses among a large number of independently tested hypotheses.”
<em>The Annals of Statistics</em>, <b>34</b>(1), 373–393.
</p>
<p>Jiang H, Doerge RW (2008).
“Estimating the proportion of true null hypotheses for multiple comparisons.”
<em>Cancer informatics</em>, <b>6</b>, 117693510800600001.
</p>
<p>Nettleton D, Hwang JG, Caldo RA, Wise RP (2006).
“Estimating the number of true null hypotheses from a histogram of p values.”
<em>Journal of agricultural, biological, and environmental statistics</em>, <b>11</b>(3), 337.
</p>
<p>Pounds S, Morris SW (2003).
“Estimating the occurrence of false positives and false negatives in microarray studies by approximating and partitioning the empirical distribution of p-values.”
<em>Bioinformatics</em>, <b>19</b>(10), 1236–1242.
</p>
<p>Holm S (1979).
“A simple sequentially rejective multiple test procedure.”
<em>Scandinavian journal of statistics</em>, 65–70.
</p>
<p>Bonferroni C (1936).
“Teoria statistica delle classi e calcolo delle probabilita.”
<em>Pubblicazioni del R Istituto Superiore di Scienze Economiche e Commericiali di Firenze</em>, <b>8</b>, 3–62.
</p>
<p>Hochberg Y (1988).
“A sharper Bonferroni procedure for multiple tests of significance.”
<em>Biometrika</em>, <b>75</b>(4), 800–802.
</p>
<p>Šidák Z (1967).
“Rectangular confidence regions for the means of multivariate normal distributions.”
<em>Journal of the American Statistical Association</em>, <b>62</b>(318), 626–633.
</p>
<p>Murray MH, Blume JD (2020).
“False Discovery Rate Computation: Illustrations and Modifications.”
2010.04680.
</p>


<h3>See Also</h3>

<p><code>plot.p.fdr, summary.p.fdr, get.pi0</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example 1
pi0 = 0.8
pi1 = 1-pi0
n = 10000
n.0 = ceiling(n*pi0)
n.1 = n-n.0

sim.data = c(rnorm(n.1,3,1),rnorm(n.0,0,1))
sim.data.p = 2*pnorm(-abs(sim.data))

fdr.output = p.fdr(pvalues=sim.data.p, adjust.method="BH")

fdr.output$fdrs
fdr.output$pi0

# Example 2

sim.data.p = output = c(runif(800),runif(200, min=0, max=0.01))
fdr.output = p.fdr(pvalues=sim.data.p, adjust.method="Holm", sort.results = TRUE)

fdr.output$`Results Matrix`

</code></pre>


</div>