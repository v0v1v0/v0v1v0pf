<div class="container">

<table style="width: 100%;"><tr>
<td>rankReads</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function computes a score to assess the significance of sequencing values</h2>

<h3>Description</h3>

<p>Implementation of two methods based (1) on the coefficient of variation
or (2) on the fold change rank ordering statistics for detecting genes
with significant sequencing values (gwssv). A score is obtained for each
gene and a threshold allows to select the number of gwssv.</p>


<h3>Usage</h3>

<pre><code class="language-R">rankReads(xdata, cont, test, meth=0, Ttimes=10, err=0.1, trim.opt=0,
                        rseed=60)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p> A matrix or a table containing sequencing dataset.
The rownames of xdata is used for the output idnames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont</code></td>
<td>
<p> A vector containing the label names of the control samples:
<code>cont</code> = c("cont01", "cont02", ...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p> A vector containing the label names of the test samples:
<code>test</code> = c("test01", "test02", "test03", ...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>
<p> This parameter allows to specify the approach to use. The value
0 (defaul) means the coefficient of variation is used. When
non-zero value is given, the fcros method used: <code>meth</code> = 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ttimes</code></td>
<td>
<p> The number of perturbed data to use.
The value 10 (default) means that the dataset is used 20 times
and small uniform values are added at each time:
<code>Ttimes</code> = 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p> This is the amount of the uniform values to add to count values.
The value 0.1 (default) is used:
<code>err</code> = 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim.opt</code></td>
<td>
<p> A scalar between 0 and 0.5. The value 0.25 (default) means
that 25% of the lower and the upper rank values of each gene are not
used for computing its statistics "ri", i.e. the inter-quartile range
rank values are averaged: <code>trim.opt</code> = 0.25</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rseed</code></td>
<td>
<p> This value allow to set the computer random generation seed
value in order to be able to have the same results for runs
performed at different times: <code>rseed</code> = 58</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Label names appearing in the parameters "cont" and "test" should match
with some label names in the columns of the data matrix "xdata". It is not
necessary to use all label names appearing in the columns of the dataset matrix.
For a general purpose dataset, one of these parametere can be empty.</p>


<h3>Value</h3>

<p> This function returns a data frame containing 10 components when meth=1
and 3 components when meth=0
</p>
<table>
<tr style="vertical-align: top;">
<td><code>idnames</code></td>
<td>
<p> A vector containing the list of IDs or symbols associated with genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score </code></td>
<td>
<p>coefficient of variation (meth=0) or Fisher-Snedecor test p-value
(meth=1). Smaller (higher) values are associated with genes with significant
(non significant) sequencing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moy </code></td>
<td>
<p>trimmed means associated with genes (when meth=0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ri </code></td>
<td>
<p>The average of rank values associated with genes when meth=1.
These values are rank values statistics leading to f-values
and p-values (when meth=1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FC </code></td>
<td>
<p>The fold changes for genes in the dataset. These fold changes are
calculated as a ratio of averages from the test and the control
samples. Non log scale values are used in the calculation (when meth=1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FC2 </code></td>
<td>
<p>The robust fold changes for genes. These fold changes are
calculated as a trimmed mean of the fold changes or ratios
obtained from the dataset samples.  Non log scale values are used
in the calculation (when meth=1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.value </code></td>
<td>
<p>The f-values are probabilities associated with genes using
the "mean" and the "standard deviation" ("sd") of the statistics "ri".
The "mean" and "sd" are used as a normal distribution parameters 
(when meth=1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value </code></td>
<td>
<p>The p-values associated with genes. These values are obtained
from the fold change rank values and one sample t-test (when meth=1).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Doulaye Dembele doulaye@igbmc.fr</p>


<h3>References</h3>

<p>Dembele D, manuscript under preparation</p>


<h3>Examples</h3>

<pre><code class="language-R">   data(bott);
   cont &lt;- c("SRX033480", "SRX033488", "SRX033481");
   test &lt;- c("SRX033493", "SRX033486", "SRX033494");
   n &lt;- nrow(bott);

   x2 &lt;- tcnReads(bott[,c(cont,test)])
   idx.ok &lt;- (apply(x2, 1, sum) != 0)
   xdata &lt;- x2[,c(cont,test)]
   rownames(xdata) &lt;- bott[,1]
   idx.ok &lt;- (apply(x2, 1, sum) != 0)
   tt2 &lt;- sum(idx.ok)

   raf10.cv &lt;- rankReads(xdata, cont, test, meth=0)
   raf10.pv &lt;- rankReads(xdata, cont, test, meth=1)
   score.cv &lt;- -log10(sort(raf10.cv$score))
   score.pv &lt;- -log10(sort(raf10.pv$score))
   tmp &lt;- scoreThr(score.cv, 2500, 3500)
   tmp

   tmp &lt;- scoreThr(score.pv, 2500, 3500)
   tmp

   op &lt;- par(mfrow = c(1,2))
   plot(score.cv, xlab = "index of genes",
      ylab = "-log10(sorted(score)", main = "rs.cv", type = "l",
      col = "blue", panel.first = grid())
   plot(score.pv, xlab = "index of genes",
      ylab = "-log10(sorted(score)", main = "rs.pv", type = "l",
      col = "blue", panel.first = grid())
   par(op)
</code></pre>


</div>