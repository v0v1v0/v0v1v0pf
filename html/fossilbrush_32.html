<div class="container">

<table style="width: 100%;"><tr>
<td>threshold_ranges</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>threshold_ranges</h2>

<h3>Description</h3>

<p>Function to detect if two peaks in a density spectrum can
be considered separate based on a user supplied threshold.
Creates a sequence of divisions from the troughs immediately
preceding any significant peaks, then bins occurrences for
a given taxon name by those divisions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">threshold_ranges(
  x,
  rank = "genus",
  srt = "max_ma",
  end = "min_ma",
  method = "kernel",
  step = 1,
  density = 0.1,
  use_sd = TRUE,
  win = 5,
  thresh = 5,
  ...,
  report = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An occurrence dataset containing taxon names,
maximum ages and minimum ages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>The column name in x containing the taxon names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srt</code></td>
<td>
<p>A column name in x denoting the occurrence maximum ages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>A column name in x denoting the occurrence minumum ages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for quantifying occurrence density: one
histogram or kernel. Kernel is the recommended default. As called
be @seealso densify</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>A positive integer specifying the time window size
for density calculation. As called by @seealso densify</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>A positive numeric specifying the step size for
densifying records. This should ideally be smaller than step.
As called by @seealso densify</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_sd</code></td>
<td>
<p>A logical determining whether to use peaks detected
as significant using the mean + standard deviation of its neighbourhood.
If FALSE, then the peaks need only be greater than the neighbourhood
mean to be significant. Thus, use_sd is more conservative, but less
prone to noise. As called by @seealso find_peaks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>A positive integer specifying the neighborhood window length
on either side of a peak durign significance testing (i.e. win 5 will
give a total window of 11: -5 indices + peak index + 5 indices). As
called by @seealso find_peaks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>The threshold distance between peaks above which
they will be considered distinct - given in Ma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to @seealso density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report</code></td>
<td>
<p>A logical determining if the analytical outputs of the
function be returned to the user, as well as the revised taxon names, TRUE
by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical determining if function progress
should be reported</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If report = TRUE (the default), a list of five elements. $data
gives the thresholded (and potentially subdivided) taxon names. $matrix
is the taxon-wise matrix of occurrence densities. $peaks is a list
containing three lists of peaks (all peaks, significant by mean + sd,
significant by sd only) for each taxon and a dataframe of peak counts
between the three treatments. $comparison
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load dataset
data("brachios")
# subsample brachios to make for a short example runtime
set.seed(1)
brachios &lt;- brachios[sample(1:nrow(brachios), 1000),]
# interpeak thresholding
itp &lt;- threshold_ranges(brachios, win = 8, thresh = 10,
                        rank = "genus", srt = "max_ma", end = "min_ma")
</code></pre>


</div>