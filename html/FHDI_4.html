<div class="container">

<table style="width: 100%;"><tr>
<td>FHDI_CellProb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Joint Cell Probabilities for Incomplete Categorical Data</h2>

<h3>Description</h3>

<p>Calculate the joint cell probabilities for multivariate missing data using the expectation-maximization (EM) algorithm. This package is partially supported by the NSF grant CSSI 1931380.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FHDI_CellProb(datz, w=NULL, id=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datz</code></td>
<td>
<p>multivariate incomplete categorical data prepared by cell collapsing and merging algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>samping weight. Default = 1.0 if NULL. a scalar or w(nrow_y).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>index for each unit. Default = 1:nrow_y if NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The joint cell probabilities are estimated using EM by weighting method. The algorithm computes the maximum likelihood estimates 
of the joint cell probabilities under missing at random assumption. 
Note that the variable reduction (ver. &gt;= 1.4) with sure independence screening method is not applicable to a separate CellProb task. 
The input incomplete categorical data should be generated by cell make with the cell collapsing and merging algorithm.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cellpr</code></td>
<td>
<p>table of the joint cell probability. The name of a cell is linked to the user-defined categories in "k": e.g., name "325" denotes 3rd, 2nd, 5th categories for three variables, respectively, whereas "a1c" denotes 10th, 1st, 12th categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>reprint of the sampling weights "w" initially defined by the user.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dr. Cho, In Ho (maintainer)
<a href="mailto:icho@iastate.edu">icho@iastate.edu</a>
Dr. Kim, Jae Kwang
<a href="mailto:jkim@iastate.edu">jkim@iastate.edu</a>
Dr. Im, Jong Ho
<a href="mailto:ijh38@yonsei.ac.kr">ijh38@yonsei.ac.kr</a>
Yicheng Yang, Graduate Research Assistant
</p>


<h3>References</h3>

<p>Im, J., Cho, I.H. and Kim, J.K. (2018). FHDI: An <b>R</b> Package for Fractional Hot-Deck Imputation. <em>The R Journal</em>. 10(1), pp. 140-154; 
Im, J., Kim, J.K. and Fuller, W.A. (2015). Two-phase sampling approach to fractional hot deck imputation, <em>Proceeding of the Survey Research Methods Section</em>, Americal Statistical Association, Seattle, WA.;  
Ibrahim, J.G. (1990). Incomplete data in generalized linear models. <em>Journal of the American Statistical Assocation</em> <b>85</b>, 765-769. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Toy Example ### 
# y : trivariate variables
# r : indicator corresponding to missingness in y

set.seed(1345) 
n=100 
rho=0.5 
e1=rnorm(n,0,1) 
e2=rnorm(n,0,1) 
e3=rgamma(n,1,1) 
e4=rnorm(n,0,sd=sqrt(3/2))

y1=1+e1 
y2=2+rho*e1+sqrt(1-rho^2)*e2 
y3=y1+e3 
y4=-1+0.5*y3+e4

r1=rbinom(n,1,prob=0.6) 
r2=rbinom(n,1,prob=0.7) 
r3=rbinom(n,1,prob=0.8) 
r4=rbinom(n,1,prob=0.9)

y1[r1==0]=NA 
y2[r2==0]=NA 
y3[r3==0]=NA 
y4[r4==0]=NA

daty=cbind(y1,y2,y3,y4)

result_CM=FHDI_CellMake(daty, k=5, s_op_cellmake="merging", s_op_merge="fixed")
datz=result_CM$cell
result_CP=FHDI_CellProb(datz)
names(result_CP)
</code></pre>


</div>