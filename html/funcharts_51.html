<div class="container">

<table style="width: 100%;"><tr>
<td>rpca_mfd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust multivariate functional principal components analysis</h2>

<h3>Description</h3>

<p>It performs robust MFPCA as described in Capezza et al. (2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rpca_mfd(
  mfdobj,
  center = "fusem",
  scale = "funmad",
  nharm = 20,
  method = "ROBPCA",
  alpha = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mfdobj</code></td>
<td>
<p>A multivariate functional data object of class mfd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>If TRUE, it centers the data before doing MFPCA with respect
to the functional mean of the input data.
If <code>"fusem"</code>, it uses the functional M-estimator of location proposed
by Centofanti et al. (2023) to center the data.
Default is <code>"fusem"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If <code>"funmad"</code>, it scales the data before doing MFPCA using
the functional normalized median absolute deviation estimator
proposed by Centofanti et al. (2023).
If TRUE, it scales data using <code>scale_mfd</code>.
Default is <code>"funmad"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nharm</code></td>
<td>
<p>Number of multivariate functional principal components
to be calculated. Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>If <code>"ROBPCA"</code>, MFPCA uses ROBPCA of Hubert et al. (2005),
as described in Capezza et al. (2024).
If <code>"Locantore"</code>, MFPCA uses the Spherical Principal Components
procedure proposed by Locantore et al. (1999).
If <code>"Proj"</code>, MFPCA uses the Robust Principal Components based on
Projection Pursuit algorithm of Croux and Ruiz-Gazen (2005).
method If <code>"normal"</code>, it uses <code>pca_mfd</code> on <code>mfdobj</code>.
Default is <code>"ROBPCA"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>This parameter measures the fraction of outliers the algorithm
should resist and is used only if <code>method</code> is <code>"ROBPCA"</code>.
Default is 0.8.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of <code>pca_mfd</code> class, as returned by the <code>pca_mfd</code>
function when performing non robust multivariate
functional principal component analysis.
</p>


<h3>References</h3>

<p>Capezza, C., Centofanti, F., Lepore, A., Palumbo, B. (2024)
Robust Multivariate Functional Control Charts.
<em>Technometrics</em>, <a href="doi:10.1080/00401706.2024.2327346">doi:10.1080/00401706.2024.2327346</a>.
</p>
<p>Centofanti, F., Colosimo, B.M., Grasso, M.L., Menafoglio, A., Palumbo, B.,
Vantini, S. (2023)
Robust functional ANOVA with application to additive manufacturing.
<em>Journal of the Royal Statistical Society Series C: Applied Statistics</em>
72(5), 1210–1234 <a href="doi:10.1093/jrsssc/qlad074">doi:10.1093/jrsssc/qlad074</a>
</p>
<p>Croux, C., Ruiz-Gazen, A. (2005).
High breakdown estimators for principal components: The projection-pursuit
approach revisited.
<em>Journal of Multivariate Analysis</em>, 95, 206–226,
<a href="doi:10.1016/j.jmva.2004.08.002">doi:10.1016/j.jmva.2004.08.002</a>.
</p>
<p>Hubert, M., Rousseeuw, P.J., Branden, K.V. (2005)
ROBPCA: A New Approach to Robust Principal Component Analysis,
<em>Technometrics</em> 47(1), 64–79, <a href="doi:10.1198/004017004000000563">doi:10.1198/004017004000000563</a>
</p>
<p>Locantore, N., Marron, J., Simpson, D., Tripoli, N., Zhang, J., Cohen K.,
K. (1999),
Robust principal components for functional data.
<em>Test</em>, 8, 1-28. <a href="doi:10.1007/BF02595862">doi:10.1007/BF02595862</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(funcharts)
dat &lt;- simulate_mfd(nobs = 20, p = 1, correlation_type_x = "Bessel")
mfdobj &lt;- get_mfd_list(dat$X_list, n_basis = 5)

# contaminate first observation
mfdobj$coefs[, 1, ] &lt;- mfdobj$coefs[, 1, ] + 0.05

# plot_mfd(mfdobj) # plot functions to see the outlier
# pca &lt;- pca_mfd(mfdobj) # non robust MFPCA
rpca &lt;- rpca_mfd(mfdobj) # robust MFPCA
# plot_pca_mfd(pca, harm = 1) # plot first eigenfunction, affected by outlier
# plot_pca_mfd(rpca, harm = 1) # plot first eigenfunction in robust case
</code></pre>


</div>