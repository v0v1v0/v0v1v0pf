<div class="container">

<table style="width: 100%;"><tr>
<td>plot_feature_similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot heatmaps for pairwise similarity between features.</h2>

<h3>Description</h3>

<p>This method creates a heatmap based on data stored in a
<code>familiarCollection</code> object. Features in the heatmap are ordered so that
more similar features appear together.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_feature_similarity(
  object,
  feature_cluster_method = waiver(),
  feature_linkage_method = waiver(),
  feature_cluster_cut_method = waiver(),
  feature_similarity_threshold = waiver(),
  draw = FALSE,
  dir_path = NULL,
  split_by = NULL,
  facet_by = NULL,
  facet_wrap_cols = NULL,
  ggtheme = NULL,
  gradient_palette = NULL,
  gradient_palette_range = NULL,
  x_label = waiver(),
  x_label_shared = "column",
  y_label = waiver(),
  y_label_shared = "row",
  legend_label = waiver(),
  plot_title = waiver(),
  plot_sub_title = waiver(),
  caption = NULL,
  y_range = NULL,
  y_n_breaks = 3,
  y_breaks = NULL,
  rotate_x_tick_labels = waiver(),
  show_dendrogram = c("top", "right"),
  dendrogram_height = grid::unit(1.5, "cm"),
  width = waiver(),
  height = waiver(),
  units = waiver(),
  export_collection = FALSE,
  ...
)

## S4 method for signature 'ANY'
plot_feature_similarity(
  object,
  feature_cluster_method = waiver(),
  feature_linkage_method = waiver(),
  feature_cluster_cut_method = waiver(),
  feature_similarity_threshold = waiver(),
  draw = FALSE,
  dir_path = NULL,
  split_by = NULL,
  facet_by = NULL,
  facet_wrap_cols = NULL,
  ggtheme = NULL,
  gradient_palette = NULL,
  gradient_palette_range = NULL,
  x_label = waiver(),
  x_label_shared = "column",
  y_label = waiver(),
  y_label_shared = "row",
  legend_label = waiver(),
  plot_title = waiver(),
  plot_sub_title = waiver(),
  caption = NULL,
  y_range = NULL,
  y_n_breaks = 3,
  y_breaks = NULL,
  rotate_x_tick_labels = waiver(),
  show_dendrogram = c("top", "right"),
  dendrogram_height = grid::unit(1.5, "cm"),
  width = waiver(),
  height = waiver(),
  units = waiver(),
  export_collection = FALSE,
  ...
)

## S4 method for signature 'familiarCollection'
plot_feature_similarity(
  object,
  feature_cluster_method = waiver(),
  feature_linkage_method = waiver(),
  feature_cluster_cut_method = waiver(),
  feature_similarity_threshold = waiver(),
  draw = FALSE,
  dir_path = NULL,
  split_by = NULL,
  facet_by = NULL,
  facet_wrap_cols = NULL,
  ggtheme = NULL,
  gradient_palette = NULL,
  gradient_palette_range = NULL,
  x_label = waiver(),
  x_label_shared = "column",
  y_label = waiver(),
  y_label_shared = "row",
  legend_label = waiver(),
  plot_title = waiver(),
  plot_sub_title = waiver(),
  caption = NULL,
  y_range = NULL,
  y_n_breaks = 3,
  y_breaks = NULL,
  rotate_x_tick_labels = waiver(),
  show_dendrogram = c("top", "right"),
  dendrogram_height = grid::unit(1.5, "cm"),
  width = waiver(),
  height = waiver(),
  units = waiver(),
  export_collection = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>familiarCollection</code> object, or other other objects from which
a <code>familiarCollection</code> can be extracted. See details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_cluster_method</code></td>
<td>
<p>The method used to perform clustering. These are
the same methods as for the <code>cluster_method</code> configuration parameter:
<code>none</code>, <code>hclust</code>, <code>agnes</code>, <code>diana</code> and <code>pam</code>.
</p>
<p><code>none</code> cannot be used when extracting data regarding mutual correlation or
feature expressions.
</p>
<p>If not provided explicitly, this parameter is read from settings used at
creation of the underlying <code>familiarModel</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_linkage_method</code></td>
<td>
<p>The method used for agglomerative clustering in
<code>hclust</code> and <code>agnes</code>. These are the same methods as for the
<code>cluster_linkage_method</code> configuration parameter: <code>average</code>, <code>single</code>,
<code>complete</code>, <code>weighted</code>, and <code>ward</code>.
</p>
<p>If not provided explicitly, this parameter is read from settings used at
creation of the underlying <code>familiarModel</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_cluster_cut_method</code></td>
<td>
<p>The method used to divide features into
separate clusters. The available methods are the same as for the
<code>cluster_cut_method</code> configuration parameter: <code>silhouette</code>, <code>fixed_cut</code> and
<code>dynamic_cut</code>.
</p>
<p><code>silhouette</code> is available for all cluster methods, but <code>fixed_cut</code> only
applies to methods that create hierarchical trees (<code>hclust</code>, <code>agnes</code> and
<code>diana</code>). <code>dynamic_cut</code> requires the <code>dynamicTreeCut</code> package and can only
be used with <code>agnes</code> and <code>hclust</code>.
</p>
<p>If not provided explicitly, this parameter is read from settings used at
creation of the underlying <code>familiarModel</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_similarity_threshold</code></td>
<td>
<p>The threshold level for pair-wise
similarity that is required to form feature clusters with the <code>fixed_cut</code>
method.
</p>
<p>If not provided explicitly, this parameter is read from settings used at
creation of the underlying <code>familiarModel</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>(<em>optional</em>) Draws the plot if TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir_path</code></td>
<td>
<p>(<em>optional</em>) Path to the directory where created performance
plots are saved to. Output is saved in the <code>feature_similarity</code>
subdirectory. If <code>NULL</code> no figures are saved, but are returned instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split_by</code></td>
<td>
<p>(<em>optional</em>) Splitting variables. This refers to column names
on which datasets are split. A separate figure is created for each split.
See details for available variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_by</code></td>
<td>
<p>(<em>optional</em>) Variables used to determine how and if facets of
each figure appear. In case the <code>facet_wrap_cols</code> argument is <code>NULL</code>, the
first variable is used to define columns, and the remaing variables are
used to define rows of facets. The variables cannot overlap with those
provided to the <code>split_by</code> argument, but may overlap with other arguments.
See details for available variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_wrap_cols</code></td>
<td>
<p>(<em>optional</em>) Number of columns to generate when facet
wrapping. If NULL, a facet grid is produced instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggtheme</code></td>
<td>
<p>(<em>optional</em>) <code>ggplot</code> theme to use for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient_palette</code></td>
<td>
<p>(<em>optional</em>) Sequential or divergent palette used to
colour the similarity or distance between features in a heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient_palette_range</code></td>
<td>
<p>(<em>optional</em>) Numerical range used to span the
gradient. This should be a range of two values, e.g. <code>c(0, 1)</code>. Lower or
upper boundary can be unset by using <code>NA</code>. If not set, the full
metric-specific range is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_label</code></td>
<td>
<p>(<em>optional</em>) Label to provide to the x-axis. If NULL, no label
is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_label_shared</code></td>
<td>
<p>(<em>optional</em>) Sharing of x-axis labels between facets.
One of three values:
</p>

<ul>
<li> <p><code>overall</code>: A single label is placed at the bottom of the figure. Tick
text (but not the ticks themselves) is removed for all but the bottom facet
plot(s).
</p>
</li>
<li> <p><code>column</code>: A label is placed at the bottom of each column. Tick text (but
not the ticks themselves) is removed for all but the bottom facet plot(s).
</p>
</li>
<li> <p><code>individual</code>: A label is placed below each facet plot. Tick text is kept.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_label</code></td>
<td>
<p>(<em>optional</em>) Label to provide to the y-axis. If NULL, no label
is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_label_shared</code></td>
<td>
<p>(<em>optional</em>) Sharing of y-axis labels between facets.
One of three values:
</p>

<ul>
<li> <p><code>overall</code>: A single label is placed to the left of the figure. Tick text
(but not the ticks themselves) is removed for all but the left-most facet
plot(s).
</p>
</li>
<li> <p><code>row</code>: A label is placed to the left of each row. Tick text (but not the
ticks themselves) is removed for all but the left-most facet plot(s).
</p>
</li>
<li> <p><code>individual</code>: A label is placed below each facet plot. Tick text is kept.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_label</code></td>
<td>
<p>(<em>optional</em>) Label to provide to the legend. If NULL, the
legend will not have a name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>
<p>(<em>optional</em>) Label to provide as figure title. If NULL, no
title is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_sub_title</code></td>
<td>
<p>(<em>optional</em>) Label to provide as figure subtitle. If
NULL, no subtitle is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>(<em>optional</em>) Label to provide as figure caption. If NULL, no
caption is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_range</code></td>
<td>
<p>(<em>optional</em>) Value range for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_n_breaks</code></td>
<td>
<p>(<em>optional</em>) Number of breaks to show on the y-axis of the
plot. <code>y_n_breaks</code> is used to determine the <code>y_breaks</code> argument in case it
is unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_breaks</code></td>
<td>
<p>(<em>optional</em>) Break points on the y-axis of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate_x_tick_labels</code></td>
<td>
<p>(<em>optional</em>) Rotate tick labels on the x-axis by
90 degrees. Defaults to <code>TRUE</code>. Rotation of x-axis tick labels may also be
controlled through the <code>ggtheme</code>. In this case, <code>FALSE</code> should be provided
explicitly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_dendrogram</code></td>
<td>
<p>(<em>optional</em>) Show dendrogram around the main panel.
Can be <code>TRUE</code>, <code>FALSE</code>, <code>NULL</code>, or a position, i.e. <code>top</code>, <code>bottom</code>, <code>left</code>
and <code>right</code>. Up to two positions may be provided, but only as long as the
dendrograms are not on opposite sides of the heatmap: <code>top</code> and <code>bottom</code>,
and <code>left</code> and <code>right</code> cannot be used together.
</p>
<p>A dendrogram can only be drawn from cluster methods that produce
dendrograms, such as <code>hclust</code>. A dendrogram can for example not be
constructed using the partitioning around medioids method (<code>pam</code>).
</p>
<p>By default, a dendrogram is drawn to the top and right of the panel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendrogram_height</code></td>
<td>
<p>(<em>optional</em>) Height of the dendrogram. The height is
1.5 cm by default. Height is expected to be grid unit (see <code>grid::unit</code>),
which also allows for specifying relative heights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>(<em>optional</em>) Width of the plot. A default value is derived from
the number of facets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>(<em>optional</em>) Height of the plot. A default value is derived
from the number of features and the number of facets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>(<em>optional</em>) Plot size unit. Either <code>cm</code> (default), <code>mm</code> or
<code style="white-space: pre;">⁠in⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export_collection</code></td>
<td>
<p>(<em>optional</em>) Exports the collection if TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed on to <code>as_familiar_collection</code>, <code>ggplot2::ggsave</code>, <code>extract_feature_similarity</code>
</p>

<dl>
<dt><code>familiar_data_names</code></dt>
<dd>
<p>Names of the dataset(s). Only used if the <code>object</code>
parameter is one or more <code>familiarData</code> objects.</p>
</dd>
<dt><code>collection_name</code></dt>
<dd>
<p>Name of the collection.</p>
</dd>
<dt><code>device</code></dt>
<dd>
<p>Device to use. Can either be a device function
(e.g. png), or one of "eps", "ps", "tex" (pictex),
"pdf", "jpeg", "tiff", "png", "bmp", "svg" or "wmf" (windows only). If
<code>NULL</code> (default), the device is guessed based on the <code>filename</code> extension.</p>
</dd>
<dt><code>scale</code></dt>
<dd>
<p>Multiplicative scaling factor.</p>
</dd>
<dt><code>dpi</code></dt>
<dd>
<p>Plot resolution. Also accepts a string input: "retina" (320),
"print" (300), or "screen" (72). Applies only to raster output types.</p>
</dd>
<dt><code>limitsize</code></dt>
<dd>
<p>When <code>TRUE</code> (the default), <code>ggsave()</code> will not
save images larger than 50x50 inches, to prevent the common error of
specifying dimensions in pixels.</p>
</dd>
<dt><code>bg</code></dt>
<dd>
<p>Background colour. If <code>NULL</code>, uses the <code>plot.background</code> fill value
from the plot theme.</p>
</dd>
<dt><code>create.dir</code></dt>
<dd>
<p>Whether to create new directories if a non-existing
directory is specified in the <code>filename</code> or <code>path</code> (<code>TRUE</code>) or return an
error (<code>FALSE</code>, default). If <code>FALSE</code> and run in an interactive session,
a prompt will appear asking to create a new directory when necessary.</p>
</dd>
<dt><code>data</code></dt>
<dd>
<p>A <code>dataObject</code> object, <code>data.table</code> or <code>data.frame</code> that
constitutes the data that are assessed.</p>
</dd>
<dt><code>is_pre_processed</code></dt>
<dd>
<p>Flag that indicates whether the data was already
pre-processed externally, e.g. normalised and clustered. Only used if the
<code>data</code> argument is a <code>data.table</code> or <code>data.frame</code>.</p>
</dd>
<dt><code>cl</code></dt>
<dd>
<p>Cluster created using the <code>parallel</code> package. This cluster is then
used to speed up computation through parallellisation.</p>
</dd>
<dt><code>feature_similarity_metric</code></dt>
<dd>
<p>Metric to determine pairwise similarity
between features. Similarity is computed in the same manner as for
clustering, and <code>feature_similarity_metric</code> therefore has the same options
as <code>cluster_similarity_metric</code>: <code>mcfadden_r2</code>, <code>cox_snell_r2</code>,
<code>nagelkerke_r2</code>, <code>spearman</code>, <code>kendall</code> and <code>pearson</code>.
</p>
<p>If not provided explicitly, this parameter is read from settings used at
creation of the underlying <code>familiarModel</code> objects.</p>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>Flag to indicate whether feedback should be provided on the
computation and extraction of various data elements.</p>
</dd>
<dt><code>message_indent</code></dt>
<dd>
<p>Number of indentation steps for messages shown during
computation and extraction of various data elements.</p>
</dd>
<dt><code>estimation_type</code></dt>
<dd>
<p>(<em>optional</em>) Sets the type of estimation that should be
possible. This has the following options:
</p>

<ul>
<li> <p><code>point</code>: Point estimates.
</p>
</li>
<li> <p><code>bias_correction</code> or <code>bc</code>: Bias-corrected estimates. A bias-corrected
estimate is computed from (at least) 20 point estimates, and <code>familiar</code> may
bootstrap the data to create them.
</p>
</li>
<li> <p><code>bootstrap_confidence_interval</code> or <code>bci</code> (default): Bias-corrected
estimates with bootstrap confidence intervals (Efron and Hastie, 2016). The
number of point estimates required depends on the <code>confidence_level</code>
parameter, and <code>familiar</code> may bootstrap the data to create them.
</p>
</li>
</ul>
<p>As with <code>detail_level</code>, a non-default <code>estimation_type</code> parameter can be
specified for separate evaluation steps by providing a parameter value in a
named list with data elements, e.g. <code>list("auc_data"="bci", "model_performance"="point")</code>. This parameter can be set for the following
data elements: <code>auc_data</code>, <code>decision_curve_analyis</code>, <code>model_performance</code>,
<code>permutation_vimp</code>, <code>ice_data</code>, and <code>prediction_data</code>.</p>
</dd>
<dt><code>aggregate_results</code></dt>
<dd>
<p>(<em>optional</em>) Flag that signifies whether results
should be aggregated during evaluation. If <code>estimation_type</code> is
<code>bias_correction</code> or <code>bc</code>, aggregation leads to a single bias-corrected
estimate. If <code>estimation_type</code> is <code>bootstrap_confidence_interval</code> or <code>bci</code>,
aggregation leads to a single bias-corrected estimate with lower and upper
boundaries of the confidence interval. This has no effect if
<code>estimation_type</code> is <code>point</code>.
</p>
<p>The default value is equal to <code>TRUE</code> except when assessing metrics to assess
model performance, as the default violin plot requires underlying data.
</p>
<p>As with <code>detail_level</code> and <code>estimation_type</code>, a non-default
<code>aggregate_results</code> parameter can be specified for separate evaluation steps
by providing a parameter value in a named list with data elements, e.g.
<code>list("auc_data"=TRUE, , "model_performance"=FALSE)</code>. This parameter exists
for the same elements as <code>estimation_type</code>.</p>
</dd>
<dt><code>confidence_level</code></dt>
<dd>
<p>(<em>optional</em>) Numeric value for the level at which
confidence intervals are determined. In the case bootstraps are used to
determine the confidence intervals bootstrap estimation, <code>familiar</code> uses the
rule of thumb <code class="reqn">n = 20 / ci.level</code> to determine the number of required
bootstraps.
</p>
<p>The default value is <code>0.95</code>.</p>
</dd>
<dt><code>bootstrap_ci_method</code></dt>
<dd>
<p>(<em>optional</em>) Method used to determine bootstrap
confidence intervals (Efron and Hastie, 2016). The following methods are
implemented:
</p>

<ul>
<li> <p><code>percentile</code> (default): Confidence intervals obtained using the percentile
method.
</p>
</li>
<li> <p><code>bc</code>: Bias-corrected confidence intervals.
</p>
</li>
</ul>
<p>Note that the standard method is not implemented because this method is
often not suitable due to non-normal distributions. The bias-corrected and
accelerated (BCa) method is not implemented yet.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function generates area under the ROC curve plots.
</p>
<p>Available splitting variables are: <code>fs_method</code>, <code>learner</code>, and <code>data_set</code>.
By default, the data is split by <code>fs_method</code> and <code>learner</code>, with facetting
by <code>data_set</code>.
</p>
<p>Note that similarity is determined based on the underlying data. Hence the
ordering of features may differ between facets, and tick labels are
maintained for each panel.
</p>
<p>Available palettes for <code>gradient_palette</code> are those listed by
<code>grDevices::palette.pals()</code> (requires R &gt;= 4.0.0), <code>grDevices::hcl.pals()</code>
(requires R &gt;= 3.6.0) and <code>rainbow</code>, <code>heat.colors</code>, <code>terrain.colors</code>,
<code>topo.colors</code> and <code>cm.colors</code>, which correspond to the palettes of the same
name in <code>grDevices</code>. If not specified, a default palette based on palettes
in Tableau are used. You may also specify your own palette by using colour
names listed by <code>grDevices::colors()</code> or through hexadecimal RGB strings.
</p>
<p>Labeling methods such as <code>set_fs_method_names</code> or <code>set_data_set_names</code> can
be applied to the <code>familiarCollection</code> object to update labels, and order
the output in the figure.
</p>


<h3>Value</h3>

<p><code>NULL</code> or list of plot objects, if <code>dir_path</code> is <code>NULL</code>.
</p>


</div>