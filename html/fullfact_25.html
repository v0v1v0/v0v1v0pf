<div class="container">

<table style="width: 100%;"><tr>
<td>JackGlmer3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Jackknife components for non-normal data 3</h2>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, dam by sire, and any additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">JackGlmer3(observ, dam, sire, response, fam_link, remain, quasi = F, size = 1,
first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link="logit"), binomial(link="probit"), poisson(link="log"), and poisson(link="sqrt").
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
Extracts any additional fixed effect and random effect variance components. The fixed-effect variance
component is as a single group using the method described by Nakagawa and Schielzeth (2013).
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for remaining formula components. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code>JackGlmer</code>, <code>JackGlmer2</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(chinook_survival) #Chinook salmon offspring survival
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(1:6,9),one="alive",zero="dead")

#Delete-one
## Not run: survival_jack3&lt;- JackGlmer3(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit""),remain="egg_size + (1|tray)")
## End(Not run)

#Delete-d, d=30
## Not run: survival_jack3.2&lt;- JackGlmer3(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit""),remain="egg_size + (1|tray)",size=30)
## End(Not run)
</code></pre>


</div>