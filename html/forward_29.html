<div class="container">

<table style="width: 100%;"><tr>
<td>fwdglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Forward Search in Generalized Linear Models</h2>

<h3>Description</h3>

<p>This function applies the forward search approach to robust analysis in generalized linear models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fwdglm(formula, family, data, weights, na.action, contrasts = NULL, bsb = NULL, 
       balanced = TRUE, maxit = 50, epsilon = 1e-06, nsamp = 100, trace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fit. The details of the model are the same as for glm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. See <code>family</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the model. By default the variables are taken from the environment from which the function is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain <code>NA</code>'s. The default is set by the <code>na.action</code> setting of <code>options</code>, and is <code>na.fail</code> if that is unset. The default is <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of <code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsb</code></td>
<td>
<p>an optional vector specifying a starting subset of observations to be used in the forward search. By default the <code>"best"</code> starting subset is chosen using the function <code>lmsglm</code> with control arguments provided by <code>nsamp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balanced</code></td>
<td>
<p>logical, for a binary response if <code>TRUE</code> the proportion of successes on the full dataset is approximately balanced during the forward search algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>integer giving the maximal number of IWLS iterations. See <code>glm.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>positive convergence tolerance epsilon. See <code>glm.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>the initial subset for the forward search in generalized linear models is found by the function <code>lmsglm</code>. This argument allows to control how many subsets are used in the robust fitting procedure. The choices are: the number of samples (100 by the default) or <code>"all"</code>. Note that the algorithm tries to find <code>nsamp</code> good subsets or a maximum of 2*<code>nsamp</code> subsets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logical, if <code>TRUE</code> a message is printed for every ten iterations completed during the forward search.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns an object of class <code>"fwdglm"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Residuals</code></td>
<td>
<p>a <code class="reqn">(n x (n-p+1))</code> matrix of residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Unit</code></td>
<td>
<p>a matrix of units added (to a maximum of 5 units) at each step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>included</code></td>
<td>
<p>a list with each element containing a vector of units included at each step of the forward search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Coefficients</code></td>
<td>
<p>a <code class="reqn">((n-p+1) x p)</code> matrix of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tStatistics</code></td>
<td>
<p>a <code class="reqn">((n-p+1) x p)</code> matrix of t statistics for the coefficients, i.e. coef.est/SE(coef.est).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Leverage</code></td>
<td>
<p>a <code class="reqn">(n x (n-p+1))</code> matrix of leverage values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxRes</code></td>
<td>
<p>a <code class="reqn">((n-p) x 2)</code> matrix of max deviance residuals in the best subsets and <code class="reqn">m</code>-th deviance residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MinDelRes</code></td>
<td>
<p>a <code class="reqn">((n-p-1) x 2)</code> matrix of minimum deviance residuals out of best subsets and <code class="reqn">(m+1)</code>-th deviance residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ScoreTest</code></td>
<td>
<p>a <code class="reqn">((n-p) x 1)</code> matrix of score test statistics for a goodness of link test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Likelihood</code></td>
<td>
<p>a <code class="reqn">((n-p) x 4)</code> matrix with columns containing: deviance, residual deviance, psuedo <code class="reqn">R^2</code> (computed as <code class="reqn">1-deviance/null.deviance</code>), dispersion parameter (computed as <code class="reqn">\sum(pearson.residuals^2)/(m - p)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CookDist</code></td>
<td>
<p>a <code class="reqn">((n-p) x 1)</code> matrix of forward Cook's distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ModCookDist</code></td>
<td>
<p>a <code class="reqn">((n-p) x 5)</code> matrix of forward modified Cook's distances for the units (to a maximum of 5 units) included at each step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weights</code></td>
<td>
<p>a <code class="reqn">(n x (n-p))</code> matrix of weights used at each step of the forward search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inibsb</code></td>
<td>
<p>a vector giving the best starting subset chosen by <code>lmsglm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary.response</code></td>
<td>
<p>logical, equal to <code>TRUE</code> if binary response.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Originally written for S-Plus by:
Kjell Konis <a href="mailto:kkonis@insightful.com">kkonis@insightful.com</a> and Marco Riani <a href="mailto:mriani@unipr.it">mriani@unipr.it</a> <br>
Ported to R by Luca Scrucca <a href="mailto:luca@stat.unipg.it">luca@stat.unipg.it</a></p>


<h3>References</h3>

<p>Atkinson, A.C. and Riani, M. (2000), <em>Robust Diagnostic Regression Analysis</em>, First Edition. New York: Springer, Chapter 6.</p>


<h3>See Also</h3>

<p><code>summary.fwdglm</code>, <code>plot.fwdglm</code>, <code>fwdlm</code>, <code>fwdsco</code>.  
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
data(cellular)
cellular$TNF &lt;- as.factor(cellular$TNF)
cellular$IFN &lt;- as.factor(cellular$IFN)
mod &lt;- fwdglm(y ~ TNF + IFN, data=cellular, family=poisson(log), nsamp=200)
summary(mod)
## Not run: plot(mod)
plot(mod, 1)
plot(mod, 5)
plot(mod, 6, ylim=c(-3, 20))
plot(mod, 7)
plot(mod, 8)
</code></pre>


</div>