<div class="container">

<table style="width: 100%;"><tr>
<td>funspaceGAM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional space GAM</h2>

<h3>Description</h3>

<p>Mapping response variables in a functional space
</p>


<h3>Usage</h3>

<pre><code class="language-R">funspaceGAM(y, funspace, family = "gaussian", minObs = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector including the variable to be mapped inside the functional space. There must be a correspondence between the elements of y and the observations used to make the PCA (contained in 'pca.object'), both in the number of elements and in their order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funspace</code></td>
<td>
<p>An object of class <code>funspace</code> providing the functional space to be considered. See function <code>funspace</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A family object specifying the distribution and link to use in the gam model. Defaults to "gaussian". See package <code>mgcv</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minObs</code></td>
<td>
<p>minimum number of observations needed in a  group to make a model (defaults to 30).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Different response variables can be mapped onto a functional space. In <code>funspace</code>, we follow the approach by Carmona et al. (2021), in which a generalized additive model is estimated across the bidimensional functional space. The resulting models show the predicted values of the response variable at each position of the portion of the functional space that is defined in the TPD of the global set of observations or of individual groups.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>funspace</code> containing the functional space, trait probability distributions, and the fitted gam models. The <code>funspace</code> class has specific methods exists for the generic functions <code>plot</code> and <code>summary</code>.
</p>


<h3>References</h3>

<p>CP Carmona, et al. (2021). Erosion of global functional diversity across the tree of life. Science Advances eabf2675
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# 1. GAM on a space based on a PCA
x &lt;- princomp(GSPFF)
funtest &lt;- funspace(x = x, PCs = c(1, 2), threshold = 0.95)
y &lt;- abs(x$scores[, 1] * x$scores[, 2]) + rnorm(nrow(GSPFF), mean = 0, sd = 1)
funtestGAM &lt;- funspaceGAM(y = y, funspace = funtest)
plot(funtestGAM, quant.plot = TRUE, quant.col = "grey90")
summary(funtestGAM)


</code></pre>


</div>