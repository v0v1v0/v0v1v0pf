<div class="container">

<table style="width: 100%;"><tr>
<td>cwm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit for the CWM</h2>

<h3>Description</h3>

<p>Maximum likelihood fitting of the cluster-weighted model by the EM algorithm.</p>


<h3>Usage</h3>

<pre><code class="language-R">cwm(formulaY = NULL, familyY = gaussian, data, Xnorm = NULL, Xbin = NULL,
  Xpois = NULL, Xmult = NULL, modelXnorm = NULL, Xbtrials = NULL, k = 1:3, 
  initialization = c("random.soft", "random.hard", "kmeans", "mclust", "manual"), 
  start.z = NULL, seed = NULL, maxR = 1, iter.max = 1000, threshold = 1.0e-04, 
  eps = 1e-100, parallel = FALSE,   pwarning = FALSE)
</code></pre>


<h3>Arguments</h3>

                      
<table>
<tr style="vertical-align: top;">
<td><code>formulaY</code></td>
<td>
<p>an optional object of class "<code>formula</code>" (or one that can be coerced to that class): a symbolic description of the model to be fitted.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familyY</code></td>
<td>
<p>a description of the error distribution and link function to be used for the conditional distribution of <code class="reqn">Y</code> in each mixture component. This can be a character string naming a <code>family function</code>, a family function or the result of a call to a family function. 
The following family functions are supported:  
</p>

<ul>
<li> <p><code>binomial(link = "logit")</code> 
</p>
</li>
<li> <p><code>gaussian(link = "identity")</code> 
</p>
</li>
<li> <p><code>Gamma(link = "log")</code>
</p>
</li>
<li> <p><code>inverse.gaussian(link = "1/mu^2")</code> 
</p>
</li>
<li> <p><code>poisson(link = "log")</code>
</p>
</li>
<li> <p><code>student.t(link = "identity")</code> 
</p>
</li>
</ul>
<p>Default value is <code>gaussian(link = "identity")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional <code>data.frame</code>, <code>list</code>, or <code>environment</code> with the variables needed to use <code>formulaY</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xnorm, Xbin, Xpois, Xmult</code></td>
<td>

<p>an optional matrix containing variables to be used for marginalization having normal, binomial, Poisson and multinomial distributions. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelXnorm</code></td>
<td>
<p>an optional vector of character strings indicating the parsimonious models to be fitted for variables in <code>Xnorm</code>. The default is  <code>c("E", "V")</code> for a single continuous covariate, and <code>c("EII", "VII", "EEI", "VEI", "EVI", "VVI", "EEE", "VEE", "EVE", "EEV", "VVE", "VEV", "EVV", "VVV")</code> for multivariate continuous covariates (see <code>mixture:gpcm for details</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xbtrials</code></td>
<td>

<p>an optional vector containing the number of trials for each column in <code>Xbin</code>. If omitted, the maximum of each column in <code>Xbin</code> is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>an optional vector containing the numbers of mixture components to be tried. Default value is <code>1:3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialization</code></td>
<td>

<p>an optional character string. It sets the initialization strategy for the EM-algorithm. It can be:
</p>

<ul>
<li> <p><code>"random.soft"</code>
</p>
</li>
<li> <p><code>"random.hard"</code>
</p>
</li>
<li> <p><code>"kmeans"</code>
</p>
</li>
<li> <p><code>"mclust"</code> 
</p>
</li>
<li> <p><code>"manual"</code>
</p>
</li>
</ul>
<p>Default value is <code>"random.soft"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.z</code></td>
<td>

<p>matrix of soft or hard classification: it is used only if <code>initialization = "manual"</code>.Only models with the same number of mixture components as the columns of this matrix will be fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>an optional scalar. It sets the seed for the random number generator, when random initializations are used; if <code>NULL</code>, current seed is not changed. Default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxR</code></td>
<td>

<p>number of initializations to be tried. Default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>

<p>an optional scalar. It sets the maximum number of iterations in the EM-algorithm. Default value is 200.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>

<p>an optional scalar. It sets the threshold for the Aitken acceleration procedure. Default value is 1.0e-04.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>an optional scalar. It sets the smallest value for eigenvalues of covariance matrices for <code>Xnorm</code>. Default value is 1e-100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>When <code>TRUE</code>, the package <code>parallel</code> is used for parallel computation. When several models are estimated, computational time is reduced. The number of cores to use may be set with the global option <code>cl.cores</code>; default value is detected using <code>detectCores()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pwarning</code></td>
<td>
<p>When <code>TRUE</code>, warnings are printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>familyY = binomial</code>, the response variable must be a matrix with two columns, where the first column is the number of "successes" and the second column is the number of "failures".  
When several models have been estimated, methods <code>summary</code> and <code>print</code> consider the best model according to the information criterion in <code>criterion</code>, among the estimated models having a number of components among those in <code>k</code> an error distribution among those in <code>familyY</code> and a parsimonious model among those in <code>modelXnorm</code>.
</p>


<h3>Value</h3>

<p>This function returns a class <code>cwm</code> object, which is a list of values related to the model selected. It contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>an object of class <code>call</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulaY</code></td>
<td>
<p>an object of class <code>formula</code> containing a symbolic description of the model fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familyY</code></td>
<td>
<p>the distribution used for the conditional distribution of <code class="reqn">Y</code> in each mixture component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> with the variables needed to use <code>formulaY</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concomitant</code></td>
<td>
<p>a list containing <code>Xnorm</code>, <code>Xbin</code>, <code>Xpois</code>, <code>Xmult</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xbtrials</code></td>
<td>
<p>number of trials used for <code>Xbin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>a list; each element is related to one of the models fitted. Each element is a list and contains:</p>
</td>
</tr>
</table>
<ul>
<li>
<p><code>posterior</code> posterior probabilities
</p>
</li>
<li>
<p><code>iter</code> number of iterations performed in EM algorithm
</p>
</li>
<li>
<p><code>k </code> number of (fitted) mixture components.
</p>
</li>
<li>
<p><code>size</code> estimated size of the groups.
</p>
</li>
<li>
<p><code>cluster </code> classification vector
</p>
</li>
<li>
<p><code>loglik </code> final log-likelihood value
</p>
</li>
<li>
<p><code>df </code> overall number of estimated parameters
</p>
</li>
<li>
<p><code>prior </code> weights for the mixture components
</p>
</li>
<li>
<p><code>IC </code> list containing values of the information criteria 
</p>
</li>
<li>
<p><code>converged</code> logical; <code>TRUE</code> if EM algorithm converged
</p>
</li>
<li>
<p><code>GLModels</code> a list;  each element is related to a mixture component and contains:
</p>

<ul>
<li>
<p><code>model </code> a "<code>glm</code>" class object.
</p>
</li>
<li>
<p><code>sigma </code> estimated local scale parameters of the conditional distribution of <code class="reqn">Y</code>, when <code>familyY</code> is <code>gaussian</code> or <code>student.t</code>
</p>
</li>
<li>
<p><code>t_df</code> estimated degrees of freedom of the t distribution, when <code>familyY</code> is <code>student.t</code>
</p>
</li>
<li>
<p><code>nuY</code> estimated shape parameter, when <code>familyY</code> is <code>Gamma</code>. The gamma distribution is parameterized according to McCullagh &amp; Nelder (1989, p. 30)
</p>
</li>
</ul>
</li>
<li>
<p><code>concomitant</code> a list with estimated concomitant variables parameters for each mixture component
</p>

<ul>
<li>
<p><code>normal.d, multinomial.d, poisson.d, binomial.d</code> marginal distribution of concomitant variables
</p>
</li>
<li>
<p><code>normal.mu</code> mixture component means for <code>Xnorm</code>  
</p>
</li>
<li>
<p><code>normal.Sigma</code> mixture component covariance matrices for <code>Xnorm</code>
</p>
</li>
<li>
<p><code>normal.model</code> models fitted for <code>Xnorm</code>  
</p>
</li>
<li>
<p><code>multinomial.probs</code> multinomial distribution probabilities for  <code>Xmult</code> 
</p>
</li>
<li>
<p><code>poisson.lambda</code> lambda parameters for <code>Xpois</code>  
</p>
</li>
<li>
<p><code>binomial.p</code> binomial probabilities for <code>Xbin</code>  
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>

<p>Mazza A., Punzo A., Ingrassia S.
</p>


<h3>References</h3>

<p>Mazza, A., Ingrassia, S., and Punzo, A. (2018). flexCWM: A Flexible Framework for Cluster-Weighted Models.  <em>Journal of Statistical Software</em>, <b>86</b>(2), 1-30.
</p>
<p>Ingrassia, S., Minotti, S. C., and Vittadini, G. (2012). Local Statistical Modeling via the Cluster-Weighted Approach with Elliptical Distributions. <em>Journal of Classification</em>, <b>29</b>(3), 363-401.
</p>
<p>Ingrassia, S., Minotti, S. C., and Punzo, A. (2014). Model-based clustering via linear cluster-weighted models. <em>Computational Statistics and Data Analysis</em>, <b>71</b>, 159-182.
</p>
<p>Ingrassia, S., Punzo, A., and Vittadini, G. (2015). The Generalized Linear Mixed Cluster-Weighted Model. <em>Journal of Classification</em>, <b>32</b>(forthcoming)
</p>
<p>McCullagh, P. and Nelder, J. (1989). Generalized Linear Models. Chapman &amp; Hall, Boca Raton, 2nd edition
</p>
<p>Punzo, A. (2014). Flexible Mixture Modeling with the Polynomial Gaussian Cluster-Weighted Model. <em>Statistical Modelling</em>, <b>14</b>(3), 257-291.
</p>




<h3>See Also</h3>

                  
<p><code>flexCWM-package</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## an exemple with artificial data
data("ExCWM")
attach(ExCWM)
str(ExCWM)

# mixtures of binomial distributions
resXbin &lt;- cwm(Xbin = Xbin, k = 1:2, initialization = "kmeans")
getParXbin(resXbin)

# Mixtures of Poisson distributions
resXpois &lt;- cwm(Xpois = Xpois, k = 1:2, initialization = "kmeans")
getParXpois(resXpois)

# parsimonious mixtures of multivariate normal distributions
resXnorm &lt;- cwm(Xnorm = cbind(Xnorm1,Xnorm2), k = 1:2, initialization = "kmeans")
getParXnorm(resXnorm)

## an exemple with real data
data("students")
attach(students)
str(students)
# CWM
fit2 &lt;- cwm(WEIGHT ~ HEIGHT + HEIGHT.F , Xnorm = cbind(HEIGHT, HEIGHT.F), 
  k = 2, initialization = "kmeans", modelXnorm = "EEE")
summary(fit2, concomitant = TRUE)
plot(fit2)


</code></pre>


</div>