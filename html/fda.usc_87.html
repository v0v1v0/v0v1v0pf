<div class="container">

<table style="width: 100%;"><tr>
<td>fanova.RPm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional ANOVA with Random Project.</h2>

<h3>Description</h3>

<p>The procedure is based on the analysis of randomly chosen one-dimensional
projections. The function tests ANOVA models for functional data with
continuous covariates and perform special contrasts for the factors in the
formula.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fanova.RPm(
  object,
  formula,
  data.fac,
  RP = min(30, ncol(object)),
  alpha = 0.95,
  zproj = NULL,
  par.zproj = list(norm = TRUE),
  hetero = TRUE,
  pr = FALSE,
  w = rep(1, ncol(object)),
  nboot = 0,
  contrast = NULL,
  ...
)

## S3 method for class 'fanova.RPm'
summary(object, ndec = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Functional response data.  Object with class fdata with
<code>n</code> curves discretizated in <code>m</code> points. For multivariate problems
<code>object</code> can be a <code>data.frame</code> or a <code>matrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>as formula without response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.fac</code></td>
<td>
<p>Explanatory variables.  Data frame with dimension (<code>n</code>
x <code>p</code>), where <code>p</code> are the number of factors or covariates
considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RP</code></td>
<td>
<p>Vector of number of random projections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Confidence level, by default <code>alpha</code>=0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zproj</code></td>
<td>
<p>Function for generating the projections or an object that
contains that projections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.zproj</code></td>
<td>
<p>List of parameters for <code>zproj</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetero</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (by default) means heteroskedastic ANOVA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p>codelogical. If <code>TRUE</code> prints intermediate results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Vector of weights (only for multivariate problems).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap samples, by default no bootstrap
computations, <code>nboot</code>=0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>List of special contrast to be used ; by default no special
contrasts are used (<code>contrast</code>=<code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndec</code></td>
<td>
<p>Number of decimals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>zproj</code> allows to change the generator process of the projections. This
can be done through the inclusion of a function or a collection of
projections generated outside the function. By default, for a functional
problem, the function <code>rproc2fdata</code> is used. For multivariate problems,
if no function is included, the projections are generated by a normalized
gaussian process of the same dimension as <code>object</code>. Any user function
can be included with the only limitation that the two first parameters are:
</p>

<ul>
<li> <p><code>n</code>: number of projections
</p>
</li>
<li> <p><code>t</code>: discretization points for functional problems
</p>
</li>
<li> <p><code>m</code>: number of columns for multivariate problems.
</p>
</li>
</ul>
<p>That functions must return a <code>fdata</code> or <code>matrix</code> object
respectively.  
</p>
<p>The function allows user-defined contrasts.  The list of contrast to be used
for some of the factors in the formula.  Each contrast matrix in the list
has <code>r</code> rows, where <code>r</code> is the number of factor levels. The user
can also request special predetermined contrasts, for example using the
<code>contr.helmert</code>, <code>contr.sum</code> or
<code>contr.treatment</code> functions.
</p>
<p>The function returns (by default) the significance of the variables using
the Bonferroni test and the False Discovery Rate test. Bootstrap procedure
provides more precision
</p>


<h3>Value</h3>

<p>An object with the following components:<br></p>

<ul>
<li> <p>proj The projection value of each point on the curves. Matrix with dimension
(<code>RP</code> x <code>m</code>), where <code>RP</code> is the number of projection and
<code>m</code> are the points observed in each projection curve. 
</p>
</li>
<li> <p>mins
minimum number for each random projection. 
</p>
</li>
<li> <p>result p-value for each
random projection. 
</p>
</li>
<li> <p>test.Bonf significance (TRUE or FALSE) for
vector of random projections <code>RP</code> in columns and factor (and special
contrast) by rows. 
</p>
</li>
<li> <p>p.Bonf p-value for vector of random projections
<code>RP</code> in columns and factor (and special contrast) by rows.
</p>
</li>
<li> <p>test.fdr False Discovery Rate (TRUE or FALSE) for vector of random
projections <code>RP</code> in columns and factor (and special contrast) by rows.
</p>
</li>
<li> <p>p.fdr p-value of False Discovery Rate for vector of random
projections <code>RP</code> in columns and factor (and special contrast) by rows.
</p>
</li>
<li> <p>test.Boot False Discovery Rate (TRUE or FALSE) for vector of random
projections <code>RP</code> in columns and factor (and special contrast) by rows.
</p>
</li>
<li> <p>p.Boot p-value of Bootstrap sambple for vector of random projections
<code>RP</code> in columns and factor (and special contrast) by rows.
</p>
</li>
</ul>
<h3>Note</h3>

<p>anova.RPm deprecated.
</p>
<p>If <code>hetero=TRUE</code> then all factors must be categorical.
</p>


<h3>Author(s)</h3>

<p>Juan A. Cuesta-Albertos, Manuel Febrero-Bande, Manuel Oviedo de la
Fuente<br><a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Cuesta-Albertos, J.A., Febrero-Bande, M. <em>A simple multiway
ANOVA for functional data.</em> TEST 2010, DOI <b>10.1007/s11749-010-0185-3</b>.
</p>


<h3>See Also</h3>

<p>See Also as: <code>fanova.onefactor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# ex fanova.hetero
data(phoneme)
names(phoneme)
# A MV matrix obtained from functional data
data=as.data.frame(phoneme$learn$data[,c(1,seq(0,150,10)[-1])]) 
group=phoneme$classlearn
n=nrow(data)
group.rand=as.factor(sample(rep(1:3,len=n),n))
RP=c(2,5,15,30)

#ex 1: real factor and random factor
m03=data.frame(group,group.rand)
resul1=fanova.RPm(phoneme$learn,~group+group.rand,m03,RP=c(5,30))
summary(resul1)

#ex 2: real factor with special contrast
m0=data.frame(group)
cr5=contr.sum(5)   #each level vs last level
resul03c1=fanova.RPm(data,~group,m0,contrast=list(group=cr5))
summary(resul03c1)

#ex 3: random factor with special contrast. Same projs as ex 2.
m0=data.frame(group.rand)
zz=resul03c1$proj
cr3=contr.sum(3)   #each level vs last level
resul03c1=fanova.RPm(data,~group.rand,m0,contrast=list(group.rand=cr3),zproj=zz)
summary(resul03c1)

## End(Not run)
  
</code></pre>


</div>