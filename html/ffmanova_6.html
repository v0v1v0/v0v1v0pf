<div class="container">

<table style="width: 100%;"><tr>
<td>ffmanova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fifty-fifty MANOVA</h2>

<h3>Description</h3>

<p>General linear modeling of fixed-effects models with multiple responses is
performed. The function calculates 50-50 MANOVA <code class="reqn">p</code>-values, ordinary
univariate <code class="reqn">p</code>-values and adjusted <code class="reqn">p</code>-values using rotation
testing.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ffmanova(
  formula,
  data = NULL,
  stand = TRUE,
  nSim = 0,
  verbose = TRUE,
  returnModel = TRUE,
  returnY = FALSE,
  returnYhat = FALSE,
  returnYhatStd = FALSE,
  newdata = NULL,
  linComb = NULL,
  nonEstimableAsNA = TRUE,
  outputClass = "ffmanova"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Model formula.  See "Note" below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame or list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>Logical. Standardization of responses. This option has effect
on the 50-50 MANOVA testing and the calculation of <code>exVarSS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSim</code></td>
<td>
<p>nonnegative integer. The number of simulations to use in the
rotation tests. Can be a single nonnegative integer or a list of values for
each term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical.  If <code>TRUE</code>, the rotation tests print trace information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnModel</code></td>
<td>
<p>When <code>TRUE</code>, and object, <code>ffModel</code>, with output from <code>ffModelObj</code> is included in output. 
Must be <code>TRUE</code> to enable predictions by <code>predict.ffmanova</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnY</code></td>
<td>
<p>Response matrix, <code>Y</code>, in output when <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnYhat</code></td>
<td>
<p>Matrix <code>Yhat</code> of fitted values corresponding to <code>Y</code> in output when <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnYhatStd</code></td>
<td>
<p>Standard errors, <code>YhatStd</code>, in output when <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Possible input to <code>predict.ffmanova</code>. When non-NULL, prediction results will be included output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linComb</code></td>
<td>
<p>Possible input to <code>predict.ffmanova</code> in addition to <code>newdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonEstimableAsNA</code></td>
<td>
<p>Will be used as input to <code>predict.ffmanova</code> when <code>newdata</code> and/or <code>linComb</code> is non-NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputClass</code></td>
<td>
<p>When set to, <code>"anova"</code>, <code>ffAnova</code> results will be produced.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An overall <code class="reqn">p</code>-value for all responses is calculated for each model
term. This is done using the 50-50 MANOVA method, which is a modified
variant of classical MANOVA made to handle several highly correlated
responses.
</p>
<p>Ordinary single response <code class="reqn">p</code>-values are produced. By using rotation
testing these can be adjusted for multiplicity according to familywise error
rates or false discovery rates. Rotation testing is a Monte Carlo simulation
framework for doing exact significance testing under multivariate normality.
The number of simulation repetitions (<code>nSim</code>) must be chosen.
</p>
<p>Unbalance is handled by a variant of Type II sums of squares, which has
several nice properties: </p>
 <ol>
<li>
<p> Invariant to ordering of the
model terms.  </p>
</li>
<li>
<p> Invariant to scale changes.  </p>
</li>
<li>
<p> Invariant to how the
overparameterization problem of categorical variable models is solved (how
constraints are defined).  </p>
</li>
<li>
<p> Whether two-level factors are defined to be
continuos or categorical does not influence the results.  </p>
</li>
<li>
<p> Analysis of
a polynomial model with a single experimental variable produce results
equivalent to the results using an orthogonal polynomial.  </p>
</li>
</ol>
<p> In addition to
significance testing an explained variance measure, which is based on sums
of sums of squares, is computed for each model term.
</p>


<h3>Value</h3>

<p>An object of class <code>"ffmanova"</code>, which consists of the
concatenated results from the underlying functions <code>manova5050</code>,
<code>rotationtests</code> and <code>unitests</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>termNames</code></td>
<td>
<p>model term names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exVarSS</code></td>
<td>
<p>explained variances
calculated from sums of squares summed over all responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees
of freedom - adjusted for other terms in model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_om</code></td>
<td>
<p>degrees of
freedom - adjusted for terms contained in actual term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPC</code></td>
<td>
<p>number of
principal components used for testing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nBU</code></td>
<td>
<p>number of principal
components used as buffer components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exVarPC</code></td>
<td>
<p>variance explained by
<code>nPC</code> components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exVarBU</code></td>
<td>
<p>variance explained by <code>(nPC+nBU)</code>
components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pValues</code></td>
<td>
<p>50-50 MANOVA <code class="reqn">p</code>-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>logical.  Whether the responses are standardised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>The test statistics as <code class="reqn">t</code>-statistics (when single degree of
freedom) or <code class="reqn">F</code>-statistics </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pRaw</code></td>
<td>
<p>matrix of ordinary
<code class="reqn">p</code>-values from F- or t-testing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pAdjusted</code></td>
<td>
<p>matrix of adjusted
<code class="reqn">p</code>-values according to familywise error rates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pAdjFDR</code></td>
<td>
<p>matrix of
adjusted <code class="reqn">p</code>-values according to false discovery rates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simN</code></td>
<td>
<p>number of simulations performed for each term (same as input)</p>
</td>
</tr>
</table>
<p>The matrices <code>stat</code>, <code>pRaw</code>, <code>pAdjusted</code> and <code>pAdjFDR</code>
have one row for each model term and one column for each response.
</p>
<p>According to the input parameters, additional elements can be included in output.
</p>


<h3>Note</h3>

<p>The model is specified with <code>formula</code>, in the same way as in <code>lm</code>
(except that offsets are not supported).  See <code>lm</code> for details.
Input parameters <code>formula</code> and <code>data</code> will be interpreted by <code>model.frame</code>.
</p>


<h3>Author(s)</h3>

<p>Øyvind Langsrud and Bjørn-Helge Mevik
</p>


<h3>References</h3>

<p>Langsrud, Ø. (2002) 50-50 Multivariate Analysis of Variance for
Collinear Responses. <em>The Statistician</em>, <b>51</b>, 305–317.
</p>
<p>Langsrud, Ø. (2003) ANOVA for Unbalanced Data: Use Type II Instead of Type
III Sums of Squares. <em>Statistics and Computing</em>, <b>13</b>, 163–167.
</p>
<p>Langsrud, Ø. (2005) Rotation Tests. <em>Statistics and Computing</em>,
<b>15</b>, 53–60.
</p>
<p>Moen, B., Oust, A., Langsrud, Ø., Dorrell, N., Gemma, L., Marsden, G.L.,
Hinds, J., Kohler, A., Wren, B.W. and Rudi, K. (2005) An explorative
multifactor approach for investigating global survival mechanisms of
Campylobacter jejuni under environmental conditions.  <em>Applied and
Environmental Microbiology</em>, <b>71</b>, 2086-2094.
</p>
<p>See also <a href="https://www.langsrud.com/stat/program.htm">https://www.langsrud.com/stat/program.htm</a>.
</p>


<h3>See Also</h3>

<p><code>ffAnova</code> and <code>predict.ffmanova</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(dressing)

# An ANOVA model with all design variables as factors 
# and with visc as the only response variable.
# Classical univariate Type II test results are produced.
ffmanova(visc ~ (factor(press) + factor(stab) + factor(emul))^2 + day,
         data = dressing) 

# A second order response surface model with day as a block factor. 
# The properties of the extended Type II approach is utilized. 
ffmanova(visc ~ (press + stab + emul)^2 + I(press^2)+ I(stab^2)+ I(emul^2)+ day,
         data = dressing)

# 50-50 MANOVA results with the particle-volume curves as 
# multivariate responses. The responses are not standardized.
ffmanova(pvol ~ (press + stab + emul)^2 + I(press^2)+ I(stab^2)+ I(emul^2)+ day,
         stand = FALSE, data = dressing)

# 50-50 MANOVA results with 9 rheological responses (standardized).
# 99 rotation simulation repetitions are performed. 
res &lt;- ffmanova(rheo ~ (press + stab + emul)^2 + I(press^2)+ I(stab^2)+ I(emul^2)+ day,
                nSim = 99, data = dressing)
res$pRaw      #  Unadjusted single responses p-values 
res$pAdjusted #  Familywise error rate adjusted p-values 
res$pAdjFDR   #  False discovery rate adjusted p-values

# As above, but this time 9999 rotation simulation repetitions 
# are performed, but only for the model term stab^2. 
res &lt;- ffmanova(rheo ~ (press + stab + emul)^2 + I(press^2)+ I(stab^2)+ I(emul^2)+ day,
                nSim = c(0,0,0,0,0,9999,0,0,0,0,0), data = dressing)
res$pAdjusted[6,] # Familywise error rate adjusted p-values for stab^2
res$pAdjFDR[6,]   # False discovery rate adjusted p-values for stab^2

# Note that the results of the first example above can also be 
# obtained by using the car package.
## Not run: 
   require(car)
   Anova(lm(visc ~ (factor(press) + factor(stab) + factor(emul))^2 + day,
         data = dressing), type = "II")
## End(Not run)

# The results of the second example differ because Anova does not recognise 
# linear terms (emul) as being contained in quadratic terms (I(emul^2)).
# A consequence here is that the clear significance of emul disappears.
## Not run: 
   require(car)
   Anova(lm(visc ~ (press + stab + emul)^2 + I(press^2)+ I(stab^2)+ I(emul^2)+ day,
         data = dressing), type="II")
## End(Not run)

</code></pre>


</div>