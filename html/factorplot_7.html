<div class="container">

<table style="width: 100%;"><tr>
<td>factorplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Pairwise Differences</h2>

<h3>Description</h3>

<p>This function calculates all pairwise difference from the input data.  The
input data can be the result of a GLM (produced with <code>glm</code>), a
multinomial logit model (produced with <code>multinom</code> from the <span class="pkg">nnet</span>
package), a general linear hypothesis test (produced with <code>glht</code>
from the <span class="pkg">multcomp</span> package), an object of class <code>eff</code> from the
<code>effects</code> package or any vector of values and a corresponding
variance-covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">factorplot(obj, adjust.method = "none", ...)

## S3 method for class 'glm'
factorplot(
  obj,
  adjust.method = "none",
  order = "natural",
  factor.variable = NULL,
  pval = 0.05,
  two.sided = TRUE,
  ...
)

## S3 method for class 'lm'
factorplot(
  obj,
  adjust.method = "none",
  order = "natural",
  factor.variable = NULL,
  pval = 0.05,
  two.sided = TRUE,
  ...
)

## S3 method for class 'summary.glht'
factorplot(obj, ...)

## S3 method for class 'glht'
factorplot(obj, adjust.method = "none", pval = 0.05, ...)

## S3 method for class 'sims'
factorplot(obj, adjust.method = "none", order = "natural", pval = 0.05, ...)

## Default S3 method:
factorplot(
  obj,
  adjust.method = "none",
  order = "natural",
  var,
  resdf = Inf,
  pval = 0.05,
  two.sided = TRUE,
  ...
)

## S3 method for class 'eff'
factorplot(
  obj,
  adjust.method = "none",
  order = "natural",
  pval = 0.05,
  two.sided = TRUE,
  ordby = NULL,
  ...
)

## S3 method for class 'multinom'
factorplot(
  obj,
  adjust.method = "none",
  order = "natural",
  variable,
  pval = 0.05,
  two.sided = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>An object of class <code>glm</code> or <code>lm</code>, <code>glht</code>,
<code>summary.glht</code>, <code>multinom</code> or a vector of values (of class
<code>numeric</code>) for which pairwise differences will be calculated.
Alternatively, an object of class <code>sims</code> which gives an Nsim x
Nstimulus matrix of predictions from which differences will be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.method</code></td>
<td>
<p>For objects of class <code>multinom</code> and <code>numeric</code>
- one of the methods allowed by <code>p.adjust</code> in <span class="pkg">stats</span> -
‘holm’, ‘hochberg’, ‘hommel’, ‘bonferroni’,
‘BH’, ‘BY’, ‘fdr’, ‘none’.  See help for the
<code>p.adjust</code> for more information on these different adjustment
methods.  For objects of class <code>glm</code>, <code>lm</code> or <code>glht</code>,
additional arguments of ‘single-step’, ‘Shaffer’,
‘Westfall’ and ‘free’ are possible.  See <code>glht</code>
from the <span class="pkg">multcomp</span> package for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to
<code>summary.glht</code>, including, but not limited to <code>level</code> and
<code>alternative</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>One of ‘natural’, ‘alph’, or ‘size’
indicating how the levels of the factor should be ordered for presentation.
The ‘natural’ option (the default) leaves the levels as they are in
the factor contrasts.  ‘alph’ sorts the levels alphabetically and
‘size’ sorts the levels by size of coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.variable</code></td>
<td>
<p>String containing the name of the factor for which
pairwise coefficient differences will be calculated (if a <code>glm</code> or
<code>lm</code> class object is passed to the function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>The (uncorrected) Type I error probability required, default =
0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>Logical argument indicating whether the hypothesis test
should be against a two-sided alternative if TRUE (default) or a one-sided
alternative if FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Variance-covariance matrix to be used if <code>obj</code> is a numeric
vector.  This could also be a vector of quasi/floating variances from which
a diagonal variance-covariance matrix will be produced</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resdf</code></td>
<td>
<p>Residual degrees of freedom used as the degrees of freedom for
the t-distribution from which p-values will be generated if <code>obj</code> is a
numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordby</code></td>
<td>
<p>For objects of class <code>eff</code> with interactions, <code>ordby</code>
is a string indicating the variable by which the plot should be ordered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>String containing the name of the column of the model matrix
for which pairwise differences will be calculated if a <code>multinom</code> class
object is passed to the function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates pairwise differences that can be passed to a novel
plotting method that does not suffer from some of the same problems as
floating/quasi confidence intervals and is easier to apprehend immediately
than a compact letter display.
</p>
<p>While the factorplot function and its print and summary methods work equally
well regardless of the number of levels in the <code>factor.variable</code>, the
plot function automatically scales the resulting graph to the appropriate
size, but will be less useful as the number of contrasts gets large (e.g., &gt;
30).  If more than one factor covariate is present and the
<code>factor.variable</code> option is NULL, the function generates a text-based
menu in the R GUI that will allow the users to pick the term for which they
want to calculate the results.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b.diff</code></td>
<td>
<p>An upper-triangular matrix of pairwise differences
between row and column levels of the factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.sd</code></td>
<td>
<p>An upper-triangular
matrix of standard errors of the pairwise differences represented in b.diff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>An upper-triangular matrix of uncorrected (one-sided) p-values
corresponding to the entries of b.diff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The p-value specified in
the command</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dave Armstrong
</p>


<h3>References</h3>

<p>Easton, D.F., J. Peto and G.A.G. Babiker. 1991. Floating
absolute risk: An alternative to relative risk in survival and case control
analysis avoiding an arbitrary reference group.  <em>Statistics in
Medicine</em> <b>10</b>: 1025–1035.<br> Firth, David and Renee X. de Menzes.
2004.  Quasi-variances.  <em>Biometrika</em> <b>91.1</b>: 65–80.<br> Plummer,
M. 2004. Improved estimates of floating absolute risk.  <em>Statistics in
Medicine</em> <b>23</b>: 93–104.<br></p>


<h3>Examples</h3>

<pre><code class="language-R">
## for lm/glm
x &lt;- as.factor(round(runif(1000, .5,5.5)))
levels(x) &lt;- paste("lab", 1:20, sep="")
X &lt;- model.matrix(~x)
Y &lt;- X %*% rnorm(ncol(X),0,4) + rnorm(1000)
mod &lt;- lm(Y ~ x)
fp &lt;- factorplot(mod, factor.variable="x",  pval = 0.05, order="alph")

## for glht
library(multcomp)
mod.glht &lt;- glht(mod, linfct = mcp('x' = 'Tukey'))
fp2 &lt;- factorplot(mod.glht, adjust.method='single-step')

## for vector of values
b &lt;- c(0, mod$coef[-1])
v &lt;- rbind(0, cbind(0, vcov(mod)[-1,-1]))
names(b) &lt;- colnames(v) &lt;- rownames(v) &lt;- mod$xlevels[["x"]]
fp3 &lt;- factorplot(b, var=v, resdf=mod$df.residual)

## for multinomial logit
data(france)
library(nnet)
multi.mod &lt;- multinom(vote ~ retnat + lrself + male + age, data=france)
fp4 &lt;- factorplot(multi.mod, variable="lrself")

</code></pre>


</div>