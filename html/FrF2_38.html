<div class="container">

<table style="width: 100%;"><tr>
<td>DanielPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Normal or Half-Normal Effects Plots </h2>

<h3>Description</h3>

<p>The function is modified from the same-name function in packge <span class="pkg">BsMD</span>
with the purpose of providing more usage comfort (correct effect sizes 
in case of factors, automatic annotation, 
automatic labelling of the most significant factors only).
</p>


<h3>Usage</h3>

<pre><code class="language-R">DanielPlot(fit, ...)
## S3 method for class 'design'
DanielPlot(fit, ..., response = NULL)
## Default S3 method:
DanielPlot(fit, code = FALSE, autolab = TRUE, alpha = 0.05, faclab = NULL, 
       block = FALSE, datax = TRUE, half = FALSE, pch = "*", 
       cex.fac = par("cex.lab"), cex.lab = par("cex.lab"), 
       cex.pch = par("cex"), cex.legend = par("cex.lab"), 
       main = NULL, subtitle=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>an experimental design of class <code>design</code> 
with the <code>type</code> element of the <code>design.info</code> attribute 
containing “FrF2” or “pb”<br>
OR<br>
object of class <code>lm</code>. Fitted model from <code>lm</code> or <code>aov</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the default function, 
or graphical parameters to be passed to <code>plot</code>;
note that one should not use <code>pch</code> for split-plot designs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p> NULL or a character string that specifies response variable to be used, 
must be an element of <code>response.names(obj)</code>; 
if NULL, the first response from <code>response.names(obj)</code> is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>logical. If <code>TRUE</code> labels “A”,“B”, etc. are used 
instead of the names of the coefficients (factors). A legend linking 
codes to names is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autolab</code></td>
<td>
<p> If TRUE, only the significant factors according to the Lenth method
(significance level given by <code>alpha</code>) are labelled. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> significanc level for the Lenth method </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faclab</code></td>
<td>
<p>NULL or list. 
If <code>NULL</code>, point labels are automatically determined according to the 
setting of <code>code</code> (i.e. A,B,C etc. for <code>code=TRUE</code>, natural effect 
names otherwise) and <code>autolab</code> (i.e. all effects are labelled if <code>autolab=FALSE</code>,
only significant effects are labelled if <code>autolab=TRUE</code>).  
Otherwise, <code>faclab</code> can be used for manual labelling of certain effects 
and should be a list with <code>idx</code> (integer vector referring to 
position of effects to be labelled) and <code>lab</code> (character vector of labels)
components. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>logical. If <code>TRUE</code>, the first factor is labelled as “BK” (block).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datax</code></td>
<td>
<p>logical. If <code>TRUE</code>, the x-axis is used for the factor effects the
the y-axis for the normal scores. The opposite otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>half</code></td>
<td>
<p>logical. If <code>TRUE</code>, half-normal plot of effects is display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>numeric or character. Points character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.fac</code></td>
<td>
<p>numeric. Factor label character size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>numeric. Labels character size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pch</code></td>
<td>
<p>numeric. Points character size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>numeric. Legend size in case of codes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>NULL or character. Title of plot. If NULL, automatic title is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>NULL or character. Sub title of plot. Should not be used for split-plot designs, 
because automatic subtitle is generated for these.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The design underlying <code>fit</code> 
has to be a (regular or non-regular) fractional factorial 2-level design. 
Effects (except for the intercept) are displayed in a normal or half-normal 
plot with the effects in the x-axis by default. 
</p>
<p>If <code>fit</code> is a design with at least one response variable 
rather than a linear model fit, 
the <code>lm</code>-method for class <code>design</code> is applied to it with 
degree high enough that at least one effect is assigned to each column of the Yates matrix, 
and the default method for <code>DanielPlot</code> is afterwards applied to the 
resulting linear model.
</p>
<p>For split-plot designs, whole plot effects are shown as different plotting 
characters, because they are potentially subject to larger variability, 
and one should not be too impressed, if they look impressively large, 
as this may well be indication of plot-to-plot variability rather than a 
true effect.
</p>


<h3>Value</h3>

<p>The function invisibly returns a data frame with columns: <code>x</code>, <code>y</code>,
<code>no</code>, <code>effect</code>, <code>coded</code> (if coded plot was requested) 
and <code>pchs</code>, for the coordinates, the position numbers, 
the effect names, the coded effect names, and the plotting characters 
for plotted points.
</p>
<p>The plotting characters are particularly useful for split-plot designs and can be used 
for subsequent separate plotting of whole-plot and split-plot effects, if necessary.
</p>


<h3>Note</h3>

<p>If you load package <span class="pkg">BsMD</span> after package <span class="pkg">FrF2</span>, 
a mere call to function <code>DanielPlot</code> will use the function from package <span class="pkg">BsMD</span> 
rather than the one from package <span class="pkg">FrF2</span>. You can explicitly request 
usage of the <span class="pkg">FrF2</span> function by <code>FrF2::DanielPlot</code>. </p>


<h3>Author(s)</h3>

<p>Ernesto Barrios, modified by Ulrike Groemping.</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (2005)
<em>Statistics for Experimenters, 2nd edition</em>.
New York: Wiley.
</p>
<p>Daniel, C. (1959) 
Use of Half Normal Plots in Interpreting Two Level Experiments.
<em>Technometrics</em> <b>1</b>, 311–340.
</p>
<p>Daniel, C. (1976) 
<em>Application of Statistics to Industrial Experimentation.</em>
New York: Wiley.
</p>
<p>Lenth, R.V. (1989) Quick and easy analysis of unreplicated factorials.
<em>Technometrics</em> <b>31</b>, 469–473.
</p>
<p>Lenth, R.V. (2006) Lenth s Method for the Analysis of Unreplicated Experiments.
To appear in <em>Encyclopedia of Statistics in Quality and Reliability</em>, Wiley, New York.
Downloadable at <a href="http://www.wiley.com/legacy/wileychi/eqr/docs/sample_1.pdf">http://www.wiley.com/legacy/wileychi/eqr/docs/sample_1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code>qqnorm</code>, <code>halfnormal</code>, 
<code>LenthPlot</code>, <code>BsMD-package</code> </p>


</div>