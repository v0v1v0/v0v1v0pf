<div class="container">

<table style="width: 100%;"><tr>
<td>cond.fun.chisq.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Conditional Functional Chi-Squared Test
</h2>

<h3>Description</h3>

<p>Asymptotic chi-squared test to determine the model-free functional dependency of effect variable <code class="reqn">Y</code> on a cause variable <code class="reqn">X</code>, conditioned on a third variable <code class="reqn">Z</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cond.fun.chisq.test(x, y, z=NULL, data=NULL, log.p = FALSE,
                    method = c("fchisq", "nfchisq"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector or character; either a discrete random variable (cause) represented as vector or a character column name in <code>data</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>vector or character; either a discrete random variable (effect) represented as vector or a character column name in <code>data</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>vector or character; either a discrete random variable (condition) represented as vector or a character column name in <code>data</code>. In case of <code>NULL</code>, a <code>fun.chisq.test</code> on a contingency table, with <code>x</code> as row variable and <code>y</code> as column variable, is returned. See <code>fun.chisq.test</code> for details. The default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing three or more columns whose names can be used as values for <code>x</code>, <code>y</code> and <code>z</code>. In case of <code>NULL</code>, <code>x</code>, <code>y</code> and <code>z</code> must be vectors. The default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>

<p>logical; if <code>TRUE</code>, the p-value is given as <code>log(p)</code>. Taking the log improves numerical precision when the p-value is close to zero. The default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string to specify the method to compute the conditional functional chi-squared test statistic and its p-value. The options are <code>"fchisq"</code> (default) and <code>"nfchisq"</code>. See Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The conditional functional chi-squared test introduces the concept of conditional functional depedency, where the functional association between two variables (<code>x</code> and <code>y</code>) is tested conditioned on a third variable (<code>z</code>) (Zhang 2014). Two methods are provided to compute the chi-squared statistic and its p-value. When <code>method = "fchisq"</code>, the p-value is computed using the chi-squared distribution; when <code>method = "nfchisq"</code>, a normalized statistic is obtained by shifting and scaling the original chi-squared statistic and a p-value is computed using the standard normal distribution (Box et al. 2005). The normalized test is more conservative on the degrees of freedom.
</p>


<h3>Value</h3>

<p>A list with class "<code>htest</code>" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the conditional functional chi-squared statistic if <code>method = "fchisq"</code>; or the normalized conditional functional chi-squared statistic if <code>method = "nfchisq"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>degrees of freedom for the conditional functional chi-squared statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the conditional functional test. If <code>method = "fchisq"</code>, the p-value is computed by an asymptotic chi-squared distribution; if <code>method = "nfchisq"</code>, the p-value is computed by the standard normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>an estimate of the conditional function index between 0 and 1. The value of 1 indicates strong functional dependency between <code>x</code> and <code>y</code>, given <code>z</code>. It is asymmetrical with respect to whether <code>x</code> was chosen as the cause of effect <code>y</code> or vice versa.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sajal Kumar and Mingzhou Song
</p>


<h3>References</h3>

<p>Box GE, Hunter JS, Hunter WG (2005).
<em>Statistics for Experimenters: Design, Innovation and Discovery</em>, 2nd edition.
Wiley-Interscience, New York.<br><br> Zhang Y (2014).
<em>Nonparametric Statistical Methods for Biological Network Inference</em>.
Ph.D. thesis, Department of Computer Science, New Mexico State University, Las Cruces, NM, USA.
</p>


<h3>See Also</h3>


<p>See (unconditional) functional chi-squared test <code>fun.chisq.test</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a relationship between variables X and Z
xz = matrix(c(30,2,2, 2,2,40, 2,30,2),ncol=3,nrow=3,
            byrow = TRUE)
# Re-construct X
x = rep(c(1:nrow(xz)),rowSums(xz))
# Re-construct Z
z = c()
for(i in 1:nrow(xz))
  z = c(z,rep(c(1:ncol(xz)),xz[i,]))

# Generate a relationship between variables Z and Y
# Make sure Z retains its distribution
zy = matrix(c(4,30, 30,4, 4,40),ncol=2,nrow=3,
            byrow = TRUE)
# Re-construct Y
y = rep(0,length(z))
for(i in unique(z))
  y[z==i] = rep(c(1:ncol(zy)),zy[i,])

# Tables
table(x,z)
table(z,y)
table(x,y)

# Conditional functional dependency
# Y = f(X) | Z should be false
cond.fun.chisq.test(x=x,y=y,z=z)
# Z = f(X) | Y should be true
cond.fun.chisq.test(x=x,y=z,z=y)
# Y = f(Z) | X should be true
cond.fun.chisq.test(x=z,y=y,z=x)
</code></pre>


</div>