<div class="container">

<table style="width: 100%;"><tr>
<td>plot.funspace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional space plotting</h2>

<h3>Description</h3>

<p>Takes a <code>funspace</code> object produced by <code>funspace()</code> or <code>funspaceGAM()</code> and plots the trait probability distribution (TPD) or the map of the response variable (depending of which kind of funspace object is provided) in a functional space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'funspace'
plot(
  x = NULL,
  type = "global",
  which.group = NULL,
  quant.plot = FALSE,
  quant = NULL,
  quant.lty = 1,
  quant.col = "grey30",
  quant.lwd = 1,
  quant.labels = TRUE,
  colors = NULL,
  ncolors = 100,
  pnt = FALSE,
  pnt.pch = 19,
  pnt.cex = 0.5,
  pnt.col = "grey80",
  arrows = FALSE,
  arrows.length = 1,
  arrows.head = 0.08,
  arrows.col = "black",
  arrows.label.col = "black",
  arrows.label.pos = 1.1,
  arrows.label.cex = 1,
  axis.title = TRUE,
  axis.title.x = NULL,
  axis.title.y = NULL,
  axis.title.cex = 1,
  axis.title.line = 2,
  axis.cex = 1,
  globalContour = TRUE,
  globalContour.quant = NULL,
  globalContour.lwd = 3,
  globalContour.lty = 1,
  globalContour.col = "grey50",
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>funspace</code> object produced by <code>funspace()</code> or <code>funspaceGAM()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character indicating whether the plots should represent the global distribution of observations (<code>type = "global"</code>), or be separated by the groups (<code>type = "groups"</code>) provided when the <code>funspace</code> object was created. Defaults to <code>"global"</code>. In the case of funspace objects based on a TPD function created with the <code>TPD</code> package, only groups are plotted (there is no "global" distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.group</code></td>
<td>
<p>when plotting groups, either a character or a number indicating the name (character) or position (number) of a single group to be plotted individually.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.plot</code></td>
<td>
<p>Logical, Default is <code>TRUE</code>. Should contour lines representing quantiles (specified in <code>quant</code>) be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>A vector specifying the quantiles to be plotted (in case <code>quant.plot</code> is set to <code>TRUE</code>. In case a TPD function is plotted, the quantiles represent the quantiles of the trait probability density function (lower quantiles indicate areas with higher probability density). In case a GAM object is plotted, the quantiles of the fitted response variable are plotted. In case a TPD function is plotted, default quantiles are 0.99 (or the selected threshold if it is lower), 0.5 and 0.25. In the GAM alternative, default quantiles are 0.99, 0.5 and 0.25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.lty</code></td>
<td>
<p>type of line to be used to represent quantiles. See <code>lty</code> argument in <code>graphics::par()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.col</code></td>
<td>
<p>Color to be used in the quantile lines. Defaults to <code>"grey30"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.lwd</code></td>
<td>
<p>Line width to be used in the quantile lines. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.labels</code></td>
<td>
<p>Logical, Default is <code>TRUE</code>. Should labels be added to quantile lines?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>A vector defining the colors of plotted quantiles in the TPD case. Only two colors need to be specified. The first color is automatically assigned to the highest quantile in <code>quantiles</code> (e.g. 0.99), the second color is assigned to the lowest quantile. These colors are then used to automatically generate a gradient from the greatest to the lowest quantile. Any color is admitted. Default is <code>NULL</code>, in which case <code>c("yellow", "red")</code> is used in case a trait probability density function is plotted and to <code>viridis::viridis(5)</code> in the GAM case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolors</code></td>
<td>
<p>number of colors to include in the color gradients set by <code>colors</code>. Defaults to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnt</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Should data points be added to the functional space?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnt.pch</code></td>
<td>
<p>Numerical. Graphical parameter to select the type of point to be drawn. Default is set to 19. See <code>pch</code> argument in <code>graphics::par()</code>..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnt.cex</code></td>
<td>
<p>Numerical. Graphical parameter to set the size of the points. Default is 0.5. See <code>cex</code> argument in <code>graphics::par()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnt.col</code></td>
<td>
<p>Graphical parameter to set the points color. Default is <code>"grey80"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. In case the functional space is based on a PCA, should the loadings of the original traits be represented by arrows in the functional space?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows.length</code></td>
<td>
<p>Numerical. Graphical parameter to set the length of the arrow  (see <code>arrows</code>). Lower values lead to shorter arrows, which can help to make arrows fit within the represented functional space. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows.head</code></td>
<td>
<p>Numerical. Graphical parameter to set the length of the arrow head (see <code>arrows</code>). Defaults to 0.08.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows.col</code></td>
<td>
<p>Graphical parameter to set the arrows color (see <code>arrows</code>). Default is <code>"black"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows.label.col</code></td>
<td>
<p>Graphical parameter to set the color of the arrows labels  color. Default is <code>"black"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows.label.pos</code></td>
<td>
<p>Numerical. Graphical parameter to set the position of the arrow labels with respect to the arrow heads. Default is 1.1, which draws arrow labels slightly beyond the arrow heads. A value of 1 means drawing labels on top of arrow heads.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows.label.cex</code></td>
<td>
<p>Numerical. Graphical parameter to set the size of arrow labels. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title</code></td>
<td>
<p>Logical. Default is <code>TRUE</code>. Should axes titles be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.x</code></td>
<td>
<p>Character. The title to be plotted in the x axis if <code>axis.title</code> is set to <code>TRUE</code>. If not specified, a default axis title is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.y</code></td>
<td>
<p>Character. The title to be plotted in the y axis if <code>axis.title</code> is set to <code>TRUE</code>. If not specified, a default axis title is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.cex</code></td>
<td>
<p>Numerical. Graphical parameter to set the size of the axes titles. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.line</code></td>
<td>
<p>Numerical. Graphical parameter to set the on which margin line to plot axes titles. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.cex</code></td>
<td>
<p>Numerical. Graphical parameter to set the size of the axes annotation. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalContour</code></td>
<td>
<p>Logical, Default is <code>TRUE</code>. Should a contour line representing the global distribution be plotted when <code>type</code> is set to <code>"groups"</code>. Adding a global contour lines provides a common reference for all groups and makes comparisons easier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalContour.quant</code></td>
<td>
<p>A vector specifying the quantiles to be plotted (in case <code>globalContour</code> is set to <code>TRUE</code>. Defaults to the threshold selected when the provided <code>funspace</code> object was originally created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalContour.lwd</code></td>
<td>
<p>Line width to be used in the global contour lines. Defaults to 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalContour.lty</code></td>
<td>
<p>type of line to be used to represent the global contour lines. See <code>lty</code> argument in <code>graphics::par()</code>. Defaults to 1 (a continuous line).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalContour.col</code></td>
<td>
<p>Graphical parameter to set the color of the global contour lines. Default is <code>"grey50"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the y limits (y1, y2) of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces default plots. If the input object was generated with <code>funspace()</code>, the plot shows a bivariate functional trait space displaying trait probability densities (for single or multiple groups). If the input object was  generated with <code>funspaceGAM</code>, the plot shows a heatmap depicting how a target variable is distributed within the functional trait space (for single or multiple groups).
</p>


<h3>Value</h3>

<p>No return value. This function is called for its side effect: generating plots.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- princomp(GSPFF)
funtest &lt;- funspace(x = x, PCs = c(1, 2), threshold = 0.95)
plot(funtest, type = "global", quant.plot = TRUE, quant.lwd = 2, pnt = TRUE, pnt.cex = 0.1,
   pnt.col = rgb(0.1, 0.8, 0.2, alpha = 0.2), arrows = TRUE, arrows.length = 0.7)

</code></pre>


</div>