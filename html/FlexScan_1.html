<div class="container">

<table style="width: 100%;"><tr>
<td>flexscan</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Flexible Scan Statistics</h2>

<h3>Description</h3>

<p>An easy way to conduct flexible scan. Monte-Carlo method is used to test the spatial clusters given the cases, population, and shapefile. A table with formal style and a map with clusters are included in the result report. The method can be referenced at: Toshiro Tango and Kunihiko Takahashi (2005) &lt;doi:10.1186/1476-072X-4-11&gt;.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flexscan(map,case,pop,nsim,k,alpha,isplot,col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>spatial object, typically a shapefile read in using 'rgdal::readOGR'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>numeric, a vector of number of cases for each region of 'map'; it is noteworthy that the order of regions in 'case' is corresponding to that in 'map'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>numeric, a vector of number of population for each region of 'map'; it is noteworthy that the order of regions in 'pop' is corresponding to that in 'map'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>numeric, the number of simulations for Monte Carlo test; the default is 999</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>numeric, the maximum number of regions allowed for clusters; the default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric, the significance level of flexible scan test; the default is 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isplot</code></td>
<td>
<p>logical, wether to plot the results; the default is 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color vector, two colors for most likely cluster and secondary cluster; the default is c("red","blue")</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.frame</code></td>
<td>
<p>a data.frame containing 8 variables as follows:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cluster Type</code></td>
<td>
<p>most likely cluster or secondary cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Region ID</code></td>
<td>
<p>region id for each cluster; it is noteworthy that the 'ID' is the order of regions in 'map'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Observed Cases</code></td>
<td>
<p>observed cases for each cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Expected Cases</code></td>
<td>
<p>expected cases for each cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SR</code></td>
<td>
<p>standardized ratio of observed to expected cases</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p>relative risk for each cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LLR</code></td>
<td>
<p>loglikelihood ratio for each cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P Value</code></td>
<td>
<p>p value of likelihood ratio test for each cluster</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Please feel free to contact us, if you have any advice and find any bug!
</p>
<p>Reference:
</p>
<p>Tango, T. &amp; Takahashi, K. A Flexibly Shaped Spatial Scan Statistic for Detecting Clusters. INT J HEALTH GEOGR. 4, 11 (2005).
</p>
<p>Updates:
</p>
<p>Version 0.2.0: Fix the bugs according to the dependent package of "smerc" version 1.1
</p>
<p>Version 0.2.2: Fix the bugs according to the dependent package of "spdep"
</p>


<h3>Author(s)</h3>

<p>Zhicheng Du&lt;dgdzc@hotmail.com&gt;, Yuantao Hao&lt;haoyt@mail.sysu.edu.cn&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(map)
  data(sample)
  # simple example for checks; turn the warnings back on using 'options(warn=0)'
  options(warn=-1)
  flexscan(map,case=sample$case,pop=sample$pop,k=3,isplot=FALSE,nsim=10)
## Not run: 
 flexscan(map,case=sample$case,pop=sample$pop)

## End(Not run)
</code></pre>


</div>