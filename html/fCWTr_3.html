<div class="container">

<table style="width: 100%;"><tr>
<td>fcwt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast continuous wavelet transform</h2>

<h3>Description</h3>

<p>The core function of this package making use of the fCWT library. It processes
an input signal in form of a real valued numeric vector interpreted as an
evenly spaced time series and returns the absolute values of a spectogram,
i.e. a graph with a time and a frequency dimension.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fcwt(
  signal,
  sample_freq,
  n_freqs,
  freq_begin = 2 * sample_freq/length(signal),
  freq_end = sample_freq/2,
  sigma = 1,
  remove_coi = TRUE,
  n_threads = 2L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p>Real-valued time series. The time steps are assumed to be evenly spaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_freq</code></td>
<td>
<p>Sampling rate of input time series. This number primarily establishes
a connection to physical units which is used in other frequency definitions
as well as the units of the output data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_freqs</code></td>
<td>
<p>Number of frequency bins generated by the CWT. The frequencies
are linearly distributed. Computation time increases when raising the
number of frequency bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq_begin, freq_end</code></td>
<td>
<p>Optionally specifies the frequency range <code style="white-space: pre;">⁠[freq_end, freq_begin]⁠</code>. If not
specified the maximal meaningful frequency range, depending on the input signal,
is taken.
The range and <code>sample_freq</code> need to be specified in the same units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Sets a dimensionless parameter modifying the wavelet spread which in the
time-domain is roughly given by <code class="reqn">\Sigma_t \sim \sqrt{2} \frac{\sigma}{f}</code>.
Changing this parameter adjusts the time/frequency uncertainty balance.
Defaults to 1.
Larger (lower) value of sigma corresponds to a better (worse) frequency
resolution and a worse (better) time resolution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_coi</code></td>
<td>
<p>Boundary effects can result in nonphysical artifacts. If <code>remove_coi = TRUE</code>,
those are effectively removed by setting corresponding values to <code>NA</code>.
We define the essential support of the
(Gaussian) wavelet to be four times its standard deviation,
<code class="reqn">4 \Sigma_t = 2 * \sqrt{2} \frac{\sigma}{f}</code>, and so a wavelet touches
the boundary if the distance of the center of the wavelet to the boundary
is less then <code class="reqn">4 \Sigma_t</code>. Values that fall into that range are removed
if <code>remove_coi = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_threads</code></td>
<td>
<p>Number of threads used by the computation, if supported by your platform.
Defaults to 2 threads (to accomodate CRAN requirements).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The wavelet used in this calculation is the so called Morlet wavelet,
a sinusoidal wave modulated by a Gaussian whose spread is controlled by
the argument <code>sigma</code>.
</p>
<p>See the original paper
Arts, L.P.A., van den Broek, E.L.
The fast continuous wavelet transformation (fCWT) for real-time, high-quality,
noise-resistant time–frequency analysis.
Nat Comput Sci 2, 47–58 (2022). <a href="https://doi.org/10.1038/s43588-021-00183-z">doi:10.1038/s43588-021-00183-z</a>
</p>


<h3>Value</h3>

<p>The spectogram, a numeric real-valued matrix with dimensions
<code>dim = c(length(signal), n_freqs)</code>.
This matrix is wrapped into a S3-class <code>fcwtr_scalogram</code> so that plotting and
coercion functions can be used conveniently.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ts_sin_440 &lt;- sin((1:5000) * 2 * pi * 440 / 44100)

res &lt;-
  fcwt(
    ts_sin_440,
    sample_freq = 44100,
    freq_begin = 50,
    freq_end = 1000,
    n_freqs = 10,
    sigma = 5
  )
</code></pre>


</div>