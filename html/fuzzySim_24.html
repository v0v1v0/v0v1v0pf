<div class="container">

<table style="width: 100%;"><tr>
<td>multTSA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Trend Surface Analysis for multiple species
</h2>

<h3>Description</h3>

<p>This function performs trend surface analysis for one or more species at a time. It converts categorical presence-absence (1-0) data into continuous surfaces denoting the spatial trend in species' occurrence patterns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multTSA(data, sp.cols, coord.cols, id.col = NULL, degree = 3,
step = TRUE, criterion = "AIC", type = "P", Favourability = FALSE,
suffix = "_TS", save.models = FALSE, verbosity = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a matrix or data frame containing, at least, two columns with spatial coordinates, and one column per species containing their presence (1) and absence (0) data, with localities in rows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.cols</code></td>
<td>

<p>names or index numbers of the columns containing the species presences and absences in data. Must contain only zeros (0) for absences and ones (1) for presences.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord.cols</code></td>
<td>

<p>names or index numbers of the columns containing the spatial coordinates in data (x and y, or longitude and latitude, in this order!).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.col</code></td>
<td>

<p>optionally, the name or index number of a column (to be included in the output) containing locality identifiers in data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>

<p>the degree of the spatial polynomial to use (see Details). The default is 3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>

<p>logical value indicating whether the regression of presence-absence on the spatial polynomial should do a stepwise inclusion of the polynomial terms (using the <code>step</code> function with default settings, namely backward AIC selection), rather than forcing all terms into the equation. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>

<p>character value indicating whether the backward stepwise selection of variables (if step = TRUE) should be made according to "AIC" (the default, using the <code>step</code> function) or to "significance" (using the <code>modelTrim</code> function).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>the type of trend surface to obtain. Can be either "Y" for the raw polynomial equation (i.e. in the scale of the predictors, e.g. if you want to use the spatial trend as a predictor variable in a model), "P" for the logit-transformed probability (e.g. if you want to use the output as a prediction of presence probability based on spatial trend alone), or "F" for spatial favourability, i.e., prevalence-independent probability (see <code>Fav</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Favourability</code></td>
<td>

<p>deprecated argument; 'type' should now be used instead, although (at least for the timebeing) this will still be accepted (with Favourability=TRUE internally resulting in type="F") for back-compatibility.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>

<p>character indicating the suffix to add to the trend surface columns in the resulting data frame. The default is "_TS".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.models</code></td>
<td>

<p>logical value indicating whether the models obtained from the regressions should be saved and included in the output. The default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>

<p>integer value indicating the amount of messages to display; currently meaningful values are 0, 1, and 2 (the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>modelTrim</code> (if step = TRUE and criterion = "significance").
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Trend Surface Analysis is a way to model the spatial structure in species' distributions by regressing occurrence data on the spatial coordinates x and y, for a linear trend, or on polynomial terms of these coordinates (x^2, y^2, x*y, etc.), for curvilinear trends (Legendre &amp; Legendre, 1998; Borcard et al., 2011). Second- and third-degree polynomials are often used. 'multTSA' allows specifying the degree of the spatial polynomial to use. By default, it uses a 3rd-degree polynomial and performs stepwise AIC selection of the polynomial terms to include.
</p>


<h3>Value</h3>

<p>This function returns a matrix or data frame containing the identifier column (if provided in 'id.col') and one column per species containing the value predicted by the trend surface analysis. If save.models = TRUE, the output is a list containing this dataframe plus a list of the model objects.
</p>


<h3>Author(s)</h3>

<p>A. Marcia Barbosa
</p>


<h3>References</h3>

<p>Borcard D., Gillet F. &amp; Legendre P. (2011) Numerical Ecology with R. Springer, New York.
</p>
<p>Legendre P. &amp; Legendre L. (1998) Numerical Ecology. Elsevier, Amsterdam.
</p>


<h3>See Also</h3>

<p><code>distPres</code>, <code>poly</code>, <code>multGLM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(rotif.env)

head(rotif.env)

names(rotif.env)

tsa &lt;- multTSA(rotif.env, sp.cols = 18:20,
coord.cols = c("Longitude", "Latitude"), id.col = 1)

head(tsa)
</code></pre>


</div>