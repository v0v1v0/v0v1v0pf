<div class="container">

<table style="width: 100%;"><tr>
<td>GevModelling</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Extreme Value Modelling</h2>

<h3>Description</h3>

<p>A collection and description functions to estimate 
the parameters of the GEV distribution. To model
the GEV three types of approaches for parameter 
estimation are provided: Maximum likelihood
estimation, probability weighted moment method,
and estimation by the MDA approach. MDA includes
functions for the Pickands, Einmal-Decker-deHaan, 
and Hill estimators together with several plot 
variants.
<br></p>
<p>The GEV modelling functions are:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>gevSim</code> </td>
<td style="text-align: left;"> generates data from the GEV distribution, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>gumbelSim</code> </td>
<td style="text-align: left;"> generates data from the Gumbel distribution, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>gevFit</code> </td>
<td style="text-align: left;"> fits data to the GEV distribution, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>gumbelFit</code> </td>
<td style="text-align: left;"> fits data to the Gumbel distribution, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>print</code> </td>
<td style="text-align: left;"> print method for a fitted GEV object, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>plot</code> </td>
<td style="text-align: left;"> plot method for a fitted GEV object, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>summary</code> </td>
<td style="text-align: left;"> summary method for a fitted GEV object, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>gevrlevelPlot</code> </td>
<td style="text-align: left;"> k-block return level with confidence intervals. </td>
</tr>
</table>
<h3>Usage</h3>

<pre><code class="language-R">gevSim(model = list(xi = -0.25, mu = 0, beta = 1), n = 1000, seed = NULL)
gumbelSim(model = list(mu = 0, beta = 1), n = 1000, seed = NULL)

gevFit(x, block = 1, type = c("mle", "pwm"), title = NULL, description = NULL, ...)
gumbelFit(x, block = 1, type = c("mle", "pwm"), title = NULL, description = NULL, ...)

## S4 method for signature 'fGEVFIT'
show(object)
## S3 method for class 'fGEVFIT'
plot(x, which = "ask", ...)
## S3 method for class 'fGEVFIT'
summary(object, doplot = TRUE, which = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>

<p>block size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>

<p>a character string which allows for a brief description.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doplot</code></td>
<td>

<p>a logical. Should the results be plotted?
<br>
[shaparmPlot] - <br>
a vector of logicals of the same lengths as tails
defining for which tail depths plots should be created,
by default plots will be generated for a tail depth of 5
percent. By default <code>c(FALSE, FALSE, FALSE, FALSE, 
        TRUE, FALSE, FALSE, FALSE, FALSE, FALSE)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>[gevSim][gumbelSim] - <br>
a list with components <code>shape</code>, <code>location</code> and 
<code>scale</code> giving the parameters of the GEV distribution.
By default the shape parameter has the value -0.25, the
location is zero and the scale is one.
To fit random deviates from a Gumbel distribution set 
<code>shape=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>[gevSim][gumbelSim] - <br>
number of generated data points, an integer value.
<br>
[rgev] - <br>        
the number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>[summary][grlevelPlot] - <br>
a fitted object of class <code>"gevFit"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>[gevSim] - <br>
an integer value to set the seed for the random number generator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>[gevFit] - <br>
a character string which allows for a project title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>a character string denoting the type of parameter estimation,
either by maximum likelihood estimation <code>"mle"</code>, the
default value, or by the probability weighted moment method
<code>"pwm"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>[plot][summary] - <br>
a vector of logicals, one for each plot, denoting which plot 
should be displayed. Alternatively if <code>which="ask"</code> the
user will be interactively asked which of the plots should be
displayed. By default <code>which="all"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>[dgev][devd] - <br>
a numeric vector of quantiles.
<br>
[gevFit] - <br>
data vector. In the case of <code>method="mle"</code> the interpretation 
depends on the value of block: if no block size is specified then 
data are interpreted as block maxima; if block size is set, then data
are interpreted as raw data and block maxima are calculated. 
<br>
[hillPlot][shaparmPlot] - <br>
the data from which to calculate the shape parameter, a
numeric vector.
<br>
[print][plot] - <br>
a fitted object of class <code>"gevFit"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi, mu, beta</code></td>
<td>

<p>[*gev] - <br><code>xi</code> is the shape parameter, <code>mu</code> the location parameter,
and <code>beta</code> is the scale parameter. The default values are 
<code>xi=1</code>, <code>mu=0</code>, and <code>beta=1</code>. Note, if <code>xi=0</code> 
the distribution is of type Gumbel.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>[gevFit] - <br>
control parameters optionally passed to the 
optimization function. Parameters for the optimization
function are passed to components of the <code>control</code> argument of
<code>optim</code>. 
<br>
[hillPlot] - <br>
other graphics parameters.
<br>
[plot][summary] - <br>
arguments passed to the plot function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Parameter Estimation:</b>
<br><br><code>gevFit</code> and <code>gumbelFit</code> estimate the parameters either 
by the probability weighted moment method, <code>method="pwm"</code> or 
by maximum log likelihood estimation <code>method="mle"</code>. The 
summary method produces diagnostic plots for fitted GEV or Gumbel 
models.
<br></p>
<p><b>Methods:</b>
<br><br><code>print.gev</code>, <code>plot.gev</code> and <code>summary.gev</code> are
print, plot, and summary methods for a fitted object of class 
<code>gev</code>. Concerning the summary method, the data are 
converted to unit exponentially distributed residuals under null 
hypothesis that GEV fits. Two diagnostics for iid exponential data 
are offered. The plot method provides two different residual plots 
for assessing the fitted GEV model. Two diagnostics for 
iid exponential data are offered. 
<br></p>
<p><b>Return Level Plot:</b>
<br><br><code>gevrlevelPlot</code> calculates and plots the k-block return level 
and 95% confidence interval based on a GEV model for block maxima, 
where <code>k</code> is specified by the user. The k-block return level 
is that level exceeded once every <code>k</code> blocks, on average. The 
GEV likelihood is reparameterized in terms of the unknown return 
level and profile likelihood arguments are used to construct a 
confidence interval. 
<br></p>
<p><b>Hill Plot:</b>
<br><br>
The function <code>hillPlot</code> investigates the shape parameter and 
plots the Hill estimate of the tail index of heavy-tailed data, or 
of an associated quantile estimate. This plot is usually calculated 
from the alpha perspective. For a generalized Pareto analysis of 
heavy-tailed data using the <code>gpdFit</code> function, it helps to 
plot the Hill estimates for <code>xi</code>. 
<br></p>
<p><b>Shape Parameter Plot:</b>
<br><br>
The function <code>shaparmPlot</code> investigates the shape parameter and 
plots for the upper and lower tails the shape parameter as a function 
of the taildepth. Three approaches are considered, the <em>Pickands</em> 
estimator, the <em>Hill</em> estimator, and the
<em>Decker-Einmal-deHaan</em> estimator.
</p>


<h3>Value</h3>

<p><code>gevSim</code>
<br>
returns a vector of data points from the simulated series.
<br></p>
<p><code>gevFit</code>
<br>
returns an object of class <code>gev</code> describing the fit.
<br></p>
<p><code>print.summary</code>
<br>
prints a report of the parameter fit.
<br></p>
<p><code>summary</code>
<br>
performs diagnostic analysis. The method provides two different 
residual plots for assessing the fitted GEV model.  
<br></p>
<p><code>gevrlevelPlot</code>
<br>
returns a vector containing the lower 95% bound of the confidence 
interval, the estimated return level and the upper 95% bound. 
<br></p>
<p><code>hillPlot</code>
<br>
displays a plot.
<br></p>
<p><code>shaparmPlot</code> 
<br>
returns a list with one or two entries, depending on the
selection of the input variable <code>both.tails</code>. The two 
entries <code>upper</code> and <code>lower</code> determine the position of 
the tail. Each of the two variables is again a list with entries 
<code>pickands</code>, <code>hill</code>, and <code>dehaan</code>. If one of the 
three methods will be discarded the printout will display zeroes.
</p>


<h3>Note</h3>

<p><b>GEV Parameter Estimation:</b>
<br><br>
If method <code>"mle"</code> is selected the parameter fitting in <code>gevFit</code> 
is passed to the internal function <code>gev.mle</code> or <code>gumbel.mle</code>
depending on the value of <code>gumbel</code>, <code>FALSE</code> or <code>TRUE</code>.
On the other hand, if method <code>"pwm"</code> is selected the parameter 
fitting in <code>gevFit</code> is passed to the internal function 
<code>gev.pwm</code> or <code>gumbel.pwm</code> again depending on the value of 
<code>gumbel</code>, <code>FALSE</code> or <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Alec Stephenson for R's <code>evd</code> and <code>evir</code> package, and <br>
Diethelm Wuertz for this <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>-port.
</p>


<h3>References</h3>

<p>Coles S. (2001);
<em>Introduction to Statistical Modelling of Extreme Values</em>,
Springer.
</p>
<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997);
<em>Modelling Extremal Events</em>, 
Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## gevSim -
   # Simulate GEV Data, use default length n=1000
   x = gevSim(model = list(xi = 0.25, mu = 0 , beta = 1), n = 1000)
   head(x)

## gumbelSim -
   # Simulate GEV Data, use default length n=1000
   x = gumbelSim(model = list(xi = 0.25, mu = 0 , beta = 1))
     
## gevFit -
   # Fit GEV Data by Probability Weighted Moments:
   fit = gevFit(x, type = "pwm") 
   print(fit)
   
## summary -
   # Summarize Results:
   par(mfcol = c(2, 2))
   summary(fit)
</code></pre>


</div>