<div class="container">

<table style="width: 100%;"><tr>
<td>checkPairwise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check pedigree data for relationship errors</h2>

<h3>Description</h3>

<p>The <code>checkPairwise()</code> function provides a convenient way to check for
pedigree errors, given the available marker data. The function calls
<code>ibdEstimate()</code> to estimate IBD coefficients for all pairs of typed pedigree
members, and uses the estimates to test for potential errors. By default, the
results are shown in a colour-coded plot (based on <code>ribd::ibdTriangle()</code>)
where unlikely relationships are easy to spot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">checkPairwise(
  x,
  ids = typedMembers(x),
  excludeInbred = TRUE,
  plotType = c("base", "ggplot2", "plotly", "none"),
  GLRthreshold = 1000,
  pvalThreshold = NULL,
  nsim = 0,
  seed = NULL,
  plot = TRUE,
  verbose = TRUE,
  ...
)

plotCP(
  cpRes,
  plotType = c("base", "ggplot2", "plotly"),
  labels = FALSE,
  errtxt = "Potential error",
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped</code> object or a list of such.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>A vector of ID labels; the individuals to include in the check.
Default: All typed members of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excludeInbred</code></td>
<td>
<p>A logical, by default TRUE, indicating if inbred
individuals should be excluded from the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>Either "base" (default), "ggplot2", "plotly" or "none".
Abbreviations are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GLRthreshold</code></td>
<td>
<p>A positive number, by default 1000. Threshold for the
generalised likelihood ratio (see Details). Scores exceeding this are
flagged as potential errors in the output table and encircled in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalThreshold</code></td>
<td>
<p>A positive number, or NULL (default). If given, this is
used instead of <code>GLRthreshold</code> to identify potential errors. Ignored if
<code>nsim = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>A nonnegative number; the number of simulations used to estimate
p-values. If 0 (default), this step is skipped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer seed for the random number generator (optional, and
only relevant if <code>nsim &gt; 0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Deprecated. To suppress the triangle plot, use <code>plotType = "none"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed on to <code>ribd::ibdTriangle()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpRes</code></td>
<td>
<p>A data frame: the output from <code>checkPairwise()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>A logical (default: FALSE). If TRUE, labels are included in the
IBD triangle plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errtxt</code></td>
<td>
<p>A character string to use for the error legend.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To identify potential pedigree errors, the function calculates the
<em>generalised likelihood ratio</em> (GLR) of each pairwise relationship.
This compares the likelihood of the estimated coefficients with that of the
coefficients implied by the pedigree. By default, relationships whose GLR
exceed 1000 are flagged as errors and shown with a circle in the plot.
Alternatively, if arguments <code>nsim</code> and <code>pvalThreshold</code> are supplied, the
p-value of each score is estimated by simulation, and used as threshold for
calling errors.
</p>
<p>By default, inbred individuals are excluded from the analysis, since pairwise
relationships involving inbred individuals have undefined kappa coefficients
(and therefore no position in the triangle). In some cases it may still be
informative to include their estimates; set <code>excludeInbred = FALSE</code> to
enforce this.
</p>


<h3>Value</h3>

<p>If <code>plotType</code> is "none" or "base": A data frame containing both the
estimated and pedigree-based IBD coefficients for each pair of typed
individuals. The last columns (<code>GLR</code>, <code>pval</code> and <code>err</code>) contain test
results using the GLR scores to identify potential pedigree errors.
</p>
<p>If <code>plotType</code> is "ggplot2" or "plotly", the plot objects are returned.
</p>


<h3>See Also</h3>

<p><code>ibdEstimate()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Example with realistic data

x = avuncularPed() |&gt;
  profileSim(markers = NorwegianFrequencies, seed = 1729)

checkPairwise(x)

### Create an error: sample swap 1 &lt;-&gt; 3
als = getAlleles(x)
als[c(1,3), ] = als[c(3,1), ]
y = setAlleles(x, alleles = als)

checkPairwise(y)

# Using p-values instead of GLR
nsim = 10 # increase!
checkPairwise(y, nsim = nsim, pvalThreshold = 0.05)

# Plot can be done separately
res = checkPairwise(y, nsim = nsim, pvalThreshold = 0.05, plotType = "none")
plotCP(res, plotType = "base", errtxt = "Not good!")


# Combined plot of pedigree and check results
dev.new(height = 5, width = 8, noRStudioGD = TRUE)
layout(rbind(1:2), widths = 2:3)
plot(y, margins = 2, title = "Swapped 1 - 3")
plotCP(res, labels = TRUE)


</code></pre>


</div>