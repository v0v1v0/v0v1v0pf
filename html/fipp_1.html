<div class="container">

<table style="width: 100%;"><tr>
<td>dbnb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability density function of the BNB distribution</h2>

<h3>Description</h3>

<p>Evaluates the probability density function of the
beta-negative-binomial (BNB) distribution with a mean parameter and
two shape parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dbnb(x, mu, a, b, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>mean parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>1st shape parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>2nd shape parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, density values p are given as log(p).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The BNB distribution has density
</p>
<p style="text-align: center;"><code class="reqn">
  f(x) = \frac{\Gamma(\mu + x) B(\mu + a, x + b)}{\Gamma(\mu) \Gamma(x + 1) B(a, b)},
</code>
</p>

<p>where <code class="reqn">\mu</code> is the mean parameter and <code class="reqn">a</code> and <code class="reqn">b</code> are the first and
second shape parameter.
</p>


<h3>Value</h3>

<p>Numeric vector of density values.
</p>


<h3>References</h3>

<p>Frühwirth-Schnatter, S., Malsiner-Walli, G., and Grün, B. (2020)
Generalized mixtures of finite mixtures and telescoping sampling
<a href="https://arxiv.org/abs/2005.09918">https://arxiv.org/abs/2005.09918</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Similar to other d+DISTRIBUTION_NAME functions such as dnorm, it
## evaluates the density of a distribution (in this case the BNB distri)
## at point x
##
## Let's try with the density of x = 1 for BNB(1,4,3)
x &lt;- 1
dbnb(x, mu = 1, a = 4, b = 3)

## The primary use of this function is in the closures returned from
## fipp() or nCluststers() as a prior on K-1
pmf &lt;- nClusters(Kplus = 1:15, N = 100, type = "static",
gamma = 1, maxK = 150)

## Now evaluate above when K-1 ~ BNB(1,4,3)
pmf(priorK = dbnb, priorKparams = list(mu = 1, a = 4, b = 3))

## Compare the result with the case when K-1 ~ Pois(1)
pmf(priorK = dpois, priorKparams = list(lambda = 1))

## Although both BNB(1,4,3) and Pois(1) have 1 as their mean, the former
## has a fatter rhs tail. We see that it is reflected in the induced prior 
## on K+ as well

</code></pre>


</div>