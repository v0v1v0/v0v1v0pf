<div class="container">

<table style="width: 100%;"><tr>
<td>testforecast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare locally stationary forecasting with Box-Jenkins-type
forecasting, by predicting the final values of a time series.
</h2>

<h3>Description</h3>

<p>A good way of evaluating a forecasting method is to
apply the method to most of a series (apart from the last few values)
to forecast those last few values. Then, the forecasts and the true
values can be compared to see how good the forecast is. This function
performs this for the locally stationary forecasting based
on wavelet processes in <code>forecastlpacf</code> and
a version of the Box-Jenkins forecasting, and also produces
both plots and returns results of the testing.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testforecast(x, n.to.test, go.back=0,  plot.it = TRUE, regularize = TRUE, 
    lag.max = max(10, 2 * n.to.test), truth.pch = 23, truth.col = 3, zoom = TRUE, 
    zoom.no = 30, forecast.type = NULL, conf.level = 0.95, stycol = 6, silent = TRUE,
	  lapplyfn=lapply, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The time series you want to use in testing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.to.test</code></td>
<td>
<p>Suppose the length of <code>x</code> is T. This function
uses the first T-<code>n.to.test</code> observations to predict the
last <code>n.to.test</code> observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>go.back</code></td>
<td>
<p>If <code>go.back=0</code> then a single forecasting operation
forecasting the last n.to.test observations from the previous
data is conducted. If <code>go.back</code> is an integer greater than
zero then the same forecasting as with <code>go.back</code> occurs but
each time the end of the series is moved back one point. This
shifting back occurs from one shift to <code>go.back</code> shifts.
The purpose of this is to repeat the exercise for using previous
data to forecast <code>n.to.test</code> points at the end of the
series, but to then repeat this for the series one step earlier,
then two steps earlier, ..., back to <code>go.back</code> steps earlier.
The results of each forecast are combined into an overall
root-mean-squared error result for each forecast horizon (there
will be <code>n.to.test</code> values) for both of the Box-Jenkins
and the new forecast methodology provided by 
<code>forecastlpacf</code>. These additionally forecasts
will be computed in parallel if the <code>parallel</code> package
is loaded and <code>mclapply</code> is used as an argument to
<code>lapplyfn</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>If <code>TRUE</code> a plot is produced showing the original
time series, the stationary and locally stationary forecasts,
and their prediction intervals.  If <code>FALSE</code> then no plot
is produced.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regularize</code></td>
<td>
<p>Passed through to <code>forecastlpacf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.max</code></td>
<td>
<p>Passed through to <code>forecastlpacf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truth.pch</code></td>
<td>
<p>The type of plotting character used for the true
values, see <code>pch</code> argument to <code>points</code> function in R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truth.col</code></td>
<td>
<p>Colour of plot symbol used for true values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zoom</code></td>
<td>
<p>Typically, we're interested in the later values of a time
series when doing forecasting. If this argument is <code>TRUE</code>
then only the last <code>zoom.no</code> observations are plotted, so one
can focus on the end of the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zoom.no</code></td>
<td>
<p>If <code>zoom=TRUE</code> then this argument controls how much
of the end of the series is plotted.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forecast.type</code></td>
<td>
<p>Passed through to <code>forecastlpacf</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Controls the width of the prediction intervals for
both stationary and nonstationary forecasting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stycol</code></td>
<td>
<p>The colour of both the stationary forecasts and their
confidence intervals. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>If <code>TRUE</code> then nothing gets printed, otherwise
messages get printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lapplyfn</code></td>
<td>
<p>For single-processor use this argument should
be <code>lapply</code> (the default). However, you can set the argument 
to <code>mclapply</code> if you have the <code>parallel</code> package loaded.
Remember to set the number of processors you want to use
with the <code>mc.cores</code> option, e.g. <code>options(mc.cores=4)</code>
if you had four cores available.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to the <code>forecastlpacf</code> call</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose <code>n.to.test=1</code>. Then this function uses all the values of
the time series <code>x</code> apart from the last to generate two forecasts
of the last value. The two methods used to forecast are
the locally stationary method <code>forecastlpacf</code> and a Box-Jenkins
ARIMA alternative for stationary series coded in <code>fp.forecast</code>.
</p>
<p>Then, if <code>plot.it=TRUE</code> a plot of the time series <code>x</code> is produced,
overlaid with both types of forecast and their related prediction intervals
(the locally stationary ones are hached thin rectangles, the stationary
ones indicated by vertical &lt; &gt; symbols. The true value is also indicated
by a character whose visual characteristics are controlled by
the <code>truth.pch</code> and <code>truth.col</code> arguments, but by default
are a green diamond.
</p>
<p>If <code>n.to.test</code> is bigger than 1 then all of the data, apart from
the last <code>n.to.test</code> values are used in constructing the forecasts
(both stationary and locally stationary) for the last <code>n.to.test</code>
values.
</p>
<p>Values of the empirical root mean squared error of the two forecast
methods are printed out (unless <code>silent=TRUE</code>). The predictions
and their standard errors for the <code>n.to.test</code> values are printed out.
</p>


<h3>Value</h3>

<p>If <code>go.back=0</code> a matrix with <code>n.to.test</code>
values with four columns is returned. The
first column is the actual true value of the time series in the last
<code>n.to.test</code> positions. The second and fourth columns are the forecast
values from the locally stationary and stationary methods. The third column
are the locally stationary prediction error values.
</p>
<p>If <code>go.back</code> is a positive integer then a data frame with two
columns. The first column corresponds to stationary forecasting
using the standard Box-Jenkins type method encapsulated by
<code>fp.forecast</code>. The second column corresponds to
the locally stationary forecasting encapsulated by
<code>forecastlpacf</code>. Each row of the frame corresponds to
a different forecasting horizon, the horizon is indicated by
the row name of the data frame.
</p>


<h3>Author(s)</h3>

<p>G.P. Nason
</p>


<h3>References</h3>

<p>Killick, R., Knight, M.I., Nason, G.P., Nunes M.A., Eckley I.A. (2023) Automatic Locally Stationary Time Series Forecasting with
application to predicting U.K. Gross Value Added Time Series under sudden shocks caused by the COVID pandemic 
<a href="https://arxiv.org/abs/2303.07772">arXiv:2303.07772</a>
</p>


<h3>See Also</h3>

<p><code>forecastlpacf</code>,
<code>fp.forecast</code>,
<code>plot.forecastlpacf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Generate simulated time series from TVAR(2) model.
#
x.test &lt;- tvar2sim()
#
# Now run testforecast on this example time series.
# We've only supplied plot.it=FALSE because its in an R help page, normally
# you would set plot.it=TRUE, which is the default, because you want to see
# the plot.
#
tmp &lt;- testforecast(x.test, n.to.test=3, forecast.type="recursive",
	plot.it=FALSE)
</code></pre>


</div>