<div class="container">

<table style="width: 100%;"><tr>
<td>emfrail_pll</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Profile log-likelihood calculation</h2>

<h3>Description</h3>

<p>Profile log-likelihood calculation
</p>


<h3>Usage</h3>

<pre><code class="language-R">emfrail_pll(formula, data, distribution = emfrail_dist(), values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Same as in <code>emfrail</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Same as in <code>emfrail</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>Same as in <code>emfrail</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>A vector of values on where to calculate the profile likelihood. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can be used to calculate the profile log-likelihood for different values of <code class="reqn">\theta</code>.
The scale is that of <code>theta</code> as defined in <code>emfrail_dist()</code>.
For the gamma and pvf frailty, that is the inverse of the frailty variance.
</p>


<h3>Value</h3>

<p>The profile log-likelihood at the specific value of the frailty parameter
</p>


<h3>Note</h3>

<p>This function is just a simple wrapper for <code>emfrail()</code> with the <code>control</code> argument
a call from <code>emfrail_control</code> with the option <code>opt_fit = FALSE</code>. More flexibility can be obtained
by calling <code>emfrail</code> with this option, especially
for setting other <code>emfrail_control</code> parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
fr_var &lt;- seq(from = 0.01, to = 1.4, length.out = 20)
pll_gamma &lt;- emfrail_pll(formula = Surv(time, status) ~  rx + sex + cluster(litter),
 data =  rats,
 values = 1/fr_var )
 plot(fr_var, pll_gamma,
     type = "l",
     xlab = "Frailty variance",
     ylab = "Profile log-likelihood")

# check with coxph;
# attention: theta is the the inverse frailty variance in emfrail,
# but theta is the frailty variance in coxph.

pll_cph &lt;- sapply(fr_var, function(th)
  coxph(data =  rats, formula = Surv(time, status) ~ rx + sex + frailty(litter, theta = th),
        method = "breslow")$history[[1]][[3]])

lines(fr_var, pll_cph, col = 2)

# Same for inverse gaussian
pll_if &lt;- emfrail_pll(Surv(time, status) ~  rx + sex + cluster(litter),
                      rats,
                      distribution = emfrail_dist(dist = "pvf"),
                      values = 1/fr_var )

# Same for pvf with a positive pvfm parameter
pll_pvf &lt;- emfrail_pll(Surv(time, status) ~  rx + sex + cluster(litter),
                       rats,
                       distribution = emfrail_dist(dist = "pvf", pvfm = 1.5),
                       values = 1/fr_var )

miny &lt;- min(c(pll_gamma, pll_cph, pll_if, pll_pvf))
maxy &lt;- max(c(pll_gamma, pll_cph, pll_if, pll_pvf))

plot(fr_var, pll_gamma,
     type = "l",
     xlab = "Frailty variance",
     ylab = "Profile log-likelihood",
     ylim = c(miny, maxy))
points(fr_var, pll_cph, col = 2)
lines(fr_var, pll_if, col = 3)
lines(fr_var, pll_pvf, col = 4)

legend(legend = c("gamma (emfrail)", "gamma (coxph)", "inverse gaussian", "pvf, m=1.5"),
       col = 1:4,
       lty = 1,
       x = 0,
       y = (maxy + miny)/2)
</code></pre>


</div>