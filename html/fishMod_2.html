<div class="container">

<table style="width: 100%;"><tr>
<td>deltaLN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting models based on the Delta Log-Normal distribution.</h2>

<h3>Description</h3>

<p>Fits a compound model that assumes a Delta Log-Normal distribution. The mean of the log-normal process and the mean of the binary process are allowed to change with covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">deltaLN( ln.form, binary.form, data, residuals=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code> ln.form</code></td>
<td>
<p>an object of class "formula" (or one that can be coerced to that class). This is a symbolic representation of the model for the log-normal variable. Note that offset terms (if any) should be included in this part of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> binary.form</code></td>
<td>
<p>an object of class "formula" (or one that can be coerced to that class). This is a symbolic representation of the model for the binary variable and should not contain an outcome (e.g. ~1+var1+var2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> data</code></td>
<td>
<p>a data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> residuals</code></td>
<td>
<p>boolean indicating if the quantile residuals should be calculated. Default is TRUE indicating residuals are to be calculated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The observed random variables y_i are assumed to arise from a process that has a non-zero probability that y_i is greater than zero; further, the distribution of y_i conditional on y_i&gt;0 follows a log-normal distribution. This modelling framework models the mean of the conditional distribution and the probability of obtaining a non-zero.
</p>
<p>The means of each component of the model are specified in ln.form and binary.form for the log-normal and the zero/non-zero model components respectively. The binary.form formula should not contain an outcome. The binary part of the model is done using a logistic link funciton.
</p>
<p>If residuals are requested then two types are returned: Pearson residuals and randomised quantile residuals, described in general by Dunn and Smyth (1996).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code> pgm returns an object of class "DeltaLNmod", a list with the following elements</code></td>
<td>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> coef</code></td>
<td>
<p>the estiamted coefficients from the fitting process. A list with an element for the binary and log-normal parts of the model as well as an element for the standard deviation of the log-normal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> logl</code></td>
<td>
<p>the maximum log likelihood (found at the estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> AIC</code></td>
<td>
<p>an Information Criteria.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> BIC</code></td>
<td>
<p>Bayesian Information Criteria.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> fitted</code></td>
<td>
<p>fitted values of the delta log-normal variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> fitted.var</code></td>
<td>
<p>variance of the fitted delta log-normal variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> residuals</code></td>
<td>
<p>a 2-column matrix whose first column contains the randomised quantile residuals and whose second column contains the Pearson residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> n</code></td>
<td>
<p>the number of observations used to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> ncovars</code></td>
<td>
<p>the number of parameters in the combined model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> nzero</code></td>
<td>
<p>the number of non-zero elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> lnMod</code></td>
<td>
<p>the lm object obtained from fitting the log-normal (non-zero) part of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> binMod</code></td>
<td>
<p>the glm object obtained from fitting the zero / non-zero part of the model.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Scott D. Foster</p>


<h3>References</h3>

<p>Aitchison J. (1955) On the Distribution of a Positive Random Variable Having a Discrete Probability Mass at the Origin. <em>Journal of the American Statistical Association</em> <b>50</b> 901-908.
</p>
<p>Dunn P. K and Smyth G. K (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> <b>5</b>: 236-244.
</p>
<p>Foster, S.D. and Bravington, M.V. (2013) A Poisson-Gamma Model for Analysis of Ecological Non-Negative Continuous Data. <em>Journal of Environmental and Ecological Statistics</em> <b>20</b>: 533-552
</p>


</div>