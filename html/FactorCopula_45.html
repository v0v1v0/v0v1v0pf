<div class="container">

<table style="width: 100%;"><tr>
<td>Select.StructuredFactor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model selection of the bi-factor and second-order copula models for item response data</h2>

<h3>Description</h3>

<p>A heuristic algorithm that automatically selects the bivariate parametric copula families for the bi-factor and second-order copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class="language-R">selectBifactor(y, grpsize, copnames, gl)
selectSecond_order(y, grpsize, copnames, gl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the item reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames</code></td>
<td>
<p>A vector with the names of possible candidates of bivariate copulas to be selected for the bi-factor and second-order copula models for item response data. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The linking copulas at each factor are selected with a sequential algorithm under the initial assumption that linking copulas are BVN, and then sequentially copulas with tail dependence are assigned to any of pairs where necessary to account for tail asymmetry.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>“common factor”</code></td>
<td>
<p>The selected bivariate linking copulas for the common factor (Bi-factor: copulas link items with the common factor. Second-order: copulas link group-specific factors with the common factor).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>“group-specific factor”</code></td>
<td>
<p>The selected bivariate linking copulas for the items with group-speicifc factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log-likelihood</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br>
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132–157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#------------------------------------------------
# Setting quadreture points
nq &lt;- 15
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                     TAS Data
#------------------             -----------------
data(TAS)
#using a subset of the data
#group1: 1,3,6,7,9,13,14
grp1=c(1,3)
#group2: 2,4,11,12,17
grp2=c(2,4)
#group3: 5,8,10,15,16,18,19,20
grp3=c(5,8)
#Rearrange items within testlets
set.seed(123)
i=sample(1:nrow(TAS),500)
ydat=TAS[i,c(grp1,grp2,grp3)]

#size of each group
g1=length(grp1)
g2=length(grp2)
g3=length(grp3)
grpsize=c(g1,g2,g3)

# listing possible copula candidates:
copnames=c("bvt2","bvt3")

Bifactor_model = selectBifactor(ydat, grpsize, copnames, gl)

</code></pre>


</div>