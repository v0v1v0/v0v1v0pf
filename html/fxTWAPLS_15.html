<div class="container">

<table style="width: 100%;"><tr>
<td>TWAPLS.w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TWA-PLS training function</h2>

<h3>Description</h3>

<p>TWA-PLS training function, which can perform <code>fx</code> correction.
<code>1/fx^2</code> correction will be applied at step 7.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TWAPLS.w(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code>fx</code> function will be used when choosing "bin";
<code>fx_pspline</code> function will be used when choosing "pspline".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of the training results, which will be used by the predict
function. Each element in the list is described below:
</p>

<dl>
<dt><code>fit</code></dt>
<dd>
<p>the fitted values using each number of components.</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>the observed modern climate values.</p>
</dd>
<dt><code>taxon_name</code></dt>
<dd>
<p>the name of each taxon.</p>
</dd>
<dt><code>optimum</code></dt>
<dd>
<p>the updated taxon optimum</p>
</dd>
<dt><code>comp</code></dt>
<dd>
<p>each component extracted (will be used in step 7
regression).</p>
</dd>
<dt><code>u</code></dt>
<dd>
<p>taxon optimum for each component (step 2).</p>
</dd>
<dt><code>t</code></dt>
<dd>
<p>taxon tolerance for each component (step 2).</p>
</dd>
<dt><code>z</code></dt>
<dd>
<p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>s</code></dt>
<dd>
<p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>orth</code></dt>
<dd>
<p>a list that stores orthogonalization parameters
(step 4).</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>a list that stores regression coefficients (step 7).</p>
</dd>
<dt><code>meanx</code></dt>
<dd>
<p>mean value of the observed modern climate values.</p>
</dd>
<dt><code>nPLS</code></dt>
<dd>
<p>the total number of components extracted.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>fx</code>, <code>TWAPLS.predict.w</code>, and
<code>WAPLS.w</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Training
fit_t_Tmin &lt;- fxTWAPLS::TWAPLS.w(taxa, modern_pollen$Tmin, nPLS = 5)
fit_tf_Tmin &lt;- fxTWAPLS::TWAPLS.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

## End(Not run)

</code></pre>


</div>