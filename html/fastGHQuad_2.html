<div class="container">

<table style="width: 100%;"><tr>
<td>aghQuad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adaptive Gauss-Hermite quadrature using Laplace approximation</h2>

<h3>Description</h3>

<p>Convenience function for integration of a scalar function g based upon its
Laplace approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aghQuad(g, muHat, sigmaHat, rule, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Function to integrate with respect to first (scalar) argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muHat</code></td>
<td>
<p>Mode for Laplace approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaHat</code></td>
<td>
<p>Scale for Laplace approximation (<code>sqrt(-1/H)</code>, where H
is the second derivative of g at muHat)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>Gauss-Hermite quadrature rule to use, as produced by
<code>gaussHermiteData</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for g</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function approximates </p>
<p style="text-align: center;"><code class="reqn">\int_{-\infty}^{\infty} g(x) \, dx</code>
</p>
<p> using the method of Liu &amp; Pierce (1994). This
technique uses a Gaussian approximation of g (or the distribution component
of g, if an expectation is desired) to "focus" quadrature around the
high-density region of the distribution. Formally, it evaluates: </p>
<p style="text-align: center;"><code class="reqn">
\sqrt{2} \hat{\sigma} \sum_i w_i \exp(x_i^2) g(\hat{\mu} + \sqrt{2} </code>
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma} x_i) </code>
</p>
<p> where x and w come from the given rule.
</p>
<p>This method can, in many cases (where the Gaussian approximation is
reasonably good), achieve better results with 10-100 quadrature points than
with 1e6 or more draws for Monte Carlo integration. It is particularly
useful for obtaining marginal likelihoods (or posteriors) in hierarchical
and multilevel models â€” where conditional independence allows for
unidimensional integration, adaptive Gauss-Hermite quadrature is often
extremely effective.
</p>


<h3>Value</h3>

<p>Numeric (scalar) with approximation integral of g from -Inf to Inf.
</p>


<h3>Author(s)</h3>

<p>Alexander W Blocker <a href="mailto:ablocker@gmail.com">ablocker@gmail.com</a>
</p>


<h3>References</h3>

<p>Liu, Q. and Pierce, D. A. (1994). A Note on Gauss-Hermite
Quadrature. Biometrika, 81(3) 624-629.
</p>


<h3>See Also</h3>

<p><code>gaussHermiteData</code>, <code>ghQuad</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Get quadrature rules
rule10  &lt;- gaussHermiteData(10)
rule100 &lt;- gaussHermiteData(100)

# Estimating normalizing constants
g &lt;- function(x) 1/(1+x^2/10)^(11/2) # t distribution with 10 df
aghQuad(g, 0, 1.1,  rule10)
aghQuad(g, 0, 1.1,  rule100)
# actual is
1/dt(0,10)

# Can work well even when the approximation is not exact
g &lt;- function(x) exp(-abs(x)) # Laplace distribution
aghQuad(g, 0, 2,  rule10)
aghQuad(g, 0, 2,  rule100)
# actual is 2

# Estimating expectations
# Variances for the previous two distributions
g &lt;- function(x) x^2*dt(x,10) # t distribution with 10 df
aghQuad(g, 0, 1.1,  rule10)
aghQuad(g, 0, 1.1,  rule100)
# actual is 1.25

# Can work well even when the approximation is not exact
g &lt;- function(x) x^2*exp(-abs(x))/2 # Laplace distribution
aghQuad(g, 0, 2,  rule10)
aghQuad(g, 0, 2,  rule100)
# actual is 2
</code></pre>


</div>