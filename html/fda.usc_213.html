<div class="container">

<table style="width: 100%;"><tr>
<td>fEqDistrib.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tests for checking the equality of distributions between two functional populations.</h2>

<h3>Description</h3>

<p>Three tests for the equality of distributions of two populations are provided. The null hypothesis is that the two populations are the same
</p>


<h3>Usage</h3>

<pre><code class="language-R">XYRP.test(X.fdata, Y.fdata, nproj = 10, npc = 5, test = c("KS", "AD"))

MMD.test(
  X.fdata,
  Y.fdata,
  metric = "metric.lp",
  B = 1000,
  alpha = 0.95,
  kern = "RBF",
  ops.metric = list(lp = 2),
  draw = FALSE
)

MMDA.test(
  X.fdata,
  Y.fdata,
  metric = "metric.lp",
  B = 1000,
  alpha = 0.95,
  kern = "RBF",
  ops.metric = list(lp = 2),
  draw = FALSE
)

fEqDistrib.test(
  X.fdata,
  Y.fdata,
  metric = "metric.lp",
  method = c("Exch", "WildB"),
  B = 5000,
  ops.metric = list(lp = 2),
  iboot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X.fdata</code></td>
<td>
<p><code>fdata</code> object containing the curves from the first population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.fdata</code></td>
<td>
<p><code>fdata</code> object containing the curves from the second population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproj</code></td>
<td>
<p>Number of projections for <code>XYRP.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>The number of principal components employed for generating the random projections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>For <code>XYRP.test</code> "KS" and/or "AD" for computing Kolmogorov-Smirnov or Anderson-Darling p-values in the projections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>Character with the metric function for computing distances among curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap or Monte Carlo replicas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Confidence level for computing the threshold. By default =0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kern</code></td>
<td>
<p>For <code>MMDA.test</code> "RBF" or "metric" for indicating the use of Radial Basis Function or directly, the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ops.metric</code></td>
<td>
<p>List of parameters to be used with <code>metric</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>By default, FALSE. Plots the density of the bootstrap replicas jointly with the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>In <code>fEqDistrib.test</code> a character indicating the bootstrap method for computing the distribution under H0.
"Exch" for Exchangeable bootstrap and "WildB" for Wild Bootstrap. By default, both are provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iboot</code></td>
<td>
<p>In <code>fEqDistrib.test</code> returns the bootstrap replicas.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>XYRP.test</code> computes the p-values using random projections. Requires <code>kSamples</code> library. 
<code>MMD.test</code> computes Maximum Mean Discrepancy p-values using permutations (see Sejdinovic et al, (2013)) and <code>MMDA.test</code> 
does the same using an asymptotic approximation. 
<code>fEqDistrib.test</code> checks the equality of distributions using an embedding in a RKHS and two bootstrap approximations for 
calibration.
</p>


<h3>Value</h3>

<p>A list with the following components by function:
</p>

<ul>
<li> <p><code>XYRP.test</code>: <code>FDR.pv</code>: p-value using FDR, <code>proj.pv</code>: Matrix of p-values obtained for projections. 
</p>
</li>
<li> <p><code>MMD.test</code>,<code>MMDA.test</code>: <code>stat</code>: Statistic, <code>p.value</code>: p-value, <code>thresh</code>: Threshold at level <code>alpha</code>.
</p>
</li>
<li> <p><code>fEqDistrib.test</code>:  <code>result</code>: <code>data.frame</code> with columns <code>Stat</code> and <code>p.value</code>, 
<code>Boot</code>: <code>data.frame</code> with bootstrap replicas if <code>iboot=TRUE</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.febrero@usc.es">manuel.febrero@usc.es</a>
</p>


<h3>References</h3>

<p>Sejdinovic, D., Sriperumbudur, B., Gretton, A., Fukumizu, K. <em>Equivalence of distance-based and RKHS-based statistics in Hypothesis Testing</em> The Annals of Statistics, 2013. 
DOI <b>10.1214/13-AOS1140</b>.
</p>


<h3>See Also</h3>

<p><code>fmean.test.fdata, cov.test.fdata</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
tt=seq(0,1,len=51)
bet=0
mu1=fdata(10*tt*(1-tt)^(1+bet),tt)
mu2=fdata(10*tt^(1+bet)*(1-tt),tt) 
fsig=1
X=rproc2fdata(100,tt,mu1,sigma="vexponential",par.list=list(scale=0.2,theta=0.35))
Y=rproc2fdata(100,tt,mu2,sigma="vexponential",par.list=list(scale=0.2*fsig,theta=0.35))
fmean.test.fdata(X,Y,npc=-.98,draw=TRUE)
cov.test.fdata(X,Y,npc=5,draw=TRUE)
bet=0.1
mu1=fdata(10*tt*(1-tt)^(1+bet),tt)
mu2=fdata(10*tt^(1+bet)*(1-tt),tt) 
fsig=1.5
X=rproc2fdata(100,tt,mu1,sigma="vexponential",par.list=list(scale=0.2,theta=0.35))
Y=rproc2fdata(100,tt,mu2,sigma="vexponential",par.list=list(scale=0.2*fsig,theta=0.35))
fmean.test.fdata(X,Y,npc=-.98,draw=TRUE)
cov.test.fdata(X,Y,npc=5,draw=TRUE)
XYRP.test(X,Y,nproj=15)
MMD.test(X,Y,B=1000)
fEqDistrib.test(X,Y,B=1000)

## End(Not run)

</code></pre>


</div>