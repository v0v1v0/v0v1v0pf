<div class="container">

<table style="width: 100%;"><tr>
<td>Aggregation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Aggregates</h2>

<h3>Description</h3>

<p>The function takes a relational data frame and computes the aggregation
based on the relation specified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Aggregation(
  data,
  aggVar,
  weightVar = rep(NA, length(aggVar)),
  year = "Year",
  relationDF = FAOcountryProfile[, c("FAOST_CODE", "M49_FAOST_CODE")],
  aggMethod = rep("sum", length(aggVar)),
  applyRules = TRUE,
  keepUnspecified = TRUE,
  unspecifiedCode = 0,
  thresholdProp = rep(0.65, length(aggVar))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame containing the country level data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggVar</code></td>
<td>
<p>The vector of names of the variables to be
aggregated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightVar</code></td>
<td>
<p>The vector of names of the variables to be used
as weighting when the aggregation method is weighted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>The column containing the time information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relationDF</code></td>
<td>
<p>A relational data frame which specifies the
territory and the mother country. At least one column must have 
a corrispondent variable name in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggMethod</code></td>
<td>
<p>Can be a single method for all data or a vector
specifying different method for each variable. The method can be 
"sum", "mean", "weighted.mean".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>applyRules</code></td>
<td>
<p>Logical, specifies whether the 
<code>thresholdProp</code> rule must be applied or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepUnspecified</code></td>
<td>
<p>Whether countries with unspecified region
should be aggregated into an "Unspecified" group or simply
drop. Default to create the new group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unspecifiedCode</code></td>
<td>
<p>The output code of the unspecified group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholdProp</code></td>
<td>
<p>The vector of the missing threshold for the 
aggregation rule to be applied. The default is set to only compute 
aggregation if there are more than 65 percent of data available (0.65).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The length of <code>aggVar</code>, <code>aggMethod</code>, <code>weightVar</code>,
<code>thresholdProp</code> must be the same.
</p>
<p>Aggregation should not be computed if insufficient
countries have reported data. This corresponds to the argument
<code>thresholdProp</code> which specifies the percentage which of
country must report data (both for the variable to be aggregated and
the weighting variable).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example.df = data.frame(FAOST_CODE = rep(c(1, 2, 3), 2),
##                        Year = rep(c(2010, 2011), c(3, 3)),
##                        value = rep(c(1, 2, 3), 2),
##                        weight = rep(c(0.3, 0.7, 1), 2))

## Lets aggregate country 1 and 2 into one country and keep country
## 3 seperate.
## relation.df = data.frame(FAOST_CODE = 1:3, NEW_CODE = c(1, 1, 2))

</code></pre>


</div>