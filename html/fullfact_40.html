<div class="container">

<table style="width: 100%;"><tr>
<td>powerLmer3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power analysis for normal data 3</h2>

<h3>Description</h3>

<p>Extracts the power values of dam, sire, and dam by sire variance components from a
linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model can include additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerLmer3(var_rand, n_rand, design, remain, var_fix = NULL, n_fix = NULL,
alpha = 0.05, nsim = 100, ml = F, ftest = "LR", iter = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var_rand</code></td>
<td>
<p>Vector of known dam, sire, dam by sire, residual, and remaining random
variance components, i.e. c(dam, sire, dam x sire, residual, rand1, rand2, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_rand</code></td>
<td>
<p>Vector of known dam, sire, family, and remaining random sample sizes,
i.e. c(dam, sire, family, rand1, rand2, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>A data frame of the experimental design, using only integers. First
three columns must contain and be named "dam", "sire", "family". Remaining columns are
the random effects followed by the fixed effects. Continuous fixed effects are a column
containing the values 1:nrow(design).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package format. Must be random effects
followed by fixed effects. No interactions or random slopes; formulate as intercepts in design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_fix</code></td>
<td>
<p>Vector of known fixed variance components, i.e. c(fix1, fix2, etc.).
Continous fixed random values are sorted to match column values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fix</code></td>
<td>
<p>Vector of known fixed sample sizes, i.e. c(fix1, fix2, etc.). Continuous fixed
effects must have a sample size of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Statistical significance value. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftest</code></td>
<td>
<p>Default is "LR" for likelihood ratio test for fixed effects. Option "PB" is for parametric
bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations for computing the parametric bootstrap significance value
for any fixed effects.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and any remaining random and fixed effects power values.
Power values are calculated by stochastically simulation data and then calculating the proportion of
significance values less than <em>alpha</em> for each component (Bolker 2008).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
Significance values for any fixed effects are determined using likelihood ratio tests or parametric
bootstrap method (Bolker et al. 2009) from the <em>mixed</em> function of the <em>afex</em> package.
</p>


<h3>Value</h3>

<p>Prints a data frame with the sample sizes, variance component inputs, variance component outputs, and power values.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM. 2008. Ecological models and data in R. Princeton University Press, New Jersey.
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code>powerLmer</code>, <code>powerLmer2</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">##design object: 2 remaining random effects and 1 continous fixed effect
block=c(2,2); blocN=4; position=16; posN=20; offN=20
dam0&lt;- stack(as.data.frame(matrix(1:(block[1]*blocN),ncol=blocN,nrow=block[1])))
sire0&lt;- stack(as.data.frame(matrix(1:(block[2]*blocN),ncol=blocN,nrow=block[2])))
observ0&lt;- merge(dam0,sire0, by="ind")
levels(observ0[,1])&lt;- 1:blocN; colnames(observ0)&lt;- c("block","dam","sire")
observ0$family&lt;- 1:nrow(observ0)  #add family
#expand for offspring, observ0 x offN
observ1&lt;- do.call("rbind", replicate(offN,observ0,simplify=FALSE))
observ1$position&lt;- rep(1:position,each=posN)
observ1$position&lt;- sample(observ1$position,nrow(observ1)) #shuffle
desn&lt;- observ1[,c(2,3,4,5,1)];rm(observ0,observ1) #dam,sire,family,position,block
desn$egg_size&lt;- 1:nrow(desn)

#100 simulations
## Not run: powerLmer3(var_rand=c(0.19,0.03,0.02,0.51,0.1,0.05),n_rand=c(8,8,16,16,4),
var_fix=0.1,n_fix=1,design=desn,remain="(1|position)+ (1|block)+ egg_size") 
## End(Not run)
</code></pre>


</div>