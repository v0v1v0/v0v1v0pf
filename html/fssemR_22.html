<div class="container">

<table style="width: 100%;"><tr>
<td>multiFSSEMiPALM2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>multiFSSEMiPALM2</h2>

<h3>Description</h3>

<p>Implementing FSSELM algorithm for network inference. If Xs is identify for different conditions, multiFSSEMiPALM will be use, otherwise, please
use <code>multiFSSEMiPALM2</code> for general cases
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiFSSEMiPALM2(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  lambda,
  rho,
  Wl,
  Wf,
  p,
  maxit = 100,
  inert = inert_opt("linear"),
  threshold = 1e-06,
  verbose = TRUE,
  sparse = TRUE,
  trans = FALSE,
  B2norm = NULL,
  strict = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xs</code></td>
<td>
<p>eQTL matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>initialized noise variance from ridge regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Hyperparameter of lasso term in FSSEM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Hyperparameter of fused-lasso term in FSSEM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum iteration number. Default 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inert</code></td>
<td>
<p>inertial function for iPALM. Default as k-1/k+2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>convergence threshold. Default 1e-6</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Default TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>Sparse Matrix or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>Fs matrix is transposed to k x p or not. If Fs from ridge regression, trans = TRUE, else, trans = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B2norm</code></td>
<td>
<p>B2norm matrices generated from ridge regression. Default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strict</code></td>
<td>
<p>Converge strictly or not. Default False</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>fit List of FSSEM model
</p>

<dl>
<dt>Bs</dt>
<dd>
<p> coefficient matrices of gene regulatory networks</p>
</dd>
<dt>Fs</dt>
<dd>
<p> coefficient matrices of eQTL-gene effect</p>
</dd>
<dt>mu</dt>
<dd>
<p> Bias vector</p>
</dd>
<dt>sigma2</dt>
<dd>
<p> estimate of covariance in SEM</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">seed = 1234
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
library(fssemR)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
## If we assume that different condition has different genetics perturbations (eQTLs)
data$Data$X = list(data$Data$X, data$Data$X)
## gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
##                            N, Ng, Nk)
gamma = 0.6784248     ## optimal gamma computed by cv.multiRegression
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
Xs    = data$Data$X
Ys    = data$Data$Y
Sk    = data$Data$Sk


cvfitc &lt;- cv.multiFSSEMiPALM2(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                             sigma2 = fit$sigma2, nlambda = 5, nrho = 5,
                             nfold = 5, p = Ng, q = Nk, wt = TRUE)

fitc0 &lt;- multiFSSEMiPALM2(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                          sigma2 = fit$sigma2, lambda = cvfitc$lambda, rho = cvfitc$rho,
                          Wl = inverseB(fit$Bs), Wf = flinvB(fit$Bs),
                          p = Ng, maxit = 100, threshold = 1e-5, sparse = TRUE, 
                          verbose = TRUE, trans = TRUE, strict = TRUE)


(TPR(fitc0$Bs[[1]], data$Vars$B[[1]]) + TPR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
(FDR(fitc0$Bs[[1]], data$Vars$B[[1]]) + FDR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
TPR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
FDR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
</code></pre>


</div>