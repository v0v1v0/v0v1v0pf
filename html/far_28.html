<div class="container">

<table style="width: 100%;"><tr>
<td>far</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> FARX(1) model estimation </h2>

<h3>Description</h3>

<p>Estimates the parameters of FAR(1) and FARX(1) processes
(mean and autocorrelation operator)
</p>


<h3>Usage</h3>

<pre><code class="language-R">far(data, y, x, kn, center=TRUE, na.rm=TRUE, joined=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A <code>fdata</code> object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> A vector giving the name(s) of the endogenous variable(s) of
the model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A vector giving the name(s) of the exogenous variable(s) of
the model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn</code></td>
<td>
<p> A vector giving the values of the various
<code>kn</code> (dimension of plug-in in the algorithm). If it not supplied,
the default value is one. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p> Logical. Does the observation need to be centered. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p> Logical. Does the <code>n.a.</code> need to be removed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joined</code></td>
<td>
<p> Logical. If <code>TRUE</code>, the joined (whole) far model
is computed, otherwise the model work with the separated variables. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>The models</b>
</p>
<p>A Functional AutoRegressive of order 1 (<b>FAR(1)</b>) process is, in a
general way,  defined by the following equation:
</p>
<p style="text-align: center;"><code class="reqn">T_{n}=\rho\left(T_{n-1}\right)+\epsilon_{n}, n \in
    Z</code>
</p>

<p>where <code class="reqn">T_{n}</code> and <code class="reqn">\epsilon_{n}</code> take their values in a
functional space (for instance an Hilbertian one), and <code class="reqn">\rho</code>
is a linear operator. <code class="reqn">\epsilon_{n}</code> is a strong white noise.
</p>
<p>Now, let us consider a vector of observations, for instance:
</p>
<p style="text-align: center;"><code class="reqn">\left(T_{1,n},...,T_{i,n},...,T_{m,n}\right)</code>
</p>

<p>where each  <code class="reqn">T_{i,n}</code> lives in a one dimension functional
space (not necessary the same). In the following, we will cut this
list into two parts: the endogeneous variables <code class="reqn">Y_{n}</code> (the
ones we are interested in), and the exogeneous variables
<code class="reqn">X_{n}</code> (which influence the endogeneous ones).
</p>
<p>Then an order 1 Functional AutoRegressive process with eXogeneous
variables (<b>FARX(1)</b>) is defined by the equation:
</p>
<p style="text-align: center;"><code class="reqn">Y_{n}=\rho\left(Y_{n-1}\right)+a\left(X_{n}\right)+\epsilon_{n}
    , n \in Z</code>
</p>

<p>where <code class="reqn">\rho</code> and <code class="reqn">a</code> are linear operators in the
adequate spaces.
</p>
<p><b>Estimation</b>
</p>
<p>This function estimates the parameters of FAR and FARX models.
</p>
<p>First, if the mean of the <code>data</code> is not zero (which is required
by the model), you can substance this mean using the <code>center</code>
option. Moreover, if the <code>data</code> contains <code>NA</code> values, you
can work with it using the <code>na.rm</code> option.
</p>
<p><b>FAR Estimation</b>
</p>
<p>The estimation is mainly about estimating the <code class="reqn">\rho</code>
operator. This estimation is done in a appropriate subspace (computed
from the variance of the observations). What is important to know is
that the best dimension <code>kn</code> for this subspace is not determined
by this function. So the user have to supply this dimension using the
<code>kn</code> option. A way to chose this dimension is to first use the
<code>far.cv</code> function on the history.
</p>
<p><b>FARX Estimation</b>
</p>
<p>The FARX estimation can be realized by two methods: joined or not.
</p>
<p>The <b>joined</b> estimation is done by “joining” the variables
into one and estimating a FAR model on the resulting variable. For
instance, with the previous notations, the transformation is:
</p>
<p style="text-align: center;"><code class="reqn">T_{n}=\left(Y_{n},X_{n+1}\right)</code>
</p>

<p>and <code class="reqn">T_{n}</code> is then a peculiar FAR(1) process. In such a case,
you have to use the <code>joined=TRUE</code> oto the interpretation of
this operatorption and specify <b>one</b>
value for <code>kn</code> (corresponding to the <code class="reqn">T_{n}</code> variable).
</p>
<p>Alternatively, you can choose not to estimate the FARX model by the
joined procedure, then <code>kn</code> need to be a vector with a length
equal to the number of variables involved in the FARX model
(endogeneous and exogeneous).
</p>
<p>In both procedures, the endogeneous and exogeneous variables are
provided through the <code>y</code> and <code>x</code> options respectively.
</p>
<p><b>Results</b>
</p>
<p>The function returns a <code>far</code> object. Use the <code>print</code>,
<code>coef</code> and <code>predict</code> functions to get more informations
about the model.
</p>


<h3>Value</h3>

<p>A <code>far</code> object, see details for more informations.
</p>


<h3>Note</h3>

<p>This function could be used to estimate FAR and FARX with order higher
than 1 as a change of variables can transform the process to an
order 1 FAR or FARX. For instance, if <code class="reqn">T_{n}</code> is a FAR(2)
process then <code class="reqn">Y_{n}=\left(T_{n},T_{n-1}\right)</code> is a
FAR(1) process.
</p>
<p>However, this is not a basic use of this function and may require a
hard work of the user to get the result.
</p>


<h3>Author(s)</h3>

<p> J. Damon </p>


<h3>References</h3>

<p> Besse, P. and Cardot, H. (1996). Approximation spline de la
prévision d'un processus fonctionnel autorégressif d'ordre 1.
<em>Revue Canadienne de Statistique/Canadian Journal of Statistics</em>,
<b>24</b>, 467–487.
</p>
<p>Bosq, D. (2000) <em>Linear Processes in Function Spaces: Theory and
Applications</em>, (Lecture Notes in Statistics,
Vol. 149). New York: Springer-Verlag.
</p>


<h3>See Also</h3>

 <p><code>predict.far</code>, <code>far.cv</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # Simulation of a FARX process
  data1 &lt;- simul.farx(m=10,n=400,base=base.simul.far(20,5),
                base.exo=base.simul.far(20,5),
                d.a=matrix(c(0.5,0),nrow=1,ncol=2),
                alpha.conj=matrix(c(0.2,0),nrow=1,ncol=2),
                d.rho=diag(c(0.45,0.90,0.34,0.45)),
                alpha=diag(c(0.5,0.23,0.018)),
                d.rho.exo=diag(c(0.45,0.90,0.34,0.45)),
                cst1=0.0)

  # Cross validation (joined and separate)
  model1.cv &lt;- far.cv(data=data1, y="X", x="Z", kn=8, ncv=10, cvcrit="X",
                center=FALSE, na.rm=FALSE, joined=TRUE)
  model2.cv &lt;- far.cv(data=data1, y="X", x="Z", kn=c(4,4), ncv=10, cvcrit="X",
                center=FALSE, na.rm=FALSE, joined=FALSE)
  print(model1.cv)
  print(model2.cv)
  k1 &lt;- model1.cv$minL2[1]
  k2 &lt;- model2.cv$minL2[1:2]

  # Modelization of the FARX process (joined and separate)
  model1 &lt;- far(data=data1, y="X", x="Z", kn=k1,
                center=FALSE, na.rm=FALSE, joined=TRUE)
  model2 &lt;- far(data=data1, y="X", x="Z", kn=k2,
                center=FALSE, na.rm=FALSE, joined=FALSE)
  print(model1)
  print(model2)
</code></pre>


</div>