<div class="container">

<table style="width: 100%;"><tr>
<td>FlexParamCurve-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tools to Fit Flexible Parametric Curves</h2>

<h3>Description</h3>

<p>selfStart functions and model selection tools to fit parametric curves in 
</p>
<p><code>nls</code>, <code>nlsList</code> and <code>nlme</code> frameworks.</p>


<h3>Details</h3>

<p>General approach for using package (also see examples below)
</p>
<p>1) Run <code class="reqn">modpar</code> to produce initial parameter estimates and estimates of parameter bounds for your dataset. 
</p>
<p>These are used to accomodate fixed parameters and are saved in user-specified <code>list</code> object
</p>
<p>All parameters and options in this list can be edited manually or using <code class="reqn">change.pnparameters</code>. The
</p>
<p>list could be created manually given that the elements were labelled sufficiently. Note that this step is 
</p>
<p>unnecessary when using the model selection routines <code class="reqn">pn.mod.compare</code> and <code class="reqn">pn.modselect.step</code> as they
</p>
<p>will automatically call <code class="reqn">modpar</code> if parameter estimates are missing.
</p>
<p>2) Determine most appropriate model (number of necessary parameters) for your data
</p>
<p>using  <code class="reqn">pn.mod.compare</code> or <code class="reqn">pn.modselect.step</code> (these rank competing model and then compare nested models using
</p>
<p><code class="reqn">extraF</code>). This may take some time as many <code class="reqn">nlsList</code> objects are fitted.
</p>
<p>Note that if you perform this step, then you do not need to perform step 1.
</p>
<p>If you are sure of your model (e.g. it is a simple logistic) Step 2 may be unnecessary.
</p>
<p>3) Fit <code class="reqn">nls</code> or <code class="reqn">nlsList</code> or <code class="reqn">nlme</code> models using <code class="reqn">SSposnegRichards</code> specifying
</p>
<p>the appropriate model number and the list of parameters and options (specified pn.options object). 
</p>
<p>Note if required model is monotonic (i.e. contains no recession parameters, modno= 12 or 32) recessional parameters
</p>
<p>will be ignored unless "force.nonmonotonic" option is TRUE in the specified pn.options list
</p>
<p>object (see <code class="reqn">modpar</code>) in which case they will be included as fixed values from the list object.
</p>
<p>Parameter bounds can be refinedto improve fits by altering this list, either manually or using
</p>
<p><code>change.pnparameters</code>.
</p>
<p>4) Plot your curves using <code class="reqn">posnegRichards.eqn</code> specifying the appropriate model number and list of parameters/options.
</p>
<p>User level functions include:
</p>
<p><code class="reqn">pn.mod.compare</code>
</p>
<pre>

      all-model selection for positive-negative Richards nlsList models

        </pre>
<p><code class="reqn">pn.modselect.step</code>
</p>
<pre>

      backward stepwise model selection for positive-negative Richards nlsList models

        </pre>
<p><code class="reqn">SSposnegRichards</code>
</p>
<pre>

      selfStart function for estimating parameters of 36 possible reductions of the 8-parameter

      positive-negative Richards model (double-Richards)

        </pre>
<p><code class="reqn">posnegRichards.eqn</code>
</p>
<pre>

      function for evaluating 36 possible reductions of the 8-parameter 

      positive-negative Richards model (double-Richards)

        </pre>
<p><code class="reqn">modpar</code>
</p>
<pre>

      estimates mean parameters (and parameter bounds) for 8-parameter positive-negative Richards

      models or 4-parameter Richards models and saves in objects pnmodelparams

      and pnmodelparamsbounds. (required prior to use of the above functions)

        </pre>
<p><code class="reqn">change.pnparameters</code>
</p>
<pre>      

      simple function to update pnmodelparams and pnmodelparamsbounds

      with user specified values

        </pre>
<p><code class="reqn">extraF</code>
</p>
<pre>

      performs extra sum-of-squares F test for two nested nlsList models

        </pre>
<p><code class="reqn">extaF.nls</code>
</p>
<pre>

      performs extra sum-of-squares F test for two nested nls models

        </pre>


<h3>Note</h3>

<p>Version 1.5 saves many variables, and internal variables in the package environment:
</p>
<p>FlexParamCurve:::FPCEnv. By default, the pn.options file is copied to the environment
</p>
<p>specified by the functions (global environment by default). Model selection routines
</p>
<p>also copy from FPCenv to the global environment all nlsList models fitted during 
</p>
<p>model selection to provide backcompatibility with code for earlier versions. The user
</p>
<p>can redirect the directory to copy to by altering the Envir argument when calling the 
</p>
<p>function.
</p>


<h3>Author(s)</h3>

<p>Stephen Oswald &lt;steve.oswald@psu.edu&gt;</p>


<h3>References</h3>

<p>## Oswald, S.A. et al. 2012. FlexParamCurve: R package for flexible
</p>
<pre>

     fitting of nonlinear parametric curves. Methods in Ecology and Evolution. 3(6): 1073-77.

     doi: 10.1111/j.2041-210X.2012.00231.x (see also tutorial and introductory videos at:

     http://www.methodsinecologyandevolution.org/view/0/podcasts.html 

     posted September 2012 - if no longer at this link, check the archived videos (and comments) at:

     http://www.methodsinecologyandevolution.org/view/0/VideoPodcastArchive.html#allcontent)

                      </pre>


<h3>See Also</h3>

<p><code>nlme</code>
</p>
<p><code>SSlogis</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Code is provided here for an illustrative overview of using FlexParamCurve to select,  

# fit, analyze and plot the most appropriate non-linear curves for a dataset.

# NOTE: autorun is disabled for these examples since more detailed examples are provided for the 

# individual functions in their associated help files and runtime for this overview approximates 

# 5 mins. To run, simply copy and paste code from this help file into the R GUI.



# run all-model selection for posneg.data object (Step 2) without need to run any previous functions

## Not run:   

    modseltable &lt;- pn.mod.compare(posneg.data$age, posneg.data$mass,

    posneg.data$id, existing = FALSE, pn.options = "myoptions")
## End(Not run)



# run backwards stepwise model selection (Step 2) for logist.data object

#without need to run any previous functions

## Not run:   

    modseltable &lt;- pn.modselect.step(logist.data$age, logist.data$mass,

    logist.data$id, existing = FALSE, pn.options = "myoptions")
## End(Not run)



# estimate fixed parameters use data object posneg.data (Step 1)

## Not run:   

     modpar(posneg.data$age,posneg.data$mass, pn.options = "myoptions")
## End(Not run)



# change fixed values of M and constrain hatching mass to 45.5 in a growth curve (Step 1)

## Not run:   

      change.pnparameters(M=1,RM=0.5,first.y=45.5, pn.options = "myoptions")
## End(Not run)

    

# fit nlsList object using 6 parameter model with values M and RM (Step 3)

# fixed to value in pnmodelparams and then fit nlme model

## Not run:   

richardsR22.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,

      Infl = Infl, RAsym = RAsym, Rk = Rk, Ri = Ri,

      modno = 22, pn.options = "myoptions"), data = posneg.data)

richardsR22.nlme &lt;- nlme(richardsR22.lis, random = pdDiag(Asym + Infl ~ 1))
## End(Not run)

 

# fit reduced nlsList model and then compare performance with extraF (manual version of Step 2)

## Not run:   

 richardsR20.lis &lt;- nlsList(mass ~ SSposnegRichards(age, Asym = Asym, K = K,

      Infl = Infl, modno = 20, pn.options = "myoptions"), data = posneg.data)

 extraF(richardsR20.lis,richardsR22.lis)
## End(Not run)

 

# fit and plot a logistic curve (M=1) to data, note - all parameters set to 1 are ignored

# note code here forces \eqn{modpar} to only estimate 4 curve parameters (simple Richards curve)

#create list for fixed parameters

## Not run:   

modpar(logist.data$age,logist.data$mass,force4par=TRUE, pn.options = "myoptions")

change.pnparameters(M=1, pn.options = "myoptions") # set M to 1 for subsequent fit

richardsR20.nls &lt;- nls(mass ~ SSposnegRichards(age, Asym = Asym, K = K,

      Infl = Infl, modno = 20, pn.options = "myoptions"), data = logist.data)

plot(logist.data$age , logist.data$mass, xlab = "age", ylab = "mass", pch = ".", cex = 0.7) 

par &lt;- coef( richardsR20.nls )
## End(Not run)



#(Step 4)

## Not run:   

curve(posnegRichards.eqn(x, Asym = par[1], K = par[2], Infl = par[3], modno = 20

, pn.options = "myoptions"), add= TRUE)
## End(Not run)

</code></pre>


</div>