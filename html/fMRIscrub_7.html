<div class="container">

<table style="width: 100%;"><tr>
<td>FD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Framewise Displacement</h2>

<h3>Description</h3>

<p>Calculate Framewise Displacement (FD)
</p>


<h3>Usage</h3>

<pre><code class="language-R">FD(
  X,
  trans_units = c("mm", "cm", "in"),
  rot_units = c("deg", "rad", "mm", "cm", "in"),
  brain_radius = NULL,
  detrend = FALSE,
  lag = 1,
  cutoff = 0.3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An <code class="reqn">N</code> by <code class="reqn">6</code> matrix in which the first three columns represent the
translational RPs (<code>trans_units</code>), and the second three columns represent
the rotational RPs (<code>rot_units</code>). If <code>rot_units</code> measures an angle,
it will be converted to <code>trans_units</code> by measuring displacement on a
sphere of radius <code>brain_radius</code> <code>trans_units</code>.
</p>
<p>Alternatively, this can be the file path to an <code class="reqn">N</code> by <code class="reqn">6</code> matrix which can be
read with <code>read.table</code> (fields separated by white-space; no
header).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans_units</code></td>
<td>
<p><code>"mm"</code> for millimeters (default), <code>"cm"</code>
for centimeters, or <code>"in"</code> for inches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot_units</code></td>
<td>
<p><code>"deg"</code> for degrees (default), <code>"rad"</code> for radians,
or one of the <code>trans_units</code> options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brain_radius</code></td>
<td>
<p>If <code>rot_units</code> measures an angle, the rotational RPs
are transformed to a spatial measurement representing the displacement on a
sphere of radius <code>brain_radius</code> <code>trans_units</code>.
</p>
<p>If <code>brain_radius</code> is <code>NULL</code> (default), it will be set to
50 mm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend</code></td>
<td>
<p>Detrend each RP with the DCT before computing FD?
Default: <code>FALSE</code>. Can be a number of DCT bases to use, or <code>TRUE</code>
to use 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>The difference of indices between which to calculate change in
position. Default: <code>1</code> (the previous timepoint). Changing this
argument sets <code class="reqn">\Delta x_i = x_{i-lag} - x_i</code> (and similarly for the
other RPs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>FD values higher than this will be flagged. Default: <code>.3</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The FD formula is taken from Power et. al. (2012):
</p>
<p style="text-align: center;"><code class="reqn">FD_i = | \Delta x_i | + | \Delta y_i | + | \Delta z_i | + | \Delta \alpha_i | + | \Delta \beta_i | + | \Delta \gamma_i |</code>
</p>

<p>where <code class="reqn">i</code> is the timepoint; <code class="reqn">x</code>, <code class="reqn">y</code> and <code class="reqn">z</code> are the
translational realignment parameters (RPs);
<code class="reqn">\alpha</code>, <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> are the rotational RPs;
and <code class="reqn">\Delta x_i = x_{i-1} - x_i</code> (and similarly for the other RPs).
</p>


<h3>Value</h3>

<p>A list with components
</p>

<dl>
<dt>measure</dt>
<dd>
<p>A length <code class="reqn">N</code> vector of FD values in <code>trans_units</code>.</p>
</dd>
<dt>measure_info</dt>
<dd>
<p>"FD"</p>
</dd>
<dt>outlier_cutoff</dt>
<dd>
<p><code>cutoff</code></p>
</dd>
<dt>outlier_flag</dt>
<dd>
<p>A length-N logical vector, where <code>TRUE</code> indicates suspected outlier presence.</p>
</dd>
</dl>
<h3>References</h3>


<ul><li>
<p>Power, J. D., Barnes, K. A., Snyder, A. Z., Schlaggar, B. L. &amp; Petersen, S. E. Spurious but systematic correlations in functional connectivity MRI networks arise from subject motion. Neuroimage 59, 2142-2154 (2012).
</p>
</li></ul>
</div>