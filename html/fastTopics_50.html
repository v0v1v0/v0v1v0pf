<div class="container">

<table style="width: 100%;"><tr>
<td>pca_from_topics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Low-dimensional Embeddings from Poisson NMF or Multinomial Topic Model</h2>

<h3>Description</h3>

<p>Lightweight interface for rapidly producing
low-dimensional embeddings from matrix factorizations or
multinomial topic models. The defaults used are more suitable for
producing embeddings from matrix factorizations or topic models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pca_from_topics(fit, dims = 2, center = TRUE, scale. = FALSE, ...)

tsne_from_topics(
  fit,
  dims = 2,
  pca = FALSE,
  normalize = FALSE,
  perplexity = 100,
  theta = 0.1,
  max_iter = 1000,
  eta = 200,
  check_duplicates = FALSE,
  verbose = TRUE,
  ...
)

umap_from_topics(
  fit,
  dims = 2,
  n_neighbors = 30,
  metric = "euclidean",
  scale = "none",
  pca = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>An object of class “poisson_nmf_fit” or
“multinom_topic_model_fit”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p>The number of dimensions in the embedding. In
<code>tsne_from_topics</code>, this is passed as argument “dims”
to <code>Rtsne</code>. In <code>umap_from_topics</code>, this is
passed as argument “n_components” to
<code>umap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>A logical value indicating whether columns of
<code>fit$L</code> should be zero-centered before performing PCA; passed
as argument “center” to <code>prcomp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.</code></td>
<td>
<p>A logical value indicating whether columns of
<code>fit$L</code> should be scaled to have unit variance prior to
performing PCA; passed as argument “scale.” to
<code>prcomp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to
<code>prcomp</code>, <code>Rtsne</code> or
<code>umap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca</code></td>
<td>
<p>Whether to perform a PCA processing step in t-SNE or
UMAP; passed as argument “pca” to <code>Rtsne</code>
or <code>umap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Whether to normalize the data prior to running
t-SNE; passed as argument “normalize” to
<code>Rtsne</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perplexity</code></td>
<td>
<p>t-SNE perplexity parameter, passed as argument
“perplexity” to <code>Rtsne</code>. The perplexity
is automatically revised if it is too large; see
<code>Rtsne</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>t-SNE speed/accuracy trade-off parameter; passed as
argument “theta” to <code>Rtsne</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of t-SNE iterations; passed as
argument “max_iter” to <code>Rtsne</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>t-SNE learning rate parameter; passed as argument
“eta” to <code>Rtsne</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_duplicates</code></td>
<td>
<p>When <code>check_duplicates = TRUE</code>, checks
whether there are duplicate rows in <code>fit$L</code>; passed as argument
“check_duplicates” to <code>Rtsne</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code>, progress updates are
printed; passed as argument “verbose” to
<code>Rtsne</code> or <code>umap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_neighbors</code></td>
<td>
<p>Number of nearest neighbours in manifold
approximation; passed as argument “n_neighbors” to
<code>umap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>Distance matrix used to find nearest neighbors;
passed as argument “metric” to
<code>umap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Scaling to apply to <code>fit$L</code>; passed as argument
“scale” to <code>umap</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that since <code>tsne_from_topics</code> and
<code>umap_from_topics</code> use nonlinear transformations of the data,
distances between points are generally less interpretable than a
linear transformation obtained by, say, PCA.
</p>


<h3>Value</h3>

<p>An n x d matrix containing the embedding, where n is the
number of rows of <code>fit$L</code>, and <code>d = dims</code>.
</p>


<h3>References</h3>

<p>Kobak, D. and Berens, P. (2019). The art of using t-SNE for
single-cell transcriptomics. <em>Nature Communications</em> <b>10</b>,
5416. doi: <a href="https://doi.org/10.1038/s41467-019-13056-x">10.1038/s41467-019-13056-x</a>
</p>


<h3>See Also</h3>

<p><code>pca_plot</code>, <code>tsne_plot</code>,
<code>umap_plot</code>, <code>prcomp</code>,
<code>Rtsne</code>, <code>umap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggplot2)
library(cowplot)
set.seed(1)
data(pbmc_facs)

# Get the Poisson NMF and multinomial topic model fit to the PBMC data.
fit1 &lt;- multinom2poisson(pbmc_facs$fit)
fit2 &lt;- pbmc_facs$fit
fit2 &lt;- poisson2multinom(fit1)

# Compute the first two PCs of the loadings matrix (for the topic
# model, fit2, the loadings are the topic proportions).
Y1 &lt;- pca_from_topics(fit1)
Y2 &lt;- pca_from_topics(fit2)
subpop &lt;- pbmc_facs$samples$subpop
quickplot(Y1[,1],Y1[,2],color = subpop) + theme_cowplot()
quickplot(Y2[,1],Y2[,2],color = subpop) + theme_cowplot()

# Compute a 2-d embedding of the loadings using t-SNE.

Y1 &lt;- tsne_from_topics(fit1)
Y2 &lt;- tsne_from_topics(fit2)
quickplot(Y1[,1],Y1[,2],color = subpop) + theme_cowplot()
quickplot(Y2[,1],Y2[,2],color = subpop) + theme_cowplot()


# Compute a 2-d embedding of the loadings using UMAP.

Y1 &lt;- umap_from_topics(fit1)
Y2 &lt;- umap_from_topics(fit2)
quickplot(Y1[,1],Y1[,2],color = subpop) + theme_cowplot()
quickplot(Y2[,1],Y2[,2],color = subpop) + theme_cowplot()


</code></pre>


</div>