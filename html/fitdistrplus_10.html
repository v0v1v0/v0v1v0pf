<div class="container">

<table style="width: 100%;"><tr>
<td>CIcdfplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical cumulative distribution function with pointwise confidence intervals on probabilities or on quantiles</h2>

<h3>Description</h3>

   
<p><code>cdfband</code> plots the empirical cumulative distribution function with the bootstraped pointwise confidence intervals on probabilities of on quantiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CIcdfplot(b, CI.output, CI.type = "two.sided", CI.level = 0.95, CI.col = "red", 
  CI.lty = 2, CI.fill = NULL, CI.only = FALSE, xlim, ylim, xlogscale = FALSE, 
  ylogscale = FALSE, main, xlab, ylab, datapch, datacol, fitlty, fitcol, fitlwd, 
  horizontals = TRUE, verticals = FALSE, do.points = TRUE, use.ppoints = TRUE, 
  a.ppoints = 0.5, name.points = NULL, lines01 = FALSE, plotstyle = "graphics", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>One <code>"bootdist"</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.output</code></td>
<td>
<p> The quantity on which (bootstraped) bootstraped confidence intervals are computed: 
either <code>"probability"</code> or <code>"quantile"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.type</code></td>
<td>
<p> Type of confidence intervals : either <code>"two.sided"</code> or one-sided 
intervals (<code>"less"</code> or <code>"greater"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.level</code></td>
<td>
<p> The confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.col</code></td>
<td>
<p>the color of the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.lty</code></td>
<td>
<p>the line type of the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.fill</code></td>
<td>
<p>a color to fill the confidence area. Default is <code>NULL</code> corresponding to no filling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.only</code></td>
<td>
<p>A logical whether to plot empirical and fitted distribution functions 
or only the confidence intervals. Default to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>The <code class="reqn">x</code>-limits of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>The <code class="reqn">y</code>-limits of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">x</code>-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <code class="reqn">y</code>-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A main title for the plot, see also <code>title</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A label for the <code class="reqn">x</code>-axis, defaults to a description of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A label for the <code class="reqn">y</code>-axis, defaults to a description of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datapch</code></td>
<td>
<p>An integer specifying a symbol to be used in plotting data points, 
see also <code>points</code> (only for non censored data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datacol</code></td>
<td>
<p>A specification of the color to be used in plotting data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitcol</code></td>
<td>
<p>A (vector of) color(s) to plot fitted distributions. 
If there are fewer colors than fits they are recycled in the standard fashion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitlty</code></td>
<td>
<p>A (vector of) line type(s) to plot fitted distributions/densities. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitlwd</code></td>
<td>
<p>A (vector of) line size(s) to plot fitted distributions/densities. 
If there are fewer values than fits they are recycled in the standard fashion.
See also <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontals</code></td>
<td>
<p>If <code>TRUE</code>, draws horizontal lines for the step empirical 
cdf function (only for non censored data). See also <code>plot.stepfun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verticals</code></td>
<td>
<p>If <code>TRUE</code>, draws also vertical lines for the empirical cdf function. 
Only taken into account if <code>horizontals=TRUE</code> (only for non censored data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.points</code></td>
<td>
<p>logical; if <code>TRUE</code>, also draw points at the x-locations. 
Default is TRUE (only for non censored data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.ppoints</code></td>
<td>
<p>If <code>TRUE</code>, probability points of the empirical distribution
are defined using function <code>ppoints</code> as 
<code>(1:n - a.ppoints)/(n - 2a.ppoints + 1)</code> (only for non censored data).
If <code>FALSE</code>, probability points are simply defined as <code>(1:n)/n</code>. This argument 
is ignored for discrete data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.ppoints</code></td>
<td>
<p>If <code>use.ppoints=TRUE</code>, this is passed to function <code>ppoints</code>
(only for non censored data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.points</code></td>
<td>
<p>Label vector for points if they are drawn i.e. if do.points = TRUE (only for non censored data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines01</code></td>
<td>
<p>A logical to plot two horizontal lines at <code>h=0</code> and <code>h=1</code> for <code>cdfcomp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotstyle</code></td>
<td>
<p><code>"graphics"</code> or <code>"ggplot"</code>. 
If <code>"graphics"</code>, the display is built with <code>graphics</code> functions. 
If <code>"ggplot"</code>, a graphic object output is created with <code>ggplot2</code> functions (the <code>ggplot2</code> package must be installed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical arguments passed to <code>matlines</code> or <code>polygon</code>,
respectively when <code>CI.fill=FALSE</code> and <code>CI.fill=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>CIcdfplot</code> provides a plot of the empirical distribution using
<code>cdfcomp</code> or <code>cdfcompcens</code>,
with bootstraped pointwise confidence intervals on probabilities (y values) 
or on quantiles (x values). 
Each interval is computed by evaluating the quantity of interest (probability
associated to an x value or quantile associated to an y value) using all the
bootstraped values of parameters to get a bootstraped sample
of the quantity of interest and then by calculating percentiles on this sample to get a
confidence interval (classically 2.5 and 97.5 percentiles for a 95 percent 
confidence level).
If <code>CI.fill != NULL</code>, then the whole confidence area is filled by the color <code>CI.fill</code>
thanks to the function <code>polygon</code>, otherwise only borders are drawn thanks to the function
<code>matline</code>. Further graphical arguments can be passed to these functions using 
the three dots arguments <code>...</code>.
</p>


<h3>Author(s)</h3>

 
<p>Christophe Dutang and Marie-Laure Delignette-Muller.
</p>


<h3>References</h3>

<p>Delignette-Muller ML and Dutang C (2015), 
<em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34, <a href="https://doi.org/10.18637/jss.v064.i04">doi:10.18637/jss.v064.i04</a>.
</p>


<h3>See Also</h3>

 
<p>See also <code>cdfcomp</code>, <code>cdfcompcens</code>,
<code>bootdist</code> and <code>quantile</code>.  
</p>


<h3>Examples</h3>

<pre><code class="language-R"># We choose a low number of bootstrap replicates in order to satisfy CRAN running times
# constraint.
# For practical applications, we recommend to use at least niter=501 or niter=1001.

if (requireNamespace ("ggplot2", quietly = TRUE)) {ggplotEx &lt;- TRUE}

# (1) Fit of an exponential distribution
#

set.seed(123)
s1 &lt;- rexp(50, 1)
f1 &lt;- fitdist(s1, "exp")
b1 &lt;- bootdist(f1, niter= 11) #voluntarily low to decrease computation time

# plot 95 percent bilateral confidence intervals on y values (probabilities)
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", plotstyle = "ggplot")


# plot of the previous intervals as a band 
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", 
  CI.fill = "pink", CI.col = "red")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", 
  CI.fill = "pink", CI.col = "red", plotstyle = "ggplot")

# plot of the previous intervals as a band without empirical and fitted dist. functions
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "red")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "red", plotstyle = "ggplot")
  
# same plot without contours
CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "pink")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "probability", CI.only = TRUE,
  CI.fill = "pink", CI.col = "pink", plotstyle = "ggplot")

# plot 95 percent bilateral confidence intervals on x values (quantiles)
CIcdfplot(b1, CI.level= 95/100, CI.output = "quantile")
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "quantile", plotstyle = "ggplot")


# plot 95 percent unilateral confidence intervals on quantiles
CIcdfplot(b1, CI.level = 95/100, CI.output = "quant", CI.type = "less", 
  CI.fill = "grey80", CI.col = "black", CI.lty = 1)
if (ggplotEx) CIcdfplot(b1, CI.level = 95/100, CI.output = "quant", CI.type = "less", 
  CI.fill = "grey80", CI.col = "black", CI.lty = 1, plotstyle = "ggplot")
    
CIcdfplot(b1, CI.level= 95/100, CI.output = "quant", CI.type = "greater",
  CI.fill = "grey80", CI.col = "black", CI.lty = 1)
if (ggplotEx) CIcdfplot(b1, CI.level= 95/100, CI.output = "quant", CI.type = "greater",
  CI.fill = "grey80", CI.col = "black", CI.lty = 1, plotstyle = "ggplot")

# (2) Fit of a normal distribution on acute toxicity log-transformed values of 
# endosulfan for nonarthropod invertebrates, using maximum likelihood estimation
# to estimate what is called a species sensitivity distribution 
# (SSD) in ecotoxicology, followed by estimation of the 5, 10 and 20 percent quantile  
# values of the fitted distribution, which are called the 5, 10, 20 percent hazardous 
# concentrations (HC5, HC10, HC20) in ecotoxicology, with their
# confidence intervals, from a small number of bootstrap 
# iterations to satisfy CRAN running times constraint and plot of the band
# representing pointwise confidence intervals on any quantiles (any HCx values)
# For practical applications, we recommend to use at least niter=501 or niter=1001.
#

data(endosulfan)
log10ATV &lt;- log10(subset(endosulfan, group == "NonArthroInvert")$ATV)
namesATV &lt;- subset(endosulfan, group == "NonArthroInvert")$taxa
fln &lt;- fitdist(log10ATV, "norm")
bln &lt;- bootdist(fln, bootmethod ="param", niter=101)
quantile(bln, probs = c(0.05, 0.1, 0.2))
CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
          xlim = c(0,5), name.points=namesATV)
if (ggplotEx) CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
  xlim = c(0,5), name.points=namesATV, plotstyle = "ggplot")


# (3) Same type of example as example (2) from ecotoxicology
# with censored data
#
data(salinity)
log10LC50 &lt;-log10(salinity)
fln &lt;- fitdistcens(log10LC50,"norm")
bln &lt;- bootdistcens(fln, niter=101)
(HC5ln &lt;- quantile(bln,probs = 0.05))
CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
    xlab = "log10(LC50)",xlim=c(0.5,2),lines01 = TRUE)
if (ggplotEx) CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
                        xlab = "log10(LC50)",xlim=c(0.5,2),lines01 = TRUE, plotstyle = "ggplot")
# zoom around the HC5  
CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
          xlab = "log10(LC50)", lines01 = TRUE, xlim = c(0.8, 1.5), ylim = c(0, 0.1))
abline(h = 0.05, lty = 2) # line corresponding to a CDF of 5 percent

if (ggplotEx) CIcdfplot(bln, CI.output = "quantile", CI.fill = "lightblue", CI.col = "blue",
    xlab = "log10(LC50)", lines01 = TRUE, xlim = c(0.8, 1.5), ylim = c(0, 0.1), 
    plotstyle = "ggplot") +
  ggplot2::geom_hline(yintercept = 0.05, lty = 2) # line corresponding to a CDF of 5 percent

</code></pre>


</div>