<div class="container">

<table style="width: 100%;"><tr>
<td>cov.wml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Covariance Matrices (Maximum Likelihood)</h2>

<h3>Description</h3>

<p>Returns a list containing estimates of the weighted covariance
matrix and the mean of the data, and optionally of the (weighted)
correlation matrix. The
covariance matrix is divided by the sum of the weights,
corresponding to <code>n</code> and the ML-estimator in the case of equal
weights, as opposed to <code>n-1</code> for <code>cov.wt</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">cov.wml(x, wt = rep(1/nrow(x), nrow(x)), cor = FALSE, center = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame.  As usual, rows are observations and
columns are variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>a non-negative and non-zero vector of weights for each
observation.  Its length must equal the number of rows of
<code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>A logical indicating whether the estimated correlation
weighted matrix will be returned as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Either a logical or a numeric vector specifying the centers
to be used when computing covariances.  If <code>TRUE</code>, the
(weighted) mean of each variable is used, if '<code>FALSE</code>, zero is
used.  If <code>center</code> is numeric, its length must equal the
number of columns of <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following named components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>the estimated (weighted) covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>an estimate for the center (mean) of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>the number of observations (rows) in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>the weights used in the estimation.  Only returned if given
as an argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>the estimated correlation matrix.  Only returned if ‘cor’ is
‘TRUE’.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Hennig
<a href="mailto:christian.hennig@unibo.it">christian.hennig@unibo.it</a>
<a href="https://www.unibo.it/sitoweb/christian.hennig/en/">https://www.unibo.it/sitoweb/christian.hennig/en/</a></p>


<h3>See Also</h3>

<p><code>cov.wt</code>, <code>cov</code>, <code>var</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- c(1,2,3,4,5,6,7,8,9,10)
  y &lt;- c(1,2,3,8,7,6,5,8,9,10)
  cov.wml(cbind(x,y),wt=c(0,0,0,1,1,1,1,1,0,0))
  cov.wt(cbind(x,y),wt=c(0,0,0,1,1,1,1,1,0,0))
</code></pre>


</div>