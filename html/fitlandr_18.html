<div class="container">

<table style="width: 100%;"><tr>
<td>sim_vf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation from vector fields</h2>

<h3>Description</h3>

<p>Parallel computing based on <code>future</code> is supported. Use <code>future::plan("multisession")</code> to enable this.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_vf(
  vf,
  noise = 1,
  noise_warmup = noise,
  chains = 10,
  length = 10000,
  discard = 0.3,
  stepsize = 0.01,
  sparse = 1,
  forbid_overflow = FALSE,
  linear_interp = FALSE,
  inits = matrix(c(stats::runif(chains, min = vf$lims[1], max = vf$lims[2]),
    stats::runif(chains, min = vf$lims[3], max = vf$lims[4])), ncol = 2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vf</code></td>
<td>
<p>A <code>vectorfield</code> object estimated by <code>fit_2d_vf()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>Relative noise of the simulation. Set this smaller when the simulation is unstable (e.g., when the elements in the diffusion matrix are not finite), and set this larger when the simulation converges too slowly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_warmup</code></td>
<td>
<p>The noise used for the warming-up period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>How many chains simulations should be performed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>The simulation length for each chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discard</code></td>
<td>
<p>How much of the starting part of each chain should be discarded? (Warming-up period.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize</code></td>
<td>
<p>The stepsize for Euler–Maruyama simulation of the system.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>A number. How much do you want to sparse the output? When the noise is small, sparse the output may make the density estimation more efficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forbid_overflow</code></td>
<td>
<p>If <code>TRUE</code>, when the simulated system runs out of the margins specified in <code>vf</code>, the system will be moved back to the previous value. This can help to stabilize the simulation. <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear_interp</code></td>
<td>
<p>Use linear interpolation method to estimate the drift vector (and the diffusion matrix). This can speed up the calculation. If <code>TRUE</code>, be sure that a linear grid was calculated for the vector field using <code style="white-space: pre;">⁠&lt;vf&gt; &lt;- add_interp_grid(&lt;vf&gt;)⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>The initial values of each chain.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix of the simulated data.
</p>


</div>