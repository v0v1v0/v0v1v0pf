<div class="container">

<table style="width: 100%;"><tr>
<td>crossValidationFeatureSelection_Res</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>NeRI-based selection of a linear, logistic, or Cox proportional hazards regression model from a set of candidate variables</h2>

<h3>Description</h3>

<p>This function performs a cross-validation analysis of a feature selection algorithm based on net residual improvement (NeRI) to return a predictive model.
It is composed of a NeRI-based feature selection followed by an update procedure, ending with a bootstrapping backwards feature elimination.
The user can control how many train and blind test sets will be evaluated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	crossValidationFeatureSelection_Res(size = 10,
	                                    fraction = 1.0,
	                                    pvalue = 0.05,
	                                    loops = 100,
	                                    covariates = "1",
	                                    Outcome,
	                                    timeOutcome = "Time",
	                                    variableList,
	                                    data,
	                                    maxTrainModelSize = 20,
	                                    type = c("LM", "LOGIT", "COX"),
	                                    testType = c("Binomial",
	                                                 "Wilcox",
	                                                 "tStudent",
	                                                 "Ftest"),
	                                    startOffset = 0,
	                                    elimination.bootstrap.steps = 100,
	                                    trainFraction = 0.67,
	                                    trainRepetition = 9,
	                                    setIntersect = 1,
	                                    unirank = NULL,
	                                    print=TRUE,
	                                    plots=TRUE,
	                                    lambda="lambda.1se",
	                                    equivalent=FALSE,
	                                    bswimsCycles=10,
	                                    usrFitFun=NULL,
	                                    featureSize=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>The number of candidate variables to be tested (the first <code>size</code> variables from <code>variableList</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fraction</code></td>
<td>

<p>The fraction of data (sampled with replacement) to be used as train
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>

<p>The maximum <em>p</em>-value, associated to the NeRI, allowed for a term in the model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loops</code></td>
<td>

<p>The number of bootstrap loops
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>

<p>A string of the type "1 + var1 + var2" that defines which variables will always be included in the models (as covariates)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outcome</code></td>
<td>

<p>The name of the column in <code>data</code> that stores the variable to be predicted by the model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeOutcome</code></td>
<td>

<p>The name of the column in <code>data</code> that stores the time to event (needed only for a Cox proportional hazards regression model fitting)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variableList</code></td>
<td>

<p>A data frame with two columns. The first one must have the names of the candidate variables and the other one the description of such variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame where all variables are stored in different columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxTrainModelSize</code></td>
<td>

<p>Maximum number of terms that can be included in the model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Fit type: Logistic ("LOGIT"), linear ("LM"), or Cox proportional hazards ("COX")
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testType</code></td>
<td>

<p>Type of non-parametric test to be evaluated by the <code>improvedResiduals</code> function: Binomial test ("Binomial"), Wilcoxon rank-sum test ("Wilcox"), Student's <em>t</em>-test ("tStudent"), or <em>F</em>-test ("Ftest")
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startOffset</code></td>
<td>

<p>Only terms whose position in the model is larger than the <code>startOffset</code> are candidates to be removed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elimination.bootstrap.steps</code></td>
<td>

<p>The number of bootstrap loops for the backwards elimination procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainFraction</code></td>
<td>

<p>The fraction of data (sampled with replacement) to be used as train for the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setIntersect</code></td>
<td>

<p>The intersect of the model (To force a zero intersect, set this value to 0)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainRepetition</code></td>
<td>

<p>The number of cross-validation folds (it should be at least equal to <code class="reqn">1/trainFraction</code> for a complete cross-validation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unirank</code></td>
<td>

<p>A list with the results yielded by the <code>uniRankVar</code> function, required only if the rank needs to be updated during the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>Logical. If <code>TRUE</code>, information will be displayed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>

<p>Logical. If <code>TRUE</code>, plots are displayed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>The passed value to the s parameter of the glmnet cross validation coefficient
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equivalent</code></td>
<td>

<p>Is set to TRUE CV will compute the equivalent model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bswimsCycles</code></td>
<td>

<p>The maximum number of models to be returned by <code>BSWiMS.model</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usrFitFun</code></td>
<td>

<p>A user fitting function to be evaluated by the cross validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>featureSize</code></td>
<td>

<p>The original number of features to be explored in the data frame.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function produces a set of data and plots that can be used to inspect the degree of over-fitting or shrinkage of a model.
It uses bootstrapped data, cross-validation data, and, if possible, retrain data.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula.list</code></td>
<td>

<p>A list containing objects of class <code>formula</code> with the formulas used to fit the models found at each cycle
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Models.testPrediction</code></td>
<td>

<p>A data frame with the blind test set predictions made at each fold of the cross validation (Full B:SWiMS,Median,Bagged,Forward,Backward Elimination), where the models used to generate such predictions (<code>formula.list</code>) were generated via a feature selection process which included only the train set.
It also includes a column with the <code>Outcome</code> of each prediction, and a column with the number of the fold at which the prediction was made.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullBSWiMS.testPrediction</code></td>
<td>

<p>A data frame similar to <code>Models.testPrediction</code>, but where the model used to generate the predictions was the Full model, generated via a feature selection process which included all data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BSWiMS</code></td>
<td>

<p>A list containing the values returned by <code>bootstrapVarElimination_Res</code> using all data and the model from <code>updatedforwardModel</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forwardSelection</code></td>
<td>

<p>A list containing the values returned by <code>ForwardSelection.Model.Res</code> using all data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updatedforwardModel</code></td>
<td>

<p>A list containing the values returned by <code>updateModel.Res</code> using all data and the model from <code>forwardSelection</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testRMSE</code></td>
<td>

<p>The global blind test root-mean-square error (RMSE) of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testPearson</code></td>
<td>

<p>The global blind test Pearson <em>r</em> product-moment correlation coefficient of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testSpearman</code></td>
<td>

<p>The global blind test Spearman <code class="reqn">\rho</code> rank correlation coefficient of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FulltestRMSE</code></td>
<td>

<p>The global blind test RMSE of the Full model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullTestPearson</code></td>
<td>

<p>The global blind test Pearson <em>r</em> product-moment correlation coefficient of the Full model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullTestSpearman</code></td>
<td>

<p>The global blind test Spearman <code class="reqn">\rho</code> rank correlation coefficient of the Full model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainRMSE</code></td>
<td>

<p>The train RMSE at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainPearson</code></td>
<td>

<p>The train Pearson <em>r</em> product-moment correlation coefficient at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainSpearman</code></td>
<td>

<p>The train Spearman <code class="reqn">\rho</code> rank correlation coefficient at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullTrainRMSE</code></td>
<td>

<p>The train RMSE of the Full model at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullTrainPearson</code></td>
<td>

<p>The train Pearson <em>r</em> product-moment correlation coefficient of the Full model at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullTrainSpearman</code></td>
<td>

<p>The train Spearman <code class="reqn">\rho</code> rank correlation coefficient of the Full model at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testRMSEAtFold</code></td>
<td>

<p>The blind test RMSE at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullTestRMSEAtFold</code></td>
<td>

<p>The blind test RMSE of the Full model at each fold of the cross-validation procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fullenet</code></td>
<td>

<p>An object of class <code>cv.glmnet</code> containing the results of an elastic net cross-validation fit
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LASSO.testPredictions</code></td>
<td>

<p>A data frame similar to <code>Models.testPrediction</code>, but where the predictions were made by the elastic net model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LASSOVariables</code></td>
<td>

<p>A list with the elastic net Full model and the models found at each cross-validation fold
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byFoldTestMS</code></td>
<td>

<p>A vector with the Mean Square error for each blind fold
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byFoldTestSpearman</code></td>
<td>

<p>A vector with the Spearman correlation between prediction and outcome for each blind fold
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byFoldTestPearson</code></td>
<td>

<p>A vector with the Pearson correlation between prediction and outcome for each blind fold
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byFoldCstat</code></td>
<td>

<p>A vector with the C-index (Somers' Dxy rank correlation :<code>rcorr.cens</code>) between prediction and outcome for each blind fold
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVBlindPearson</code></td>
<td>

<p>A vector with the Pearson correlation between the outcome and prediction for each repeated experiment
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVBlindSpearman</code></td>
<td>

<p>A vector with the Spearm correlation between the outcome and prediction for each repeated experiment
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVBlindRMS</code></td>
<td>

<p>A vector with the RMS between the outcome and prediction for each repeated experiment
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Models.trainPrediction</code></td>
<td>

<p>A data frame with the outcome and the train prediction of every model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullBSWiMS.trainPrediction</code></td>
<td>

<p>A data frame with the outcome and the train prediction at each CV fold for the main model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LASSO.trainPredictions</code></td>
<td>

<p>A data frame with the outcome and the prediction of each enet lasso model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniTrainMSS</code></td>
<td>

<p>A data frame with mean square of the train residuals from the univariate models of the model terms
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniTestMSS</code></td>
<td>

<p>A data frame with mean square of the test residuals of the univariate models of the model terms
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BSWiMS.ensemble.prediction</code></td>
<td>

<p>The ensemble prediction by all models on the test data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AtOptFormulas.list</code></td>
<td>

<p>The list of formulas with "optimal" performance
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ForwardFormulas.list</code></td>
<td>

<p>The list of formulas produced by the forward procedure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baggFormulas.list</code></td>
<td>

<p>The list of the bagged models
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LassoFilterVarList</code></td>
<td>

<p>The list of variables used by LASSO fitting
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jose G. Tamez-Pena and Antonio Martinez-Torteya</p>


<h3>See Also</h3>

<p><code>crossValidationFeatureSelection_Bin,
				 improvedResiduals,
				 bootstrapVarElimination_Res</code></p>


</div>