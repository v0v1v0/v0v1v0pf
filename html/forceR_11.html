<div class="container">

<table style="width: 100%;"><tr>
<td>find_best_fits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Best Polynomial Fits for Curves</h2>

<h3>Description</h3>

<p>Calculates best model fits for all curves based on AIC criterion. The function fits polynomial functions with 1 to 20 coefficients and uses the Akaike Information
Criterion (AIC) to evaluate the goodness of the fits. A model is considered a good fit, when the percentage of change from one model to the next (e.g. a model with
6 coefficients to a model with 7 coefficients) is, e.g. <code style="white-space: pre;">⁠&lt; 5%⁠</code> when <code>threshold = 5</code>. The first for models meeting this criterion are plotted as colored graphs and the AICs of these models
are visualized in a second plot for each curve. All first four coefficients per curve that fulfill the criterion are stored and in the end, a histogram of how
often which coefficients were good fits is plotted as well. The function returns the numerical value of the coefficient that fulfilled the criterion of a good fit
in most curves.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_best_fits(
  df,
  degrees = 1:20,
  threshold = 5,
  zero_threshold = NULL,
  plot.to.screen = FALSE,
  path.data = NULL,
  path.plots = NULL,
  show.progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The resulting tibble of the function <code>avg_peaks()</code>. See below for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degrees</code></td>
<td>
<p>Numerical vector of polynomial degrees to test. Cannot be infinitely high - if two high, throws error: <code style="white-space: pre;">⁠'degree' must be less than number of unique points⁠</code>.
Default: <code>1:20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Percentage of AIC change compared to previous degree to fit the good-fit-criteria (s.a.). Default: <code>5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_threshold</code></td>
<td>
<p>Either numerical or <code>NULL</code>: If numerical, the function checks if the graph of the current model starts and ends near zero,
e.g. below 0.2 if <code>zero_threshold = 0.2</code>. Default: <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.to.screen</code></td>
<td>
<p>A logical value indicating if results should be
plotted in the current R plot device. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.data</code></td>
<td>
<p>A string character defining where to save the results. If <code>NULL</code>,
data is not stored in a file. Default: <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.plots</code></td>
<td>
<p>A string character defining where to save the plots. If <code>NULL</code>,
plots will not be saved to PDF files. Default: <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.progress</code></td>
<td>
<p>A logical value indicating if progress should be
printed to the console. Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>#' This function expects a tibble made of three columns as <code>df</code>: <code>species</code> containing the species names,
<code>index</code> numerical column, e.g. time (but can be arbitrary continuous unit), for each species,
and <code>force.norm.100</code> containing the averaged and rescaled curve of each species.
</p>


<h3>Value</h3>

<p>Returns the a numerical value representing the number of coefficient that was most often under the first 4 models that were followed by an
AIC-change <code style="white-space: pre;">⁠&lt;= 5%⁠</code> by the next model. Additionally, plots showing the model fits and a histogram of the coefficients that met the 5%-criterion can be
plotted to the plot device or saved as PDFs in <code>path.plots</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Using the forceR::peaks.df.100.avg dataset:

# find smallest polynomial degree that best describes all curves
best.fit.poly &lt;- find_best_fits(df = forceR::peaks.df.100.avg)

best.fit.poly

</code></pre>


</div>