<div class="container">

<table style="width: 100%;"><tr>
<td>penplot_cmp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot penetrance functions from competing risk models
</h2>

<h3>Description</h3>

<p>Plots the penetrance functions from competing risk models given the values of baseline parameters and regression coefficients and choices of baseline and frailty distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">penplot_cmp(event, base.parms, vbeta, cuts = NULL, variation = "none", 
          base.dist = "Weibull", frailty.dist = NULL, depend = c(1, 1), 
          agemin = 20, agemax = 80, print = TRUE, 
          col = c("blue","red","blue","red"),  lty = c(1, 1, 2, 2), 
          add.legend = TRUE, add.title = TRUE, x = "topleft", 
          y = NULL, xlab = "Age at onset", ylab = "Penetrance", 
          ylim = NULL, main = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>Event of interest for penetrance function: either 1 or 2. Default is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.parms</code></td>
<td>

<p>List of vectors of parameter values for the specified baseline hazard functions for both events. For example, <code>base.parms = list(c(lambda1, rho1), c(lambda2, rho2))</code> should be specified when <code>base.dist = c("Weibull", "Weibull")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vbeta</code></td>
<td>

<p>List of vectors of regression coefficients for gender and majorgene, <code>vbeta = list(c(beta1.s, beta1.g), c(beta2.s, beta2.g))</code> for both events. If <code>variation = "secondgene"</code>, regression coefficients for gender, major gene and second gene, <code>vbeta = list(c(beta1.s, beta1.g1, beta1.g2), c(beta2.s, beta2.g1, beta2.g2))</code>, should be specified for each event.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuts</code></td>
<td>

<p>Vector of cut points defining the intervals when <code>base.dist = "piecewise"</code> is specified and must be strictly positive and finite and greater than <code>agemin</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variation</code></td>
<td>

<p>Source of residual familial correlation.  Possible choices are: <code>"frailty"</code> for frailty shared within families, <code>"secondgene"</code> for second gene variation, or <code>"none"</code> for no residual familial correlation. Default is <code>"none"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.dist</code></td>
<td>

<p>Vector of two baseline hazard distributions chosen for competing events. Possible choices are: <code>"Weibull"</code>, <code>"loglogistic"</code>, <code>"Gompertz"</code>, <code>"lognormal"</code>,  <code>"gamma"</code>, or <code>"piecewise"</code>.If only one distribution is specified, the same distribution will be assumed for both events. A vector of two distributions should be specified if different baseline distributions are assumed for different events. Default is <code>c("Weibull", "Weibull")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frailty.dist</code></td>
<td>

<p>Choice of frailty distribution. Possible choices are <code>"gamma"</code> for independent gamma, <code>"lognormal"</code> for independent log-normal, <code>"cgamma"</code> for correlated gamma, <code>"clognormal"</code> for correlated log-normal distribution when <code>variation = "frailty"</code> or <code>"none" or NULL</code> when no frailty distribution is assumed. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depend</code></td>
<td>

<p>Vector of frailty parameter values assumed for specified frailty distribution.  They  corresponds inverse of variance of the frailty distribution. Dependence within families decreases with <code>depend</code> value.  Default value is <code>c(1,1)</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agemin</code></td>
<td>

<p>Minimum age of disease onset. Default is 20 years of age.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agemax</code></td>
<td>

<p>Maximum age of disease onset. Default is 80 years of age.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>Logical; if <code>TRUE</code>, prints the penetrance values by age 70 obtained from the assumed model for male carriers, female carriers, male noncarrers, and female noncarriers.	 Default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>Colors of lines for male carriers, female carriers, male noncarrers, and female noncarriers. Default is <code>c("blue", "red", "blue", "red")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>Types of lines for male carriers, female carriers, male noncarriers, and female noncarriers. Default is <code>c(1, 1, 2, 2)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.legend</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays legend in the plot. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.title</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays title in the plot. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Position of legend; see legend. Defaults are <code>x = "topleft", y = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Title for the x-axis. Default is <code>"Age at Onset"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Title for the y-axis. Default is <code>"Penetrance"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Limits of the y-axis. Default is <code>NULL</code>. If <code>NULL</code>, <code>ylim</code> will be automatically determined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title of the plot. Default is <code>NULL</code>. If <code>NULL</code>, the title will be automatically created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed through to plotting functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p><em>Cause-specific proportional hazard models</em>
The penetrance models for competing events conditional on the covariates   X = c(x<sub>s</sub>, x<sub>g</sub>) are assumed to have the following hazard functions for event <code class="reqn">j = 1, 2</code>:
 h<sub>j</sub>(t|X) = h<sub>0j</sub>(t - t<sub>0</sub>) exp(β<sub>js</sub> * x<sub>s</sub> + β<sub>jg</sub> * x<sub>g</sub>), 
where h<sub>0j</sub>(t) is the baseline hazard function for event <code class="reqn">j</code>, <code class="reqn">j=1,2</code>, t<sub>0j</sub> is a minimum age of disease onset, x<sub>s</sub> and x<sub>g</sub> indicate male (1) or female (0) and carrier (1) or non-carrier (0) of a major gene of interest, respectively.
</p>
<p>The penetrance function for the penetrance model has the form, 1 - exp(- H<sup>0</sup>(t - t<sub>0</sub>) * exp(β<sub>s</sub> * x<sub>s</sub> + β<sub>g</sub> * x<sub>g</sub> )), 
where H<sub>0</sub>(t) is the cumulative baseline hazard function.
</p>
<p><em>Shared frailty models</em>
</p>
<p>The penetrance model conditional on the frailty <code class="reqn">Z</code> and covariates 
  X = c(x<sub>s</sub>, x<sub>g</sub>) is assumed to have the following hazard function:
 h(t|X,Z) = h<sub>0</sub>(t - t<sub>0</sub>) Z exp(β<sub>s</sub> * x<sub>s</sub> + β<sub>g</sub> * x<sub>g</sub>),
where h<sub>0</sub>(t) is the baseline hazard function, t<sub>0</sub> is a minimum age of disease onset, x<sub>x</sub> and x<sub>g</sub> indicate male (1) or female (0) and carrier (1) or non-carrier (0) of a main gene of interest, respectively.
</p>
<p>For example, when using a Weibull distribution for baseline hazard and a gamma distribution for frailty, the penetrance function has the form
 1 - (1 + λ<sup>ρ</sup> * (t - t<sub>0</sub>)<sup>ρ</sup> * exp(β<sub>s</sub> * x<sub>s</sub> + β<sub>g</sub> * x<sub>g</sub>)/κ)<sup>-κ</sup>.
</p>
<p><em>Two-gene models</em>
</p>
<p>The penetrance curve for the two-gene model is generated by
1 - exp(- H<sup>0</sup>(t - t<sub>0</sub>) * exp(β<sub>s</sub> * x<sub>s</sub> + β<sub>1</sub> * x<sub>1</sub> + β<sub>2</sub> * x<sub>2</sub>)), 
where H<sub>0</sub>(t) is the cumulative baseline hazard function,
x<sub>1</sub> indicates carrior (1) or non-carrior (0) of a major gene and x<sub>2</sub> indicates carrior (1) or non-carrior (0) of a second gene.
When plotting with the two-gene model, the plot will generate separate curves for mutation carriers and noncarriers, and separate curves for the second gene carriers and noncarriers.
</p>


<h3>Value</h3>

<p>Displays plots of the penetrance functions and returns the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pen70</code></td>
<td>
<p>Penetrance estimates by age 70 specific to gender and mutation-status subgroups. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.age</code></td>
<td>
<p>Vector of ages of onset ranging from <code>agemin</code> to <code>agemax</code> years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>Penetrance estimates computed at each age of <code>x.age</code>; if <code>variation = "none"</code> or <code>"frailty"</code>, it includes subgroups specific to gender and mutation status for major gene. If <code>variation = "secondgene"</code>, it includes subgroups specific to gender and both mutation statuses for major gene and second gene.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yun-Hee Choi
</p>


<h3>See Also</h3>

<p><code>simfam_cmp, plot.penmodel_cmp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Penetrance function curves for event 1 
# based on Weibull baselines (no frailty)
penplot_cmp(event=1, base.parms = list(c(0.01,3), c(0.01, 3)), 
        vbeta = list(c(-1, 2), c(-1, 1)), variation = "none", 
        base.dist = "Weibull", agemin = 20, ylim = c(0,1))

# Penetrance function curves for event 1 
# based on gamma frailty and Weibull baselines
penplot_cmp(event=1, base.parms = list(c(0.01,3), c(0.01, 3)), 
        vbeta = list(c(-1, 2), c(-1, 1)), depend=c(2, 2), 
        variation = "frailty", frailty.dist="gamma", base.dist = "Weibull", 
        agemin = 20, ylim = c(0,1))

# Penetrance function curves for event 1 
# based on correlated gamma frailty and Weibull baselines
penplot_cmp(event=1, base.parms = list(c(0.01,3), c(0.01, 3)), 
        vbeta = list(c(-1, 2), c(-1, 1)), depend=c(2, 2, 0.2), 
        variation = "frailty", frailty.dist="cgamma", 
        base.dist = "Weibull", agemin = 20, ylim = c(0,1))

# Penetrance function curves for event 1 
# based on correlated lognormal frailty and Weibull baselines
penplot_cmp(event=1, base.parms = list(c(0.01,3), c(0.01, 3)), 
        vbeta = list(c(-1, 2), c(-1, 1)), depend=c(2, 2, 0.2), 
        variation = "frailty", frailty.dist="clognormal", 
        base.dist = "Weibull", agemin = 20, ylim = c(0,1))
</code></pre>


</div>