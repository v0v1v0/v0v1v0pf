<div class="container">

<table style="width: 100%;"><tr>
<td>NormalityTests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tests for normality</h2>

<h3>Description</h3>

<p>A collection of functions of one sample tests for testing normality
of financial return series.
<br></p>
<p>The functions for testing normality are:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>ksnormTest</code> </td>
<td style="text-align: left;"> Kolmogorov-Smirnov normality test, </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>shapiroTest</code> </td>
<td style="text-align: left;"> Shapiro-Wilk's test for normality, </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>jarqueberaTest</code> </td>
<td style="text-align: left;"> Jarque-Bera test for normality, </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>dagoTest</code> </td>
<td style="text-align: left;"> D'Agostino normality test. </td>
</tr>
</table>
<p>Functions for high precision Jarque Bera LM and ALM tests:
</p>

<table><tr>
<td style="text-align: left;">
  <code>jbTest</code> </td>
<td style="text-align: left;"> Performs finite sample adjusted JB, LM and ALM test. </td>
</tr></table>
<p>Additional functions for testing normality from the 'nortest' package:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>adTest</code> </td>
<td style="text-align: left;"> Anderson--Darling normality test, </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>cvmTest</code> </td>
<td style="text-align: left;"> Cramer--von Mises normality test, </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>lillieTest</code> </td>
<td style="text-align: left;"> Lilliefors (Kolmogorov-Smirnov) normality test, </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>pchiTest</code> </td>
<td style="text-align: left;"> Pearson chi-square normality test, </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>sfTest</code> </td>
<td style="text-align: left;"> Shapiro-Francia normality test. </td>
</tr>
</table>
<p>For SPlus/Finmetrics Compatibility:
</p>

<table><tr>
<td style="text-align: left;">
  <code>normalTest</code> </td>
<td style="text-align: left;"> test suite for some normality tests. </td>
</tr></table>
<h3>Usage</h3>

<pre><code class="language-R">ksnormTest(x, title = NULL, description = NULL)

jbTest(x, title = NULL, description = NULL)
shapiroTest(x, title = NULL, description = NULL)
normalTest(x, method = c("sw", "jb"), na.rm = FALSE)

jarqueberaTest(x, title = NULL, description = NULL)
dagoTest(x, title = NULL, description = NULL)

adTest(x, title = NULL, description = NULL)
cvmTest(x, title = NULL, description = NULL)
lillieTest(x, title = NULL, description = NULL)
pchiTest(x, title = NULL, description = NULL)
sfTest(x, title = NULL, description = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a numeric vector of data values or an S4 object of class
<code>"timeSeries"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>an optional character string, if not specified the inputs data name
is deparsed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>

<p>optional description string, or a vector of character strings.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>for <code>normalTest</code> only, indicates one of four different methods
for the normality test, one of <code>"ks"</code> (Kolmogorov-Smirnov
one-sample test, the the default), <code>"sw"</code> (Shapiro-Wilk test),
<code>"jb"</code> (Jarque-Bera Test), and <code>"da"</code> (D'Agostino Test).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>for <code>normalTest</code> only, a logical value. Should missing values
removed before computing the tests? The default value is
<code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The hypothesis tests may be of interest for many financial
and economic applications, especially for the investigation
of univariate time series returns.
</p>
<p>Several tests for testing if the records from a data set are normally
distributed are available. The input to all these functions may be
just a vector <code>x</code> or a univariate time series object <code>x</code>
of class <code>timeSeries</code>.
</p>
<p>First, there exists a wrapper function which allows to call one from
two normal tests either the Shapiro–Wilks test or the Jarque–Bera
test. This wrapper was introduced for compatibility with S-Plus'
FinMetrics package.
</p>
<p>Also available are the Kolmogorov–Smirnov one sample test and the
D'Agostino normality test.
</p>
<p>The remaining five normal tests are the Anderson–Darling test,
the Cramer–von Mises test, the Lilliefors (Kolmogorov–Smirnov)
test, the Pearson chi–square test, and the Shapiro–Francia test.
They are calling functions from R's contributed package <code>nortest</code>.
The difference to the original test functions implemented in R and
from contributed R packages is that the Rmetrics functions accept
time series objects as input and give a more detailed output report.
</p>
<p>The Anderson-Darling test is used to test if a sample of data came
from a population with a specific distribution, here the normal
distribution. The <code>adTest</code> goodness-of-fit test can be
considered as a modification of the Kolmogorov–Smirnov test which
gives more weight to the tails than does the <code>ksnormTest</code>.
</p>
<p>Note that <code>jarqueBeraTest</code> computes the asymptotic statistic
and p-value, while <code>jbTesT</code> gives final sample approximations.
</p>


<h3>Value</h3>

<p>an object from class <code>fHTEST</code>.
</p>
<p>Slot <code>test</code> is a list containing the following (optionally empty)
elements (in addition to those described in <code>fHTEST</code>):
</p>

<dl>
<dt>ksnormTest</dt>
<dd>
<p>the 'D' statistic and p-values for the three alternatives
'two-sided, 'less' and 'greater'.
</p>
</dd>
<dt>shapiroTest</dt>
<dd>
<p>the 'W' statistic and the p-value.
</p>
</dd>
<dt>jarqueberaTest</dt>
<dd>
<p>no additional elements.
</p>
</dd>
<dt>jbTest</dt>
<dd>
<p>the 'Chi-squared' statistic with 2 degrees of freedom and the
asymptotic p-value. <code>jbTest</code> is the finite sample version of
the Jarque Bera Lagrange multiplier, LM, and adjusted Lagrange
multiplier test, ALM.
</p>
</dd>
<dt>dagoTest</dt>
<dd>
<p>the 'Chi-squared', the 'Z3' (Skewness) and 'Z4' (Kurtosis)
statistic together with the corresponding p values.
</p>
</dd>
<dt>adTest</dt>
<dd>
<p>the 'A' statistic and the p-value.
</p>
</dd>
<dt>cvmTest</dt>
<dd>
<p>the 'W' statistic and the p-value.
</p>
</dd>
<dt>lillieTest</dt>
<dd>
<p>the 'D' statistic and the p-value.
</p>
</dd>
<dt>pchiTest</dt>
<dd>
<p>the value for the 'P' statistic and the p-values for the adjusted
and not adjusted test cases.  In addition the number of classes is
printed, taking the default value due to Moore (1986) computed
from the expression <code>n.classes = ceiling(2 * (n^(2/5)))</code>,
where <code>n</code> is the number of observations.
</p>
</dd>
<dt>sfTest</dt>
<dd>
<p>the 'W' statistic and the p-value.
</p>
</dd>
</dl>
<h3>Note</h3>

<p>Some of the test implementations are selected from R's <code>ctest</code>
and <code>nortest</code> packages.
</p>


<h3>Author(s)</h3>

<p>R-core team for the tests from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s ctest package,<br>
Adrian Trapletti for the runs test from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s tseries package,<br>
Juergen Gross for the normal tests from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s nortest package,<br>
James Filliben for the Fortran program producing the runs report,<br>
Diethelm Wuertz and Helmut Katzgraber for the finite sample JB tests, <br>
Diethelm Wuertz for the Rmetrics <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>-port. <br>
Earlier versions of theses functions  were based on Fortran code of Paul Johnson.
</p>


<h3>References</h3>

<p>Anderson T.W., Darling D.A. (1954);
<em>A Test of Goodness of Fit</em>,
JASA 49:765–69.
</p>
<p>Conover, W. J. (1971);
<em>Practical nonparametric statistics</em>,
New York: John Wiley &amp; Sons.
</p>
<p>D'Agostino R.B., Pearson E.S. (1973);
<em>Tests for Departure from Normality</em>,
Biometrika 60, 613–22.
</p>
<p>D'Agostino R.B., Rosman B. (1974);
<em>The Power of Geary's Test of Normality</em>,
Biometrika 61, 181–84.
</p>
<p>Durbin J. (1961);
<em>Some Methods of Constructing Exact Tests</em>,
Biometrika 48, 41–55.
</p>
<p>Durbin,J. (1973);
<em>Distribution Theory Based on the Sample Distribution Function</em>,
SIAM, Philadelphia.
</p>
<p>Geary R.C. (1947);
<em>Testing for Normality</em>;
Biometrika 36, 68–97.
</p>
<p>Lehmann E.L. (1986);
<em>Testing Statistical Hypotheses</em>,
John Wiley and Sons, New York.
</p>
<p>Linnet K. (1988);
<em>Testing Normality of Transformed Data</em>,
Applied Statistics 32, 180–186.
</p>
<p>Moore, D.S. (1986);
<em>Tests of the chi-squared type</em>,
In: D'Agostino, R.B. and Stephens, M.A., eds.,
Goodness-of-Fit Techniques, Marcel Dekker, New York.
</p>
<p>Shapiro S.S., Francia R.S. (1972);
<em>An Approximate Analysis of Variance Test for Normality</em>,
JASA 67, 215–216.
</p>
<p>Shapiro S.S., Wilk M.B., Chen V. (1968);
<em>A Comparative Study of Various Tests for Normality</em>,
JASA 63, 1343–72.
</p>
<p>Thode H.C. (2002);
<em>Testing for Normality</em>,
Marcel Dekker, New York.
</p>
<p>Weiss M.S. (1978);
<em>Modification of the Kolmogorov-Smirnov
Statistic for Use with Correlated Data</em>,
JASA 73, 872–75.
</p>
<p>Wuertz D., Katzgraber H.G. (2005);
<em>Precise finite-sample quantiles of the
Jarque-Bera adjusted Lagrange multiplier test</em>,
ETHZ Preprint.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- rnorm(100)

## Kolmogorov-Smirnov one-sampe test
ksnormTest(x)

## Shapiro-Wilk test
shapiroTest(x)

## Jarque-Bera Test
jarqueberaTest(x)
jbTest(x)
</code></pre>


</div>