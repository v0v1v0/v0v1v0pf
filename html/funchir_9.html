<div class="container">

<table style="width: 100%;"><tr>
<td>funchir-utils</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Miscellaneous utile functions </h2>

<h3>Description</h3>

<p>Several odds-and-ends functions for data manipulation &amp; representation, etc. See details and examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   create_quantiles(x, num, right = FALSE, na.rm = FALSE,
                    include.lowest = TRUE, labels = 1:num)
   to.pct(x, dig = Inf)
   nx.mlt(x, n)
   divide(x, n, na.rm = FALSE)
   dol.form(x, dig = 0L, suff = "", tex = FALSE)
   ntostr(n, dig = 2L)
   write.packages(con)
   stale_package_check(con)
   embed.mat(mat, M = nrow(mat), N = ncol(mat), m = 1L, n = 1L, fill = 0L)
   get_age(birthdays, ref_dates)
   quick_year(dates)
   quick_mday(dates)
   quick_yday(dates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A numeric vector. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num</code></td>
<td>
<p> A number, typically an integer, specifying how many equal-count intervals into which to divide the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p> logical, indicating if the intervals should be closed on the right (and open on the left) or vice versa. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
 <p><code>logical</code> passed to <code>quantile</code> with the usual interpretation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.lowest</code></td>
<td>
<p> logical, indicating if an <code>x[i]</code> equal to the lowest (or highest, for <code>right = FALSE</code>) <code>breaks</code> value should be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
 <p><code>character</code> vector of length <code>num</code>; the labels to be applied to the resulting <code>factor</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dig</code></td>
<td>
<p> The number of digits to be included past the decimal in output; sent directly to <code>round</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suff</code></td>
<td>
<p> The suffix to appended/unit in which to express <code>x</code>. Currently one of <code>c("", "k", "m", "b")</code>, corresponding to plain units, thousands, millions, and billions, respectively. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tex</code></td>
<td>
<p> Should <code>$</code> be printed as <code>\$</code> for direct copy-pasting to TeX files? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> For <code>nx.mlt</code>, <code>divide</code> and <code>ntostr</code>, a number; see details. For <code>embed.mat</code>, an integer specifying the column at which to insert <code>mat</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con</code></td>
<td>
<p> A file/connection where output should be written. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p> A matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p> An integer specifying the number of rows in the enclosing matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p> An integer specifying the number of columns in the enclosing matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> An integer specifying the row at which to insert <code>mat</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p> An atomic vector specifying how to fill the enclosing matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>birthdays</code></td>
<td>
<p> A vector of <code>Date</code>s. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_dates</code></td>
<td>
<p> A vector of <code>Date</code>s. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p> A vector of <code>Date</code>s. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>create_quantiles</code> is a parsimonious function for generating quantiles of a vector (e.g., quartiles for <code>num=4</code> or quintiles for <code>num=5</code>). Basically a wrapper for the <code>cut</code> function; the type of the output is <code>factor</code>. Fails for vectors with overlapping quantiles (e.g., with &gt;50% of values of <code>x</code> equal to zero) unless the correct number of labels (i.e., the number of unique quantile breaks) is given in the <code>labels</code> argument.
</p>
<p><code>to.pct</code> converts a number (probably a proportion, i.e., typically between 0 and 1) to a percentage; also has an argument (<code>dig</code>) which can be used to round the output inline.
</p>
<p><code>nx.mlt</code> returns the least multiple of <code>n</code> which (weakly) exceeds <code>x</code>. Convenient for making axes ticks land on pretty numbers.
</p>
<p><code>divide</code> divides the range (min through max) of <code>x</code> into <code>n</code> points (basically a shorthand for <code>seq</code>).
</p>
<p><code>dol.form</code> takes a financial input and converts it to a (American-formatted, American-currency) string for printingâ€“appending a dollar sign (<code>"\$"</code>) and inserting commas after every third digit from the left of the decimal point.
</p>
<p><code>ntostr</code> converts <code>n</code> to a <code>character</code> vector with each element width <code>dig</code>. This is particularly nice for converting 99:100 to "99" and "100".
</p>
<p><code>write.packages</code> captures the current package environment (inspired by <code>sessionInfo()</code> and writes it as a JSON to <code>con</code> with <code>writeLines</code>; a <code>list</code> version of this object is returned. This may be essential for tracking across time which package versions were being used.
</p>
<p><code>stale_package_check</code> reads a file (with <code>readLines</code>) and checks which functions are actually used from each loaded package. Currently only checks for <code>library</code> (i.e., not <code>require</code>) calls.
</p>
<p><code>embed.mat</code> inserts a supplied matrix into a (weakly) larger enclosing matrix, typically filled with 0s, at a specified position.
</p>
<p><code>get_age</code> returns the accurate, fractional age (in years) of each individual, quickly. Accuracy deteriorates when non-leap century years are involved (i.e., any year congruent to 0 mod 100 but not 0 mod 400); designed for use with currently-relevant birthdays and ages.
</p>
<p><code>quick_year</code> converts a <code>Date</code> object into its year efficiently; also ignores concerns of leap centuries. <code>quick_mday</code> returns the day of the month. <code>quick_yday</code> returns the day of the year. Returns as an <code>integer</code>.
</p>


<h3>See Also</h3>

<p><code>cut</code>, <code>prettyNum</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- runif(100)

  # Return which multiple of 1/7 least
  #   exceeds each element of x
  create_quantiles(x, 7)

  to.pct(x)
  to.pct(x, dig = 2) #output of the form xxx.xx

  nx.mlt(x, 1/3)

  dol.form(x, dig=2L)

  ntostr(999:1000, dig = 3L) # c("999","000")
  ntostr(999:1000, dig = 2L) # c("99","00")

  library(stats)
  write.packages()

  inmat &lt;- matrix(1:9, ncol = 3L)
  embed.mat(inmat, M = 4L, N = 4L)
  embed.mat(inmat, N = 6L, n = 4L, fill = NA)

  d1 = as.Date('1987-05-02')
  d2 = as.Date('2016-02-23')
  get_age(d1, d2)
  quick_year(d1)
  quick_mday(d1)
</code></pre>


</div>