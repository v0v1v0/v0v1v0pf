<div class="container">

<table style="width: 100%;"><tr>
<td>modelFAMT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The FAMT complete multiple testing procedure
</h2>

<h3>Description</h3>

<p>This function implements the whole FAMT procedure (including <code>nbfactors</code> and <code>emfa</code>). The number of factors considered in the model is chosen to reduce the variance of the number of the false discoveries. The model parameters are estimated using an EM algorithm. Factor-adjusted tests statistics are derived, as well as the corresponding p-values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">modelFAMT(data, x = 1, test = x[1], nbf = NULL, maxnbfactors = 8, 
min.err = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>'FAMTdata' object, see <code>as.FAMTdata</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Column number(s) corresponding to the experimental condition and the optional covariates (1 by default) in the covariates data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Column number corresponding to the experimental condition (x[1] by default) one which the test is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbf</code></td>
<td>
<p>The number of factors of the FA model (NULL by default). If NULL, the function estimates the optimal nbf (see <code>nbfactors</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxnbfactors</code></td>
<td>
<p>The maximum number of factors (8 by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.err</code></td>
<td>
<p>Stopping criterion value for iterations (default value:0.001)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>adjpval</code></td>
<td>
<p>Vector of FAMT factor-adjusted p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjtest</code></td>
<td>
<p>Vector of FAMT factor-adjusted F statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjdata</code></td>
<td>
<p>Factor-adjusted FAMT data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FA</code></td>
<td>
<p>Estimation of the FA model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>Vector of classical p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Column number(s) corresponding to the experimental condition and the optional covariates in the covariates data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Column number corresponding to the experimental condition on which the test is performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbf</code></td>
<td>
<p>The number of factors used to fit the FA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idcovar</code></td>
<td>
<p>The column number used for the array identification in the 'covariates' data frame</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The user can perform individual test statistics putting the number of factors (<code>nbf</code>) equal to zero.  
The result of this function is a 'FAMTmodel'. It is used as argument in other functions of the package : <code>summaryFAMT</code>, <code>pi0FAMT</code> or <code>defacto</code>. 
We advise to carry out a summary of FAMT model with the function <code>summaryFAMT</code>.
</p>


<h3>Author(s)</h3>

<p>David Causeur</p>


<h3>References</h3>

<p>Friguet C., Kloareg M. and Causeur D. (2009). A factor model approach to multiple testing under dependence. Journal of the American Statistical Association, 104:488, p.1406-1415 </p>


<h3>See Also</h3>

<p><code>as.FAMTdata</code>, <code>raw.pvalues</code>, <code>nbfactors</code>, <code>emfa</code>, <code>summaryFAMT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Reading 'FAMTdata'
data(expression)
data(covariates)
data(annotations)

chicken = as.FAMTdata(expression,covariates,annotations,idcovar=2)

# Classical method with modelFAMT 
## Not run: modelpval=modelFAMT(chicken,x=c(3,6),test=6,nbf=0)
## Not run: summaryFAMT(modelpval)

# FAMT complete multiple testing procedure
# when the optimal number of factors is unknown
## Not run: model = modelFAMT(chicken,x=c(3,6),test=6)

# when the optimal number of factors has already been estimated 
 model = modelFAMT(chicken,x=c(3,6),test=6,nbf=3)

summaryFAMT(model)
hist(model$adjpval)
## End(Not run)
</code></pre>


</div>