<div class="container">

<table style="width: 100%;"><tr>
<td>fasano.franceschini.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fasano-Franceschini Test</h2>

<h3>Description</h3>

<p>Performs a two-sample multivariate Kolmogorov-Smirnov test as described
by Fasano and Franceschini (1987). This test evaluates the null hypothesis
that two i.i.d. random samples were drawn from the same underlying
probability distribution. The data can be of any dimension and of any
type (continuous, discrete, or mixed).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fasano.franceschini.test(
  S1,
  S2,
  nPermute = 100,
  threads = 1,
  seed = NULL,
  verbose = TRUE,
  method = c("r", "b")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S1</code></td>
<td>
<p><code>matrix</code> or <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p><code>matrix</code> or <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPermute</code></td>
<td>
<p>A nonnegative <code>integer</code> setting the number of permutations
to use for performing the permutation test. Default is <code>100</code>. If set to
<code>0</code>, only the test statistic is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>A positive <code>integer</code> or <code>"auto"</code> setting the number
of threads to use during the permutation test. If set to <code>"auto"</code>, the
number of threads is determined by <code>RcppParallel::defaultNumThreads()</code>.
Default is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An optional integer to seed the PRNG used for the permutation test.
A seed must be passed to reproducibly compute p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A <code>boolean</code> indicating whether to display a progress bar.
Default is <code>TRUE</code>. Only available when <code>threads = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>An optional <code>character</code> indicating which method to use to
compute the test statistic. The two methods are <code>'r'</code> (range tree) and
<code>'b'</code> (brute force). Both methods return the same results but may vary in
computation speed. If this argument is not passed, the sample sizes and dimension
of the data are used to infer which method is likely faster. See the Details
section for more information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test statistic can be computed using two different methods.
Both methods return identical results, but have different time complexities:
</p>

<ul>
<li>
<p> Range tree method: This method has a time complexity of
<em>O(N*log(N)^(d-1))</em>, where <em>N</em> is the size of the larger sample
and <em>d</em> is the dimension of the data.
</p>
</li>
<li>
<p> Brute force method: This method has a time complexity of <em>O(N^2)</em>.
</p>
</li>
</ul>
<p>The range tree method tends to be faster for low dimensional data or large
sample sizes, while the brute force method tends to be faster for high
dimensional data or small sample sizes. When <code>method</code> is not passed,
the sample sizes and dimension of the data are used to infer which method will
likely be faster. However, as the geometry of the samples can influence
computation time, the method inferred to be faster may not actually be faster. To
perform more comprehensive benchmarking for a specific dataset, <code>nPermute</code>
can be set equal to <code>0</code>, which bypasses the permutation test and only
computes the test statistic.
</p>


<h3>Value</h3>

<p>A list of class <code>htest</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The permutation test p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The name of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>The names of the original data objects.</p>
</td>
</tr>
</table>
<h3>References</h3>



<ul><li>
<p>Fasano, G. &amp; Franceschini, A. (1987). A multidimensional version of the
Kolmogorov-Smirnov test. <em>Monthly Notices of the Royal Astronomical Society</em>,
225:155-170. <a href="https://doi.org/10.1093/mnras/225.1.155">doi:10.1093/mnras/225.1.155</a>.
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(0)

# create 2-D samples
S1 &lt;- data.frame(x = rnorm(n = 20, mean = 0, sd = 1),
                 y = rnorm(n = 20, mean = 1, sd = 2))
S2 &lt;- data.frame(x = rnorm(n = 40, mean = 0, sd = 1),
                 y = rnorm(n = 40, mean = 1, sd = 2))

# perform test
fasano.franceschini.test(S1, S2)

# perform test with more permutations
fasano.franceschini.test(S1, S2, nPermute = 150)

# set seed for reproducible p-value
fasano.franceschini.test(S1, S2, seed = 0)$p.value
fasano.franceschini.test(S1, S2, seed = 0)$p.value

# perform test using range tree method
fasano.franceschini.test(S1, S2, method = 'r')

# perform test using brute force method
fasano.franceschini.test(S1, S2, method = 'b')

# perform test using multiple threads to speed up p-value computation
## Not run: 
fasano.franceschini.test(S1, S2, threads = 2)

## End(Not run)

</code></pre>


</div>