<div class="container">

<table style="width: 100%;"><tr>
<td>DVARS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>DVARS</h2>

<h3>Description</h3>

<p>Computes the DSE decomposition and DVARS-related statistics. Based on code
from github.com/asoroosh/DVARS .
</p>


<h3>Usage</h3>

<pre><code class="language-R">DVARS(
  X,
  normalize = TRUE,
  cutoff_DPD = 5,
  cutoff_ZD = qnorm(1 - 0.05/nrow(as.matrix_ifti(X))),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code class="reqn">T</code> by <code class="reqn">N</code> numeric matrix representing an fMRI run. There should
not be any missing data (<code>NA</code> or <code>NaN</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Normalize the data? Default: <code>TRUE</code>. Normalization removes
constant-zero voxels, scales by 100 / the median of the mean image, and
then centers each voxel on its mean.
</p>
<p>To replicate Afyouni and Nichols' procedure for the HCP MPP data, since the
HCP scans are already normalized to 10,000, just divide the data by 100 and
center the voxels on their means:
</p>
<p><code>Y &lt;- Y/100; DVARS(t(Y - apply(Y, 1, mean)))</code> where <code>Y</code> is the
<code class="reqn">V</code> by <code class="reqn">T</code> data matrix.
</p>
<p>Note that while voxel centering doesn't affect DVARS, it does affect
DPD and ZD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff_DPD, cutoff_ZD</code></td>
<td>
<p>Numeric outlier cutoffs. Timepoints
exceeding these cutoffs will be flagged as outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should occasional updates be printed? Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components
</p>

<dl>
<dt>measure</dt>
<dd>
<p>A data.frame with <code class="reqn">T</code> rows, each column being a different variant of DVARS.</p>
</dd>
<dt>measure_info</dt>
<dd>
<p>"DVARS"</p>
</dd>
<dt>outlier_cutoff</dt>
<dd>
<p>The outlier cutoff value(s).</p>
</dd>
<dt>outlier_flag</dt>
<dd>
<p>A logical data.frame with <code class="reqn">T</code> rows, where <code>TRUE</code> indicates suspected outlier presence.</p>
</dd>
</dl>
<h3>References</h3>


<ul><li>
<p>Afyouni, S. &amp; Nichols, T. E. Insight and inference for DVARS. NeuroImage 172, 291-312 (2018).
</p>
</li></ul>
</div>