<div class="container">

<table style="width: 100%;"><tr>
<td>predict.fregre.gkam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for functional linear model</h2>

<h3>Description</h3>

<p>Computes predictions for regression between functional (and non functional)
explanatory variables and scalar response. 
</p>
 
<ul>
<li> <p><code>predict.fregre.lm</code>, Predict method for functional linear model of
<code>fregre.lm</code> fits object using basis or principal component
representation.
</p>
</li>
<li> <p><code>predict.fregre.plm</code>, Predict method for
semi-functional linear regression model of <code>fregre.plm</code> fits
object using using asymmetric kernel estimation. 
</p>
</li>
<li> <p><code>predict.fregre.glm</code>, Predict method for functional generalized linear
model of <code>fregre.glm</code> fits object using basis or principal
component representation. 
</p>
</li>
<li> <p><code>predict.fregre.gsam</code>, Predict method for functional generalized 
spectral additive model of <code>fregre.gsam</code> fits object using basis 
or principal component representation.
</p>
</li>
<li> <p><code>predict.fregre.gkam</code>, Predict method for functional generalized 
kernel additive model of <code>fregre.gkam</code> fits object using 
backfitting algorithm. 
</p>
</li>
</ul>
<p>These functions use the model fitting function <code>lm</code>,
<code>glm</code> or <code>gam</code> properties.<br> If using functional
data derived, is recommended to use a number of bases to represent beta
lower than the number of bases used to represent the functional data. <br>
The first item in the <code>data</code> list of <code>newx</code> argument is called
<em>"df"</em> and is a data frame with the response and non functional
explanatory variables, as <code>lm</code>, <code>glm</code> or
<code>gam</code>. Functional variables (<code>fdata</code> and <code>fd</code> class)
are introduced in the following items in the <code>data</code> list of <code>newx</code>
argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'fregre.gkam'
predict(object, newx = NULL, type = "response", ...)

## S3 method for class 'fregre.glm'
predict(object, newx = NULL, type = "response", ...)

## S3 method for class 'fregre.gsam'
predict(object, newx = NULL, type = "response", ...)

## S3 method for class 'fregre.lm'
predict(
  object,
  newx = NULL,
  type = "response",
  se.fit = FALSE,
  scale = NULL,
  df = df,
  interval = "none",
  level = 0.95,
  weights = 1,
  pred.var = res.var/weights,
  ...
)

## S3 method for class 'fregre.plm'
predict(object, newx = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>fregre.lm</code>, <code>fregre.plm</code>, <code>fregre.glm</code>,
<code>fregre.gsam</code><br> or <code>fregre.gkam</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newx</code></td>
<td>
<p>An optional data list in which to look for variables with which
to predict. If omitted, the fitted values are used. List of new explanatory
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character vector, Type of prediction: (<code>response</code>, <code>terms</code> for model terms or <code>effects</code>  for model terms where
the partial effects are summarized for each functional variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>=TRUE (not default) standard error estimates are returned for
each prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Scale parameter for std.err. calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom for scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>Type of interval calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Tolerance/confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>variance weights for prediction. This can be a numeric vector
or a one-sided model formula. In the latter case, it is interpreted as an
expression evaluated in newdata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.var</code></td>
<td>
<p>the variance(s) for future observations to be assumed for
prediction intervals. See <code>link{predict.lm}</code> for more details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return the predicted values and optionally:
</p>

<ul>
<li> <p>predict.lm,predict.glm,predict.gam produces a vector of predictions
or a matrix of predictions and bounds with column names fit, lwr, and upr if
interval is set. If se.fit is TRUE, a list with the following components is
returned: fit vector or matrix as above. 
</p>
</li>
<li> <p>se.fit standard error of predicted means. 
</p>
</li>
<li> <p>residual.scale residual standard deviations.
</p>
</li>
<li> <p>df degrees of freedom for residual.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).
<em>Statistical Computing in Functional Data Analysis: The R Package
fda.usc.</em> Journal of Statistical Software, 51(4), 1-28.
<a href="https://www.jstatsoft.org/v51/i04/">https://www.jstatsoft.org/v51/i04/</a>
</p>


<h3>See Also</h3>

<p>See Also as: <code>fregre.lm</code>, <code>fregre.plm</code>,
<code>fregre.glm</code>, <code>fregre.gsam</code> and
<code>fregre.gkam</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
ind &lt;- 1:129
x &lt;- tecator$absorp.fdata
x.d2 &lt;- fdata.deriv(x,nderiv=2)
tt &lt;- x[["argvals"]]
dataf &lt;- as.data.frame(tecator$y)
ldat &lt;- ldata("df" = dataf[ind,], "x.d2" = x.d2[ind])
basis.x &lt;- list("x.d2" = create.pc.basis(ldat$x.d2))
res &lt;- fregre.gsam(Fat ~  s(x.d2,k=3),
                   data=ldat, family = gaussian(),
                   basis.x = basis.x)
newldat &lt;- ldata("df" = dataf[-ind,], "x.d2" = x.d2[-ind])
pred &lt;- predict(res, newldat)
plot(pred,tecator$y$Fat[-ind])
res.glm &lt;- fregre.glm(Fat  ~  x.d2, data = ldat,
                  family = gaussian(),basis.x = basis.x)
pred.glm &lt;- predict(res.glm, newldat)
newy &lt;- tecator$y$Fat[-ind]
points(pred.glm,tecator$y$Fat[-ind],col=2)

# Time-consuming 
res.gkam &lt;- fregre.gkam(Fat ~ x.d2, data = ldat)
pred.gkam &lt;- predict(res.gkam, newldat)
points(pred.gkam,tecator$y$Fat[-ind],col = 4)

((1/length(newy)) * sum((drop(newy)-pred)^2)) / var(newy)
((1/length(newy)) * sum((newy-pred.glm)^2)) / var(newy)    
((1/length(newy)) * sum((newy-pred.gkam)^2)) / var(newy)    

## End(Not run)                                                                                                              
</code></pre>


</div>