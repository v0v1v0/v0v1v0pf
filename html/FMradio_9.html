<div class="container">

<table style="width: 100%;"><tr>
<td>FAsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate data according to the common factor analytic model
</h2>

<h3>Description</h3>

<p><code>FAsim</code> is a function that enables the simulation of data according to the common factor analytic model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FAsim(p, m, n, simplestructure = TRUE, balanced = TRUE,
      loadingfix = TRUE, loadingnegative = TRUE,
      loadingvalue = .8, loadingvaluelow = .2, numloadings,
      loadinglowerH = .7, loadingupperH = .9, 
      loadinglowerL = .1, loadingupperL = .3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>A <code>numeric</code> integer or <code>integer</code> indicating the number of observed features.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>A <code>numeric</code> integer or <code>integer</code> indicating the latent dimension of the factor solution (i.e., the number of factors).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>A <code>numeric</code> integer or <code>integer</code> indicating the number of samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplestructure</code></td>
<td>

<p>A <code>logical</code> indicating if the generating factor structure should be factorially pure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balanced</code></td>
<td>

<p>A <code>logical</code> indicating if the high (i.e., qualitatively 'significant') loadings should be divided evenly over the respective factors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadingfix</code></td>
<td>

<p>A <code>logical</code> indicating if the loadings should have a fixed value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadingnegative</code></td>
<td>

<p>A <code>logical</code> indicating if, next to positive, also negative loadings should be present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadingvalue</code></td>
<td>

<p>A <code>numeric</code> indicating the value for high (i.e., qualitatively 'significant') loadings. Used when <code>loadingfix = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadingvaluelow</code></td>
<td>

<p>A <code>numeric</code> indicating the value for low loadings. Used when <code>loadingfix = TRUE</code> &amp; <code>simplestructure = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numloadings</code></td>
<td>

<p>A <code>numeric</code> vector with length equalling argument <code>m</code>, indicating the number of high (i.e., qualitatively 'significant') loadings per factor.<br> 
Used when <code>balanced = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadinglowerH</code></td>
<td>

<p>A <code>numeric</code> indicating the lower-bound of high (i.e., qualitatively 'significant') loadings. Used when <code>loadingfix = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadingupperH</code></td>
<td>

<p>A <code>numeric</code> indicating the upper-bound of high (i.e., qualitatively 'significant') loadings. Used when <code>loadingfix = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadinglowerL</code></td>
<td>

<p>A <code>numeric</code> indicating the lower-bound of low (i.e., qualitatively 'non-significant') loadings. Used when <code>loadingfix = FALSE</code> &amp; <code>simplestructure = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadingupperL</code></td>
<td>

<p>A <code>numeric</code> indicating the upper-bound of low (i.e., qualitatively 'non-significant') loadings. Used when <code>loadingfix = FALSE</code> &amp; <code>simplestructure = FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>FAsim</code> provides certain flexibility when generating data according to an orthogonal common factor-analytic model.
It can produce data according to, for example, (i) factorially pure loadings structures, (ii) loadings-structures with only positive entries or both positive and negative loadings, (iii) loadings-structures with fixed values or varying values, (iv) balanced and unbalanced loadings-structures.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>list</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$data</code></td>
<td>
<p>A standardized data <code>matrix</code> of size <code class="reqn">n \times p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$loadings</code></td>
<td>
<p>Loadings <code>matrix</code> of size <code class="reqn">p \times m</code> on which the data-generation was based.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$Uniqueness</code></td>
<td>
<p>A <code>numeric</code> vector of size <code class="reqn">p</code> representing the uniquenesses on which the data-generation was based.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$cormatrix</code></td>
<td>
<p>A <code class="reqn">p \times p</code> correlation <code>matrix</code> based on the generated data in slot <code>$data</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>


<ul>
<li>
<p> A uniform distribution is assumed when generating draws between <code>loadinglowerH</code> and <code>loadingupperH</code>.
</p>
</li>
<li>
<p> A uniform distribution is assumed when generating draws between <code>loadinglowerL</code> and <code>loadingupperL</code>.
</p>
</li>
<li>
<p> The argument <code>m</code> cannot exceed the Ledermann-bound (Ledermann, 1937): <code class="reqn">\lfloor [2p + 1 - (8p + 1)^{1/2}]/2\rfloor</code>, where <code class="reqn">p</code> indicates the observed-feature dimension.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Carel F.W. Peeters &lt;cf.peeters@vumc.nl&gt;
</p>


<h3>References</h3>

<p>Ledermann, W. (1937). On the rank of the reduced correlational matrix in multiple factor analysis. Psychometrika, 2:85â€“93.
</p>
<p>Peeters, C.F.W. <em>et al.</em> (2019). Stable prediction with radiomics data.
<a href="https://arxiv.org/abs/1903.11696">arXiv:1903.11696 [stat.ML]</a>.
</p>


<h3>See Also</h3>

<p><code>dimGB</code>, <code>mlFA</code>, <code>facScore</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate some data according to a factor model with 3 latent factors
## Balanced and factorially pure loadings structure
simDAT &lt;- FAsim(p = 24, m = 3, n = 40, loadingvalue = .9)
simDAT$loadings

## Simulate some data according to a factor model with 3 latent factors
## Unbalanced and factorially pure loadings structure
simDAT &lt;- FAsim(p = 24, m = 3, n = 40, loadingvalue = .9,
                balanced = FALSE, numloadings = c(10,10,4))
simDAT$loadings

## Simulate some data according to a factor model with 3 latent factors
## Unbalanced and factorially non-pure loadings structure
simDAT &lt;- FAsim(p = 24, m = 3, n = 40, loadingvalue = .9,
                balanced = FALSE, numloadings = c(10,10,4),
                simplestructure = FALSE)
simDAT$loadings

## Simulate some data according to a factor model with 3 latent factors
## Unbalanced and factorially non-pure loadings structure
## Non-fixed high and low loadings
simDAT &lt;- FAsim(p = 24, m = 3, n = 40, loadingvalue = .9,
                balanced = FALSE, numloadings = c(10,10,4),
                simplestructure = FALSE, loadingfix = FALSE)
simDAT$loadings
</code></pre>


</div>