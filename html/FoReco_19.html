<div class="container">

<table style="width: 100%;"><tr>
<td>cstd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-sectional top-down reconciliation</h2>

<h3>Description</h3>

<p>Top-down forecast reconciliation for genuine hierarchical/grouped time series
(Gross and Sohl, 1990), where the forecast of a ‘Total’ (top-level series,
expected to be positive) is disaggregated according to a proportional scheme
(weights). Besides fulfilling any aggregation constraint, the top-down
reconciled forecasts should respect two main properties:
</p>

<ul>
<li>
<p> the top-level value remains unchanged;
</p>
</li>
<li>
<p> all the bottom time series reconciled forecasts are non-negative.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">cstd(base, agg_mat, weights, normalize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>A (<code class="reqn">h \times 1</code>) numeric vector containing the top-level base forecast;
<code class="reqn">h</code> is the forecast horizon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_mat</code></td>
<td>
<p>A (<code class="reqn">n_a \times n_b</code>) numeric matrix representing the cross-sectional
aggregation matrix. It maps the <code class="reqn">n_b</code> bottom-level (free)
variables into the <code class="reqn">n_a</code> upper (constrained) variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A (<code class="reqn">h \times n_b</code>) numeric matrix containing the proportions for the
bottom time series; <code class="reqn">h</code> is the forecast horizon, and <code class="reqn">n_b</code> is the total number
of bottom variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>If <code>TRUE</code> (<em>default</em>), the <code>weights</code> will sum to 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A (<code class="reqn">h \times n</code>) numeric matrix of cross-sectional reconciled forecasts.
</p>


<h3>References</h3>

<p>Gross, C.W. and Sohl, J.E. (1990), Disaggregation methods to expedite product
line forecasting. <em>Journal of Forecasting</em> 9(3), 233–254. <a href="https://doi.org/10.1002/for.3980090304">doi:10.1002/for.3980090304</a>
</p>


<h3>See Also</h3>

<p>Top-down reconciliation: 
<code>cttd()</code>,
<code>tetd()</code>
</p>
<p>Cross-sectional framework: 
<code>csboot()</code>,
<code>csbu()</code>,
<code>cscov()</code>,
<code>cslcc()</code>,
<code>csmo()</code>,
<code>csrec()</code>,
<code>cstools()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# Aggregation matrix for Z = X + Y, X = XX + XY and Y = YX + YY
A &lt;- matrix(c(1,1,1,1,1,1,0,0,0,0,1,1), 3, byrow = TRUE)
# (3 x 1) top base forecasts vector (simulated), forecast horizon = 3
topf &lt;- rnorm(3, 10)
# Same weights for different forecast horizons
fix_weights &lt;- runif(4)
reco &lt;- cstd(base = topf, agg_mat = A, weights = fix_weights)

# Different weights for different forecast horizons
h_weights &lt;- matrix(runif(4*3), 3, 4)
recoh &lt;- cstd(base = topf, agg_mat = A, weights = h_weights)

</code></pre>


</div>