<div class="container">

<table style="width: 100%;"><tr>
<td>GloDenReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global density regression.</h2>

<h3>Description</h3>

<p>Global Fréchet regression for densities with respect to <code class="reqn">L^2</code>-Wasserstein distance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GloDenReg(
  xin = NULL,
  yin = NULL,
  hin = NULL,
  qin = NULL,
  xout = NULL,
  optns = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xin</code></td>
<td>
<p>An n by p matrix or a vector of length n (if p=1) with input measurements of the predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yin</code></td>
<td>
<p>A matrix or list holding the sample of observations of the response. If <code>yin</code> is a matrix, each row holds the observations of the response corresponding to a row in <code>xin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hin</code></td>
<td>
<p>A list holding the histograms of the response corresponding to each row in <code>xin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qin</code></td>
<td>
<p>A matrix or list holding the quantile functions of the response. If <code>qin</code> is a matrix, each row holds the quantile function of the response taking values on <code>optns$qSup</code> corresponding to a row in <code>xin</code>.
Note that only one of the three <code>yin</code>, <code>hin</code>, and <code>qin</code> needs to be input.
If more than one of them are specified, <code>yin</code> overwrites <code>hin</code>, and <code>hin</code> overwrites <code>qin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xout</code></td>
<td>
<p>A k by p matrix or a vector of length k (if p=1) with output measurements of the predictors. Default is <code>xin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optns</code></td>
<td>
<p>A list of control parameters specified by <code>list(name=value)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Available control options are <code>qSup</code>, <code>nqSup</code>, 
<code>lower</code>, <code>upper</code>, <code>Rsquared</code>, <code>bwDen</code>, <code>ndSup</code>, <code>dSup</code>, 
<code>delta</code>, <code>kernelDen</code>, <code>infSupport</code>, and <code>denLowerThreshold</code>. 
<code>Rsquared</code> is explained as follows and see <code>LocDenReg</code> for the other options.
</p>

<dl>
<dt>Rsquared</dt>
<dd>
<p>A logical variable indicating whether R squared would be returned. Default is <code>FALSE</code>.</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xout</code></td>
<td>
<p>Input <code>xout</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dout</code></td>
<td>
<p>A matrix or list holding the output densities corresponding to <code>xout</code>. If <code>dout</code> is a matrix, each row gives a density and the domain grid is given in <code>dSup</code>. If <code>dout</code> is a list, each element is a list of two components, <code>x</code> and <code>y</code>, giving the domain grid and density function values, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dSup</code></td>
<td>
<p>A numeric vector giving the domain grid of <code>dout</code> when it is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qout</code></td>
<td>
<p>A matrix holding the quantile functions of the output densities. Each row corresponds to a value in <code>xout</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qSup</code></td>
<td>
<p>A numeric vector giving the domain grid of <code>qout</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xin</code></td>
<td>
<p>Input <code>xin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>din</code></td>
<td>
<p>Densities corresponding to the input <code>yin</code>, <code>hin</code> or <code>qin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qin</code></td>
<td>
<p>Quantile functions corresponding to the input <code>yin</code>, <code>hin</code> or <code>qin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsq</code></td>
<td>
<p>A scalar giving the R squared value if <code>optns$Rsquared = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optns</code></td>
<td>
<p>A list of control options used.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><cite>Petersen, A., &amp; Müller, H.-G. (2019). "Fréchet regression for random objects with Euclidean predictors." The Annals of Statistics, 47(2), 691–719.</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">xin = seq(0,1,0.05)
yin = lapply(xin, function(x) {
  rnorm(100, rnorm(1,x,0.005), 0.05)
})
qSup = seq(0,1,0.02)
xout = seq(0,1,0.25)
res1 &lt;- GloDenReg(xin=xin, yin=yin, xout=xout, optns = list(qSup = qSup))
plot(res1)

hin = lapply(yin, function(y) hist(y, breaks = 50, plot=FALSE))
res2 &lt;- GloDenReg(xin=xin, hin=hin, xout=xout, optns = list(qSup = qSup))
plot(res2)

</code></pre>


</div>