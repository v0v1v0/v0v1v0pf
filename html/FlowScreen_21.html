<div class="container">

<table style="width: 100%;"><tr>
<td>mqt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moving quantile threshold</h2>

<h3>Description</h3>

<p>This function calculates the daily moving window quantile threshold for use in 
identifying the partial duration series of streamflow droughts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mqt(TS, Qdr = 0.2, WinSize = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TS</code></td>
<td>
<p>output from <code>create.ts</code> containing a data.frame of flow
time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qdr</code></td>
<td>
<p>Numeric value of the drought threshold quantile.  Default is 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WinSize</code></td>
<td>
<p>Numeric value specifying the size of the moving window in
days.  Default is 30.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The threshold is defined by a moving quantile, where daily threshold 
values are based on the 80th percentile of the flow duration curve 
(i.e. 0.2 quantile) from a 30-day moving window (Beyene et al. 2014). 
With this method, every day of the year has a different threshold based on 
the streamflow measured on the day, the 15 days before 
the day, and the 15 days after the day.The size of the moving window can be 
modified with the WinSize argument, and the percentile can be modified with the
Qdr argument.
</p>


<h3>Value</h3>

<p>Returns a numeric vector containing the streamflow drought threshold
in m3/s for each day of the year.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>References</h3>

<p>Beyene, B.S., Van Loon, A.F., Van Lanen, H.A.J., Torfs, P.J.J.F., 2014. 
Investigation of variable threshold level approaches for hydrological drought 
identification. Hydrol. Earth Syst. Sci. Discuss. 11, 12765-12797. 
http://dx.doi.org/10.5194/hessd-11-12765-2014.
</p>


<h3>See Also</h3>

<p>See <code>create.ts</code> to format the input flow series.
</p>
<p>The following functions use this function: <code>dr.pds</code>, 
<code>dr.events</code>, <code>dr.seas</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cania.sub.ts)
res &lt;- mqt(cania.sub.ts)

# subset one year of the flow series
flow.sub &lt;- cania.sub.ts[cania.sub.ts$year == 1990,]

# plot the 1990 observed flows in dark blue and the daily drought threshold in red
plot(flow.sub$doy, flow.sub$Flow, ylab="Q (m3/s)", xlab="Day of Year",
 pch=19, col="darkblue", type="b")
points(res, pch=19, cex=0.7, col="red")
</code></pre>


</div>