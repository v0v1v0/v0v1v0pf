<div class="container">

<table style="width: 100%;"><tr>
<td>boot.resid.quad.plateau</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quadratic plateau model estimation by bootstrapping residuals</h2>

<h3>Description</h3>

<p><code>boot.resid.quad.plateau</code> is the core function to implement bootstrapping residuals on quadratic plateau models, which assumes
y = (a + b * x + c *x^2) * (x &lt;= -0.5*b/c) + (a + -b^2/(4 * c)) * (x &gt; -0.5 * b/c). Note that this function may take minutes up to days. Parallel computing may be necessary.
We suggest users start with a smaller <code>B</code> and moderate n.start to see if the bootstrap models can converge.
In general, increasing n.start and plus_minus may help with ease of convergence. For rigorous statistical inference, B should be on the order of a thousand.
</p>


<h3>Usage</h3>

<pre><code class="language-R">boot.resid.quad.plateau(
  mod,
  data,
  x.range = data.frame(x = seq(0, 280, by = 40)),
  B = 100 - 1,
  plus_minus = 100,
  n.start = 5000,
  print.progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>a full model list, probably from <code>f.quad.plateau()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame with two columns (<code>x</code> and <code>y</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.range</code></td>
<td>
<p>vector of data.frame with one column for range of N rate of interested for prediction interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>bootstrap sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plus_minus</code></td>
<td>
<p>radius of random initial values (default: <code>100</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.start</code></td>
<td>
<p>total number of initial points considered (default: <code>1000</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.progress</code></td>
<td>
<p>logical flag whether printing progress</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>boot.resid.quad.plateau</code> returns a list of two elements:
<code>result</code>: matrix with B rows and columns containing bootstrap sample for parameter (<code>a,b,c</code>), optimal N and yield (<code>max_x, max_y</code>), log-likelihood (<code>logLik</code>) and N values of interest;
<code>x.range</code>: range of x considered for prediction interval (same as <code>x.range</code> in vector form)
</p>


<h3>Examples</h3>

<pre><code class="language-R">

set.seed(1)
x &lt;- rep(1:300, each=5)
a &lt;- 8; b &lt;- 0.05; c &lt;- -1e-4
y &lt;- (a + b * x + c *x^2) * (x &lt;= -0.5*b/c) + (a + -b^2/(4 * c)) * (x &gt; -0.5 * b/c) +
    rnorm(length(x), sd=0.1)
d &lt;- cbind(x,y)

ans &lt;- f.quad.plateau(d, start=list(a = 7, b = 0.02, c = 1e-5),
    plus_minus=10, n.start=10, msg=FALSE)


boot.resid.quad.plateau(ans, d, x.range=seq(0,280,by=40),
    B=1e1-1, plus_minus = 1e2, n.start=1000, print.progress=TRUE) # use larger B for inference





</code></pre>


</div>