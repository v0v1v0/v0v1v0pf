<div class="container">

<table style="width: 100%;"><tr>
<td>rStructuredFactor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of bi-factor and second-order copula models for item response data</h2>

<h3>Description</h3>

<p>Simulating item response data from the bi-factor and second-order copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class="language-R">rBifactor(n, d, grpsize, categ, copnames1,copnames2, theta1, theta2)
rSecond_order(n, d, grpsize, categ, copnames1, copnames2, theta1, theta2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Number of observed variables/items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categ</code></td>
<td>
<p>A vector of categories for the observed variables/items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>
<p><b>For the bi-factor model</b>: copula parameter vector of size <code class="reqn">d</code> for items with the common factor. <b>For the second-order copulas</b>: copula parameter vector of size <code class="reqn">G</code> for the common factor and group-specific factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>
<p><b>For the bi-factor model</b>: copula parameter vector of size <code class="reqn">d</code> for items with the group-specific factor. <b>For the second-order copulas</b>: copula parameter vector of size <code class="reqn">d</code> for items with the group-specific factor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames1</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the common factor. <b>For the second-order factor copula</b>: <code class="reqn">G</code>-vector with the names of bivariate copulas that link the each of the group-specific factors with the common factor, where <code class="reqn">G</code> is the number of groups of items. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames2</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. <b>For the second-order factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Data matrix of dimension <code class="reqn">n\times d</code>, where <code class="reqn">n</code> is the sample size, and <code class="reqn">d</code> is the total number of observed variables/items.
</p>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br>
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132–157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># ---------------------------------------------------
# ---------------------------------------------------
#Sample size
n = 500

#Ordinal Variables  ---------------------------------
d = 9
grpsize=c(3,3,3)
ngrp=length(grpsize)

#Categories for ordinal  ----------------------------
categ = rep(3,d)

# ---------------------------------------------------
# ---------------------------------------------------
#              Bi-factor copula model
# ---------------------------------------------------
# ---------------------------------------------------
#Copula parameters
theta = rep(2.5, d)
delta = rep(1.5, d)

#Copula names
copulanames1 = rep("gum", d)
copulanames2 = rep("gum", d)

#----------------- Simulating data ------------------
data_Bifactor = rBifactor(n, d, grpsize, categ, copulanames1,
copulanames2, theta, delta)

# ---------------------------------------------------
# ---------------------------------------------------
#              Second-order copula model
# ---------------------------------------------------
# ---------------------------------------------------
#Copula parameters
theta= rep(1.5, ngrp)
delta = rep(2.5, d)

#Copula names
copulanames1 = rep("gum", ngrp)
copulanames2 = rep("gum", d)

data_Second_order = rSecond_order(n, d, grpsize, categ,
copulanames1, copulanames2, theta, delta)
</code></pre>


</div>