<div class="container">

<table style="width: 100%;"><tr>
<td>SNPcvinter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for <code>SNPinter</code>
</h2>

<h3>Description</h3>

<p>Performs K-fold cross validation for the revised partially functional interaction regression analysis over a grid of values for the regularization parameter lambda1 and lambda2.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SNPcvinter(y, z, location, X, K, lambda1, lambda2 = NULL, eta = 0,
  type1, nbasis1, params1, Bsplines = 20, norder = 4,
  intercept = FALSE, eps = 1e-05, maxstep = 1e+05, Plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector defining the response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a matrix defining the scalar covariates, with the number of rows equal to the number of samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>a numeric vector defining the sampling sites of the sequence data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix specifying the sequence (genotypes) data, with the number of rows equal to the number of samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>an integer specifying the number of cross-validation folds, default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>a numeric vector specifying the sparsity penalty parameter to be determined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>a numeric vector specifying the group sparsity penalty parameter to be determined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>a numeric vector specifying the penalty parameter for smoothing analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type1</code></td>
<td>
<p>a character specifying the type of the basis functions that constitutes the genetic variation function. The options are "Bspline", "Exponential", "Fourier", "Monomial", and "Power".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis1</code></td>
<td>
<p>an integer specifying the number of basis functions that constitutes the genetic variation function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params1</code></td>
<td>
<p>in addition to rangeval1 (a vector of length 2 giving the lower and upper limits of the range of permissible values for the genetic variation function) and nbasis1, all bases have one or two parameters unique to that basis type or shared with one other;
</p>

<ul>
<li>
<p>bspline: Argument norder = the order of the spline, which is one more than the degree of the polynomials used. This defaults to 4, which gives cubic splines.
</p>
</li>
<li>
<p>exponential: Argument ratevec. In fda_2.0.2, this defaulted to 1. In fda_2.0.3, it will default to 0:1.
</p>
</li>
<li>
<p>fourier: Argument period defaults to diff(rangeval).
</p>
</li>
<li>
<p>monomial/power: Argument exponents. Default = 0:(nbasis-1). For monomial bases, exponents must be distinct nonnegative integers. For power bases, they must be distinct real numbers.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bsplines</code></td>
<td>
<p>an integer specifying the number of basis functions that constitutes the genetic effect function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norder</code></td>
<td>
<p>an integer specifying the order of bsplines that constitutes the genetic effect function, which is one higher than their degree. The default of 4 gives cubic splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>should intercept(s) be fitted (TRUE) or set to zero (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a numeric variable specifying the threshold at which the algorithm terminates, default is 1e-5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxstep</code></td>
<td>
<p>a numeric variable specifying the maximum iteration steps, default is 1e5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plot</code></td>
<td>
<p>should the estimated genetic effect function beta0(t) and interaction items betak(t) be plotted (TRUE) or not (default = FALSE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An "SNPcvinter" object that contains the list of the following items.
</p>

<ul>
<li>
<p>lambda1Select: a numeric value of the sparsity penalty parameter selected by cross validation.
</p>
</li>
<li>
<p>lambda2Select: a numeric value of the group sparsity penalty parameter selected by cross validation.
</p>
</li>
<li>
<p>etaSelect: a numeric value of the smoothing parameter selected by cross validation.
</p>
</li>
<li>
<p>alpha: estimated intercept value..
</p>
</li>
<li>
<p>gamma: estimated coefficients of the scalar covariates.
</p>
</li>
<li>
<p>b: estimated coefficients of the chosen basis functions for the genetic effect function beta0(t) and interaction items betak(t).
</p>
</li>
<li>
<p>betat: an "fd" object, representing the estimated genetic effect function beta(t) and interaction items betak(t).
</p>
</li>
<li>
<p>residuals: the residuals, that is response minus fitted values.
</p>
</li>
<li>
<p>fitted.values:  the fitted mean values.
</p>
</li>
<li>
<p>lambda1: a numeric vector specifying the sparsity penalty parameter for cross validation.
</p>
</li>
<li>
<p>lambda2: a numeric vector specifying the group sparsity penalty parameter for cross validation.
</p>
</li>
<li>
<p>eta: a numeric vector specifying the smoothing parameter for cross validation.
</p>
</li>
<li>
<p>CVerror: a numeric vector, containing the mean square errors on testing set during cross validation.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>See Also as <code>simData2</code>, <code>SNPinter</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(FunctanSNP)
n &lt;- 300
m &lt;- 30
simdata2 &lt;- simData2(n, m, seed = 123)
y &lt;- simdata2$y
z &lt;- simdata2$z
location &lt;- simdata2$location
X &lt;- simdata2$X
lambda1 &lt;- c(0.01, 0.05, 0.1)
lambda2 &lt;- sqrt(3)*lambda1
SNPcvinterres &lt;- SNPcvinter(y, z, location, X, K = 3, lambda1, lambda2, eta = 0,
                            type1 = "Bspline", nbasis1 = 5, params1 = 4, Bsplines = 5,
                            norder = 4, intercept = TRUE, eps = 1e-2, maxstep = 1e2, Plot = TRUE)
SNPcvinterres$lambda1Select
SNPcvinterres$lambda2Select
SNPcvinterres$alpha
SNPcvinterres$gamma
SNPcvinterres$b

</code></pre>


</div>