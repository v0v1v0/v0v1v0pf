<div class="container">

<table style="width: 100%;"><tr>
<td>cov_nnls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate non-negative diagonal terms on G matrix</h2>

<h3>Description</h3>

<p>Helper function for 'G_estimate'. Uses least squares under non-negativity
constraints, mainly relying on 'nnls' capability from 'lsei'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cov_nnls(
  data,
  L,
  out_index,
  data_cov,
  RE_table,
  idx_lst,
  designmat,
  betaHat,
  GTilde,
  non_neg = 0,
  silent = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing all predictor and outcome variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>The dimension of the functional domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_index</code></td>
<td>
<p>Indices of outcome variables in 'data'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_cov</code></td>
<td>
<p>(unsure) Covariance of variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE_table</code></td>
<td>
<p>Data frame containing random effects and interactions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx_lst</code></td>
<td>
<p>(unsure) Column indices of random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>designmat</code></td>
<td>
<p>(unsure)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaHat</code></td>
<td>
<p>Estimates of coefficients of random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GTilde</code></td>
<td>
<p>Current 'GTilde' estimate, created as an intermediate in 'G_estimate'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>non_neg</code></td>
<td>
<p>(unsure), defaults to 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Whether to print the step. Defaults to 'TRUE'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with the same dimensions as 'GTilde'.
</p>


</div>