<div class="container">

<table style="width: 100%;"><tr>
<td>LMDC.select</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Impact points selection of functional predictor and regression using local
maxima distance correlation (LMDC)</h2>

<h3>Description</h3>

<p>LMDC.select function selects impact points of functional predictior using
local maxima distance correlation (LMDC) for a scalar response given.<br>
LMDC.regre function fits a multivariate regression method using the selected
impact points like covariates for a scalar response.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LMDC.select(
  y,
  covar,
  data,
  tol = 0.06,
  pvalue = 0.05,
  plot = FALSE,
  local.dc = TRUE,
  smo = FALSE,
  verbose = FALSE
)

LMDC.regre(
  y,
  covar,
  data,
  newdata,
  pvalue = 0.05,
  method = "lm",
  par.method = NULL,
  plot = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>name of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>vector with the names of the covaviables (or points of impact)
with length <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame with length n rows and at least p + 1 columns,
containing the scalar response and the potencial p covaviables (or points of
impact) in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance value for distance correlation and imapct point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>pvalue of bias corrected distance correlation t-test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical value, if TRUE plots the distance correlation curve for
each covariate in multivariate case and in each discretization points
(argvals) in the functional case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local.dc</code></td>
<td>
<p>Compute local distance correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smo</code></td>
<td>
<p>logical. If TRUE, the curve of distance correlation computed in
the impact points is smoothed using B-spline representation with a suitable
number of basis elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print iterative and relevant steps of the procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with
which to predict.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Name of regression method used, see details. This argument is
used in do.call function like "what" argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.method</code></td>
<td>
<p>List of parameters used to call the method. This argument
is used in do.call function like "args" argument.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>String of characters corresponding to the name of the regression method
called.
Model available options:
</p>
 
<ul>
<li>
<p> "lm": Step-wise lm regression model (uses lm function, stats
package). Recommended for linear models, test linearity using
<code>flm.test</code> function.  
</p>
</li>
<li>
<p> "gam": Step-wise gam regression
model (uses gam function, mgcv package). Recommended for non-linear models.
</p>
</li>
</ul>
<p>Models that use the indicated function of the required package: 
</p>

<ul>
<li>
<p> "svm": Support vector machine (svm function, e1071 package).#' 
</p>
</li>
<li>
<p> "knn": k-nearest neighbor regression (knnn.reg function, FNN package).#' 
</p>
</li>
<li>
<p> "lars": Least Angle Regression using Lasso (lars function, lars
package). 
</p>
</li>
<li>
<p> "glmnet": Lasso and Elastic-Net Regularized Generalized Linear Models
(glmnet and cv.glmnet function, glmnet package).  
</p>
</li>
<li>
<p> "rpart": Recursive partitioning for regression a (rpart function, rpart package).
</p>
</li>
<li>
<p> "flam": Fit the Fused Lasso Additive Model for a Sequence of Tuning
Parameters (flam function, flam package). 
</p>
</li>
<li>
<p> "novas": NOnparametric VAriable Selection (code available in
<a href="https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NOVAS/novas-routines.R">https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NOVAS/novas-routines.R</a>).
</p>
</li>
<li>
<p> "cosso": Fit Regularized Nonparametric Regression Models Using COSSO
Penalty (cosso function, cosso package).  
</p>
</li>
<li>
<p> "npreg": kernel regression estimate of a one (1) dimensional dependent
variable on p-variate explanatory data (npreg function, np package). 
</p>
</li>
<li>
<p> "mars": Multivariate adaptive regression splines (mars function, mda
package). 
</p>
</li>
<li>
<p> "nnet": Fit Neural Networks (nnet function, nnet package). 
</p>
</li>
<li>
<p>"lars": Fits Least Angle Regression, Lasso and Infinitesimal Forward
Stagewise regression models (lars function, lars package).  
</p>
</li>
</ul>
<h3>Value</h3>

<p>LMDC.select function return a list of two elements:
</p>

<ul>
<li> <p><code>cor</code> the value of distance correlation for each covariate. 
</p>
</li>
<li> <p><code>maxLocal</code> index or locations of local maxima distance correlations.
</p>
</li>
</ul>
<p>LMDC.regre function return a list of folowing elements:
</p>

<ul>
<li>
<p>model object corresponding to the estimated method using the selected variables
</p>
</li>
<li>
<p>xvar names of selected variables (impact points). 
</p>
</li>
<li>
<p>edf Effective Degrees of Freedom. 
</p>
</li>
<li>
<p>nvarNumber of selected variables (impact points).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Manuel Oviedo de la Fuente <a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Ordonez, C., Oviedo de la Fuente, M., Roca-Pardinas, J.,
Rodriguez-Perez, J. R. (2018). Determining optimum wavelengths for leaf
water content estimation from reflectance: A distance correlation approach.
<em>Chemometrics and Intelligent Laboratory Systems</em>. 173,41-50
<a href="https://doi.org/10.1016/j.chemolab.2017.12.001">doi:10.1016/j.chemolab.2017.12.001</a>.
</p>


<h3>See Also</h3>

<p>See Also as: <code>lm</code>, <code>gam</code>,
<code>dcor.xy</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
absorp=fdata.deriv(tecator$absorp.fdata,2)
ind=1:129
x=absorp[ind,]
y=tecator$y$Fat[ind]
newx=absorp[-ind,]
newy=tecator$y$Fat[-ind]

## Functional PC regression
res.pc=fregre.pc(x,y,1:6)
pred.pc=predict(res.pc,newx)

# Functional regression with basis representation
res.basis=fregre.basis.cv(x,y)
pred.basis=predict(res.basis[[1]],newx)

# Functional nonparametric regression
res.np=fregre.np.cv(x,y)
pred.np=predict(res.np,newx)

dat    &lt;- data.frame("y"=y,x$data)
newdat &lt;- data.frame("y"=newy,newx$data)

res.gam=fregre.gsam(y~s(x),data=list("df"=dat,"x"=x))
pred.gam=predict(res.gam,list("x"=newx))

dc.raw &lt;- LMDC.select("y",data=dat, tol = 0.05, pvalue= 0.05,
                      plot=F, smo=T,verbose=F)
covar &lt;- paste("X",dc.raw$maxLocal,sep="")                      
# Preselected design/impact points 
covar
ftest&lt;-flm.test(dat[,-1],dat[,"y"], B=500, verbose=F,
    plot.it=F,type.basis="pc",est.method="pc",p=4,G=50)
    
if (ftest$p.value&gt;0.05) { 
  # Linear relationship, step-wise lm is recommended
  out &lt;- LMDC.regre("y",covar,dat,newdat,pvalue=.05,
              method ="lm",plot=F,verbose=F)
} else {
 # Non-Linear relationship, step-wise gam is recommended
  out &lt;- LMDC.regre("y",covar,dat,newdat,pvalue=.05,
              method ="gam",plot=F,verbose=F) }  
             
# Final  design/impact points
out$xvar

# Predictions
mean((newy-pred.pc)^2)                
mean((newy-pred.basis)^2) 
mean((newy-pred.np)^2)              
mean((newy-pred.gam)^2) 
mean((newy-out$pred)^2)

## End(Not run)                          
</code></pre>


</div>