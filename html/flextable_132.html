<div class="container">

<table style="width: 100%;"><tr>
<td>merge_v</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Merge flextable cells vertically</h2>

<h3>Description</h3>

<p>Merge flextable cells vertically when consecutive cells have
identical values. Text of formatted values are used to compare
values if available.
</p>
<p>Two options are available, either a column-by-column algorithm or an
algorithm where the combinations of these columns are used once for all
target columns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">merge_v(x, j = NULL, target = NULL, part = "body", combine = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>flextable</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>column to used to find consecutive values to be merged. Columns
from orignal dataset can also be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>columns names where cells have to be merged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>partname of the table where merge has to be done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine</code></td>
<td>
<p>If the value is TRUE, the columns defined by <code>j</code> will
be combined into a single column/value and the consecutive values of
this result will be used. Otherwise, the columns are inspected one
by one to perform cell merges.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>Other flextable merging function: 
<code>merge_at()</code>,
<code>merge_h()</code>,
<code>merge_h_range()</code>,
<code>merge_none()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ft_merge &lt;- flextable(mtcars)
ft_merge &lt;- merge_v(ft_merge, j = c("gear", "carb"))
ft_merge

data_ex &lt;- structure(list(srdr_id = c(
  "175124", "175124", "172525", "172525",
  "172545", "172545", "172609", "172609", "172609"
), substances = c(
  "alcohol",
  "alcohol", "alcohol", "alcohol", "cannabis",
  "cannabis", "alcohol\n cannabis\n other drugs",
  "alcohol\n cannabis\n other drugs",
  "alcohol\n cannabis\n other drugs"
), full_name = c(
  "TAU", "MI", "TAU", "MI (parent)", "TAU", "MI",
  "TAU", "MI", "MI"
), article_arm_name = c(
  "Control", "WISEteens",
  "Treatment as usual", "Brief MI (b-MI)", "Assessed control",
  "Intervention", "Control", "Computer BI", "Therapist BI"
)), row.names = c(
  NA,
  -9L
), class = c("tbl_df", "tbl", "data.frame"))


ft_1 &lt;- flextable(data_ex)
ft_1 &lt;- theme_box(ft_1)
ft_2 &lt;- merge_v(ft_1,
  j = "srdr_id",
  target = c("srdr_id", "substances")
)
ft_2
</code></pre>


</div>