<div class="container">

<table style="width: 100%;"><tr>
<td>find_peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>find_peaks</h2>

<h3>Description</h3>

<p>Function to scan, column-wise, a matrix of per-taxon observation
density time series. This can be applied to either the histogram
or the kernel density output of <code>densify</code>, but the latter is
recommended. Peaks are detected as local maxima, then smoothed
within a local window and tested to distinguish if they are
noise or significant. Strict threshold is that the peak is
greater than the mean + sd of the window
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_peaks(x, win = 5, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix as outputed by <code>densify</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>A positive integer specifying the window length on
either side of a peak (i.e. win 5 will give a total window of 11 -
-5 indices + peak index + 5 indices)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical determining if function progress
should be reported</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of four, the first three positions containing lists
of the peak indices for each taxon, under raw, mean + sd and mean
detection regimes. The fourth item is a dataframe of counts of peaks
per taxon, 1 row per taxon, 1 column per detection regime
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load dataset
data("brachios")
# subsample brachios to make for a short example runtime
set.seed(1)
brachios &lt;- brachios[sample(1:nrow(brachios), 1000),]
# get density matrix
dens &lt;- densify(brachios)
# run function, using kernel density matrix
pk &lt;- find_peaks(dens$kdensity)
</code></pre>


</div>