<div class="container">

<table style="width: 100%;"><tr>
<td>permutationSpace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>These functions handle the orbit of permutation/rotation tests (i.e.
permutation/rotation space).</h2>

<h3>Description</h3>

<p><code>make.permSpace</code> computes the <code>perms</code> x n matrix of ids used for
test of dependence. <code>make.signSpace</code> computes the <code>perms</code> x n
vector of +1 and -1 used for symmetry test.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>IDs</code></td>
<td>
<p>vector of IDs to be permuted. If <code>IDs</code> is a scalar, it is
replaced with <code>1:IDs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.permIDs</code></td>
<td>
<p>logical. If <code>TRUE</code>, the matrix of permuted IDs is
stored and returned. Only used with <code>testType="permutaiton"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of elements of the sample. It is also the dimention of the
random orthogonal matrix in <code>rom</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a vector of data. It can also be a vector 1:N referring to the IDs
of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p>number of random permutations. If it is a list, it has two
elements <code>number</code> (the number of random permutation requested) and
<code>seed</code> (the seed to be set when start generating. it is useful for
reproducibility) If perms &gt; number of all possible flips, then compute the
complete space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>the (possibly multivariate) permutation space as returned, for
example by <code>flip</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.only</code></td>
<td>
<p>logical. If <code>TRUE</code> only the p-value for observed test
statistic is returned, otherwise the whole space is computed. Defaults:
<code>TRUE</code> if <code>T</code> is a <code>flip-object</code>, <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>Tail of the distribution being significant for H1. See also
argument <code>tail</code> in <code>flip</code>. Defaults: <code>1</code> if <code>T</code>
is NOT a <code>flip-object</code>, it is taken from <code>T</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testType</code></td>
<td>
<p>See argument <code>testType</code> in <code>flip</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Strata</code></td>
<td>
<p>See argument <code>testType</code> in <code>flip</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A vector of length <code>N</code> with a different value for each group.
Only used together with <code>testType="combination"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>rom</code> computes a Random Orthogonal Matrix of size <code>n</code>X<code>n</code>
(C-compiled function, very fast). implements the algorithm of Stewart (1980). The function is
compiled in C++. NOTE: this option is not available in the newest versions. This is now equivalent to <code>romFast</code>
</p>
<p><code>romFast</code> computes a Random Orthogonal Matrix of size <code>n</code>X<code>n</code>
using the <code>qr.Q</code> decomposition. <code>romFast</code> is faster than
<code>rom</code> but can be inaccurate (i.e. providing inaccurate type I error
control when used in testing), specially for very small <code>n</code> (i.e.
sample size).
</p>
<p><code>allpermutations</code> computes all permutations of a vector <code>Y</code>. Is is
based on the function <code>permutations</code> of the <code>library(e1071)</code>.
</p>
<p><code>t2p</code> computes the (possibily multivariate) space of p-values from the
space of test statistic.
</p>


<h3>References</h3>

<p>Pesarin (2001) Multivariate Permutation Tests with Applications
in Biostatistics. Wiley, New York.
</p>
<p>Stewart, G. W. (1980). The efficient generation of random orthogonal
matrices with an application to condition estimators. SIAM Journal on
Numerical Analysis 17, 403-409.
</p>


<h3>See Also</h3>

<p><code>flip</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#10 random elements of the orbit of a one-sample test
make.signSpace(5, 10)

#All elements of the orbit of a one-sample test (the size of the space is 2^5 &lt; 1000)
make.signSpace(5, 1000)

## Not run: 
#A random rotation matrix of size 3
(r=rom(3))
#verify that it is orthogonal:
r%*%t(r)

## End(Not run)

</code></pre>


</div>