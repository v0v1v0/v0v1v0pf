<div class="container">

<table style="width: 100%;"><tr>
<td>P.penalty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalty matrix for higher order differences</h2>

<h3>Description</h3>

<p>This function computes the matrix that penalizes the higher order
differences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">P.penalty(tt, P = c(0, 0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>vector of the <code>n</code> discretization points or argvals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>vector of coefficients with the order of the differences. Default
value <code>P</code>=c(0,0,1) penalizes the second order difference.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For example, if <code>P</code>=c(0,1,2), the function return the penalty matrix
the second order difference of a vector <code class="reqn">tt</code>. That is </p>
<p style="text-align: center;"><code class="reqn">v^T P_j tt=
\sum_{i=3} ^{n} (\Delta tt_i) ^2</code>
</p>
<p> where </p>
<p style="text-align: center;"><code class="reqn">\Delta tt_i= tt_i -2 tt_{i-1}
+ tt_{i-2}</code>
</p>
<p> is the second order difference. More details can be found in
Kraemer, Boulesteix, and Tutz (2008).
</p>


<h3>Value</h3>

<p>penalty matrix of size <code>sum(n)</code> x <code>sum(n)</code>
</p>


<h3>Note</h3>

<p>The discretization points can be equidistant or not.
</p>


<h3>Author(s)</h3>

<p>This version is created by Manuel Oviedo de la Fuente modified the
original version created by Nicole Kramer in <code>ppls</code> package.
</p>


<h3>References</h3>

<p>N. Kraemer, A.-L. Boulsteix, and G. Tutz (2008). <em>Penalized
Partial Least Squares with Applications to B-Spline Transformations and
Functional Data</em>. Chemometrics and Intelligent Laboratory Systems, 94, 60 -
69. <a href="https://doi.org/10.1016/j.chemolab.2008.06.009">doi:10.1016/j.chemolab.2008.06.009</a>
</p>


<h3>See Also</h3>

<p><code>fdata2pls</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
P.penalty((1:10)/10,P=c(0,0,1))
# a more detailed example can be found under script file 
</code></pre>


</div>