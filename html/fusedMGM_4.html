<div class="container">

<table style="width: 100%;"><tr>
<td>FMGM_StEPS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>StEPS: train subsamples and calculate edge instabilities</h2>

<h3>Description</h3>

<p>From large to small values of candidates, calculate the edge inference instabilities from subsamples
The smallest values with the instabilities under the cutoff are chosen.
See Sedgewich et al. (2016) for more details
</p>


<h3>Usage</h3>

<pre><code class="language-R">FMGM_StEPS(
  data,
  ind_disc,
  group,
  lambda_list,
  with_prior = FALSE,
  prior_list = NULL,
  N = 20,
  b = NULL,
  gamma = 0.05,
  perm = 10000,
  eps = 0.05,
  tol_polish = 1e-12,
  ...,
  cores = parallel::detectCores(),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame with rows as observations and columns as variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_disc</code></td>
<td>
<p>Indices of discrete variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Group indices, must be provided with the observation names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_list</code></td>
<td>
<p>Vector with numeric variables. Penalization parameter candidates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with_prior</code></td>
<td>
<p>Logical. Is prior information provided? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_list</code></td>
<td>
<p>List of prior information. Each element must be a 3-column data frames, with the 1st and the 2nd columns being variable names and the 3rd column being prior confidence (0,1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Integer. Number of subsamples to use. Default: 20</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>Integer. Number of observations in each subsample. Default: ceiling(10*sqrt(number of total observations))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Numeric. Instability cutoff. Default: 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>Integer. Number of permutations to normalize the prior confidence. Default: 10000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Numeric. Pseudocount to calculate the likelihood of edge detection. Default: 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_polish</code></td>
<td>
<p>Numeric. Cutoff of polishing the resulting network. Default: 1e-12</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments sent to fast proximal gradient method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>Integer. Number of cores to use multi-core utilization. Default: maximum number of available cores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. If TRUE, the procedures are reported in real-time manner. Default: FALSE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The resulting networks, in the form of a list of MGMs
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(data_all) ;  # Example 500-by-100 simulation data
data(ind_disc) ;

group &lt;- rep(c(1,2), each=250) ;
names(group) &lt;- seq(500) ;

if (Sys.info()['sysname'] == 'Windows') {
  cores=1
} else {
  cores=parallel::detectCores() ;
}

lambda_list &lt;- 2^seq(log2(.08), log2(.32), length.out=7) ;
lambda_list &lt;- sort(lambda_list, decreasing=TRUE) ;

res_steps &lt;- FMGM_StEPS(data_all, ind_disc, group, 
                    lambda_list=lambda_list, 
                    cores=cores, verbose=TRUE)

</code></pre>


</div>