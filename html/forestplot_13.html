<div class="container">

<table style="width: 100%;"><tr>
<td>fpDrawNormalCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw standard confidence intervals</h2>

<h3>Description</h3>

<p>A function that is used to draw the different
confidence intervals for the non-summary lines.
Use the <code>fpDrawNormalCI</code> function as a
template if you want to make your own funky line + marker.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fpDrawNormalCI(
  lower_limit,
  estimate,
  upper_limit,
  size,
  y.offset = 0.5,
  clr.line,
  clr.marker,
  lwd,
  lty = 1,
  vertices,
  vertices.height = 0.1,
  shapes_gp = fpShapesGp(),
  shape_coordinates = structure(c(1, 1), max.coords = c(1, 1)),
  ...
)

fpDrawDiamondCI(
  lower_limit,
  estimate,
  upper_limit,
  size,
  y.offset = 0.5,
  clr.line,
  clr.marker,
  lwd,
  lty = 1,
  vertices,
  vertices.height = 0.1,
  shapes_gp = fpShapesGp(),
  shape_coordinates = structure(c(1, 1), max.coords = c(1, 1)),
  ...
)

fpDrawCircleCI(
  lower_limit,
  estimate,
  upper_limit,
  size,
  y.offset = 0.5,
  clr.line,
  clr.marker,
  lwd,
  lty = 1,
  vertices,
  vertices.height = 0.1,
  shapes_gp = fpShapesGp(),
  shape_coordinates = structure(c(1, 1), max.coords = c(1, 1)),
  ...
)

fpDrawPointCI(
  lower_limit,
  estimate,
  upper_limit,
  size,
  y.offset = 0.5,
  clr.line,
  clr.marker,
  lwd,
  lty = 1,
  vertices,
  vertices.height = 0.1,
  pch = 1,
  shapes_gp = fpShapesGp(),
  shape_coordinates = structure(c(1, 1), max.coords = c(1, 1)),
  ...
)

fpDrawSummaryCI(
  lower_limit,
  estimate,
  upper_limit,
  size,
  col,
  y.offset = 0.5,
  shapes_gp = fpShapesGp(),
  shape_coordinates = structure(c(1, 1), max.coords = c(1, 1)),
  ...
)

fpDrawBarCI(
  lower_limit,
  estimate,
  upper_limit,
  size,
  col,
  y.offset = 0.5,
  shapes_gp = fpShapesGp(),
  shape_coordinates = structure(c(1, 1), max.coords = c(1, 1)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lower_limit</code></td>
<td>
<p>The lower limit of the confidence line.
A native numeric variable that can actually be
outside the boundaries. If you want to see if it
is outside then convert it to 'npc' and see if the
value ends up more than 1 or less than 0. Here's how
you do the conversion:
<code>convertX(unit(upper_limit, "native"), "npc", valueOnly = TRUE)</code>
and the <code>convertX</code> together with <code>unit</code>
is needed to get the right values while you need to provide the valueOnly
as you cannot compare a unit object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>The estimate indicating the placement
of the actual box. Note, this can also be outside bounds
and is provided in a numeric format the same way as the
<code>lower_limit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_limit</code></td>
<td>
<p>The upper limit of the confidence line. See
lower_limit for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>The actual size of the box/diamond/marker.
This provided in the 'snpc' format to generate a perfect
marker. Although you can provide it alternative units as well,
this is useful for the legends to work nicely.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.offset</code></td>
<td>
<p>If you have multiple lines they need an offset in
the y-direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clr.line</code></td>
<td>
<p>The color of the line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clr.marker</code></td>
<td>
<p>The color of the estimate marker</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width, see <code>gpar</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Line type, see <code>gpar</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertices</code></td>
<td>
<p>Set this to TRUE if you want the ends of the confidence
intervals to be shaped as a T. This is set default to TRUE if you have
any other line type than 1 since there is a risk of a dash occurring
at the very end, i.e. showing incorrectly narrow confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertices.height</code></td>
<td>
<p>The height hoft the vertices. Defaults to npc units
corresponding to 10% of the row height.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapes_gp</code></td>
<td>
<p>A set of graphical parameters of class <code>fpShapesGp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape_coordinates</code></td>
<td>
<p>A vector of length 2 the label (first item of the vector)
and the band (second item of the vector) of the confidence interval.
This is used together with shapes_gp to retrieve graphical parameters for that item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Allows additional parameters for sibling functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Type of point see <code>grid.points</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>The color of the summary object</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>void</code> The function outputs the line using grid compatible
functions and does not return anything.
</p>


<h3>Author(s)</h3>

<p>Max Gordon, Thomas Lumley
</p>


<h3>See Also</h3>

<p>Other forestplot functions: 
<code>forestplot()</code>,
<code>fpColors()</code>,
<code>fpLegend()</code>,
<code>fpShapesGp()</code>,
<code>fp_add_lines()</code>,
<code>fp_decorate_graph()</code>,
<code>fp_insert_row()</code>,
<code>fp_set_style()</code>,
<code>fp_set_zebra_style()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ask &lt;- par(ask = TRUE)

test_data &lt;- data.frame(
  coef1 = c(1, 1.59, 1.3, 1.24),
  coef2 = c(1, 1.7, 1.4, 1.04)
)

test_data$low1 &lt;- test_data$coef1 - 1.96 * c(0, .2, .1, .15)
test_data$high1 &lt;- test_data$coef1 + 1.96 * c(0, .2, .1, .15)

test_data$low2 &lt;- test_data$coef2 - 1.96 * c(0, .1, .15, .2)
test_data$high2 &lt;- test_data$coef2 + 1.96 * c(0, .1, .15, .2)

col_no &lt;- grep("coef", colnames(test_data))
row_names &lt;- list(
  list("Category 1", "Category 2", "Category 3", expression(Category &gt;= 4)),
  list(
    "ref",
    substitute(
      expression(bar(x) == val),
      list(val = round(rowMeans(test_data[2, col_no]), 2))
    ),
    substitute(
      expression(bar(x) == val),
      list(val = round(rowMeans(test_data[3, col_no]), 2))
    ),
    substitute(
      expression(bar(x) == val),
      list(val = round(rowMeans(test_data[4, col_no]), 2))
    )
  )
)

coef &lt;- with(test_data, cbind(coef1, coef2))
low &lt;- with(test_data, cbind(low1, low2))
high &lt;- with(test_data, cbind(high1, high2))

# Change all to diamonds
forestplot(row_names, coef, low, high,
  fn.ci_norm = fpDrawDiamondCI,
  title = "Cool study",
  zero = 1, boxsize = 0.25,
  col = fpColors(
    box = c("royalblue", "gold"),
    line = c("darkblue", "orange"),
    summary = c("darkblue", "red")
  ),
  xlab = "The estimates",
  new_page = TRUE,
  legend = c("Treatment", "Placebo"),
  legend_args = fpLegend(
    title = "Group",
    pos = list("topright", inset = .1),
    r = unit(.1, "snpc"),
    gp = gpar(col = "#CCCCCC", lwd = 1.5)
  )
)

# Change first to diamonds
forestplot(row_names, coef, low, high,
  fn.ci_norm = c(
    "fpDrawDiamondCI",
    rep("fpDrawNormalCI",
      times = nrow(coef) - 1
    )
  ),
  title = "Cool study",
  zero = 1, boxsize = 0.25,
  col = fpColors(
    box = c("royalblue", "gold"),
    line = c("darkblue", "orange"),
    summary = c("darkblue", "red")
  ),
  xlab = "The estimates",
  new_page = TRUE,
  legend = c("Treatment", "Placebo"),
  legend_args = fpLegend(
    title = "Group",
    pos = list("topright", inset = .1),
    r = unit(.1, "snpc"),
    gp = gpar(col = "#CCCCCC", lwd = 1.5)
  )
)

# You can also use a list with the actual functions
# as long as it is formatted [[row]][[column]]
# Note: if you have a non-square input then
# the software will reformat [[col]][[row]]
# to [[row]][[col]]
forestplot(row_names, coef, low, high,
  fn.ci_norm = list(
    list(fpDrawDiamondCI, fpDrawCircleCI),
    list(fpDrawNormalCI, fpDrawNormalCI),
    list(fpDrawNormalCI, fpDrawCircleCI),
    list(fpDrawNormalCI, fpDrawNormalCI)
  ),
  title = "Cool study",
  zero = 1, boxsize = 0.25,
  col = fpColors(
    box = c("royalblue", "gold"),
    line = c("darkblue", "orange"),
    summary = c("darkblue", "red")
  ),
  xlab = "The estimates",
  new_page = TRUE,
  legend = c("Treatment", "Placebo"),
  legend_args = fpLegend(
    title = "Group",
    pos = list("topright", inset = .1),
    r = unit(.1, "snpc"),
    gp = gpar(col = "#CCCCCC", lwd = 1.5)
  )
)

par(ask = ask)
</code></pre>


</div>