<div class="container">

<table style="width: 100%;"><tr>
<td>fregre.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Functional Linear Models</h2>

<h3>Description</h3>

<p>Computes functional regression between functional (and non functional)
explanatory variables and scalar response using basis representation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fregre.lm(
  formula,
  data,
  basis.x = NULL,
  basis.b = NULL,
  lambda = NULL,
  P = NULL,
  weights = rep(1, n),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced
to that class): a symbolic description of the model to be fitted. The
details of model specification are given under <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>List that containing the variables in the model. 
Functional covariates are recommended to be of class fdata. 
Objects of class "fd" can be used at the user's own risk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.x</code></td>
<td>
<p>List of basis for functional explanatory data estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.b</code></td>
<td>
<p>List of basis for functional beta parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>List, indexed by the names of the functional covariates, 
which contains the Roughness penalty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>List, indexed by the names of the functional covariates, which contains the parameters for the creation of the penalty matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This section is presented as an extension of the linear regression models:
<code>fregre.pc</code>, <code>fregre.pls</code> and
<code>fregre.basis</code>. Now, the scalar response <code class="reqn">Y</code> is estimated by
more than one functional covariate <code class="reqn">X^j(t)</code> and also more than one non
functional covariate <code class="reqn">Z^j</code>. The regression model is given by:
</p>
<p style="text-align: center;"><code class="reqn">E[Y|X,Z]=\alpha+\sum_{j=1}^{p}\beta_{j}Z^{j}+\sum_{k=1}^{q}\frac{1}{\sqrt{T_k}}\int_{T_k}{X^{k}(t)\beta_{k}(t)dt}
</code>
</p>

<p>where <code class="reqn">Z=\left[ Z^1,\cdots,Z^p \right]</code> are the non
functional covariates, <code class="reqn">X(t)=\left[ X^{1}(t_1),\cdots,X^{q}(t_q)
\right]</code> are the functional ones and
<code class="reqn">\epsilon</code> are random errors with mean zero , finite variance
<code class="reqn">\sigma^2</code> and <code class="reqn">E[X(t)\epsilon]=0</code>.  
</p>
<p>The first item in the <code>data</code> list is called <em>"df"</em> and is a data
frame with the response and non functional explanatory variables, as
<code>lm</code>. Functional covariates of class <code>fdata</code> or <code>fd</code>
are introduced in the following items in the <code>data</code> list.<br></p>
<p><code>basis.x</code> is a list of basis for represent each functional covariate.
The basis object can be created by the function:
<code>create.pc.basis</code>, <code>pca.fd</code>
<code>create.pc.basis</code>, <code>create.fdata.basis</code> or
<code>create.basis</code>.<br><code>basis.b</code> is a list of basis for
represent each functional <code class="reqn">\beta_k</code> parameter. If <code>basis.x</code> is a
list of functional principal components basis (see
<code>create.pc.basis</code> or <code>pca.fd</code>) the argument
<code>basis.b</code> <em>(is unnecessary and)</em> is ignored.<br></p>
<p>Penalty options are under development, not guaranteed to work properly.
The user can penalty the basis elements by: (i) <code>lambda</code> is a list of
rough penalty values of each functional covariate, see
<code>P.penalty</code> for more details.
</p>


<h3>Value</h3>

<p>Return <code>lm</code> object plus:
</p>

<ul>
<li> <p><code>sr2</code> Residual variance.
</p>
</li>
<li> <p><code>Vp</code> Estimated covariance matrix for the parameters. 
</p>
</li>
<li> <p><code>lambda</code> A roughness penalty. 
</p>
</li>
<li> <p><code>basis.x</code> Basis used for <code>fdata</code> or <code>fd</code> covariates. 
</p>
</li>
<li> <p><code>basis.b</code> Basis used for beta parameter estimation.
</p>
</li>
<li> <p><code>beta.l</code> List of estimated beta parameter of functional covariates.
</p>
</li>
<li> <p><code>data</code> List that containing the variables in the model.
</p>
</li>
<li> <p><code>formula</code> formula.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@usc.es">manuel.oviedo@usc.es</a>
</p>


<h3>References</h3>

<p>Ramsay, James O., and Silverman, Bernard W. (2006), <em>
Functional Data Analysis</em>, 2nd ed., Springer, New York.
</p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/">https://www.jstatsoft.org/v51/i04/</a>
</p>


<h3>See Also</h3>

<p>See Also as: <code>predict.fregre.lm</code> and
<code>summary.lm</code>.<br> Alternative method: <code>fregre.glm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
x &lt;- tecator$absorp.fdata
y &lt;- tecator$y$Fat
tt &lt;- x[["argvals"]]
dataf &lt;- as.data.frame(tecator$y)

nbasis.x &lt;- 11
nbasis.b &lt;- 5
basis1 &lt;- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x)
basis2 &lt;- create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b)
basis.x &lt;- list("x"=basis1)
basis.b &lt;- list("x"=basis2)
f &lt;- Fat ~ Protein + x
ldat &lt;- ldata("df"=dataf,"x"=x)
res  fregre.lm(f,ldat,  basis.b=basis.b)
summary(res)
f2 &lt;- Fat ~ Protein + xd +xd2
xd &lt;- fdata.deriv(x,nderiv=1,class.out='fdata', nbasis=nbasis.x)
xd2 &lt;- fdata.deriv(x,nderiv=2,class.out='fdata', nbasis=nbasis.x)
ldat2 &lt;- list("df"=dataf,"xd"=xd,"x"=x,"xd2"=xd2)
basis.x2 &lt;- NULL#list("xd"=basis1)
basis.b2 &lt;- NULL#list("xd"=basis2)
basis.b2 &lt;- list("xd"=basis2,"xd2"=basis2,"x"=basis2)
res2 &lt;- fregre.lm(f2, ldat2,basis.b=basis.b2)
summary(res2)
par(mfrow=c(2,1))
plot(res$beta.l$x,main="functional beta estimation")
plot(res2$beta.l$xd,col=2)

## End(Not run)
</code></pre>


</div>