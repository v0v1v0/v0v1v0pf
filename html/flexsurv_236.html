<div class="container">

<table style="width: 100%;"><tr>
<td>unroll.function</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a function with matrix arguments to a function with vector
arguments.</h2>

<h3>Description</h3>

<p>Given a function with matrix arguments, construct an equivalent function
which takes vector arguments defined by the columns of the matrix.  The new
function simply uses <code>cbind</code> on the vector arguments to make a matrix,
and calls the old one.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unroll.function(mat.fn, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat.fn</code></td>
<td>
<p>A function with any number of arguments, some of which are
matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>A series of other arguments.  Their names define which
arguments of <code>mat.fn</code> are matrices.  Their values define a vector of
strings to be appended to the names of the arguments in the new function.
For example
</p>
<p><code>fn &lt;- unroll.function(oldfn, gamma=1:3, alpha=0:1)</code>
</p>
<p>will make a new function <code>fn</code> with arguments
<code>gamma1</code>,<code>gamma2</code>,<code>gamma3</code>,<code>alpha0</code>,<code>alpha1</code>.
</p>
<p>Calling
</p>
<p><code>fn(gamma1=a,gamma2=b,gamma3=c,alpha0=d,alpha1=e)</code>
</p>
<p>should give the same answer as
</p>
<p><code>oldfn(gamma=cbind(a,b,c),alpha=cbind(d,e))</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The new function, with vector arguments.
</p>


<h3>Usage in <span class="pkg">flexsurv</span>
</h3>

<p>This is used by <code>flexsurvspline</code> to allow spline models, which
have an arbitrary number of parameters, to be fitted using
<code>flexsurvreg</code>.
</p>
<p>The “custom distributions” facility of <code>flexsurvreg</code>
expects the user-supplied probability density and distribution
functions to have one explicitly named argument for each scalar
parameter, and given R vectorisation, each of those arguments
could be supplied as a vector of alternative parameter values.
</p>
<p>However, spline models have a varying number of scalar parameters,
determined by the number of knots in the spline.
<code>dsurvspline</code> and <code>psurvspline</code> have an
argument called <code>gamma</code>.  This can be supplied as a matrix,
with number of columns <code>n</code> determined by the number of knots
(plus 2), and rows referring to alternative parameter values.  The
following statements are used in the source of
<code>flexsurvspline</code>: </p>
<pre> dfn &lt;-
unroll.function(dsurvspline, gamma=0:(nk-1)) pfn &lt;-
unroll.function(psurvspline, gamma=0:(nk-1)) </pre>
<p>to convert these into functions with arguments <code>gamma0</code>,
<code>gamma1</code>,...,<code>gamman</code>, corresponding to the columns
of <code>gamma</code>, where <code>n = nk-1</code>, and with other arguments
in the same format.
</p>


<h3>Author(s)</h3>

<p>Christopher Jackson &lt;chris.jackson@mrc-bsu.cam.ac.uk&gt;
</p>


<h3>See Also</h3>

<p><code>flexsurvspline</code>,<code>flexsurvreg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
fn &lt;- unroll.function(ncol, x=1:3)
fn(1:3, 1:3, 1:3) # equivalent to...
ncol(cbind(1:3,1:3,1:3))
</code></pre>


</div>