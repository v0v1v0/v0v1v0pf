<div class="container">

<table style="width: 100%;"><tr>
<td>fm.create</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functions to Create a New, or Open an Existing Filematrix
</h2>

<h3>Description</h3>

<p>Create a new or open existing <code>filematrix</code> object.
</p>
<p><code>fm.create</code> creates a new filematrix.
If a filematrix with this name exists, it is overwritten (destroyed).
</p>
<p><code>fm.create.from.matrix</code> creates a new filematrix copy of
an existing R matrix.
</p>
<p><code>fm.open</code> opens an existing filematrix for read/write access.
</p>
<p><code>fm.load</code> loads entire existing filematrix
into memory as an ordinary R matrix.
</p>
<p><code>fm.create.from.text.file</code> reads a matrix from a text file
into a new filematrix.
The rows in the text file become columns in the filematrix.
The transposition happens because the text files stores data by rows and
filematrices store data by columns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fm.create( 
    filenamebase,
    nrow = 0,
    ncol = 1,
    type = "double",
    size = NULL,
    lockfile = NULL)
    
fm.create.from.matrix( 
    filenamebase,
    mat,
    size = NULL,
    lockfile = NULL)

fm.open(
    filenamebase,
    readonly = FALSE,
    lockfile = NULL)

fm.load(filenamebase, lockfile = NULL)

fm.create.from.text.file(
    textfilename,
    filenamebase,
    skipRows = 1,
    skipColumns = 1,
    sliceSize = 1000,
    omitCharacters = "NA",
    delimiter = "\t",
    rowNamesColumn = 1,
    type = "double",
    size = NULL)

## S4 method for signature 'filematrix'
close(con)

closeAndDeleteFiles(con)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filenamebase</code></td>
<td>

<p>Name without extension for the files storing the filematrix. <br>
The file <code>&lt;filenamebase&gt;.bmat</code> keeps the matrix values and
<code>&lt;filenamebase&gt;.desc.txt</code> stores the matrix dimensions,
data type, and data type size.
Names of rows and columns, if defined, are stored in
<code>&lt;filenamebase&gt;.nmsrow.txt</code> and <code>&lt;filenamebase&gt;.nmscol.txt</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>

<p>Number of rows in the matrix. Values over 2^32 are supported.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>

<p>Number of columns in the matrix. Values over 2^32 are supported.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>The type of values stored in the matrix.
Can be either <code>"double"</code>, <code>"integer"</code>, 
<code>"logical"</code>, or <code>"raw"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>Size of each item of the matrix in bytes. <br>
Default values are 8 for <code>"double"</code>, 4 for <code>"integer"</code>, and 
1 for <code>"logical"</code> and <code>"raw"</code>. <br>
Do not change if not sure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>

<p>Regular R matrix, to be copied into a new filematrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>readonly</code></td>
<td>

<p>If <code>TRUE</code>, the values in the opened filematrix cannot be changed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textfilename</code></td>
<td>

<p>Name of the text file with matrix data,
to be copied into a new filematrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skipRows</code></td>
<td>

<p>Number of rows with column names.
The matrix values are expected after first <code>skipRows</code>
rows of the file.
Can be zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skipColumns</code></td>
<td>

<p>Number of columns before matrix values begin.
Can be zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sliceSize</code></td>
<td>

<p>The text file with matrix is read in chuncks of <code>sliceSize</code> rows.
This is a performance tuning parameter, it does not affect the outcome.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitCharacters</code></td>
<td>

<p>The text string representing missing values.
Default value is <code>NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delimiter</code></td>
<td>

<p>The delimiter separating values in the text matrix file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowNamesColumn</code></td>
<td>

<p>The row names are taken from the <code>rowNamesColumn</code>-th 
column of the text file. 
By default, row names are extracted from the first column.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con</code></td>
<td>

<p>A filematrix object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lockfile</code></td>
<td>

<p>Optional. Name of a lock file (file is overwritten).
Used to avoid simultaneous operations by multiple R instances
accessing the same filematrix or
different filematrices on the same hard drive.
Do not use if not sure.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Once created or opened, a filematrix object can be accessed
as an ordinary matrix using both matrix <code>fm[,]</code> and
vector <code>fm[]</code> indexing.
The indices can be integer (no zeros) or logical vectors.
</p>


<h3>Value</h3>

<p>Returns a <code>filematrix</code> object.
The object can be closed with <code>close</code> command or 
closed and deleted from disk with <code>closeAndDeleteFiles</code> command.
</p>


<h3>Author(s)</h3>

<p>Andrey A Shabalin <a href="mailto:andrey.shabalin@gmail.com">andrey.shabalin@gmail.com</a>
</p>


<h3>See Also</h3>

<p>For more on the use of filematrices see <code>filematrix</code>.
</p>
<p>Run <code>browseVignettes("filematrix")</code> for the list of vignettes.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create a 10x10 matrix
fm = fm.create(filenamebase=tempfile(), nrow=10, ncol=10)

# Change values in the top 3x3 corner
fm[1:3,1:3] = 1:9

# View the values in the top 4x4 corner
fm[1:4,1:4]

# Close and delete the filematrix
closeAndDeleteFiles(fm)
</code></pre>


</div>