<div class="container">

<table style="width: 100%;"><tr>
<td>localshape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local shape matrix</h2>

<h3>Description</h3>

<p>This computes a matrix formalising 'local shape', i.e., aggregated
standardised variance/covariance in a Mahalanobis neighbourhood of the data
points. This can be used for finding clusters when used as one of the
covariance matrices in 
Invariant Coordinate Selection (function <code>ics</code> in package
<code>ICS</code>), see Hennig's
discussion and rejoinder of Tyler et al. (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">  localshape(xdata,proportion=0.1,mscatter="mcd",mcdalpha=0.8,
                       covstandard="det")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>objects times variables data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportion</code></td>
<td>
<p>proportion of points to be considered as neighbourhood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mscatter</code></td>
<td>
<p>"mcd" or "cov"; specified minimum covariance
determinant or
classical covariance matrix to be used for Mahalanobis distance
computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcdalpha</code></td>
<td>
<p>if <code>mscatter="mcd"</code>, this is the alpha parameter
to be used by the MCD covariance matrix, i.e. one minus the
asymptotic breakdown point, see <code>covMcd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covstandard</code></td>
<td>
<p>one of "trace", "det" or "none", determining by
what constant the pointwise neighbourhood covariance matrices are
standardised. "det" makes the affine equivariant, as noted in the
discussion rejoinder of Tyler et al. (2009).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The local shape matrix.
</p>


<h3>Author(s)</h3>

<p>Christian Hennig
<a href="mailto:christian.hennig@unibo.it">christian.hennig@unibo.it</a>
<a href="https://www.unibo.it/sitoweb/christian.hennig/en">https://www.unibo.it/sitoweb/christian.hennig/en</a></p>


<h3>References</h3>

<p>Tyler, D. E., Critchley, F., Duembgen, L., Oja, H. (2009)
Invariant coordinate selection (with discussion).
<em>Journal of the Royal Statistical Society, Series B</em>, 549-592.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  options(digits=3)
  data(iris)
  localshape(iris[,-5],mscatter="cov")
</code></pre>


</div>