<div class="container">

<table style="width: 100%;"><tr>
<td>lsmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>lsmm : Estimation of location scale mixed model</h2>

<h3>Description</h3>

<p>This function fits complex mixed effects model with a time and covariate dependent variance.
We suppose that the variance of the residual error is time-dependent and subject-specific.
Parameters are estimated simultaneously through a maximum likelihood method, using a Marquardt-Levenberg algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lsmm(
  formFixed,
  formRandom,
  formGroup,
  timeVar,
  data.long,
  variability_hetero = TRUE,
  formFixedVar,
  formRandomVar,
  correlated_re = FALSE,
  S1 = 1000,
  S2 = 5000,
  nproc = 1,
  clustertype = "SOCK",
  maxiter = 100,
  print.info = FALSE,
  file = NULL,
  epsa = 0.001,
  epsb = 0.001,
  epsd = 0.001,
  binit = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formFixed</code></td>
<td>
<p>A formula for the fixed effects of the longitudinal submodel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formRandom</code></td>
<td>
<p>A formula for the random effects of the longitudinal submodel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formGroup</code></td>
<td>
<p>A formula which indicates the group variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeVar</code></td>
<td>
<p>The name of the column of time in data.long. This variable must appears in data.long</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.long</code></td>
<td>
<p>A dataframe with the longitudinal data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variability_hetero</code></td>
<td>
<p>A logical to indicate if we suppose a subject_specific variability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formFixedVar</code></td>
<td>
<p>A formula for the fixed effects of the variance predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formRandomVar</code></td>
<td>
<p>A formula for the random effects of the variance predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlated_re</code></td>
<td>
<p>A logical to indicate if the random effects of the marker and the variance predictors are correlated (By default there are supposed to be independent)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S1</code></td>
<td>
<p>An integer : the number of QMC draws for the first step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p>An integer : the number of QMC draws for the second step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p>An integer : the number of processors for parallel computing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustertype</code></td>
<td>
<p>one of the supported types from <code>makeCluster</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>optional maximum number of iterations for the marqLevAlg iterative algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.info</code></td>
<td>
<p>logical indicating if the outputs of each iteration should be written</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>optional character giving the name of the file where the outputs of each iteration should be written (if print.info=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsa</code></td>
<td>
<p>optional threshold for the convergence criterion based on the parameter stability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsb</code></td>
<td>
<p>optional threshold for the convergence criterion based on the objective function stability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsd</code></td>
<td>
<p>optional threshold for the relative distance to maximum. This criterion has the nice interpretation of estimating the ratio of the approximation error over the statistical error, thus it can be used for stopping the iterative process whatever the problem.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binit</code></td>
<td>
<p>optional initials parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is defined by :
#' <code class="reqn">\quad\left\{\begin{array}{ll}
Y_{ij} = Y_{i}(t_{ij}) = \widetilde{Y}_i(t_{ij}) + \epsilon_{ij} = X_{ij}^{\top} \beta+Z_{ij}^{\top} b_{i}+\epsilon_{ij}, \\
\epsilon_{ij}(t_{ij}) \sim \mathcal{N}(0,\sigma_i^2(t_{ij})) \hspace{3mm} \text{with} \hspace{3mm} \log(\sigma_i(t_{ij}))  = O_{ij}^{\top} \mu+M_{ij}^{\top} \tau_{i}
\end{array}
\right.</code>
</p>


<h4>with <code class="reqn">X_{ij}</code>, <code class="reqn">O_{ij}</code>, <code class="reqn">Z_{ij}</code> and <code class="reqn">M_{ij}</code> four vectors of explanatory variables for subject <code class="reqn">i</code> at visit <code class="reqn">j</code>,
respectively associated with the fixed-effect vectors <code class="reqn">\beta</code> and <code class="reqn">\mu</code>, and the subject-specific random-effect vector <code class="reqn">b_i</code> and <code class="reqn">\tau_i</code>, such as
<code class="reqn">\quad\left(\begin{array}{c}
             b_{i} \\
             \tau_i
             \end{array}\right) \sim N\left(\left(\begin{array}{c}
                                                  0 \\
                                                  0
                                                  \end{array}\right),\left(\begin{array}{cc}
                                                                           \Sigma_{b} &amp; \Sigma_{\tau b} \\
                                                                           \Sigma_{\tau b}' &amp; \Sigma_{\tau}
\end{array}\right)\right)</code>
</h4>

<p><code class="reqn">Y_{i}(t_{ij}) = \tilde{Y}_i(t_{ij}) + \epsilon_{ij} = X_{ij}^{\top} \beta+Z_{ij}^{\top} b_{i}+\epsilon_{ij}</code>
</p>
<p>with <code class="reqn">X_{ij}</code> and <code class="reqn">Z_{ij}</code> two covariate vectors for subject i at visit j,
respectively associated with the vector of fixed effects <code class="reqn">\beta</code> and the vector of
subject-specific individual random effects <code class="reqn">b_i</code>.
The vector <code class="reqn">b_i</code> is assumed to be normally distributed and a specific-subject random effect on the
variance of the measure error can be added: <code class="reqn">\epsilon_{ij} \sim \mathcal{N}(0,\sigma_i^2)</code> and
</p>
<p><code class="reqn">\quad\left(\begin{array}{c}
b_{i} \\
\log \sigma_{i}
\end{array}\right) \sim \mathcal{N}\left(\left(\begin{array}{c}
                                               0 \\
                                               \mu_{\sigma}
                                               \end{array}\right),\left(\begin{array}{cc}
                                                                        \Sigma_{b} &amp; 0 \\
                                                                        0 &amp; \tau_{\sigma}^{2}
                                                                        \end{array}\right)\right)</code>
</p>



<h3>Value</h3>

<p>A FlexVarJoint object which contains the following elements :
</p>

<dl>
<dt><code>result</code></dt>
<dd>
<p>A marqLevAlg object with the results of the estimation.</p>
</dd>
<dt><code>table.res</code></dt>
<dd>
<p>The table of results : Estimation and SE</p>
</dd>
<dt><code>time.compute</code></dt>
<dd>
<p>Computation time</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>A list of control elements</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">



#fit a joint model with competing risks and subject-specific variability
example &lt;- lsmm(formFixed = y~visit,
formRandom = ~ visit,
formGroup = ~ID,
timeVar = "visit",
data.long = Data_toy,
variability_hetero = TRUE,
formFixedVar =~visit,
formRandomVar =~visit,
correlated_re = TRUE,
S1 = 100,
S2 = 1000,
nproc = 1,
maxiter = 100
)

summary(example)


</code></pre>


</div>