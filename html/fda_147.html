<div class="container">

<table style="width: 100%;"><tr>
<td>monfn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate the a monotone function</h2>

<h3>Description</h3>

<p>Evaluate a monotone function defined as the indefinite integral of
$exp(W(t))$ where $W$ is a function defined by a basis expansion.  Function $W$
is the logarithm of the derivative of the monotone function.</p>


<h3>Usage</h3>

<pre><code class="language-R">  monfn(argvals, Wfdobj, basislist=vector("list", JMAX), returnMatrix=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>argvals</code></td>
<td>
<p>A numerical vector at which function and derivative are
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wfdobj</code></td>
<td>
<p>A functional data object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basislist</code></td>
<td>
<p>A list containing values of basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnMatrix</code></td>
<td>

<p>logical:  If TRUE,  a two-dimensional is returned using a
special class from the Matrix package.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function evaluates a strictly monotone function of the form
</p>
<p style="text-align: center;"><code class="reqn">h(x) = [D^{-1} exp(Wfdobj)](x),</code>
</p>

<p>where <code class="reqn">D^{-1}</code> means taking the indefinite integral. The interval over
which the integration takes places is defined in the basis object in Wfdobj.
</p>


<h3>Value</h3>

<p>A numerical vector or matrix containing the values the warping function h.
</p>


<h3>Author(s)</h3>

<p>J. O. Ramsay
</p>


<h3>References</h3>

<p>Ramsay, James O., Hooker, G. and Graves, S. (2009), <em>Functional
Data Analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, 
Bernard W. (2005), <em>Functional
Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, 
Bernard W. (2002), <em>Applied
Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>mongrad</code>,
<code>landmarkreg</code>,
<code>smooth.morph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">oldpar &lt;- par(no.readonly=TRUE)
## basically this example resembles part of landmarkreg.R that uses monfn.R to
## estimate the warping function.

## Specify the curve subject to be registered
n=21
tbreaks = seq(0, 2*pi, len=n)
xval &lt;- sin(tbreaks)
rangeval &lt;- range(tbreaks)

## Establish a B-spline basis for the curve
wbasis &lt;- create.bspline.basis(rangeval=rangeval, breaks=tbreaks)
Wfd0   &lt;- fd(matrix(0,wbasis$nbasis,1),wbasis)
WfdPar &lt;- fdPar(Wfd0, 1, 1e-4)
fdObj  &lt;- smooth.basis(tbreaks, xval, WfdPar)$fd

## Set the mean landmark times. Note that the objective of the warping
## function is to transform the curve such that the landmarks of the curve
## occur at the designated mean landmark times.

## Specify the mean landmark times: tbreak[8]=2.2 and tbreaks[13]=3.76
meanmarks &lt;- c(rangeval[1], tbreaks[8], tbreaks[13], rangeval[2])
## Specify landmark locations of the curve: tbreaks[6] and tbreaks[16]
cmarks &lt;- c(rangeval[1], tbreaks[6], tbreaks[16], rangeval[2])

## Establish a B-basis object for the warping function
Wfd &lt;- smooth.morph(x=meanmarks, y=cmarks, ylim=rangeval, 
                    WfdPar=WfdPar)$Wfdobj

## Estimate the warping function
h = monfn(tbreaks, Wfd)

## scale using a linear equation h such that h(0)=0 and h(END)=END
b &lt;- (rangeval[2]-rangeval[1])/ (h[n]-h[1])
a &lt;- rangeval[1] - b*h[1]
h &lt;- a + b*h
plot(tbreaks, h, xlab="Time", ylab="Transformed time", type="b")
par(oldpar)
</code></pre>


</div>