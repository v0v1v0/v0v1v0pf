<div class="container">

<table style="width: 100%;"><tr>
<td>ExtremesData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Explorative Data Analysis</h2>

<h3>Description</h3>

<p>A collection and description of functions for 
explorative data analysis. The tools include 
plot functions for empirical distributions, quantile 
plots, graphs exploring the properties of exceedances 
over a threshold, plots for mean/sum ratio and for 
the development of records.
<br></p>
<p>The functions are:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>emdPlot</code> </td>
<td style="text-align: left;"> Plot of empirical distribution function, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>qqparetoPlot</code> </td>
<td style="text-align: left;"> Exponential/Pareto quantile plot, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mePlot</code> </td>
<td style="text-align: left;"> Plot of mean excesses over a threshold, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mrlPlot</code> </td>
<td style="text-align: left;"> another variant, mean residual life plot, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mxfPlot</code> </td>
<td style="text-align: left;"> another variant, with confidence intervals, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>msratioPlot</code> </td>
<td style="text-align: left;"> Plot of the ratio of maximum and sum, </td>
</tr>
<tr>
<td style="text-align: left;">   
    <code>recordsPlot</code> </td>
<td style="text-align: left;"> Record development compared with iid data, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>ssrecordsPlot</code> </td>
<td style="text-align: left;"> another variant, investigates subsamples, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sllnPlot</code> </td>
<td style="text-align: left;"> verifies Kolmogorov's strong law of large numbers, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>lilPlot</code> </td>
<td style="text-align: left;"> verifies Hartman-Wintner's law of the iterated logarithm, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>xacfPlot</code> </td>
<td style="text-align: left;"> ACF of exceedances over a threshold, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>normMeanExcessFit</code> </td>
<td style="text-align: left;"> fits mean excesses with a normal density, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>ghMeanExcessFit</code> </td>
<td style="text-align: left;"> fits mean excesses with a GH density, </td>
</tr>
<tr>
<td style="text-align: left;">   
    <code>hypMeanExcessFit</code> </td>
<td style="text-align: left;"> fits mean excesses with a HYP density, </td>
</tr>
<tr>
<td style="text-align: left;">   
    <code>nigMeanExcessFit</code> </td>
<td style="text-align: left;"> fits mean excesses with a NIG density, </td>
</tr>
<tr>
<td style="text-align: left;">  
    <code>ghtMeanExcessFit</code> </td>
<td style="text-align: left;"> fits mean excesses with a GHT density. </td>
</tr>
</table>
<h3>Usage</h3>

<pre><code class="language-R">emdPlot(x, doplot = TRUE, plottype = c("xy", "x", "y", " "), 
    labels = TRUE, ...)

qqparetoPlot(x, xi = 0, trim = NULL, threshold = NULL, doplot = TRUE, 
    labels = TRUE, ...)

mePlot(x, doplot = TRUE, labels = TRUE, ...)
mrlPlot(x, ci = 0.95, umin = mean(x), umax = max(x), nint = 100, doplot = TRUE, 
     plottype = c("autoscale", ""), labels = TRUE, ...)  
mxfPlot(x, u = quantile(x, 0.05), doplot = TRUE, labels = TRUE, ...)  
   
msratioPlot(x, p = 1:4, doplot = TRUE, labels = TRUE, ...) 
   
recordsPlot(x, ci = 0.95, doplot = TRUE, labels = TRUE, ...)
ssrecordsPlot(x, subsamples = 10, doplot = TRUE, plottype = c("lin", "log"),
    labels = TRUE, ...)
    
sllnPlot(x, doplot = TRUE, labels = TRUE, ...)
lilPlot(x, doplot = TRUE, labels = TRUE, ...)

xacfPlot(x, u = quantile(x, 0.95), lag.max = 15, doplot = TRUE, 
    which = c("all", 1, 2, 3, 4), labels = TRUE, ...)
    
normMeanExcessFit(x, doplot = TRUE, trace = TRUE, ...)
ghMeanExcessFit(x, doplot = TRUE, trace = TRUE, ...)
hypMeanExcessFit(x, doplot = TRUE, trace = TRUE, ...)
nigMeanExcessFit(x, doplot = TRUE, trace = TRUE, ...)
ghtMeanExcessFit(x, doplot = TRUE, trace = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>[recordsPlot] - <br>
a confidence level. By default 0.95, i.e. 95%.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doplot</code></td>
<td>

<p>a logical value. Should the results be plotted? By 
default <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>a logical value. Whether or not x- and y-axes should be automatically 
labelled and a default main title should be added to the plot.
By default <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.max</code></td>
<td>

<p>[xacfPlot] - <br>
maximum number of lags at which to calculate the autocorrelation 
functions. The default value is 15.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>

<p>[mrlPlot] - <br>
the number of intervals, see <code>umin</code> and <code>umax</code>. The 
default value is 100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>[msratioPlot] - <br>
the power exponents, a numeric vector. By default a sequence from  
1 to 4 in unit integer steps.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plottype</code></td>
<td>

<p>[emdPlot] - <br>
which axes should be on a log scale: <code>"x"</code> x-axis only; 
<code>"y"</code> y-axis only; <code>"xy"</code> both axes; <code>""</code> 
neither axis.
<br>
[msratioPlot] - <br>
a logical, if set to <code>"autoscale"</code>, then the scale of the 
plots are automatically determined, any other string allows user
specified scale information through the <code>...</code> argument.
<br>
[ssrecordsPlot] - <br>
one from two options can be select either <code>"lin"</code>
or <code>"log"</code>. The default creates a linear plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsamples</code></td>
<td>

<p>[ssrecordsPlot] - <br>
the number of subsamples, by default 10, an integer value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold, trim</code></td>
<td>

<p>[qPlot][xacfPlot] - <br>
a numeric value at which data are to be left-truncated, value 
at which data are to be right-truncated or the threshold value, 
by default 95%.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>a logical flag, by default <code>TRUE</code>. Should the calculations     
be traced?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>a numeric value at which level the data are to be truncated. By 
default the threshold value which belongs to the 95% quantile,
<code>u=quantile(x,0.95)</code>.       
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umin, umax</code></td>
<td>

<p>[mrlPlot] - <br>
range of threshold values. If <code>umin</code> and/or <code>umax</code> are 
not available, then by default they are set to the following 
values: <code>umin=mean(x)</code> and <code>umax=max(x)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>[xacfPlot] - <br>
a numeric or character value, if <code>which="all"</code> then all
four plots are displayed, if <code>which</code> is an integer between
one and four, then the first, second, third or fourth plot will
be displayed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>

<p>numeric data vectors or in the case of x an object to be plotted.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>

<p>the shape parameter of the generalized Pareto distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments passed to the FUN or plot function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Empirical Distribution Function:</b>
<br><br>
The function <code>emdPlot</code> is a simple explanatory function. A 
straight line on the double log scale indicates Pareto tail behaviour.
<br></p>
<p><b>Quantileâ€“Quantile Pareto Plot:</b>
<br><br><code>qqparetoPlot</code> creates a quantile-quantile plot for threshold 
data. If <code>xi</code> is zero the reference distribution is the 
exponential; if <code>xi</code> is non-zero the reference distribution 
is the generalized Pareto with that parameter value expressed 
by <code>xi</code>. In the case of the exponential, the plot is 
interpreted as follows: Concave departures from a straight line are a 
sign of heavy-tailed behaviour, convex departures show thin-tailed 
behaviour. 
<br></p>
<p><b>Mean Excess Function Plot:</b>
<br><br>
Three variants to plot the mean excess function are available: 
A sample mean excess plot over increasing thresholds, and two mean 
excess function plots with confidence intervals for discrimination 
in the tails of a distribution.
In general, an upward trend in a mean excess function plot shows 
heavy-tailed behaviour. In particular, a straight line with positive 
gradient above some threshold is a sign of Pareto behaviour in tail. 
A downward trend shows thin-tailed behaviour whereas a line with 
zero gradient shows an exponential tail. Here are some hints:
Because upper plotting points are the average of a handful of extreme 
excesses, these may be omitted for a prettier plot. 
For <code>mrlPlot</code> and <code>mxfPlot</code> the upper tail is investigated; 
for the lower tail reverse the sign of the <code>data</code> vector.
<br></p>
<p><b>Plot of the Maximum/Sum Ratio:</b>
<br><br>
The ratio of maximum and sum is a simple tool for detecting heavy 
tails of a distribution and for giving a rough estimate of
the order of its finite moments. Sharp increases in the curves
of a <code>msratioPlot</code> are a sign for heavy tail behaviour.
<br></p>
<p><b>Plot of the Development of Records:</b>
<br><br>
These are functions that investigate the development of records in 
a dataset and calculate the expected behaviour for iid data.
<code>recordsPlot</code> counts records and reports the observations 
at which they occur. In addition subsamples can be investigated
with the help of the function <code>ssrecordsPlot</code>.
<br></p>
<p><b>Plot of Kolmogorov's and Hartman-Wintner's Laws:</b>
<br><br>
The function <code>sllnPlot</code> verifies Kolmogorov's strong law of 
large numbers, and the function <code>lilPlot</code> verifies 
Hartman-Wintner's law of the iterated logarithm.
<br></p>
<p><b>ACF Plot of Exceedances over a Threshold:</b>
<br><br>
This function plots the autocorrelation functions of heights and 
distances of exceedances over a threshold.
<br></p>


<h3>Value</h3>

<p>The functions return a plot.
</p>


<h3>Note</h3>

<p>The plots are labeled by default with a x-label, a y-label and
a main title. If the argument <code>labels</code> is set to <code>FALSE</code>
neither a x-label, a y-label nor a main title will be added to the
graph. To add user defined label strings just use the 
function <code>title(xlab="\dots", ylab="\dots", main="\dots")</code>.
</p>


<h3>Author(s)</h3>

<p>Some of the functions were implemented from Alec Stephenson's 
R-package <code>evir</code> ported from Alexander McNeil's S library 
<code>EVIS</code>, <em>Extreme Values in S</em>, some from Alec Stephenson's 
R-package <code>ismev</code> based on Stuart Coles code from his book, 
<em>Introduction to Statistical Modeling of Extreme Values</em> and 
some were written by Diethelm Wuertz.
</p>


<h3>References</h3>

<p>Coles S. (2001);
<em>Introduction to Statistical Modelling of Extreme Values</em>,
Springer.
</p>
<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997);
<em>Modelling Extremal Events</em>, Springer.  
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## Danish fire insurance data:
   data(danishClaims)
   library(timeSeries)
   danishClaims = as.timeSeries(danishClaims)
   
## emdPlot -
   # Show Pareto tail behaviour:
   par(mfrow = c(2, 2), cex = 0.7)
   emdPlot(danishClaims) 
   
## qqparetoPlot -
   # QQ-Plot of heavy-tailed Danish fire insurance data:
   qqparetoPlot(danishClaims, xi = 0.7) 
 
## mePlot -
   # Sample mean excess plot of heavy-tailed Danish fire:
   mePlot(danishClaims)
      
## ssrecordsPlot -
   # Record fire insurance losses in Denmark:
   ssrecordsPlot(danishClaims, subsamples = 10) 
</code></pre>


</div>