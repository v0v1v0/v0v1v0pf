<div class="container">

<table style="width: 100%;"><tr>
<td>CompleteRmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Complete a Partially Specified Correlation Matrix by the Method of Alternating Projections</h2>

<h3>Description</h3>

<p>This function completes a (possibly) partially specified
correlation matrix by a modified alternating projections algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CompleteRmap(
  Rna,
  NMatrices = 1,
  RBounds = FALSE,
  LB = -1,
  UB = 1,
  delta = 1e-16,
  MinLambda = 0,
  MaxIter = 1000,
  detSort = FALSE,
  Parallel = FALSE,
  ProgressBar = FALSE,
  PrintLevel = 0,
  Digits = 3,
  Seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Rna</code></td>
<td>
<p>(matrix) An n x n incomplete correlation matrix.  Missing entries must
be specified by NA values. If all off diagonal values are NA then the function
will generate a random correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NMatrices</code></td>
<td>
<p>(integer) <code>CompleteRmap</code> will complete <code>NMatrices</code>
correlation matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RBounds</code></td>
<td>
<p>(logical) If <code>RBounds = TRUE</code> then the function will attempt to
produce a matrix on the surface of the associated elliptope (i.e., the space of all
possible PSD R matrices of a given dimension).
When <code>RBounds = FALSE</code>, during each cycle of the alternating projections
algorithm all negative eigenvalues of the provisional R matrix are replaced by
(sorted) uniform random numbers between the smallest positive eigenvalue and zero (inclusive) of the indefinite matrix.
Default <code>RBounds = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LB</code></td>
<td>
<p>(numeric) The lower bound for the random number generator when generating
initial estimates for the missing elements of a partially specified correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UB</code></td>
<td>
<p>(numeric) The upper bound for the random number generator when generating
initial estimates for the missing elements of a partially specified correlation matrix. Start values
(for missing correlations) are sampled from a uniform distribution with bounds <code>[LB, UB]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>(numeric) A small number that controls the precision of the estimated solution.
Default <code>delta = 1E-16</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MinLambda</code></td>
<td>
<p>(numeric) A small value greater than or equal to 0  used to replace negative
eigenvalues during the modified alternating projections algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxIter</code></td>
<td>
<p>(integer) The maximum number of cycles of the
alternating projections algorithm. Default <code>MaxIter = 1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detSort</code></td>
<td>
<p>(logical). If <code>detSort = TRUE</code> then all results will be sorted
according to the sizes of the matrix determinants (det(Ri)). Default <code>detSort = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Parallel</code></td>
<td>
<p>(logical). If <code>Parallel = TRUE</code> parallel processing will be used to
generate the completed correlation matrices. Default:  <code>Parallel = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ProgressBar</code></td>
<td>
<p>(logical).  If <code>Parallel = TRUE</code> and <code>ProgressBar = TRUE</code> a progress bar
will be printed to screen. Default <code>ProgressBar = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PrintLevel</code></td>
<td>
<p>(integer) The <code>PrintLevel</code> argument can take one of three values:
</p>

<ul>
<li>
<p> 0  No output will be printed. Default (PrintLevel = 0).
</p>
</li>
<li>
<p> 1  Print <code>Delta</code> and the minimum eigenvalue of the currently completed correlation matrix.
</p>
</li>
<li>
<p> 2  Print convergence history.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Digits</code></td>
<td>
<p>(integer) Controls the number of printed significant digits if PrintLevel = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>(integer) Initial random number seed. If reproducible results are desired then
it is necessary to specify  <code>ProgressBar = FALSE</code>. Default <code>Seed = NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li>  <p><strong>CALL</strong> The function call.
</p>
</li>
<li> <p><strong>NMatrices</strong> The number of completed R matrices.
</p>
</li>
<li> <p><strong>Rna</strong> The input partially specified R matrix.
</p>
</li>
<li>  <p><strong>Ri</strong> A list of the completed R matrices.
</p>
</li>
<li> <p><strong>RiEigs</strong> A list of eigenvalues for each <code>Ri</code>.
</p>
</li>
<li> <p><strong>RiDet</strong>  A list of the determinants for each <code>Ri</code>.
</p>
</li>
<li> <p><strong>converged</strong> The convergence status (TRUE/FALSE) for each <code>Ri</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Niels G. Waller
</p>


<h3>References</h3>

<p>Higham, N. J.  (2002).  Computing the nearest correlation matrix: A problem
from finance.  IMA Journal of Numerical Analysis, 22(3), 329â€“343.
</p>
<p>Waller, N. G.  (2020).  Generating correlation matrices with specified
eigenvalues using the method of alternating projections.
The American Statistician, 74(1), 21-28.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
Rna4 &lt;- matrix(c( 1,  NA,  .29, .18,
                  NA, 1,   .11, .24,
                 .29, .11, 1,   .06,
                 .18, .24, .06, 1), 4, 4)

Out4  &lt;- CompleteRmap(Rna = Rna4,
                      NMatrices = 5,
                      RBounds = FALSE,
                      LB = -1,
                      UB = 1,
                      delta = 1e-16,
                      MinLambda = 0,
                      MaxIter = 5000,
                      detSort = FALSE,
                      ProgressBar = TRUE,
                      Parallel = TRUE,
                      PrintLevel = 1,
                      Digits = 3,
                      Seed = 1)

summary(Out4,
        PrintLevel = 2,
        Digits = 5)

## End(Not run)
</code></pre>


</div>