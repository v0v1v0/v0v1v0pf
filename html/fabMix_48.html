<div class="container">

<table style="width: 100%;"><tr>
<td>simData2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Synthetic data generator 2
</h2>

<h3>Description</h3>

<p>Simulate data from a multivariate normal mixture using a mixture of factor analyzers mechanism. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">simData2(sameSigma,  p, q, K.true, n, loading_means, loading_sd, sINV_values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sameSigma</code></td>
<td>

<p>Logical. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>The dimension of the multivariate normal distribution (<code class="reqn">p &gt; 1</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>Number of factors. It should be strictly smaller than p.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.true</code></td>
<td>

<p>The number of mixture components (clusters).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loading_means</code></td>
<td>

<p>A vector which contains the means of blocks of factor loadings.
</p>
<p>Default: <code>loading_means = c(-30,-20,-10,10, 20, 30)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loading_sd</code></td>
<td>

<p>A vector which contains the standard deviations of blocks of factor loadings. 
</p>
<p>Default: <code>loading_sd &lt;- rep(2, length(loading_means))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sINV_values</code></td>
<td>

<p>A vector which contains the values of the diagonal of the (common) inverse covariance matrix, if <code>sigmaTrue = TRUE</code>. An <code class="reqn">K\times p</code> matrix which contains the values of the diagonal of the inverse covariance matrix per component, if <code>sigmaTrue = FALSE</code>. 
</p>
<p>Default: <code> sINV_values = rgamma(p, shape = 1, rate = 1)</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p><code class="reqn">n\times p</code> array containing the simulated data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>

<p><code class="reqn">n</code>-dimensional vector containing the class of each observation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factorLoadings</code></td>
<td>

<p><code class="reqn">K.true\times p \times q</code>-array containing the factor loadings <code class="reqn">\Lambda_{krj}</code> per cluster <code class="reqn">k</code>, feature <code class="reqn">r</code> and factor <code class="reqn">j</code>, where <code class="reqn">k=1,\ldots,K</code>; <code class="reqn">r=1,\ldots,p</code>; <code class="reqn">j=1,\ldots,q</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>

<p><code class="reqn">K.true\times p</code> matrix containing the marginal means <code class="reqn">\mu_{kr}</code>, <code class="reqn">k=1,\ldots,K</code>; <code class="reqn">r=1,\ldots,p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>

<p><code class="reqn">p\times p</code> diagonal matrix containing the variance of errors <code class="reqn">\sigma_{rr}</code>, <code class="reqn">r=1,\ldots,p</code>. Note that the same variance of errors is assumed for each cluster.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>

<p><code class="reqn">n\times q</code> matrix containing the simulated factor values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p><code class="reqn">K.true</code>-dimensional vector containing the weight of each cluster.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The marginal variance for cluster <code class="reqn">k</code> is equal to <code class="reqn">\Lambda_k\Lambda_k^{T} + \Sigma</code>.</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>Examples</h3>

<pre><code class="language-R">library('fabMix')

n = 8                # sample size
p = 5                # number of variables
q = 2                # number of factors
K = 2                # true number of clusters

sINV_diag = 1/((1:p))    # diagonal of inverse variance of errors
set.seed(100)
syntheticDataset &lt;- simData2(K.true = K, n = n, q = q, p = p, 
                        sINV_values = sINV_diag)
summary(syntheticDataset)
</code></pre>


</div>