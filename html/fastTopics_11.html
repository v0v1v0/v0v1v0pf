<div class="container">

<table style="width: 100%;"><tr>
<td>fit_topic_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simple Interface for Fitting a Multinomial Topic Model</h2>

<h3>Description</h3>

<p>Fits a multinomial topic model to the count data,
hiding most of the complexities of model fitting. The default
optimization settings used here are intended to work well in a wide
range of data sets, although some fine-tuning may be needed for
more difficult cases. For full control, use <code>fit_poisson_nmf</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_topic_model(
  X,
  k,
  numiter.main = 100,
  numiter.refine = 100,
  method.main = "em",
  method.refine = "scd",
  init.method = c("topicscore", "random"),
  control.init = list(),
  control.main = list(numiter = 4),
  control.refine = list(numiter = 4, extrapolate = TRUE),
  verbose = c("progressbar", "detailed", "none")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The n x m matrix of counts; all entries of X should be
non-negative. It can be a sparse matrix (class <code>"dgCMatrix"</code>)
or dense matrix (class <code>"matrix"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of topics. Must be 2 or greater.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numiter.main</code></td>
<td>
<p>Number of updates of the factors and loadings
to perform in the main model fitting step. Should be 1 or more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numiter.refine</code></td>
<td>
<p>Number of updates of the factors and loadings
to perform in the model refinement step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.main</code></td>
<td>
<p>The method to use for updating the factors and
loadings in the main model fitting step. Passed as argument
"method" to <code>fit_poisson_nmf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.refine</code></td>
<td>
<p>The method to use for updating the factors in
evthe model refinement step. Passed as argument "method"
to <code>fit_poisson_nmf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.method</code></td>
<td>
<p>The method used to initialize the factors and
loadings. See <code>init_poisson_nmf</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.init</code></td>
<td>
<p>A list of parameters controlling the behaviour
of the optimization and Topic SCORE method in the call to
<code>init_poisson_nmf</code>. This is passed as argument "control" to
<code>init_poisson_nmf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.main</code></td>
<td>
<p>A list of parameters controlling the behaviour
of the optimization in the main model fitting step. This is passed
as argument "control" to <code>fit_poisson_nmf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.refine</code></td>
<td>
<p>A list of parameters controlling the
behaviour of the of the optimization algorithm in the model
refinement step. This is passed as argument "control" to
<code>fit_poisson_nmf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>When <code>verbose = "progressbar"</code> or <code>verbose
= "detailed"</code>, information about the progress of the model fitting
is printed to the console. See <code>fit_poisson_nmf</code> for
more information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With the default settings, the model fitting is
accomplished in four steps: (1) initialize the Poisson NMF model
fit (<code>init_poisson_nmf</code>); (2) perform the main model fitting
step by running 100 EM updates using <code>fit_poisson_nmf</code>; (3)
refine the fit by running 100 extrapolated SCD updates, again using
<code>fit_poisson_nmf</code>; and (4) recover the multinomial topic model
by calling <code>poisson2multinom</code>.
</p>
<p>This two-stage fitting approach is based on our findings that the
EM algorithm initially makes rapid progress toward a solution, but
its convergence slows considerably as the iterates approach a
solution. Close to a solution, we have found that other algorithms
make much more rapid progress than EM; in particularly, we found
that the extrapolated SCD updates usually performed best). For
larger data sets, more updates in the main model fitting and
refinement steps may be needed to obtain a good fit.
</p>
<p>For larger data sets, more than 200 updates may be needed to obtain
a good fit.
</p>


<h3>Value</h3>

<p>A multinomial topic model fit; see
<code>poisson2multinom</code> and <code>fit_poisson_nmf</code>
for details. Note that outputted likelihoods and deviances in
<code>progress</code> are evaluated with respect to the equivalent
Poisson NMF model.
</p>


<h3>References</h3>

<p>Dey, K. K., Hsiao, C. J. and Stephens, M. (2017). Visualizing the
structure of RNA-seq expression data using grade of membership
models. <em>PLoS Genetics</em> <b>13</b>, e1006599.
</p>
<p>Blei, D. M., Ng, A. Y. and Jordan, M. I. (2003). Latent Dirichlet
allocation. <em>Journal of Machine Learning Research</em> <b>3</b>,
993-1022.
</p>
<p>Hofmann, T. (1999). Probabilistic latent semantic indexing. In
<em>Proceedings of the 22nd International ACM SIGIR Conference</em>,
50-57. doi:10.1145/312624.312649
</p>


<h3>See Also</h3>

<p><code>init_poisson_nmf</code>,
<code>fit_poisson_nmf</code>,
<code>poisson2multinom</code>,
<code>fit_multinom_model</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(Matrix)
set.seed(1)
X &lt;- simulate_count_data(80,100,k = 3,sparse = TRUE)$X
fit &lt;- fit_topic_model(X,k = 3)
print(summary(fit))

</code></pre>


</div>