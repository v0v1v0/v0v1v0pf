<div class="container">

<table style="width: 100%;"><tr>
<td>spClipPoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial - Clip (intersect) point vector layer with polygon vector layer.</h2>

<h3>Description</h3>

<p>Wrapper for sf::st_intersection, to clip (intersect) point vector layer with
a polygon vector layer.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spClipPoint(
  xyplt,
  xyplt_dsn = NULL,
  uniqueid = "PLT_CN",
  clippolyv,
  clippolyv_dsn = NULL,
  clippolyv.filter = NULL,
  buffdist = NULL,
  validate = FALSE,
  showext = FALSE,
  keepNA = FALSE,
  returnsp = TRUE,
  othertabnms = NULL,
  stopifnotin = TRUE,
  savedata = FALSE,
  exportsp = FALSE,
  spMakeSpatial_opts = NULL,
  savedata_opts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xyplt</code></td>
<td>
<p>sf R object or String. Point data to clip. Can be a spatial
points object, full pathname to a shapefile, or name of a layer within a
database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyplt_dsn</code></td>
<td>
<p>String. Data source name (dsn; e.g., sqlite or shapefile
pathname) of layer to clip. The dsn varies by driver. See gdal OGR vector
formats (https://www.gdal.org/ogr_formats.html).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniqueid</code></td>
<td>
<p>String.* Unique identifier of xyplt rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clippolyv</code></td>
<td>
<p>sf R object or String. Name of clipping polygon spatial
polygon object, full path to shapefile, or name of a layer within a
database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clippolyv_dsn</code></td>
<td>
<p>String. Data source name (dsn; e.g., sqlite or
shapefile pathname) of clipping polygon. The dsn varies by driver. See gdal
OGR vector formats (https://www.gdal.org/ogr_formats.html).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clippolyv.filter</code></td>
<td>
<p>String. Filter to subset clippolyv spatial layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffdist</code></td>
<td>
<p>Number. The distance to buffer the polygon before clipping.
Uses sf::st_buffer. The distance is based on units of polygon, st_crs(x)$units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validate</code></td>
<td>
<p>Logical. If TRUE, validates polyv and clippolyv before 
clipping. Uses sf::st_make_valid with default parameters 
(geos_method='valid_structure', geos_keep_collapsed=FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showext</code></td>
<td>
<p>Logical. If TRUE, layer extents are displayed in plot window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepNA</code></td>
<td>
<p>Logical. If TRUE, keep NA values after data intersection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnsp</code></td>
<td>
<p>Logical. If TRUE, returns sf object of points. If FALSE,
returns data frame of points (i.e., drops sf geometry).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>othertabnms</code></td>
<td>
<p>String vector. Name(s) of R objects, comma-delimited
files, or database layers to subset. Must include quotes (e.g.,
othertabnms=c("tree", "cond")).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopifnotin</code></td>
<td>
<p>Logical. If TRUE, stops if boundaries do not overlap.  If
FALSE, returns NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savedata</code></td>
<td>
<p>Logical. If TRUE, save data to outfolder.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exportsp</code></td>
<td>
<p>Logical. If TRUE, the clipped spatial point data are
exported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spMakeSpatial_opts</code></td>
<td>
<p>List. See help(spMakeSpatial_options()) for a list
of options. Use to convert X/Y values to simple feature (sf) coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savedata_opts</code></td>
<td>
<p>List. See help(savedata_options()) for a list
of options for saving data. If out_layer = NULL, default = 'pntclip'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sf::st_intersection function is used to clip points. <br></p>
<p>If the projection of clippolyv is not the same as the xyplt, the xyplt layer
layer will be reprojected to the same projection as the clippoly before
intersection.
</p>


<h3>Value</h3>

<p>A list of the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>clip_xyplt</code></td>
<td>
<p> sf object. The input xyplt, clipped to polygon boundary
layer.  The projection will be same as clippolyv projection. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy.uniqueid</code></td>
<td>
<p> String. Unique identifier of clip_xy. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clip_polyv</code></td>
<td>
<p> SpatialPolygonsDataFrame. The polygon boundary layer used
for clipping. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clip_tabs</code></td>
<td>
<p> Data frame(s). Other tables in intabs
clipped to boundary. </p>
</td>
</tr>
</table>
<p>If exportsp=TRUE, the sf object will be written to out_dsn (See note).
</p>


<h3>Note</h3>

<p>On-the-fly projection conversion<br> The spTransform (sf) method is
used for on-the-fly map projection conversion and datum transformation using
PROJ.4 arguments. Datum transformation only occurs if the +datum tag is
present in the both the from and to PROJ.4 strings. The +towgs84 tag is used
when no datum transformation is needed. PROJ.4 transformations assume NAD83
and WGS84 are identical unless other transformation parameters are
specified.  Be aware, providing inaccurate or incomplete CRS information may
lead to erroneous data shifts when reprojecting. See spTransform help
documentation for more details.
</p>
<p>ESRI Shapefile Driver<br> If exportsp=TRUE:<br> The st_write (sf) function
is called. If out_fmt="shp", the ESRI Shapefile driver truncates variable
names to 10 characters or less. Variable names are changed before export
using an internal function (trunc10shp). If sf object has more than 1
record, it will be returned but not exported.
</p>


<h3>Author(s)</h3>

<p>Tracey S. Frescino
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Get point data from WYplt data in FIESTA
WYplt &lt;- FIESTA::WYplt

# Get polygon vector layer from FIESTA external data
WYbhdistfn &lt;- system.file("extdata",
                          "sp_data/WYbighorn_districtbnd.shp",
                          package = "FIESTA")

# Extract points from polygon vector layer
xyext &lt;- spClipPoint(xyplt = WYplt,
                     clippolyv = WYbhdistfn,
                     clippolyv.filter = "DISTRICTNU == '03'",
                     uniqueid = "CN",
                     spMakeSpatial_opts = list(xvar = "LON_PUBLIC",
                                               yvar = "LAT_PUBLIC",
                                               xy.crs = 4269))
names(xyext)
xyplt &lt;- xyext$clip_xyplt
polyv &lt;- xyext$clip_polyv

# Plot extracted values of national forest district
plot(sf::st_geometry(polyv))
plot(sf::st_geometry(xyplt), add = TRUE)
</code></pre>


</div>