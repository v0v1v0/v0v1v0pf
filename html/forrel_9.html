<div class="container">

<table style="width: 100%;"><tr>
<td>ibdBootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap estimation of IBD coefficients</h2>

<h3>Description</h3>

<p>This function produces (parametric or nonparametric) bootstrap estimates of
the IBD coefficients between two individuals. Both kappa and delta
coefficients are supported (see <code>ibdEstimate()</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ibdBootstrap(
  x = NULL,
  ids = NULL,
  param = NULL,
  kappa = NULL,
  delta = NULL,
  N,
  method = "parametric",
  freqList = NULL,
  plot = TRUE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped</code> object. If <code>method = "parametric"</code>, this is only used to
extract the allele frequencies, and can be skipped if <code>freqList</code> is
provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>A pair of ID labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Either NULL (default), "kappa" or "delta". (See below.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa, delta</code></td>
<td>
<p>Probability vectors of length 3 (kappa) or 9 (delta).
Exactly one of <code>param</code>, <code>kappa</code> and <code>delta</code> must be non-NULL. If <code>kappa</code>
and <code>delta</code> are both NULL, the appropriate set of coefficients is computed
as <code>ibdEstimate(x, ids, param)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either "parametric" (default) or "nonparametric". Abbreviations
are allowed. see Details for more information about each method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqList</code></td>
<td>
<p>A list of probability vectors: The allele frequencies for
each marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A logical, only relevant for bootstraps of kappa. If TRUE, the
bootstrap estimates are plotted in the IBD triangle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer seed for the random number generator (optional).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameter <code>method</code> controls how bootstrap estimates are obtained in each
replication.
</p>
<p>If <code>method = "parametric"</code>, new profiles for two individuals are simulated
from the input coefficients, followed by a re-estimation of the coefficients.
</p>
<p>If <code>method = "nonparametric"</code>, the original markers are sampled with
replacement, before the coefficients are re-estimated.
</p>


<h3>Value</h3>

<p>A data frame with <code>N</code> rows containing the bootstrap estimates. The
last column (<code>dist</code>) gives the euclidean distance to the original
coefficients, viewed as a point in R^3 (kappa) or R^9 (delta).
</p>


<h3>See Also</h3>

<p><code>ibdEstimate()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Frequency list of 15 standard STR markers
freqList = NorwegianFrequencies[1:15]

# Number of bootstrap simulations (increase!)
N = 5

# Bootstrap estimates for kappa of full siblings
boot1 = ibdBootstrap(kappa = c(0.25, .5, .25), N = N, freqList = freqList)
boot1

# Mean deviation
mean(boot1$dist)

# Same, but with the 9 identity coefficients.
delta = c(0, 0, 0, 0, 0, 0, .25, .5, .25)
boot2 = ibdBootstrap(delta = delta, N = N, freqList = freqList)

# Mean deviation
mean(boot2$dist)

#### Non-parametric bootstrap.
# Requires `x` and `ids` to be provided

x = nuclearPed(2)
x = markerSim(x, ids = 3:4, N = 50, alleles = 1:10, seed = 123)

bootNP = ibdBootstrap(x, ids = 3:4, param = "kappa", method = "non", N = N)

# Parametric bootstrap can also be done with this syntax
bootP = ibdBootstrap(x, ids = 3:4, param = "kappa", method = "par", N = N)

</code></pre>


</div>