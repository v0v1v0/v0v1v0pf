<div class="container">

<table style="width: 100%;"><tr>
<td>Two_way_Residuals_means</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functional time series decomposition into deterministic (functional analysis of variance fitted by means), and time-varying components (functional residuals).
</h2>

<h3>Description</h3>

<p>Decomposition of functional time series into deterministic (by functional analysis of variance fitted by means), and time-varying components (functional residuals)
</p>


<h3>Usage</h3>

<pre><code class="language-R">Two_way_Residuals_means(data_pop1, data_pop2, year, age, n_prefectures, n_populations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_pop1</code></td>
<td>
<p>A p by n matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_pop2</code></td>
<td>
<p>A p by n matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>Vector with the years considered in each population. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_prefectures</code></td>
<td>
<p>Number of prefectures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p>Vector with the ages considered in each year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_populations</code></td>
<td>
<p>Number of populations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>residuals1</code></td>
<td>
<p>A matrix with  dimension n by p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals2</code></td>
<td>
<p>A matrix with  dimension n by p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rd</code></td>
<td>
<p>A two dimension logic vector proving that the decomposition sum up the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A matrix of dimension as n by 2p. This represents the time-varying component in the decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fixed_comp</code></td>
<td>
<p>A matrix of dimension as n by 2p. This represents the deterministic component in the decomposition.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Cristian Felipe Jimenez Varon, Ying Sun, Han Lin Shang
</p>


<h3>References</h3>

<p>C. F. Jimenez Varon, Y. Sun and H. L. Shang (2023) â€œForecasting high-dimensional functional time series: Application to sub-national age-specific mortality".
</p>
<p>Ramsay, J. and B. Silverman (2006). Functional Data Analysis. Springer Series in Statistics. Chapter 13. New York: Springer.
</p>


<h3>See Also</h3>

<p><code>Two_way_Residuals</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The US mortality data  1959-2020, for two populations
# and three states (New York, California, Illinois)
# Compute the functional Anova decomposition fitted by means.
FANOVA_means_residuals &lt;- Two_way_Residuals_means(data_pop1=t(all_hmd_male_data),
                            data_pop2=t(all_hmd_female_data), year = 1959:2020,
                            age = 0:100, n_prefectures = 3, n_populations = 2)
                            
# The results
##1. The functional residuals from population 1
Residuals_pop_1=FANOVA_means_residuals$residuals1
##2. The functional residuals from population 2
Residuals_pop_2=FANOVA_means_residuals$residuals2
##3. A logic vector whose components indicate whether the sum of deterministic
##  and time-varying components recover the original FTS.
Construct_data=FANOVA_means_residuals$rd
##4. Time-varying components for all the populations. The functional residuals
All_pop_functional_residuals &lt;- FANOVA_means_residuals$R
##5. The deterministic components from the functional ANOVA decomposition
deterministic_comp &lt;- FANOVA_means_residuals$Fixed_comp
</code></pre>


</div>