<div class="container">

<table style="width: 100%;"><tr>
<td>fitTsfmLagLeadBeta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a lagged and lead Betas factor model using time series regression</h2>

<h3>Description</h3>

<p>This is a wrapper function to fits a time series lagged Betas factor model for one 
or more asset returns or excess returns using time series regression. 
Users can choose between ordinary least squares-LS, discounted least 
squares-DLS (or) robust regression like <code>fitTsfm</code>.An object of class 
<code>"tsfm"</code> is returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitTsfmLagLeadBeta(
  asset.names,
  mkt.name,
  rf.name = NULL,
  data = data,
  fit.method = c("LS", "DLS", "Robust"),
  LagLeadBeta = 1,
  LagOnly = FALSE,
  control = fitTsfm.control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>asset.names</code></td>
<td>
<p>vector containing names of assets, whose returns or 
excess returns are the dependent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mkt.name</code></td>
<td>
<p>name of the column for market returns. It 
is required for a lagged Betas factor model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rf.name</code></td>
<td>
<p>name of the column of risk free rate variable to calculate 
excess returns for all assets (in <code>asset.names</code>) and the market factor (in 
<code>mkt.name</code>).Default is NULL, and no action is taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>vector, matrix, data.frame, xts, timeSeries or zoo object
containing column(s) named in <code>asset.names</code>, <code>factor.names</code> and 
optionally, <code>mkt.name</code> and <code>rf.name</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.method</code></td>
<td>
<p>the estimation method, one of "LS", "DLS" or "Robust". 
See details. Default is "LS".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LagLeadBeta</code></td>
<td>
<p>A integer number to specify numbers of lags (and leads when LagOnly is FALSE) 
of Betas to 
include in the model. The Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LagOnly</code></td>
<td>
<p>Flag variable to only include the lags (or have both lags and leads). 
The Default is FALSE (both lags and leads).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of control parameters. The default is constructed by 
the function <code>fitTsfm.control</code>. See the documentation for 
<code>fitTsfm.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>fitTsfm.control</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The lagged and lead returns model estimates lagged and lead market Beta. Specifically, 
</p>
<p style="text-align: center;"><code class="reqn">r_t = \alpha + \beta_0 MKT_t + \beta^-_1 MKT_t-1 + \ldots + \beta^-_K+1 MKT_t-K 
+  \beta^+_1 MKT_t+1 + \ldots + \beta^+_K MKT_t+K \epsilon_t, t=1 \ldots T</code>
</p>

<p>where <code class="reqn">r_t</code> is the asset returns, and MKT is the market factor. It is usually 
needed for illiquid securities with stale prices. One can also report the sum of 
the lagged and lead Betas: 
</p>
<p style="text-align: center;"><code class="reqn">\beta = \beta_0 + \beta^+_1 + \beta^+_1 + \ldots + \beta^+_K + 
\beta^-_1 + \ldots + \beta^-_K </code>
</p>



<h3>Value</h3>

<p><code>fitTsfmLagLeadBeta</code> also returns an object of class <code>"tsfm"</code> like 
<code>fitTsfm</code>. The generic function such as <code>print</code>, <code>plot</code>, <code>predict</code> 
and <code>summary</code> methods exist. Also, the generic accessor functions <code>coef</code>, 
<code>fitted</code>, <code>residuals</code> and  <code>fmCov</code> can be applied as well.
</p>
<p>An object of class <code>"tsfm"</code> is a list containing the following 
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>asset.fit</code></td>
<td>
<p>list of fitted objects for each asset. Each object is of 
class <code>lm</code> if <code>fit.method="LS" or "DLS"</code>, class <code>lmRob</code> if 
the <code>fit.method="Robust"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>length-N vector of estimated alphas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>N x (L+1) matrix of estimated betas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>length-N vector of R-squared values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.sd</code></td>
<td>
<p>length-N vector of residual standard deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>xts data object containing the assets and factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asset.names</code></td>
<td>
<p>asset.names as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.method</code></td>
<td>
<p>fit.method as input.</p>
</td>
</tr>
</table>
<p>Where N is the number of assets, L is the number of lagged and lead market Betas and T is the 
number of time periods.
</p>


<h3>Author(s)</h3>

<p>Yi-An Chen.
</p>


<h3>References</h3>

<p>Scholes, M. and Williams, J. T. (1977). Estimating betas from non-synchronous
data, Journal of Financial Economics, vol. 5, 1977, pp. 309-327
</p>


<h3>See Also</h3>

<p>The original time series function <code>fitTsfm</code> and its generic functions
application.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## A lagged Betas model with LS fit
 
 # load data
data(managers, package = 'PerformanceAnalytics')

fit &lt;- fitTsfmLagLeadBeta(asset.names = names(managers[,(1:6)]),
                          mkt.name = "SP500 TR", rf.name = "US 3m TR", 
                          data = managers, LagLeadBeta = 2, LagOnly = TRUE)
summary(fit)
fitted(fit)

</code></pre>


</div>