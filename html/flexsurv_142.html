<div class="container">

<table style="width: 100%;"><tr>
<td>plot.flexsurvreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots of fitted flexible survival models</h2>

<h3>Description</h3>

<p>Plot fitted survival, cumulative hazard or hazard from a parametric model
against nonparametric estimates to diagnose goodness-of-fit.  Alternatively
plot a user-defined function of the model parameters against time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'flexsurvreg'
plot(
  x,
  newdata = NULL,
  X = NULL,
  type = "survival",
  fn = NULL,
  t = NULL,
  start = 0,
  est = TRUE,
  ci = NULL,
  B = 1000,
  cl = 0.95,
  col.obs = "black",
  lty.obs = 1,
  lwd.obs = 1,
  col = "red",
  lty = 1,
  lwd = 2,
  col.ci = NULL,
  lty.ci = 2,
  lwd.ci = 1,
  ylim = NULL,
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output from <code>flexsurvreg</code> or
<code>flexsurvspline</code>, representing a fitted survival model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Data frame containing covariate values to produce fitted
values for.  See <code>summary.flexsurvreg</code>.
</p>
<p>If there are only factor covariates in the model, then Kaplan-Meier (or
nonparametric hazard...)  curves are plotted for all distinct groups, and
by default, fitted curves are also plotted for these groups.  To plot
Kaplan-Meier and fitted curves for only a subset of groups, use
<code>plot(survfit())</code> followed by <code>lines.flexsurvreg()</code>.
</p>
<p>If there are any continuous covariates, then a single population
Kaplan-Meier curve is drawn. By default, a single fitted curve is drawn
with the covariates set to their mean values in the data - for categorical
covariates, the means of the 0/1 indicator variables are taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Alternative way to supply covariate values, as a model matrix.
See <code>summary.flexsurvreg</code>.  <code>newdata</code> is an easier way.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>"survival"</code> for survival, to be plotted against
Kaplan-Meier estimates from <code>plot.survfit</code>.
</p>
<p><code>"cumhaz"</code> for cumulative hazard, plotted against transformed
Kaplan-Meier estimates from <code>plot.survfit</code>.
</p>
<p><code>"hazard"</code> for hazard, to be plotted against smooth nonparametric
estimates from <code>muhaz</code>.  The nonparametric estimates
tend to be unstable, and these plots are intended just to roughly indicate
the shape of the hazards through time.  The <code>min.time</code> and
<code>max.time</code> options to <code>muhaz</code> may sometimes need to
be passed as arguments to <code>plot.flexsurvreg</code> to avoid an error
here.
</p>
<p>Ignored if <code>"fn"</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>Custom function of the parameters to summarise against time.  The
first two arguments of the function must be <code>t</code> representing time, and
<code>start</code> representing left-truncation points, and any remaining
arguments must be parameters of the distribution.  It should return a
vector of the same length as <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Vector of times to plot fitted values for, see
<code>summary.flexsurvreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Left-truncation points, see <code>summary.flexsurvreg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Plot fitted curves (<code>TRUE</code> or <code>FALSE</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Plot confidence intervals for fitted curves. By default, this is
<code>TRUE</code> if one observed/fitted curve is plotted, and <code>FALSE</code> if
multiple curves are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of simulations controlling accuracy of confidence
intervals, as used in <code>summary</code>.
Decrease for greater speed at the expense of accuracy, or set <code>B=0</code> to
turn off calculation of CIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Width of confidence intervals, by default 0.95 for 95%
intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.obs</code></td>
<td>
<p>Colour of the nonparametric curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.obs</code></td>
<td>
<p>Line type of the nonparametric curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.obs</code></td>
<td>
<p>Line width of the nonparametric curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Colour of the fitted parametric curve(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Line type of the fitted parametric curve(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width of the fitted parametric curve(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ci</code></td>
<td>
<p>Colour of the fitted confidence limits, defaulting to the
same as for the fitted curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.ci</code></td>
<td>
<p>Line type of the fitted confidence limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.ci</code></td>
<td>
<p>Line width of the fitted confidence limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-axis limits: vector of two elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>If <code>TRUE</code>, add lines to an existing plot, otherwise new
axes are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other options to be passed to <code>plot.survfit</code> or
<code>muhaz</code>, for example, to control the smoothness of the
nonparametric hazard estimates.  The <code>min.time</code> and <code>max.time</code>
options to <code>muhaz</code> may sometimes need to be changed from
the defaults.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Some standard plot arguments such as <code>"xlim","xlab"</code> may not
work.  This function was designed as a quick check of model fit.  Users
wanting publication-quality graphs are advised to set up an empty plot with
the desired axes first (e.g. with <code>plot(...,type="n",...)</code>), then use
suitable <code>lines</code> functions to add lines.
</p>
<p>If case weights were used to fit the model, these are used when producing
nonparametric estimates of survival and cumulative hazard, but not for
the hazard estimates.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>flexsurvreg</code>
</p>


</div>