<div class="container">

<table style="width: 100%;"><tr>
<td>propBarchart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Barcharts and Boxplots for Columns of a Data Matrix Split by Groups</h2>

<h3>Description</h3>

<p>Split a binary or numeric matrix by a grouping variable,
run a series of tests on all variables, adjust for multiple testing
and graphically represent results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">propBarchart(x, g, alpha=0.05, correct="holm", test="prop.test",
             sort=FALSE, strip.prefix="", strip.labels=NULL,
             which=NULL, byvar=FALSE, ...)

## S4 method for signature 'propBarchart'
summary(object, ...)

groupBWplot(x, g, alpha=0.05, correct="holm", xlab="", col=NULL,
            shade=!is.null(shadefun), shadefun=NULL,
            strip.prefix="", strip.labels=NULL, which=NULL, byvar=FALSE,
            ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A binary data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>A factor specifying the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level for test of differences in
proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>Correction method for multiple testing, passed to
<code>p.adjust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Test to use for detecting significant differences in
proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>Logical, sort variables by total sample mean?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip.prefix</code></td>
<td>
<p>Character string prepended to strips of the
<code>barchart</code> (the remainder of the strip are group
levels and group sizes). Ignored if <code>strip.labels</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip.labels</code></td>
<td>
<p>Character vector of labels to use for strips of
<code>barchart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Index numbers or names of variables to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byvar</code></td>
<td>
<p>If <code>TRUE</code>, a panel is plotted for each variable. By
default a panel is plotted for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed on to <code>barchart</code>
or <code>bwplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Return value of <code>propBarchart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A title for the x-axis: see <code>title</code>. 
The default is <code>""</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector of colors for the panels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p>If <code>TRUE</code>, only variables with significant 
differences in median are filled with color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shadefun</code></td>
<td>
<p>A function or name of a function to compute which
boxes are shaded, e.g. <code>"kruskalTest"</code> (default),
<code>"medianInside"</code> or <code>"boxOverlap"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>propBarchart</code> splits a binary data matrix into
subgroups, computes the percentage of ones in each column and compares
the proportions in the groups using <code>prop.test</code>. The
p-values for all variables are adjusted for multiple testing and a
barchart of group percentages is drawn highlighting variables with
significant differences in proportion. The <code>summary</code> method can
be used to create a corresponding table for publications.
</p>
<p>Function <code>groupBWplot</code> takes a general numeric matrix, also
splits into subgroups and uses boxes instead of bars. By default
<code>kruskal.test</code> is used to compute significant differences
in location, in addition the heuristics from
<code>bwplot,kcca-method</code> can be used. Boxes of the complete sample
are used as reference in the background.
</p>


<h3>Author(s)</h3>

<p>Friedrich Leisch</p>


<h3>See Also</h3>

<p><code>barplot-methods</code>,
<code>bwplot,kcca-method</code></p>


<h3>Examples</h3>

<pre><code class="language-R"> ## create a binary matrix from the iris data plus a random noise column
 x &lt;- apply(iris[,-5], 2, function(z) z&gt;median(z))
 x &lt;- cbind(x, Noise=sample(0:1, 150, replace=TRUE))

 ## There are significant differences in all 4 original variables, Noise
 ## has most likely no significant difference (of course the difference
 ## will be significant in alpha percent of all random samples).
 p &lt;- propBarchart(x, iris$Species)
 p
 summary(p)
 propBarchart(x, iris$Species, byvar=TRUE)
 
 x &lt;- iris[,-5]
 x &lt;- cbind(x, Noise=rnorm(150, mean=3))
 groupBWplot(x, iris$Species)
 groupBWplot(x, iris$Species, shade=TRUE)
 groupBWplot(x, iris$Species, shadefun="medianInside")
 groupBWplot(x, iris$Species, shade=TRUE, byvar=TRUE)
</code></pre>


</div>