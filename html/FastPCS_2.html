<div class="container">

<table style="width: 100%;"><tr>
<td>FastPCS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes the FastPCS multivariate outlyingness index.</h2>

<h3>Description</h3>

<p>Computes a fast and robust multivariate outlyingness index for a n by p matrix of 
multivariate continuous data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  FastPCS(x,nSamp,alpha=0.5,seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric n (n&gt;5*p) by p (p&gt;1) matrix or data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSamp</code></td>
<td>
<p>A positive integer giving the number of resamples required;
<code>"nSamp"</code> may not be reached if too many of the p-subsets,
chosen out of the observed vectors, lie on a hyperplane.  If <code>"nSamp"</code> is
omitted, it is calculated so that the probability of getting at least one
uncontaminated starting point is always at least 99 percent when there are n/2 outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric parameter controlling the size of the active subsets,
i.e., <code>"h=quanf(alpha,n,p)"</code>.  Allowed
values are between 0.5 and 1 and the default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Starting value for random generator. A positive integer. Default is seed = 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The current version of FastPCS includes the use of a C-step procedure to improve efficiency (Rousseeuw and van Driessen (1999)). C-steps are taken after the raw subset (H*) as been chosen (according to the I-index) and before reweighting. In experiments, we found that carrying C-Steps 
starting from the members of <code>$rawBest</code> improves the speed of convergence without increasing the bias
of the final estimates. FastPCS is affine equivariant (Schmitt et al. (2014)) and thus consistent at the 
elliptical model (Maronna et al., (2006) p. 217).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The value of alpha used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSamp</code></td>
<td>
<p>The value of nSamp used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>The value of the FastPCS objective function of the optimal h subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rawBest</code></td>
<td>
<p>The index of the h observation with smallest outlyingness indexes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best</code></td>
<td>
<p>The index of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>The mean vector of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>Covariance matrix of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The statistical distance of each observation wrt the center vector and cov matrix of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>References</h3>

<p>Maronna, R. A., Martin R. D. and Yohai V. J. (2006). Robust Statistics: Theory and Methods. Wiley, New York.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999). A fast algorithm for the minimum covariance determinant estimator. Technometrics 41, 212–223.
</p>
<p>Eric Schmitt, Viktoria Oellerer, Kaveh Vakili (2014).
The finite sample breakdown point of PCS Statistics and Probability Letters, Volume 94, Pages 214-220.
</p>
<p>Vakili, K. and Schmitt, E. (2014).
Finding multivariate outliers with FastPCS.
<em>Computational Statistics &amp; Data Analysis</em>.
Vol. 69, pp 54–66.
(http://arxiv.org/abs/1301.2053)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## testing outlier detection 
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
x0[1:30,]&lt;-matrix(rnorm(30*p,4.5,1/100),nc=p)
z&lt;-c(rep(0,30),rep(1,70))
nstart&lt;-FPCSnumStarts(p=p,eps=0.4)
results&lt;-FastPCS(x=x0,nSamp=nstart)
z[results$best]

## testing outlier detection, different value of alpha
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
x0[1:20,]&lt;-matrix(rnorm(20*p,4.5,1/100),nc=p)
z&lt;-c(rep(0,20),rep(1,80))
nstart&lt;-FPCSnumStarts(p=p,eps=0.25)
results&lt;-FastPCS(x=x0,nSamp=nstart,alpha=0.75)
z[results$best]

#testing exact fit
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
x0[1:30,]&lt;-matrix(rnorm(30*p,5,1/100),nc=p)
x0[31:100,3]&lt;-x0[31:100,2]*2+1
z&lt;-c(rep(0,30),rep(1,70))
nstart&lt;-FPCSnumStarts(p=p,eps=0.4)
results&lt;-FastPCS(x=x0,nSamp=nstart)
z[results$rawBest]
results$obj

#testing affine equivariance
n&lt;-100
p&lt;-3
set.seed(123)
x0&lt;-matrix(rnorm(n*p),nc=p)
nstart&lt;-500
results1&lt;-FastPCS(x=x0,nSamp=nstart,seed=1)
a1&lt;-matrix(0.9,p,p)
diag(a1)&lt;-1
x1&lt;-x0%*%a1
results2&lt;-FastPCS(x=x1,nSamp=nstart,seed=1)
results2$center
results2$cov
#should be the same
results1$center%*%a1
a1

</code></pre>


</div>