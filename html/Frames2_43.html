<div class="container">

<table style="width: 100%;"><tr>
<td>SFRR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Raking ratio estimator</h2>

<h3>Description</h3>

<p>Produces estimates for population total and mean using the raking ratio estimator from survey data obtained
from a dual frame sampling desing. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SFRR(ysA, ysB, pi_A, pi_B, pik_ab_B, pik_ba_A, domains_A, domains_B, N_A, N_B, 
conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling desing in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling desing in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "a" and "ab".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "b" and "ba".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Raking ratio estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{SFRR} = \frac{N_A - \hat{N}_{ab,rake}}{\hat{N}_a^A}\hat{Y}_a^A + \frac{N_B - \hat{N}_{ab,rake}}{\hat{N}_b^B}\hat{Y}_b^B + \frac{\hat{N}_{ab,rake}}{\hat{N}_{abS}}\hat{Y}_{abS}</code>
</p>

<p>where <code class="reqn">\hat{Y}_{abS} = \sum_{i \in s_{ab}^A}\tilde{d}_i^Ay_i + \sum_{i \in s_{ab}^B}\tilde{d}_i^By_i, \hat{N}_{abS} = \sum_{i \in s_{ab}^A}\tilde{d}_i^A + \sum_{i \in s_{ab}^B}\tilde{d}_i^B</code> and
<code class="reqn">\hat{N}_{ab,rake}</code> is the smallest root of the quadratic equation <code class="reqn">\hat{N}_{ab,rake}x^2 - [\hat{N}_{ab,rake}(N_A + N_B) + \hat{N}_{aS}\hat{N}_{bS}]x + \hat{N}_{ab,rake}N_AN_B = 0</code>,
with <code class="reqn">\hat{N}_{aS} = \sum_{s_a^A}\tilde{d}_i^B</code> and <code class="reqn">\hat{N}_{bS} = \sum_{s_b^B}\tilde{d}_i^B</code>. Weights <code class="reqn">\tilde{d}_i^A</code> and <code class="reqn">\tilde{d}_i^B</code> are obtained as follows
<code class="reqn">\tilde{d}_i^A =\left\{\begin{array}{lcc}
 d_i^A &amp; \textrm{if } i \in a\\
 (1/d_i^A + 1/d_i^B)^{-1} &amp; \textrm{if } i \in ab
 \end{array}
 \right.</code>
and
<code class="reqn">\tilde{d}_i^B =\left\{\begin{array}{lcc}
 d_i^B &amp; \textrm{if } i \in b\\
 (1/d_i^A + 1/d_i^B)^{-1} &amp; \textrm{if } i \in ba
 \end{array}
 \right.</code>
being <code class="reqn">d_i^A</code> and <code class="reqn">d_i^B</code> the design weights, obtained as the inverse of the first order inclusion probabilities, that is <code class="reqn">d_i^A = 1/\pi_i^A</code> and <code class="reqn">d_i^B = 1/\pi_i^B</code>.
</p>
<p>To obtain an estimator of the variance for this estimator, one has taken into account that raking ratio estimator coincides with SF calibration estimator when frame sizes are known and "raking"
method is used. So, one can use here Deville's expression to calculate an estimator for the variance of the raking ratio estimator
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{SFRR}) = \frac{1}{1-\sum_{k\in s} a_k^2}\sum_{k\in s}(1-\pi_k)\left(\frac{e_k}{\pi_k} - \sum_{l\in s} a_{l} \frac{e_l}{\pi_l}\right)^2</code>
</p>

<p>where <code class="reqn">a_k=(1-\pi_k)/\sum_{l\in s} (1-\pi_l)</code> and <code class="reqn">e_k</code> are the residuals of the regression with auxiliary variables as regressors.
</p>


<h3>Value</h3>

<p><code>SFRR</code> returns an object of class "EstimatorDF" which is a list with, at least, the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td>
</tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table><tr style="vertical-align: top;">
<td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td>
</tr></table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Lohr, S. and Rao, J.N.K. (2000).
<em>Inference in Dual Frame Surveys</em>. Journal of the American Statistical Association, Vol. 95, 271 - 280.
</p>
<p>Rao, J.N.K. and Skinner, C.J. (1996).
<em>Estimation in Dual Frame Surveys with Complex Designs</em>. Proceedings of the Survey Method Section, Statistical Society of Canada, 63 - 68.
</p>
<p>Skinner, C.J. and Rao J.N.K. (1996).
<em>Estimation in Dual Frame Surveys with Complex Designs</em>. Journal of the American Statistical Association, Vol. 91, 443, 349 - 356.
</p>
<p>Skinner, C.J. (1991).
<em>On the Efficiency of Raking Ratio Estimation for Multiple Frame Surveys</em>. Journal of the American Statistical Association, Vol. 86, 779 - 784.
</p>


<h3>See Also</h3>

<p><code>JackSFRR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate raking ratio estimator for population total for variable Clothing
SFRR(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$ProbB, DatB$ProbA, DatA$Domain, 
DatB$Domain, 1735, 1191)

#Now, let calculate raking ratio estimator and a 90% confidence interval for 
#population total for variable Feeding, considering only first order inclusion probabilities
SFRR(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$ProbB, DatB$ProbA, 
DatA$Domain, DatB$Domain, 1735, 1191, 0.90)
</code></pre>


</div>