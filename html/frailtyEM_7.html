<div class="container">

<table style="width: 100%;"><tr>
<td>emfrail_control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Control parameters for emfrail</h2>

<h3>Description</h3>

<p>Control parameters for emfrail
</p>


<h3>Usage</h3>

<pre><code class="language-R">emfrail_control(opt_fit = TRUE, se = TRUE, se_adj = TRUE,
  ca_test = TRUE, lik_ci = TRUE, lik_interval = exp(c(-3, 20)),
  lik_interval_stable = exp(c(0, 20)), nlm_control = list(stepmax = 1),
  zph = FALSE, zph_transform = "km", em_control = list(eps = 1e-04,
  maxit = Inf, fast_fit = TRUE, verbose = FALSE, upper_tol = exp(10),
  lik_tol = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>opt_fit</code></td>
<td>
<p>Logical. Whether the outer optimization should be carried out.
If <code>FALSE</code>, then the frailty parameter is treated as fixed and the <code>emfrail</code> function returns only log-likelihood. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Logical. Whether to calculate the variance / covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_adj</code></td>
<td>
<p>Logical. Whether to calculate the adjusted variance / covariance matrix (needs <code>se == TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ca_test</code></td>
<td>
<p>Logical. Should the Commenges-Andersen test be calculated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik_ci</code></td>
<td>
<p>Logical. Should likelihood-based confidence interval be calculated for the frailty parameter?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik_interval</code></td>
<td>
<p>The edges, on the scale of <code class="reqn">\theta</code>, of the parameter space in which to search for likelihood-based confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik_interval_stable</code></td>
<td>
<p>(for dist = "stable") The edges, on the scale of <code class="reqn">\theta</code>, of the parameter space in which to search for likelihood-based confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlm_control</code></td>
<td>
<p>A list of named arguments to be sent to <code>nlm</code> for the outer optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zph</code></td>
<td>
<p>Logical. Should the <code>cox.zph</code> test be performed at the maximum likelihood estimate?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zph_transform</code></td>
<td>
<p>One of <code>"km", "rank", "identity"</code> or a function of one argument to be pased on to <code>cox.zph</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em_control</code></td>
<td>
<p>A list of parameters for the inner optimization. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>nlm_control</code> argument should not overalp with <code>hessian</code>, <code>f</code> or <code>p</code>.
</p>
<p>The <code>em_control</code> argument should be a list with the following items:
</p>

<ul>
<li>
<p><code>eps</code> A criterion for convergence of the EM algorithm (difference between two consecutive values of the log-likelihood)
</p>
</li>
<li>
<p><code>maxit</code> The maximum number of iterations between the E step and the M step
</p>
</li>
<li>
<p><code>fast_fit</code> Logical, whether the closed form formulas should be used for the E step when available
</p>
</li>
<li>
<p><code>verbose</code> Logical, whether details of the optimization should be printed
</p>
</li>
<li>
<p><code>upper_tol</code> An upper bound for <code class="reqn">\theta</code>; after this treshold, the algorithm returns the limiting log-likelihood of the no-frailty model.
That is because the no-frailty scenario corresponds to a <code class="reqn">\theta = \infty</code>, which could lead to some numerical issues
</p>
</li>
<li>
<p><code>lik_tol</code> For values higher than this, the algorithm returns a warning when the log-likelihood decreases between EM steps. Technically, this should not happen, but
if the parameter <code class="reqn">\theta</code> is somewhere really far from the maximum, numerical problems might lead in very small likelihood decreases.
</p>
</li>
</ul>
<p>The <code>fast_fit</code> option make a difference when the distribution is gamma (with or without left truncation) or
inverse Gaussian, i.e. pvf with m = -1/2 (without left truncation). For all the other scenarios, the fast_fit option will
automatically be changed to FALSE. When the number of events in a cluster / individual is not very small, the cases for which
fast fitting is available will show an improvement in performance.
</p>
<p>The starting value of the outer optimization may be set in the <code>distribution</code> argument.
</p>


<h3>Value</h3>

<p>An object of the type <code>emfrail_control</code>.
</p>


<h3>See Also</h3>

<p><code>emfrail</code>, <code>emfrail_dist</code>, <code>emfrail_pll</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">emfrail_control()
emfrail_control(em_control = list(eps = 1e-7))

</code></pre>


</div>