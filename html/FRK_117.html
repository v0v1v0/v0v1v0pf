<div class="container">

<table style="width: 100%;"><tr>
<td>SRE-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial Random Effects class</h2>

<h3>Description</h3>

<p>This is the central class definition of the <code>FRK</code> package, containing the model and all other information required for estimation and prediction.
</p>


<h3>Details</h3>

<p>The spatial random effects (SRE) model is the model employed in Fixed Rank Kriging, and the <code>SRE</code> object contains all information required for estimation and prediction from spatial data. Object slots contain both other objects (for example, an object of class <code>Basis</code>) and matrices derived from these objects (for example, the matrix <code class="reqn">S</code>) in order to facilitate computations.
</p>


<h3>Slots</h3>


<dl>
<dt><code>f</code></dt>
<dd>
<p>formula used to define the SRE object. All covariates employed need to be specified in the object <code>BAUs</code></p>
</dd>
<dt><code>data</code></dt>
<dd>
<p>the original data from which the model's parameters are estimated</p>
</dd>
<dt><code>basis</code></dt>
<dd>
<p>object of class <code>Basis</code> used to construct the matrix <code class="reqn">S</code></p>
</dd>
<dt><code>BAUs</code></dt>
<dd>
<p>object of class <code>SpatialPolygonsDataFrame</code>, <code>SpatialPixelsDataFrame</code> of <code>STFDF</code> that contains the Basic Areal Units (BAUs) that are used to both (i) project the data onto a common discretisation if they are point-referenced and (ii) provide a BAU-to-data relationship if the data has a spatial footprint</p>
</dd>
<dt><code>S</code></dt>
<dd>
<p>matrix constructed by evaluating the basis functions at all the data locations (of class <code>Matrix</code>)</p>
</dd>
<dt><code>S0</code></dt>
<dd>
<p>matrix constructed by evaluating the basis functions at all BAUs (of class <code>Matrix</code>)</p>
</dd>
<dt><code>D_basis</code></dt>
<dd>
<p>list of distance-matrices of class <code>Matrix</code>, one for each basis-function resolution</p>
</dd>
<dt><code>Ve</code></dt>
<dd>
<p>measurement-error variance-covariance matrix (typically diagonal and of class <code>Matrix</code>)</p>
</dd>
<dt><code>Vfs</code></dt>
<dd>
<p>fine-scale variance-covariance matrix at the data locations (typically diagonal and of class <code>Matrix</code>) up to a constant of proportionality estimated using the EM algorithm</p>
</dd>
<dt><code>Vfs_BAUs</code></dt>
<dd>
<p>fine-scale variance-covariance matrix at the BAU centroids (typically diagonal and of class <code>Matrix</code>) up to a constant of proportionality estimated using the EM algorithm</p>
</dd>
<dt><code>Qfs_BAUs</code></dt>
<dd>
<p>fine-scale precision matrix at the BAU centroids (typically diagonal and of class <code>Matrix</code>) up to a constant of proportionality estimated using the EM algorithm</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>vector of observations (of class <code>Matrix</code>)</p>
</dd>
<dt><code>Cmat</code></dt>
<dd>
<p>incidence matrix mapping the observations to the BAUs</p>
</dd>
<dt><code>X</code></dt>
<dd>
<p>design matrix of covariates at all the data locations</p>
</dd>
<dt><code>G</code></dt>
<dd>
<p>list of objects of class Matrix containing the design matrices for random effects at all the data locations</p>
</dd>
<dt><code>G0</code></dt>
<dd>
<p>list of objects of class Matrix containing the design matrices for random effects at all BAUs</p>
</dd>
<dt><code>K_type</code></dt>
<dd>
<p>type of prior covariance matrix of random effects. Can be "block-exponential" (correlation between effects decays as a function of distance between the basis-function centroids), "unstructured" (all elements in <code>K</code> are unknown and need to be estimated), or "neighbour" (a sparse precision matrix is used, whereby only neighbouring basis functions have non-zero precision matrix elements).</p>
</dd>
<dt><code>mu_eta</code></dt>
<dd>
<p>updated expectation of the basis-function random effects (estimated)</p>
</dd>
<dt><code>mu_gamma</code></dt>
<dd>
<p>updated expectation of the random effects (estimated)</p>
</dd>
<dt><code>S_eta</code></dt>
<dd>
<p>updated covariance matrix of random effects (estimated)</p>
</dd>
<dt><code>Q_eta</code></dt>
<dd>
<p>updated precision matrix of random effects (estimated)</p>
</dd>
<dt><code>Khat</code></dt>
<dd>
<p>prior covariance matrix of random effects (estimated)</p>
</dd>
<dt><code>Khat_inv</code></dt>
<dd>
<p>prior precision matrix of random effects (estimated)</p>
</dd>
<dt><code>alphahat</code></dt>
<dd>
<p>fixed-effect regression coefficients (estimated)</p>
</dd>
<dt><code>sigma2fshat</code></dt>
<dd>
<p>fine-scale variation scaling (estimated)</p>
</dd>
<dt><code>sigma2gamma</code></dt>
<dd>
<p>random-effect variance parameters (estimated)</p>
</dd>
<dt><code>fs_model</code></dt>
<dd>
<p>type of fine-scale variation (independent or CAR-based). Currently only "ind" is permitted</p>
</dd>
<dt><code>info_fit</code></dt>
<dd>
<p>information on fitting (convergence etc.)</p>
</dd>
<dt><code>response</code></dt>
<dd>
<p>A character string indicating the assumed distribution of the response variable</p>
</dd>
<dt><code>link</code></dt>
<dd>
<p>A character string indicating the desired link function. Can be "log", "identity", "logit", "probit", "cloglog", "reciprocal", or "reciprocal-squared". Note that only sensible link-function and response-distribution combinations are permitted.</p>
</dd>
<dt><code>mu_xi</code></dt>
<dd>
<p>updated expectation of the fine-scale random effects at all BAUs (estimated)</p>
</dd>
<dt><code>Q_posterior</code></dt>
<dd>
<p>updated joint precision matrix of the basis function random effects and observed fine-scale random effects (estimated)</p>
</dd>
<dt><code>log_likelihood</code></dt>
<dd>
<p>the log likelihood of the fitted model</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>the fitting procedure used to fit the SRE model</p>
</dd>
<dt><code>phi</code></dt>
<dd>
<p>the estimated dispersion parameter (assumed constant throughout the spatial domain)</p>
</dd>
<dt><code>k_Z</code></dt>
<dd>
<p>vector of known size parameters at the observation support level (only applicable to binomial and negative-binomial response distributions)</p>
</dd>
<dt><code>k_BAU</code></dt>
<dd>
<p>vector of known size parameters at the observed BAUs (only applicable to binomial and negative-binomial response distributions)</p>
</dd>
<dt><code>include_fs</code></dt>
<dd>
<p>flag indicating whether the fine-scale variation should be included in the model</p>
</dd>
<dt><code>include_gamma</code></dt>
<dd>
<p>flag indicating whether there are gamma random effects in the model</p>
</dd>
<dt><code>normalise_wts</code></dt>
<dd>
<p>if <code>TRUE</code>, the rows of the incidence matrices <code class="reqn">C_Z</code> and <code class="reqn">C_P</code> are normalised to sum to 1, so that the mapping represents a weighted average; if false, no normalisation of the weights occurs (i.e., the mapping corresponds to a weighted sum)</p>
</dd>
<dt><code>fs_by_spatial_BAU</code></dt>
<dd>
<p>if <code>TRUE</code>, then each BAU is associated with its own fine-scale variance parameter</p>
</dd>
<dt><code>obsidx</code></dt>
<dd>
<p>indices of observed BAUs</p>
</dd>
<dt><code>simple_kriging_fixed</code></dt>
<dd>
<p>logical indicating whether one wishes to commit to simple kriging at the fitting stage: If <code>TRUE</code>, model fitting is faster, but the option to conduct universal kriging at the prediction stage is removed</p>
</dd>
</dl>
<h3>References</h3>

<p>Zammit-Mangion, A. and Cressie, N. (2017). FRK: An R package for spatial and spatio-temporal prediction with large datasets. Journal of Statistical Software, 98(4), 1-48. doi:10.18637/jss.v098.i04.
</p>


<h3>See Also</h3>

<p><code>SRE</code> for details on how to construct and fit SRE models.
</p>


</div>