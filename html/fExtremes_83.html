<div class="container">

<table style="width: 100%;"><tr>
<td>gpdRisk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GPD Distributions for Extreme Value Theory</h2>

<h3>Description</h3>

<p>A collection and description to functions to compute
tail risk under the GPD approach.
<br></p>
<p>The GPD modelling functions are:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>gpdQPlot</code> </td>
<td style="text-align: left;"> estimation of high quantiles, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>gpdQuantPlot</code> </td>
<td style="text-align: left;"> variation of high quantiles with threshold, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>gpdRiskMeasures</code> </td>
<td style="text-align: left;"> prescribed quantiles and expected shortfalls, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>gpdSfallPlot</code> </td>
<td style="text-align: left;"> expected shortfall with confidence intervals, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>gpdShapePlot</code> </td>
<td style="text-align: left;"> variation of shape with threshold, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>gpdTailPlot</code> </td>
<td style="text-align: left;"> plot of the tail, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>tailPlot</code> </td>
<td style="text-align: left;"> , </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>tailSlider</code> </td>
<td style="text-align: left;"> , </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>tailRisk</code> </td>
<td style="text-align: left;"> . </td>
</tr>
</table>
<h3>Usage</h3>

<pre><code class="language-R">
gpdQPlot(x, p = 0.99, ci = 0.95, type = c("likelihood", "wald"),  
    like.num = 50)
gpdQuantPlot(x, p = 0.99, ci = 0.95, models = 30, start = 15, end = 500,
    doplot = TRUE, plottype = c("normal", "reverse"), labels = TRUE,
    ...) 
gpdSfallPlot(x, p = 0.99, ci = 0.95, like.num = 50)
gpdShapePlot(x, ci = 0.95, models = 30, start = 15, end = 500,
    doplot = TRUE, plottype = c("normal", "reverse"), labels = TRUE,
    ...) 
gpdTailPlot(object, plottype = c("xy", "x", "y", ""), doplot = TRUE, 
    extend = 1.5, labels = TRUE, ...)

gpdRiskMeasures(object, prob = c(0.99, 0.995, 0.999, 0.9995, 0.9999))

tailPlot(object, p = 0.99, ci = 0.95, nLLH = 25, extend = 1.5, grid =
    TRUE, labels = TRUE, ...) 
tailSlider(x)
tailRisk(object, prob = c(0.99, 0.995, 0.999, 0.9995, 0.9999), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>the probability for asymptotic confidence band; for no 
confidence band set to zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doplot</code></td>
<td>

<p>a logical. Should the results be plotted?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extend</code></td>
<td>

<p>optional argument for plots 1 and 2 expressing how far x-axis 
should extend as a multiple of the largest data value. This 
argument must take values greater than 1 and is useful for
showing estimated quantiles beyond data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>

<p>...
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>optional argument for plots 1 and 2  specifying whether or not
axes should be labelled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>like.num</code></td>
<td>

<p>the number of times to evaluate profile likelihood.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>

<p>the number of consecutive gpd models to be fitted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nLLH</code></td>
<td>

<p>...
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>[summary] - <br>
a fitted object of class <code>"gpdFit"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>a vector of probability levels, the desired probability for the 
quantile estimate (e.g. 0.99 for the 99th percentile).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>

<p>should plot be by increasing threshold (<code>TRUE</code>) or number 
of extremes (<code>FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>

<p>a numeric value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plottype</code></td>
<td>

<p>a character string.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start, end</code></td>
<td>

<p>the lowest and maximum number of exceedances to be considered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>a character string selecting the desired estimation method, either
<code>"mle"</code> for the maximum likelihood method or <code>"pwm"</code> for 
the probability weighted moment method. By default, the first will 
be selected. Note, the function <code>gpd</code> uses <code>"ml"</code>.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>[dgpd] - <br>
a numeric vector of quantiles.
<br>
[gpdFit] - <br>
the data vector. Note, there are two different names
for the first argument <code>x</code> and <code>data</code> depending 
which function name is used, either <code>gpdFit</code> or the 
EVIS synonym <code>gpd</code>.
<br>
[print][plot] - <br>
a fitted object of class <code>"gpdFit"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>control parameters and plot parameters optionally passed to the 
optimization and/or plot function. Parameters for the optimization
function are passed to components of the <code>control</code> argument of
<code>optim</code>.  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Generalized Pareto Distribution:</b>
<br><br>
Compute density, distribution function, quantile function and 
generates random variates for the Generalized Pareto Distribution.
</p>
<p><b>Simulation:</b>
<br><br><code>gpdSim</code> simulates data from a Generalized Pareto 
distribution.
<br></p>
<p><b>Parameter Estimation:</b>
<br><br><code>gpdFit</code> fits the model parameters either by the probability 
weighted moment method or the maxim log likelihood method. 
The function returns an object of class <code>"gpd"</code> 
representing the fit of a generalized Pareto model to excesses over 
a high threshold. The fitting functions use the probability weighted 
moment method, if method <code>method="pwm"</code> was selected, and the 
the general purpose optimization function <code>optim</code> when the 
maximum likelihood estimation, <code>method="mle"</code> or <code>method="ml"</code> 
is chosen.
<br></p>
<p><b>Methods:</b>
<br><br><code>print.gpd</code>, <code>plot.gpd</code> and <code>summary.gpd</code> are print, 
plot, and summary methods for a fitted object of class <code>gpdFit</code>. 
The plot method provides four different plots for assessing fitted 
GPD model. 
<br></p>
<p><b>gpd* Functions:</b>
<br><br><code>gpdqPlot</code> calculates quantile estimates and confidence intervals 
for high quantiles above the threshold in a GPD analysis, and adds a 
graphical representation to an existing plot. The GPD approximation in 
the tail is used to estimate quantile. The <code>"wald"</code> method uses 
the observed Fisher information matrix to calculate confidence interval. 
The <code>"likelihood"</code> method reparametrizes the likelihood in terms 
of the unknown quantile and uses profile likelihood arguments to 
construct a confidence interval. 
<br></p>
<p><code>gpdquantPlot</code> creates a plot showing how the estimate of a 
high quantile in the tail of a dataset based on the GPD approximation 
varies with threshold or number of extremes. For every model 
<code>gpdFit</code> is called. Evaluation may be slow. Confidence intervals 
by the Wald method may be fastest.
<br></p>
<p><code>gpdriskmeasures</code> makes a rapid calculation of point estimates 
of prescribed quantiles and expected shortfalls using the output of the
function <code>gpdFit</code>. This function simply calculates point estimates 
and (at present) makes no attempt to calculate confidence intervals for 
the risk measures. If confidence levels are required use <code>gpdqPlot</code> 
and <code>gpdsfallPlot</code> which interact with graphs of the tail of a loss
distribution and are much slower.  
<br></p>
<p><code>gpdsfallPlot</code> calculates expected shortfall estimates, in other
words tail conditional expectation and confidence intervals for high  
quantiles above the threshold in a GPD analysis. A graphicalx
representation to an existing plot is added. Expected shortfall is 
the expected size of the loss, given that a particular quantile of the 
loss distribution is exceeded. The GPD approximation in the tail is used 
to estimate expected shortfall. The likelihood is reparametrized  in 
terms of the unknown expected shortfall and profile likelihood arguments 
are used to construct a confidence interval. 
<br></p>
<p><code>gpdshapePlot</code> creates a plot showing how the estimate of shape 
varies with threshold or number of extremes. For every model 
<code>gpdFit</code> is called. Evaluation may be slow.  
<br></p>
<p><code>gpdtailPlot</code> produces a plot of the tail of the underlying 
distribution of the data.
</p>


<h3>Value</h3>

<p><code>gpdSim</code>
<br>
returns a vector of datapoints from the simulated 
series.
</p>
<p><code>gpdFit</code> 
<br>
returns an object of class <code>"gpd"</code> describing the 
fit including parameter estimates and standard errors. 
</p>
<p><code>gpdQuantPlot</code>
<br>
returns invisible a table of results.
</p>
<p><code>gpdShapePlot</code>
<br>
returns invisible a table of results.
</p>
<p><code>gpdTailPlot</code>
<br>
returns invisible a list object containing 
details of the plot is returned invisibly. This object should be 
used as the first argument of <code>gpdqPlot</code> or <code>gpdsfallPlot</code> 
to add quantile estimates or expected shortfall estimates to the 
plot. 
</p>


<h3>Author(s)</h3>

<p>Alec Stephenson for the functions from R's <code>evd</code> package, <br> 
Alec Stephenson for the functions from R's <code>evir</code> package, <br> 
Alexander McNeil for the EVIS functions underlying the <code>evir</code>
package, <br> 
Diethelm Wuertz for this <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>-port.
</p>


<h3>References</h3>

<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997);
<em>Modelling Extremal Events</em>, Springer. 
</p>
<p>Hosking J.R.M., Wallis J.R., (1987);
<em>Parameter and quantile estimation for the generalized
Pareto distribution</em>,   
Technometrics 29, 339–349.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Load Data:
   library(timeSeries)
   danish = as.timeSeries(data(danishClaims))

## Tail Plot:
   x = as.timeSeries(data(danishClaims))
   fit = gpdFit(x, u = 10)
   tailPlot(fit)

## Try Tail Slider:
   # tailSlider(x)   

## Tail Risk:
   tailRisk(fit)
</code></pre>


</div>