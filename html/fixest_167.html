<div class="container">

<table style="width: 100%;"><tr>
<td>vcov_hac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>HAC VCOVs</h2>

<h3>Description</h3>

<p>Set of functions to compute the VCOVs robust to different forms correlation in panel or
time series settings.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcov_DK(x, time = NULL, lag = NULL, ssc = NULL, vcov_fix = TRUE)

vcov_NW(x, unit = NULL, time = NULL, lag = NULL, ssc = NULL, vcov_fix = TRUE)

NW(lag = NULL)

newey_west(lag = NULL)

DK(lag = NULL)

driscoll_kraay(lag = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>fixest</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A character scalar or a one sided formula giving the name of the
variable representing the time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>An integer scalar, default is <code>NULL</code>. If <code>NULL</code>, then the default lag is equal to
<code>n_t^0.25</code> with <code>n_t</code> the number of time periods (as of Newey and West 1987) for panel
Newey-West and Driscoll-Kraay. The default for the time series Newey-West is computed via
<code>bwNeweyWest</code> which implements the Newey and West 1994 method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssc</code></td>
<td>
<p>An object returned by the function <code>ssc</code>. It specifies how to perform the small
sample correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov_fix</code></td>
<td>
<p>Logical scalar, default is <code>TRUE</code>. If the VCOV ends up not being
positive definite, whether to "fix" it using an eigenvalue decomposition
(a la Cameron, Gelbach &amp; Miller 2011).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>A character scalar or a one sided formula giving the name of the
variable representing the units of the panel.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are currently three VCOV types: Newey-West applied to time series, Newey-West applied to
a panel setting (when the argument 'unit' is not missing), and Driscoll-Kraay.
</p>
<p>The functions on this page without the prefix "vcov_" do not compute VCOVs directly but
are meant to be used in the argument <code>vcov</code> of <code>fixest</code> functions (e.g. in <code>vcov.fixest</code>
or even in the estimation calls).
</p>
<p>Note that for Driscoll-Kraay VCOVs, to ensure its properties the number of periods should
be long enough (a minimum of 20 periods or so).
</p>


<h3>Value</h3>

<p>If the first argument is a <code>fixest</code> object, then a VCOV is returned (i.e. a symmetric matrix).
</p>
<p>If the first argument is not a <code>fixest</code> object, then a) implicitly the arguments are shifted to
the left (i.e. <code>vcov_DK(~year)</code> is equivalent to <code>vcov_DK(time = ~year)</code>) and b) a
VCOV-<em>request</em> is returned and NOT a VCOV. That VCOV-request can then be used in the argument
<code>vcov</code> of various <code>fixest</code> functions (e.g. <code>vcov.fixest</code> or even in the estimation calls).
</p>


<h3>Lag selection</h3>

<p>The default lag selection depends on whether the VCOV applies to a panel or a time series.
</p>
<p>For panels, i.e. panel Newey-West or Driscoll-Kraay VCOV, the default lag is <code>n_t^0.25</code> with
<code>n_t</code> the number of time periods. This is based on Newey and West 1987.
</p>
<p>For time series Newey-West, the default lag is found thanks to the
<code>bwNeweyWest</code> function from the <code>sandwich</code> package. It is based on
Newey and West 1994.
</p>


<h3>References</h3>

<p>Newey WK, West KD (1987). "A Simple, Positive Semi-Definite, Heteroskedasticity and
Autocorrelation Consistent Covariance Matrix." <em>Econometrica</em>, 55(3), 703-708. doi:10.2307/1913610.
</p>
<p>Driscoll JC, Kraay AC (1998). "Consistent Covariance Matrix Estimation with Spatially Dependent
Panel Data." <em>The Review of Economics and Statistics</em>, 80(4), 549-560. doi:10.1162/003465398557825.
</p>
<p>Millo G (2017). "Robust Standard Error Estimators for Panel Models: A Unifying Approach"
<em>Journal of Statistical Software</em>, 82(3). doi:10.18637/jss.v082.i03.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(base_did)

#
# During the estimation
#

# Panel Newey-West, lag = 2
feols(y ~ x1, base_did, NW(2) ~ id + period)

# Driscoll-Kraay
feols(y ~ x1, base_did, DK ~ period)

# If the estimation is made with a panel.id, the dimensions are
# automatically deduced:
est = feols(y ~ x1, base_did, "NW", panel.id = ~id + period)
est

#
# Post estimation
#

# If missing, the unit and time are automatically deduced from
# the panel.id used in the estimation
vcov_NW(est, lag = 2)


</code></pre>


</div>