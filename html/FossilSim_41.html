<div class="container">

<table style="width: 100%;"><tr>
<td>sim.fossils.poisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate fossils under a Poisson sampling model</h2>

<h3>Description</h3>

<p>Fossils can be simulated for a phylo (<code>tree</code>) or taxonomy (<code>taxonomy</code>) object.
If both are specified, the function uses taxonomy.
If no taxonomic information is provided, the function assumes all speciation is symmetric (i.e. bifurcating, <code>beta = 1</code>).
A vector of rates can be specified to allow for rate variation across lineages.
If a vector is provided, each entry will apply to each unique species in the order in which they appear in the taxonomy object (if taxonomy is provided),
or to each unique edge in the order in which they appear in the tree object.
If the tree object has a root edge (<code>root.edge</code>), the first entry in the rates vector should correspond to this edge.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.fossils.poisson(
  rate,
  tree = NULL,
  taxonomy = NULL,
  fossils = NULL,
  ignore.taxonomy = FALSE,
  root.edge = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>A single Poisson sampling rate or a vector of rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>Phylo object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxonomy</code></td>
<td>
<p>Taxonomy object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fossils</code></td>
<td>
<p>Append fossils to to an existing fossils object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.taxonomy</code></td>
<td>
<p>Ignore species taxonomy (returns sp = NA). Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.edge</code></td>
<td>
<p>If TRUE include the root edge. Default = TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class fossils.
</p>


<h3>See Also</h3>

<p><code>sim.fossils.intervals</code>, <code>sim.fossils.environment</code>, <code>sim.trait.values</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate tree
t = ape::rtree(6)

# simulate fossils using the tree
rate = 2
f = sim.fossils.poisson(rate, tree = t)
plot(f, t)

# simulate fossils using taxonomy
s = sim.taxonomy(t, 0.5, 1, 0.5)
f = sim.fossils.poisson(rate, taxonomy = s)
plot(f, t)

# simulate fossils with autocorrelated rate variation across lineages
rates = sim.trait.values(init = rate, taxonomy = s, v = 1)
f = sim.fossils.poisson(rates, taxonomy = s)
plot(f, t)

# append fossils to an existing fossils object
rate = 1
f1 = sim.fossils.poisson(rate, tree = t)
plot(f1, t)
rate = 2
f2 = sim.fossils.poisson(rate, tree = t, fossils = f1)
plot(f2, t)
f3 = sim.fossils.poisson(rate, tree = t, fossils = f2, ignore.taxonomy = TRUE)
plot(f3, t, show.unknown = TRUE)

</code></pre>


</div>