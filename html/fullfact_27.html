<div class="container">

<table style="width: 100%;"><tr>
<td>JackLmer2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Jackknife components for normal data 2</h2>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class="language-R">JackLmer2(observ, dam, sire, response, position = NULL, block = NULL, ml = F, size = 1,
first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Extracts the dam, sire, dam, dam by sire, and residual variance components.
Extracts optional position and block variance components.
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for the options of position and/or block. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code>JackLmer</code>, <code>JackLmer3</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(chinook_length) #Chinook salmon offspring length

#Delete-one
#length_jack2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
#position="tray")
length_jack2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
position="tray",first=2) #first 2

#Delete-d, d=5
#length_jack2.2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
#position="tray",size=5)
length_jack2.2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
position="tray",size=5,first=2) #first 2
</code></pre>


</div>