<div class="container">

<table style="width: 100%;"><tr>
<td>fts.cov.structure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate autocovariance and cross-covariances operators</h2>

<h3>Description</h3>

<p>This function is used to estimate a collection of cross-covariances operators of two stationary functional series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fts.cov.structure(X, Y = X, lags = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an object of class <code>fd</code> containing <code class="reqn">T</code> functional observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>an object of class <code>fd</code> containing <code class="reqn">T</code> functional observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>an integer-valued vector <code class="reqn">(\ell_1,\ldots, \ell_K)</code> containing the lags for which covariances are calculated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">X_1(u),\ldots, X_T(u)</code> and <code class="reqn">Y_1(u),\ldots, Y_T(u)</code> be two samples of functional data. This function determines empirical lagged covariances between the series <code class="reqn">(X_t(u))</code> and <code class="reqn">(Y_t(u))</code>. More precisely it determines
</p>
<p style="text-align: center;"><code class="reqn">
  (\widehat{c}^{XY}_h(u,v)\colon h\in lags ),
</code>
</p>

<p>where <code class="reqn">\widehat{c}^{XY}_h(u,v)</code> is the empirical version of the covariance kernel <code class="reqn">\mathrm{Cov}(X_h(u),Y_0(v))</code>.
For a sample of size <code class="reqn">T</code> we set <code class="reqn">\hat\mu^X(u)=\frac{1}{T}\sum_{t=1}^T X_t(u)</code> and
<code class="reqn">\hat\mu^Y(v)=\frac{1}{T}\sum_{t=1}^T Y_t(v)</code>. Now for <code class="reqn">h \geq 0</code>
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{T}\sum_{t=1}^{T-h} (X_{t+h}(u)-\hat\mu^X(u))(Y_t(v)-\hat\mu^Y(v))</code>
</p>

<p>and for <code class="reqn">h &lt; 0</code>
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{T}\sum_{t=|h|+1}^{T} (X_{t+h}(u)-\hat\mu^X(u))(Y_t(v)-\hat\mu^Y(v)).</code>
</p>

<p>Since <code class="reqn">X_t(u)=\boldsymbol{b}_1^\prime(u)\mathbf{x}_t</code> and <code class="reqn">Y_t(u)=\mathbf{y}_t^\prime \boldsymbol{b}_2(u)</code> we can write
</p>
<p style="text-align: center;"><code class="reqn">
  \widehat{c}^{XY}_h(u,v)=\boldsymbol{b}_1^\prime(u)\widehat{C}^{\mathbf{xy}}\boldsymbol{b}_2(v),
</code>
</p>

<p>where <code class="reqn">\widehat{C}^{\mathbf{xy}}</code> is defined as for the function “cov.structure” for series of coefficient vectors
<code class="reqn">(\mathbf{x}_t\colon 1\leq t\leq T)</code> and <code class="reqn">(\mathbf{y}_t\colon 1\leq t\leq T)</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>fts.timedom</code>. The list contains the following components:
</p>

<ul>
<li> <p><code>operators</code> <code class="reqn">\quad</code> an array. Element <code>[,,k]</code> contains the covariance matrix of the coefficient vectors of the two time series related to lag <code class="reqn">\ell_k</code>.
</p>
</li>
<li> <p><code>lags</code> <code class="reqn">\quad</code> the lags vector from the arguments.
</p>
</li>
<li> <p><code>basisX</code> <code class="reqn">\quad</code> <code>X$basis</code>, an object of class <code>basis.fd</code> (see <code>create.basis</code>)
</p>
</li>
<li> <p><code>basisY</code> <code class="reqn">\quad</code> <code>Y$basis</code>, an object of class <code>basis.fd</code> (see <code>create.basis</code>)
</p>
</li>
</ul>
<h3>See Also</h3>

<p>The multivariate equivalent in the <code>freqdom</code> package: <code>cov.structure</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate an autoregressive process
fts = fts.rar(d=3)

# Get covariance at lag 0
fts.cov.structure(fts, lags = 0)

# Get covariance at lag 10
fts.cov.structure(fts, lags = 10)

# Get entire covariance structure between -20 and 20
fts.cov.structure(fts, lags = -20:20)

# Compute covariance with another process
fts0 = fts + fts.rma(d=3)
fts.cov.structure(fts, fts0, lags = -2:2)
</code></pre>


</div>