<div class="container">

<table style="width: 100%;"><tr>
<td>magging</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximin Aggregation</h2>

<h3>Description</h3>

<p>R wrapper for a C++ implementation of the generic maximin 
aggregation procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">magging(B)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>array of size <code class="reqn">p \times G </code> containing the group parameter
estimates where <code class="reqn">p</code> is the number of model  parameters and <code class="reqn">G</code> is the
number of groups.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Following <cite>Buhlmann 2016</cite>  this function computes the maximin 
aggregation estimator for given group estimates. This entails solving a 
convex quadratic optimization problem. The function wraps a C++ implementation
of an algorithm by Goldfarb and Idnani for solving a (convex) quadratic 
programming problem by means of a dual method.
</p>
<p>The underlying C++ program solving the convex quadratic optimization problem, 
eiquadprog.hpp, copyright (2011) Benjamin Stephens, GPL v2 see 
https://www.cs.cmu.edu/~bstephe1/eiquadprog.hpp, is based on previous 
libraries:
</p>
<p>QuadProg++, Copyright (C) 2007-2016 Luca Di Gaspero, MIT License. See 
https://github.com/liuq/QuadProgpp
</p>
<p>uQuadProg, Copyright (C) 2006 - 2017 Angelo Furfaro, LGPL v3, 
a port  of QuadProg++  working with ublas data structures. See
https://github.com/fx74/uQuadProg/blob/master/README.md
</p>
<p>QuadProg Copyright (C) 2014-2015 Gael Guennebaud, LGPL v3, a modification of 
uQuadProg, working with Eigen data structures. See
http://www.labri.fr/perso/guenneba/code/QuadProg/.
</p>


<h3>Value</h3>

<p>An object with S3 Class "FRESHD".
</p>
<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>A <code class="reqn">p</code> vector containing the maximin aggregated parameter estimates.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Adam Lund, Benjamin Stephens, Gael Guennebaud, Angelo Furfaro, Luca Di Gaspero
</p>
<p>Maintainer: Adam Lund, <a href="mailto:adam.lund@math.ku.dk">adam.lund@math.ku.dk</a>
</p>


<h3>References</h3>

<p>Buhlmann, Peter and Meinshausen, Nicolai (2016). Magging: maximin aggregation for
inhomogeneous large-scale data. Proceedings of the IEEE, 1, 104, 126-135
</p>
<p>D. Goldfarb, A. Idnani. A numerically stable dual method for solving strictly
convex quadratic programs (1983). Mathematical Programming, 27,  1-33.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##size of example
set.seed(42)
G &lt;- 15; n &lt;- c(50, 20, 13); p &lt;- c(7, 5, 4)
nlambda &lt;- 10

##marginal design matrices (Kronecker components)
x &lt;- list()
for(i in 1:length(n)){
x[[i]] &lt;- matrix(rnorm(n[i] * p[i], 0, 1), n[i], p[i])
}

##common features and effects
common_features &lt;- rbinom(prod(p), 1, 0.1)
common_effects &lt;- rnorm(prod(p), 0, 1) * common_features
system.time({
##group response and fit
lambda &lt;- exp(seq(-1, -4, length.out = nlambda))
magbeta &lt;- matrix(0, prod(p), nlambda)
B &lt;- array(NA, c(prod(p), G, nlambda))
y &lt;- array(NA, c(n, G))
for(g in 1:G){
bg &lt;- rnorm(prod(p), 0, 0.1) * (1 - common_features) + common_effects
Bg &lt;- array(bg, p)
mu &lt;- RH(x[[3]], RH(x[[2]], RH(x[[1]], Bg)))
y[,,, g] &lt;- array(rnorm(prod(n)), dim = n) + mu
B[, g, ] &lt;- glamlasso::glamlasso(x, y[,,, g], lambda = lambda)$coef
}
})

##maximin aggregation for all lambdas (models)
for(l in 1:dim(B)[3]){
magbeta[, l] &lt;- magging(B[, , l])
}

##estimated common effects for specific lambda
modelno &lt;- 10
betafit &lt;- magbeta[, modelno]
plot(common_effects, type = "h", ylim = range(betafit, common_effects), col = "red")
lines(betafit, type = "h")

</code></pre>


</div>