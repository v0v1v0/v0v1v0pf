<div class="container">

<table style="width: 100%;"><tr>
<td>modjust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adjust Reco models
</h2>

<h3>Description</h3>

<p>The function allows to adjust fitted <code class="reqn">R_{eco}</code> models by eliminating the maximum <code class="reqn">R_{eco}</code> flux as long as the p.value of the linear model of the residuals regressed against original fluxes is above a given threshold. In addition models with parameters that went astray may be skipped. The default is that <code class="reqn">R_{eco}</code> models with t1 &gt; 20 are omitted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">modjust(models, alpha = 0.1, minimum = 0.8, prmtrs = list(t1 = 20), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>

<p>Object of class "<code>breco</code>".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Alpha level against which the p.value of the linear model of the residuals against original fluxes shall be tested.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>

<p>The minimum proportion of data points that should be kept. The optimisation runs in a <code>while</code> loop until the p.value is below <code>alpha</code>. It may happen - especially when the number of data points was already low from beginning - that many data points are skipped before a solution is reached. This is prevented by this argument which acts as a brute force to the process and stops it. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prmtrs</code></td>
<td>

<p>List object that allows to skip models according to thresholds set for coefficients of the fitted regression models. The list has to be set up according to the actual method used in <code>reco</code> an the names refer to the names of the corresponding coefficients. The default is that <code class="reqn">R_{eco}</code> models with t1 &gt; 20 are omitted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed through to <code>reco</code> which is used to fit the models again based on the adjusted data.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When fitting <code class="reqn">R_{eco}</code> models based on one or few measurement campaigns in the field it may happen that outliers in the extremes of the temperature gradient have a very high influence on the fit. Although the model could be fit in the first place this often leads to unrealistic predicted fluxes. The adjustment via <code>modjust</code> leads to better overall performance and reliability of the bulk modelling.
</p>


<h3>Value</h3>

<p>Returns a "<code>breco</code>" object with the possibly adjusted models. All returned models gain a list entry within the <code>mod</code> object (see <code>reco</code> and <code>reco.bulk</code>) named <code>n.out.adj</code> giving the number of omitted data points. Fall.back models (see <code>reco.bulk</code>) in <code>models</code> are left untouched.
</p>


<h3>Author(s)</h3>

<p>Gerald Jurasinski, <a href="mailto:gerald.jurasinski@uni-rostock.de">gerald.jurasinski@uni-rostock.de</a>,
</p>
<p>based on ideas by Sascha Beetz, <a href="mailto:sascha.beetz@uni-rostock.de">sascha.beetz@uni-rostock.de</a>
</p>


<h3>See Also</h3>

<p><code>reco</code>, <code>reco.bulk</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See axamples at reco.bulk
</code></pre>


</div>