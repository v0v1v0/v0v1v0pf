<div class="container">

<table style="width: 100%;"><tr>
<td>missing_predictorMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create predictorMatrix for use with mice</h2>

<h3>Description</h3>

<p>Create predictorMatrix for use with mice
</p>


<h3>Usage</h3>

<pre><code class="language-R">missing_predictorMatrix(
  .data,
  drop_from_imputed = NULL,
  drop_from_imputer = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>Data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_from_imputed</code></td>
<td>
<p>Quoted names of variables not to impute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_from_imputer</code></td>
<td>
<p>Quoted names of variables not to use in imputation
algorithm.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix formatted for predictorMatrix argument in mice.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mice)
library(dplyr)

# Create some extra missing data
## Smoking missing completely at random
set.seed(1)
colon_s$smoking_mcar =
  sample(c("Smoker", "Non-smoker", NA),
  dim(colon_s)[1], replace=TRUE,
  prob = c(0.2, 0.7, 0.1)) %&gt;%
  factor() %&gt;%
  ff_label("Smoking (MCAR)")

## Make smoking missing conditional on patient sex
colon_s$smoking_mar[colon_s$sex.factor == "Female"] =
  sample(c("Smoker", "Non-smoker", NA),
	 sum(colon_s$sex.factor == "Female"),
	 replace = TRUE, prob = c(0.1, 0.5, 0.4))

colon_s$smoking_mar[colon_s$sex.factor == "Male"] =
  sample(c("Smoker", "Non-smoker", NA),
	 sum(colon_s$sex.factor == "Male"),
	 replace=TRUE, prob = c(0.15, 0.75, 0.1))
colon_s$smoking_mar = factor(colon_s$smoking_mar)%&gt;%
  ff_label("Smoking (MAR)")

explanatory = c("age", "sex.factor",
  "nodes", "obstruct.factor", "smoking_mar")
dependent = "mort_5yr"

colon_s %&gt;%
select(dependent, explanatory) %&gt;%
  missing_predictorMatrix(drop_from_imputed =
    c("obstruct.factor", "mort_5yr")) -&gt; predM

colon_s %&gt;%
	select(dependent, explanatory) %&gt;%
	mice(m = 2, predictorMatrix = predM) %&gt;% # e.g. m=10 when for real
	# Run logistic regression on each imputed set
	with(glm(formula(ff_formula(dependent, explanatory)),
					 family="binomial")) %&gt;%
	pool() %&gt;%
	summary(conf.int = TRUE, exponentiate = TRUE) %&gt;%
	# Jiggle into finalfit format
	mutate(explanatory_name = rownames(.)) %&gt;%
	select(explanatory_name, estimate, `2.5 %`, `97.5 %`, p.value) %&gt;%
	condense_fit(estimate_suffix = " (multiple imputation)") %&gt;%
	remove_intercept() -&gt; fit_imputed

</code></pre>


</div>