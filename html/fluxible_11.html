<div class="container">

<table style="width: 100%;"><tr>
<td>flux_fitting</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting a model to concentration data and estimating the slope</h2>

<h3>Description</h3>

<p>fits gas concentration over time data with a model
(exponential, quadratic or linear) and provides the slope later used
to calculate gas fluxes with flux_calc
</p>


<h3>Usage</h3>

<pre><code class="language-R">flux_fitting(
  conc_df,
  start_cut = 0,
  end_cut = 0,
  start_col = "f_start",
  end_col = "f_end",
  datetime_col = "f_datetime",
  conc_col = "f_conc",
  fluxid_col = "f_fluxID",
  t_window = 20,
  cz_window = 15,
  b_window = 10,
  a_window = 10,
  roll_width = 15,
  t_zero = 0,
  fit_type
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc_df</code></td>
<td>
<p>dataframe of gas concentration over time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_cut</code></td>
<td>
<p>time to discard at the start of the measurements
(in seconds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_cut</code></td>
<td>
<p>time to discard at the end of the measurements (in seconds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_col</code></td>
<td>
<p>column with datetime when the measurement started</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_col</code></td>
<td>
<p>column with datetime when the measurement ended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datetime_col</code></td>
<td>
<p>column with datetime of each concentration measurement</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc_col</code></td>
<td>
<p>column with gas concentration data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fluxid_col</code></td>
<td>
<p>column with ID of each flux</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_window</code></td>
<td>
<p>enlarge focus window before and after tmin and tmax
(exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cz_window</code></td>
<td>
<p>window used to calculate Cz, at the beginning of cut window
(exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_window</code></td>
<td>
<p>window to estimate b. It is an interval after tz where
it is assumed that the model fits the data perfectly (exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_window</code></td>
<td>
<p>window at the end of the flux to estimate a (exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roll_width</code></td>
<td>
<p>width of the rolling mean for CO2 when looking for tz,
ideally same as cz_window (exponential fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_zero</code></td>
<td>
<p>time at which the slope should be calculated
(for quadratic fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_type</code></td>
<td>
<p>exponential, quadratic or linear.
Exponential is using the exponential model from Zhao et al (2018)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a dataframe with the slope at t zero,
and parameters of a model of gas concentration over time
</p>


<h3>References</h3>

<p>Zhao, P., Hammerle, A., Zeeman, M., Wohlfahrt, G., 2018.
On the calculation of daytime CO2 fluxes measured by automated closed
transparent chambers. Agricultural and Forest Meteorology 263, 267â€“275.
https://doi.org/10.1016/j.agrformet.2018.08.022
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(co2_conc)
flux_fitting(co2_conc, fit_type = "exp")
flux_fitting(co2_conc, fit_type = "quadratic", t_zero = 10, end_cut = 30)
</code></pre>


</div>