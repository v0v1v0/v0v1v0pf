<div class="container">

<table style="width: 100%;"><tr>
<td>GevMdaEstimation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Extreme Value Modelling</h2>

<h3>Description</h3>

<p>A collection and description functions to estimate 
the parameters of the GEV distribution. To model
the GEV three types of approaches for parameter 
estimation are provided: Maximum likelihood
estimation, probability weighted moment method,
and estimation by the MDA approach. MDA includes
functions for the Pickands, Einmal-Decker-deHaan, 
and Hill estimators together with several plot 
variants.
<br></p>
<p>Maximum Domain of Attraction estimators:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>hillPlot</code> </td>
<td style="text-align: left;"> shape parameter and Hill estimate of the tail index, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>shaparmPlot</code> </td>
<td style="text-align: left;"> variation of shape parameter with tail depth. </td>
</tr>
</table>
<h3>Usage</h3>

<pre><code class="language-R">hillPlot(x, start = 15, ci = 0.95, 
    doplot = TRUE, plottype = c("alpha", "xi"), labels = TRUE, ...)
shaparmPlot(x, p = 0.01*(1:10), xiRange = NULL, alphaRange = NULL,
    doplot = TRUE, plottype = c("both", "upper"))
    
shaparmPickands(x, p = 0.05, xiRange = NULL,  
    doplot = TRUE, plottype = c("both", "upper"), labels = TRUE, ...) 
shaparmHill(x, p = 0.05, xiRange = NULL,  
    doplot = TRUE, plottype = c("both", "upper"), labels = TRUE, ...)
shaparmDEHaan(x, p = 0.05, xiRange = NULL,  
    doplot = TRUE, plottype = c("both", "upper"), labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alphaRange, xiRange</code></td>
<td>

<p>[saparmPlot] - <br>
plotting ranges for <code>alpha</code> and <code>xi</code>. By default the
values are automatically selected.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>[hillPlot] - <br>
probability for asymptotic confidence band; for no
confidence band set <code>ci</code> to zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doplot</code></td>
<td>

<p>a logical. Should the results be plotted?
<br>
[shaparmPlot] - <br>
a vector of logicals of the same lengths as tails
defining for which tail depths plots should be created,
by default plots will be generated for a tail depth of 5
percent. By default <code>c(FALSE, FALSE, FALSE, FALSE, 
        TRUE, FALSE, FALSE, FALSE, FALSE, FALSE)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>[hillPlot] - <br>
whether or not axes should be labelled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plottype</code></td>
<td>

<p>[hillPlot] - <br>
whether <code>alpha</code>, <code>xi</code> (1/alpha) or
<code>quantile</code> (a quantile estimate) should be plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>[qgev] - <br>
a numeric vector of probabilities.
[hillPlot] - <br>
probability required when option <code>quantile</code> is
chosen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>[hillPlot] - <br>
lowest number of order statistics at which to plot
a point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>[dgev][devd] - <br>
a numeric vector of quantiles.
<br>
[gevFit] - <br>
data vector. In the case of <code>method="mle"</code> the interpretation 
depends on the value of block: if no block size is specified then 
data are interpreted as block maxima; if block size is set, then data
are interpreted as raw data and block maxima are calculated. 
<br>
[hillPlot][shaparmPlot] - <br>
the data from which to calculate the shape parameter, a
numeric vector.
<br>
[print][plot] - <br>
a fitted object of class <code>"gevFit"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>[gevFit] - <br>
control parameters optionally passed to the 
optimization function. Parameters for the optimization
function are passed to components of the <code>control</code> argument of
<code>optim</code>. 
<br>
[hillPlot] - <br>
other graphics parameters.
<br>
[plot][summary] - <br>
arguments passed to the plot function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Parameter Estimation:</b>
<br><br><code>gevFit</code> and <code>gumbelFit</code> estimate the parameters either 
by the probability weighted moment method, <code>method="pwm"</code> or 
by maximum log likelihood estimation <code>method="mle"</code>. The 
summary method produces diagnostic plots for fitted GEV or Gumbel 
models.
<br></p>
<p><b>Methods:</b>
<br><br><code>print.gev</code>, <code>plot.gev</code> and <code>summary.gev</code> are
print, plot, and summary methods for a fitted object of class 
<code>gev</code>. Concerning the summary method, the data are 
converted to unit exponentially distributed residuals under null 
hypothesis that GEV fits. Two diagnostics for iid exponential data 
are offered. The plot method provides two different residual plots 
for assessing the fitted GEV model. Two diagnostics for 
iid exponential data are offered. 
<br></p>
<p><b>Return Level Plot:</b>
<br><br><code>gevrlevelPlot</code> calculates and plots the k-block return level 
and 95% confidence interval based on a GEV model for block maxima, 
where <code>k</code> is specified by the user. The k-block return level 
is that level exceeded once every <code>k</code> blocks, on average. The 
GEV likelihood is reparameterized in terms of the unknown return 
level and profile likelihood arguments are used to construct a 
confidence interval. 
<br></p>
<p><b>Hill Plot:</b>
<br><br>
The function <code>hillPlot</code> investigates the shape parameter and 
plots the Hill estimate of the tail index of heavy-tailed data, or 
of an associated quantile estimate. This plot is usually calculated 
from the alpha perspective. For a generalized Pareto analysis of 
heavy-tailed data using the <code>gpdFit</code> function, it helps to 
plot the Hill estimates for <code>xi</code>. 
<br></p>
<p><b>Shape Parameter Plot:</b>
<br><br>
The function <code>shaparmPlot</code> investigates the shape parameter and 
plots for the upper and lower tails the shape parameter as a function 
of the taildepth. Three approaches are considered, the <em>Pickands</em> 
estimator, the <em>Hill</em> estimator, and the
<em>Decker-Einmal-deHaan</em> estimator.
</p>


<h3>Value</h3>

<p><code>gevSim</code>
<br>
returns a vector of data points from the simulated series.
<br></p>
<p><code>gevFit</code>
<br>
returns an object of class <code>gev</code> describing the fit.
<br></p>
<p><code>print.summary</code>
<br>
prints a report of the parameter fit.
<br></p>
<p><code>summary</code>
<br>
performs diagnostic analysis. The method provides two different 
residual plots for assessing the fitted GEV model.  
<br></p>
<p><code>gevrlevelPlot</code>
<br>
returns a vector containing the lower 95% bound of the confidence 
interval, the estimated return level and the upper 95% bound. 
<br></p>
<p><code>hillPlot</code>
<br>
displays a plot.
<br></p>
<p><code>shaparmPlot</code> 
<br>
returns a list with one or two entries, depending on the
selection of the input variable <code>both.tails</code>. The two 
entries <code>upper</code> and <code>lower</code> determine the position of 
the tail. Each of the two variables is again a list with entries 
<code>pickands</code>, <code>hill</code>, and <code>dehaan</code>. If one of the 
three methods will be discarded the printout will display zeroes.
</p>


<h3>Note</h3>

<p><b>GEV Parameter Estimation:</b>
<br><br>
If method <code>"mle"</code> is selected the parameter fitting in <code>gevFit</code> 
is passed to the internal function <code>gev.mle</code> or <code>gumbel.mle</code>
depending on the value of <code>gumbel</code>, <code>FALSE</code> or <code>TRUE</code>.
On the other hand, if method <code>"pwm"</code> is selected the parameter 
fitting in <code>gevFit</code> is passed to the internal function 
<code>gev.pwm</code> or <code>gumbel.pwm</code> again depending on the value of 
<code>gumbel</code>, <code>FALSE</code> or <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Alec Stephenson for R's <code>evd</code> and <code>evir</code> package, and <br>
Diethelm Wuertz for this <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>-port.
</p>


<h3>References</h3>

<p>Coles S. (2001);
<em>Introduction to Statistical Modelling of Extreme Values</em>,
Springer.
</p>
<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997);
<em>Modelling Extremal Events</em>, 
Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
## Load Data:
   library(timeSeries)
   x = as.timeSeries(data(danishClaims))
   colnames(x) &lt;- "Danish"
   head(x)
   
## hillPlot -
   # Hill plot of heavy-tailed Danish fire insurance data 
   par(mfrow = c(1, 1))
   hillPlot(x, plottype = "xi")
   grid()
</code></pre>


</div>