<div class="container">

<table style="width: 100%;"><tr>
<td>totalsobol.knn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating Total Sobol' Indices from Data</h2>

<h3>Description</h3>

<p><code>totalsobol.knn</code> implements the estimation of the total Sobol' indices directly from scattered data.
Parallel computation is available to accelerate the estimation.
For categorical inputs, please convert them to factor before calling this function.
For large datasets, we support the use of subsample to reduce the computational cost.
</p>


<h3>Usage</h3>

<pre><code class="language-R">totalsobol.knn(
  X,
  y,
  noise,
  n.knn = NULL,
  n.mc = nrow(X),
  twin.mc = FALSE,
  rescale = TRUE,
  parl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix or data frame for the factors / predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector for the responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>a logical indicating whether the responses are noisy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.knn</code></td>
<td>
<p>number of nearest-neighbors for the inner loop conditional variance estimation. <code>n.knn=2</code> is recommended for regression, and <code>n.knn=3</code> for binary classification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mc</code></td>
<td>
<p>number of Monte Carlo samples for the outer loop expectation estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twin.mc</code></td>
<td>
<p>a logical indicating whether to use twinning subsamples, otherwise random subsamples are used. It is supported when the reduction ratio is at least 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>a logical logical indicating whether to standardize the factors / predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parl</code></td>
<td>
<p>number of cores on which to parallelize the computation. If <code>NULL</code>, then no parallelization is done.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>totalsobol.knn</code> provides consistent estimation of the total Sobol' indices (Sobol, 1993) from scattered data.
When the output is clean/noiseless (<code>noise=FALSE</code>), <code>totalsobol.knn</code> implements the Nearest-Neighbor estimator proposed in Broto et al. (2020).
See <code>shapleysobol_knn</code> from the <span class="pkg">sensitivity</span> package for another implementation of the nearest-neighbor estimator.
When the output is noisy (<code>noise=TRUE</code>), <code>totalsobol.knn</code> implements the Noise-Adjusted Nearest-Neighbor (NANNE) estimator (Huang and Joseph, 2024).
NANNE estimator can correct the estimation bias of the nearest-neighbor estimator caused by the random noise.
Please see Huang and Joseph (2024) for a more detailed discussion and comparison.
</p>
<p>For integer/numeric output, <code>n.knn=2</code> nearest-neighbors is recommended for the noisy data (Huang and Joseph, 2024),
and <code>n.knn=3</code> nearest-neighbors is suggested for the clean/noiseless data (Broto et al., 2020).
For numeric inputs, it is recommended to standardize them via setting the argument <code>rescale=TRUE</code>.
Categorical inputs are transformed via one-hot encoding for the nearest-neighbor search.
To speed up the nearest-neighbor search, k-d tree from the <span class="pkg">FNN</span> package is used.
Also, parallel computation is also supported via the <span class="pkg">parallel</span> package.
</p>
<p>Last, for large datasets, we support the use of subsamples for further acceleration.
Use argument <code>n.mc</code> to specify the number of subsamples.
Two options are available for finding the subsamples: random and twinning (Vakayil and Joseph, 2022).
Twinning is able to find subsamples that better represent the big data, i.e.,
providing a more accurate estimation, but at a slightly higher computational cost.
For more details, please see the <span class="pkg">twinning</span> package.
</p>


<h3>Value</h3>

<p>A numeric vector of the total Sobol' indices estimation.
</p>


<h3>Author(s)</h3>

<p>Chaofan Huang <a href="mailto:chaofan.huang@gatech.edu">chaofan.huang@gatech.edu</a> and V. Roshan Joseph <a href="mailto:roshan@gatech.edu">roshan@gatech.edu</a>
</p>


<h3>References</h3>

<p>Huang, C., &amp; Joseph, V. R. (2024). Factor Importance Ranking and Selection using Total Indices. arXiv preprint arXiv:2401.00800.
</p>
<p>Sobol', I. M. (2001). Global sensitivity indices for nonlinear mathematical models and their Monte Carlo estimates. Mathematics and computers in simulation, 55(1-3), 271-280.
</p>
<p>Broto, B., Bachoc, F., &amp; Depecker, M. (2020). Variance reduction for estimation of Shapley effects and adaptation to unknown input distribution. SIAM/ASA Journal on Uncertainty Quantification, 8(2), 693-716.
</p>
<p>Vakayil, A., &amp; Joseph, V. R. (2022). Data twinning. Statistical Analysis and Data Mining: The ASA Data Science Journal, 15(5), 598-610.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ishigami &lt;- function(x) {
  x &lt;- -pi + 2*pi*x
  y &lt;- sin(x[1]) + 7*sin(x[2])^2 + 0.1*x[3]^4*sin(x[1])
  return (y)
}

set.seed(123)
n &lt;- 10000
p &lt;- 3
X &lt;- matrix(runif(n*p), ncol=p)
y &lt;- apply(X,1,ishigami) + rnorm(n)
tsi &lt;- totalsobol.knn(X, y, noise=TRUE, n.knn=2, rescale=FALSE)
print(round(tsi,3)) # Analytical Total Sobol' Indices: 0.558, 0.442, 0.244

</code></pre>


</div>