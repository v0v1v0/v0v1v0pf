<div class="container">

<table style="width: 100%;"><tr>
<td>cv.pr.w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo-removed leave-out cross-validation</h2>

<h3>Description</h3>

<p>Pseudo-removed leave-out cross-validation
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.pr.w(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  trainfun,
  predictfun,
  pseudo,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA,
  cpus = 4,
  test_mode = TRUE,
  test_it = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainfun</code></td>
<td>
<p>Training function you want to use, either
<code>WAPLS.w</code> or <code>TWAPLS.w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictfun</code></td>
<td>
<p>Predict function you want to use: if <code>trainfun</code> is
<code>WAPLS.w</code>, then this should be <code>WAPLS.predict.w</code>;
if <code>trainfun</code> is <code>TWAPLS.w</code>, then this should be
<code>TWAPLS.predict.w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pseudo</code></td>
<td>
<p>The geographically and climatically close sites to each test
site, obtained from <code>get_pseudo</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code>fx</code> function will be used when choosing "bin";
<code>fx_pspline</code> function will be used when choosing "pspline".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpus</code></td>
<td>
<p>Number of CPUs for simultaneous iterations to execute, check
<code>parallel::detectCores()</code> for available CPUs on your machine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_mode</code></td>
<td>
<p>Boolean flag to execute the function with a limited number
of iterations, <code>test_it</code>, for testing purposes only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_it</code></td>
<td>
<p>Number of iterations to use in the test mode.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Leave-one-out cross validation results.
</p>


<h3>See Also</h3>

<p><code>fx</code>, <code>TWAPLS.w</code>,
<code>TWAPLS.predict.w</code>, <code>WAPLS.w</code>, and
<code>WAPLS.predict.w</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

point &lt;- modern_pollen[, c("Long", "Lat")]
test_mode &lt;- TRUE # It should be set to FALSE before running
dist &lt;- fxTWAPLS::get_distance(
  point,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)
pseudo_Tmin &lt;- fxTWAPLS::get_pseudo(
  dist,
  modern_pollen$Tmin,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)

cv_pr_tf_Tmin2 &lt;- fxTWAPLS::cv.pr.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  fxTWAPLS::TWAPLS.w2,
  fxTWAPLS::TWAPLS.predict.w,
  pseudo_Tmin,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)

# Run with progress bar
`%&gt;%` &lt;- magrittr::`%&gt;%`
cv_pr_tf_Tmin2 &lt;- fxTWAPLS::cv.pr.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  fxTWAPLS::TWAPLS.w2,
  fxTWAPLS::TWAPLS.predict.w,
  pseudo_Tmin,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2, # Remove the following line
  test_mode = test_mode
) %&gt;%
  fxTWAPLS::pb()

## End(Not run)

</code></pre>


</div>