<div class="container">

<table style="width: 100%;"><tr>
<td>plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the results of forecasting using <code>forecastlpacf</code>
</h2>

<h3>Description</h3>

<p>The <code>forecastlpacf</code> performs forecasting on
a locally stationary (wavelet) time series. This function
provides several options to plot the results in a user-friendly
fashion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'forecastlpacf'
plot(x, extra.y = NULL, f.col = 4, show.pi = "standard", 
    pi.col = 2, xlab = "Time", ylab = "Time Series", zoom = FALSE, zoom.no = 30, 
    sw = 0.2, conf.level = 95, pc.fan = (1:9) * 10, fan.seps = FALSE, 
    fan.rgb.col=c(1,0,0), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The object returned by the <code>forecastlpacf</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra.y</code></td>
<td>
<p>Sometimes other routines wish to add to the plot generated
by this function. The y-axis extent of those extra values might be
larger than the values that this plot alone would generate. So,
you can use this argument to provide a set of y-values that you want
to later plot and this plot takes those into account when setting
the scale of the y-axis. So, if you have extra characters or lines
to plot after this plot, and you want to ensure they'll get plotted
and that the y-axis is going to be large enough, supply the y values
as a vector (or just their maximum and minimum) and this function
will use them to help set the y-axis scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.col</code></td>
<td>
<p>The colour used to drae the forecasted values - both the points
and line joining the forecasts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.pi</code></td>
<td>
<p>If set to "standard" then 100*conf.level percent prediction
intervals are drawn for each forecasted point in the colour specified
by <code>pi.col</code>. If set to "none" then no prediction intervals are
drawn. If set to "fan" then a Bank-of-England-like fan-plot is
produced with confidence levels set by the <code>pc.fan</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.col</code></td>
<td>
<p>Colour of the prediction intervals or fan plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>The x-axis label.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>The y-axis label.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zoom</code></td>
<td>
<p>Sometimes for a long time series with a few forecasts the
forecast values can be hard to see and particularly how they relate
to the values of the series near to the end of the series. If
<code>TRUE</code> then this argument causes the function to only
plot the last <code>zoom.no</code> values of the time series and the
associated forecasts. One can then focus on the end of the time
series nearer to the forecast values and those values.
If <code>FALSE</code> then the whole time series and the forecasts are
plotted and <code>zoom.no</code> is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zoom.no</code></td>
<td>
<p>The number of time series values plotted if <code>zoom=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sw</code></td>
<td>
<p>The width of the prediction intervals if <code>show.pi="standard"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>A single confidence value associated with the prediction
interval expressed as a numerical value from 0-100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.fan</code></td>
<td>
<p>A vector of
confidence values associated with the fan plot prediction
intervals expressed as a percentage. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fan.seps</code></td>
<td>
<p>If <code>TRUE</code> then lines are drawn on the fan part of
the fan plot to more clearly indicated the distinction between
different prediction intervals. If <code>FALSE</code> then no extra
lines are drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fan.rgb.col</code></td>
<td>
<p>A vector of length three containing the red, green
and blue intensities of the fan plot colour</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to plot.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function produces a plot of a time series and its forecasts
generated by the <code>forecastlpacf</code> function.
</p>


<h3>Value</h3>

<p>The function only returns information if <code>show.pi="fan"</code>.
In this case an array is returned that contained the coordinates
of the fan part of the plot. The array is three-dimensional.
Dimension 1 corresponds to the number of steps ahead that we computed
for the forecast in the object <code>x</code>, dimension 2 corresponds to
the number of fan prediction intervals specified by the number of
confidence bands in <code>pc.fan</code>, dimension 3 always has two
dimensions: 1 corresponding to the upper prediction interval and
2 correspond to the lower interval. For example, element[2, 3, 1]
corresponds to the upper prediction interval, for the fan component
associated with the third fan confidence level value in <code>pc.fan</code>
for the <code>h=2</code> step ahead forecast.
</p>


<h3>Author(s)</h3>

<p>Guy Nason
</p>


<h3>References</h3>

<p>Killick, R., Knight, M.I., Nason, G.P., Nunes M.A., Eckley I.A. (2023) Automatic Locally Stationary Time Series Forecasting with
application to predicting U.K. Gross Value Added Time Series under sudden shocks caused by the COVID pandemic 
<a href="https://arxiv.org/abs/2303.07772">arXiv:2303.07772</a>
</p>


<h3>See Also</h3>

<p><code>forecastlpacf</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Simulate an example
#
x.test &lt;- tvar2sim()
#
# Do a two-step ahead forecast
#
x.fl &lt;- forecastlpacf(x.test, h=2, forecast.type="recursive")
#
# Now plot it.
#
# zoom=TRUE: so we only plot the last 30 time series observations, by default
# 	change zoom.no if you want more or less.
# f.col=3: the forecasts and connecting lines are drawn in colour 3 (blue)
# show.pi="fan": do a fan chart for the forecasts
# fan.rgb.col=c(1,0,1):	draw the fan in magenta (default is red)
# ylab="My Time Series": change the y label to something nice
#
plot(x.fl,zoom=TRUE, f.col=3, show.pi="fan", fan.rgb.col=c(1,0,1), ylab="My Time Series")
</code></pre>


</div>