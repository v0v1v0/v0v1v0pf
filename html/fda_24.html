<div class="container">

<table style="width: 100%;"><tr>
<td>bsplinepen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
B-Spline Penalty Matrix
</h2>

<h3>Description</h3>

<p>Computes the matrix defining the roughness penalty for functions
expressed in terms of a B-spline basis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  bsplinepen(basisobj, Lfdobj=2, rng=basisobj$rangeval, returnMatrix=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>basisobj</code></td>
<td>

<p>a B-spline basis object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lfdobj</code></td>
<td>

<p>either a nonnegative integer or a linear differential operator object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rng</code></td>
<td>

<p>a vector of length 2 defining range over which the basis penalty is to
be computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnMatrix</code></td>
<td>

<p>logical:  If TRUE,  a two-dimensional is returned using a
special class from the Matrix package.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A roughness penalty for a function $x(t)$ is defined by
integrating the square of either the derivative of $x(t)$ or,
more generally, the result of applying a linear differential operator
$L$ to it.  The most common roughness penalty is the integral of
the square of the second derivative, and
this is the default. To apply this roughness penalty, the matrix of
inner products of the basis functions (possibly after applying the
linear differential operator to them) defining this function
is necessary. This function just calls the roughness penalty evaluation
function specific to the basis involved.
</p>


<h3>Value</h3>

<p>a symmetric matrix of order equal to the number of basis functions
defined by the B-spline basis object.  Each element is the inner product
of two B-spline basis functions after applying the derivative or linear
differential operator defined by <code>Lfdobj</code>.
</p>


<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New
York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), <em>Functional
Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), <em>Applied
Functional Data Analysis</em>, Springer, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
## bsplinepen with only one basis function
##
bspl1.1 &lt;- create.bspline.basis(nbasis=1, norder=1)
pen1.1 &lt;- bsplinepen(bspl1.1, 0)

##
## bspline pen for a cubic spline with knots at seq(0, 1, .1)
##
basisobj &lt;- create.bspline.basis(c(0,1),13)
#  compute the 13 by 13 matrix of inner products of second derivatives
penmat &lt;- bsplinepen(basisobj)

##
## with rng of class Date or POSIXct
##
# Date
invasion1 &lt;- as.Date('1775-09-04')
invasion2 &lt;- as.Date('1812-07-12')
earlyUS.Canada &lt;- c(invasion1, invasion2)
BspInvade1 &lt;- create.bspline.basis(earlyUS.Canada)
Binvadmat &lt;- bsplinepen(BspInvade1)

# POSIXct
AmRev.ct &lt;- as.POSIXct1970(c('1776-07-04', '1789-04-30'))
BspRev1.ct &lt;- create.bspline.basis(AmRev.ct)
Brevmat &lt;- bsplinepen(BspRev1.ct)

</code></pre>


</div>