<div class="container">

<table style="width: 100%;"><tr>
<td>tcsrec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heuristic cross-temporal reconciliation</h2>

<h3>Description</h3>

<p>tcsrec replicates the procedure by Kourentzes and Athanasopoulos (2019):
(i) for each time series the forecasts at any temporal aggregation order are
reconciled using temporal hierarchies; (ii) time-by-time cross-sectional
reconciliation is performed; and (iii) the projection matrices obtained at
step (ii) are then averaged and used to cross-sectionally reconcile the
forecasts obtained at step (i). In cstrec, the order of application of the
two reconciliation steps (temporal first, then cross-sectional), is inverted
compared to tcsrec (Di Fonzo and Girolimetto, 2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R"># First-temporal-then-cross-sectional forecast reconciliation
tcsrec(base, cslist, telist, res = NULL, avg = "KA")

# First-cross-sectional-then-temporal forecast reconciliation
cstrec(base, cslist, telist, res = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>A (<code class="reqn">n \times h(k^\ast+m)</code>) numeric matrix containing the base forecasts to
be reconciled; <code class="reqn">n</code> is the total number of variables, <code class="reqn">m</code> is the max. order of temporal
aggregation, <code class="reqn">k^\ast</code> is the sum of (a subset of) (<code class="reqn">p-1</code>) factors of <code class="reqn">m</code>,
excluding <code class="reqn">m</code>, and <code class="reqn">h</code> is the forecast horizon for the lowest frequency time series.
The row identifies a time series, and the forecasts in each row are ordered from the
lowest frequency (most temporally aggregated) to the highest frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cslist</code></td>
<td>
<p>A list of elements for the cross-sectional reconciliation.
See csrec for a complete list (excluded <code>base</code> and <code>res</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>telist</code></td>
<td>
<p>A list of elements for the temporal reconciliation.
See terec for a complete list (excluded <code>base</code> and <code>res</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>A (<code class="reqn">n \times N(k^\ast+m)</code>) optional numeric matrix containing the
in-sample residuals at all the temporal frequencies ordered from the lowest frequency
to the highest frequency (columns) for each variable (rows). This matrix is used
to compute some covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avg</code></td>
<td>
<p>If <code>avg = "KA"</code> (<em>default</em>), the final projection
matrix <code class="reqn">\mathbf{M}</code> is the one proposed by Kourentzes and
Athanasopoulos (2019), otherwise it is calculated as simple average of
all the involved projection matrices at step 2 of the procedure (see
Di Fonzo and Girolimetto, 2023).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A (<code class="reqn">n \times h(k^\ast+m)</code>) numeric matrix of cross-temporal reconciled forecasts.
</p>


<h3>Warning</h3>

<p>The two-step heuristic reconciliation allows considering
non negativity constraints only in the first step. This means that non-negativity
is not guaranteed in the final reconciled values.
</p>


<h3>References</h3>

<p>Di Fonzo, T. and Girolimetto, D. (2023), Cross-temporal forecast reconciliation:
Optimal combination method and heuristic alternatives, <em>International Journal
of Forecasting</em>, 39, 1, 39-57. <a href="https://doi.org/10.1016/j.ijforecast.2021.08.004">doi:10.1016/j.ijforecast.2021.08.004</a>
</p>
<p>Kourentzes, N. and Athanasopoulos, G. (2019), Cross-temporal coherent forecasts
for Australian tourism, <em>Annals of Tourism Research</em>, 75, 393-409.
<a href="https://doi.org/10.1016/j.annals.2019.02.001">doi:10.1016/j.annals.2019.02.001</a>
</p>


<h3>See Also</h3>

<p>Cross-temporal framework: 
<code>ctboot()</code>,
<code>ctbu()</code>,
<code>ctcov()</code>,
<code>ctlcc()</code>,
<code>ctmo()</code>,
<code>ctrec()</code>,
<code>cttd()</code>,
<code>cttools()</code>,
<code>iterec()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# (3 x 7) base forecasts matrix (simulated), Z = X + Y and m = 4
base &lt;- rbind(rnorm(7, rep(c(20, 10, 5), c(1, 2, 4))),
              rnorm(7, rep(c(10, 5, 2.5), c(1, 2, 4))),
              rnorm(7, rep(c(10, 5, 2.5), c(1, 2, 4))))
# (3 x 70) in-sample residuals matrix (simulated)
res &lt;- rbind(rnorm(70), rnorm(70), rnorm(70))

A &lt;- t(c(1,1)) # Aggregation matrix for Z = X + Y
m &lt;- 4 # from quarterly to annual temporal aggregation

rtcs &lt;- tcsrec(base = base,
               cslist = list(agg_mat = A, comb = "shr"),
               telist = list(agg_order = m, comb = "wlsv"),
               res = res)

rcst &lt;- tcsrec(base = base,
               cslist = list(agg_mat = A, comb = "shr"),
               telist = list(agg_order = m, comb = "wlsv"),
               res = res)

</code></pre>


</div>