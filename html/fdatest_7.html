<div class="container">

<table style="width: 100%;"><tr>
<td>ITP2pafourier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Two populations Interval Testing Procedure with Fourier basis (phase-amplitude decomposition)
</h2>

<h3>Description</h3>

<p>The function implements the Interval Testing Procedure for testing the difference between two functional populations evaluated on a uniform grid. Data are represented by means of the Fourier basis expansion with the phase-amplitude decomposition and the significance of the amplitude and phase of each frequency is tested with an interval-wise control of the Family Wise Error Rate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ITP2pafourier(data1, data2, 
              maxfrequency=floor(dim(data1)[2]/2), B = 10000, paired = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data1</code></td>
<td>

<p>Pointwise evaluations of the first population's functional data set on a uniform grid. <code>data1</code> is a matrix of dimensions <code>c(n1,J)</code>, with <code>J</code> evaluations on columns and <code>n1</code> units on rows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data2</code></td>
<td>

<p>Pointwise evaluations of the second population's functional data set on a uniform grid. <code>data2</code> is a matrix of dimensions <code>c(n2,J)</code>, with <code>J</code> evaluations on columns and <code>n2</code> units on rows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxfrequency</code></td>
<td>

<p>The maximum frequency to be used in the Fourier basis expansion of data. The default is <code>floor(dim(data1)[2]/2)</code>, leading to an interpolating expansion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>

<p>A logical indicating whether the test is paired. The default is <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>ITP2pafourier</code> returns an object of <code>class</code> "<code>ITP2</code>".
</p>
<p>An object of class "<code>ITP2</code>" is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. Equal to <code>"paFourier"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>String vector indicating the type of test performed. Equal to <code>"2pop"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>Logical indicating whether the test is paired (as entered by the user).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff_phase</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> phases of the Fourier basis expansion. Rows are associated to units and columns to frequencies: the first <code>n1</code> rows report the coefficients of the first population units and the following <code>n2</code> rows report the coefficients of the second population units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff_amplitude</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> amplitudes of the Fourier basis expansion. Rows are associated to units and columns to frequencies: the first <code>n1</code> rows report the coefficients of the first population units and the following <code>n2</code> rows report the coefficients of the second population units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_phase</code></td>
<td>
<p>Uncorrected p-values of the phase tests for each frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_amplitude</code></td>
<td>
<p>Uncorrected p-values of the amplitude tests for each frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.matrix_phase</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests on phase. The element <code>(i,j)</code> of matrix <code>pval.matrix_phase</code> contains the p-value of the joint NPC test of the frequencies <code>(j,j+1,...,j+(p-i))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.matrix_amplitude</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests on amplitude. The element <code>(i,j)</code> of matrix <code>pval.matrix_amplitude</code> contains the p-value of the joint NPC test of the frequencies <code>(j,j+1,...,j+(p-i))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected.pval_phase</code></td>
<td>
<p>Corrected p-values of the phase tests for each frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected.pval_amplitude</code></td>
<td>
<p>Corrected p-values of the amplitude tests for each frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Labels indicating the population membership of each data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heatmap.matrix_phase</code></td>
<td>
<p>Heatmap matrix of p-values for phase (used only for plots).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heatmap.matrix_amplitude</code></td>
<td>
<p>Heatmap matrix of p-values for amplitude (used only for plots).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code>ITP2fourier</code>,  <code>ITP2bspline</code>, <code>ITP1fourier</code>, <code>ITP1bspline</code>, and <code>ITPimage</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Importing the NASA temperatures data set
data(NASAtemp)
# Performing the ITP
ITP.result &lt;- ITP2pafourier(NASAtemp$milan,NASAtemp$paris,maxfrequency=20,B=1000,paired=TRUE)
# Plotting the results of the ITP
plot(ITP.result,main='NASA data',xrange=c(1,365),xlab='Day')

# Plotting the p-value heatmap
ITPimage(ITP.result,abscissa.range=c(1,365))


# Selecting the significant coefficients
which(ITP.result$corrected.pval &lt; 0.05)

</code></pre>


</div>