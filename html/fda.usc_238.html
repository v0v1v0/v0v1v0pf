<div class="container">

<table style="width: 100%;"><tr>
<td>optim.basis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select the number of basis using GCV method.</h2>

<h3>Description</h3>

<p>Functional data estimation via basis representation using cross-validation
(CV) or generalized cross-validation (GCV) method with a roughness penalty.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optim.basis(
  fdataobj,
  type.CV = GCV.S,
  W = NULL,
  lambda = 0,
  numbasis = floor(seq(ncol(fdataobj)/16, ncol(fdataobj)/2, len = 10)),
  type.basis = "bspline",
  par.CV = list(trim = 0, draw = FALSE),
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdataobj</code></td>
<td>
<p><code>fdata</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.CV</code></td>
<td>
<p>Type of cross-validation. By default generalized
cross-validation (GCV) method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Matrix of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A roughness penalty. By default, no penalty <code>lambda=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbasis</code></td>
<td>
<p>Number of basis to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.basis</code></td>
<td>
<p>Character string which determines type of basis. By
default <em>"bspline"</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.CV</code></td>
<td>
<p>List of parameters for type.CV: trim, the alpha of the
trimming and <code>draw=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code> information about GCV values and input
parameters is printed. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods. Arguments to
be passed by default to create.basis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Provides the least GCV for functional data for a list of number of basis
<code>num.basis</code> and lambda values <code>lambda</code>. You can define the type of
CV to use with the <code>type.CV</code>, the default is used <code>GCV.S</code>. 
</p>
<p>Smoothing matrix is performed by <code>S.basis</code>. <code>W</code> is the
matrix of weights of the discretization points.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>gcv</code> Returns GCV values calculated for input parameters.
</p>
</li>
<li> <p><code>fdataobj</code> Matrix of set cases with dimension (<code>n</code> x <code>m</code>),
where <code>n</code> is the number of curves and <code>m</code> are the points observed
in each curve. 
</p>
</li>
<li> <p><code>fdata.est</code> Estimated <code>fdata</code> class object.
</p>
</li>
<li> <p><code>numbasis.opt</code> <code>numbasis</code> value that minimizes CV or GCV method.
</p>
</li>
<li> <p><code>lambda.opt</code> <code>lambda</code> value that minimizes CV or GCV method.
</p>
</li>
<li> <p><code>basis.opt</code> <code>basis</code> for the minimum CV or GCV method.
</p>
</li>
<li> <p><code>S.opt</code> Smoothing matrix for the minimum CV or GCV method.
</p>
</li>
<li> <p><code>gcv.opt</code> Minimum of CV or GCV method. 
</p>
</li>
<li> <p><code>lambda</code> A roughness penalty. By default, no penalty <code>lambda=0</code>.
</p>
</li>
<li> <p><code>numbasis</code> Number of basis to use. 
</p>
</li>
<li> <p><code>verbose</code> If <code>TRUE</code> information about GCV values
and input parameters is printed. Default is <code>FALSE</code>.
</p>
</li>
</ul>
<h3>Note</h3>

<p>min.basis deprecated.
</p>


<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Ramsay, James O., and Silverman, Bernard W. (2006), <em>
Functional Data Analysis</em>, 2nd ed., Springer, New York.
</p>
<p>Wasserman, L. <em>All of Nonparametric Statistics</em>. Springer Texts in
Statistics, 2006.
</p>
<p>Hardle, W. <em>Applied Nonparametric Regression</em>. Cambridge University
Press, 1994.
</p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/">https://www.jstatsoft.org/v51/i04/</a>
</p>


<h3>See Also</h3>

<p>See Also as <code>S.basis</code>. <br> Alternative method:
<code>optim.np</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
a1&lt;-seq(0,1,by=.01)
a2=rnorm(length(a1),sd=0.2)
f1&lt;-(sin(2*pi*a1))+rnorm(length(a1),sd=0.2)
nc&lt;-50
np&lt;-length(f1)
tt=1:101
S&lt;-S.NW(tt,2)
mdata&lt;-matrix(NA,ncol=np,nrow=50)
for (i in 1:50) mdata[i,]&lt;- (sin(2*pi*a1))+rnorm(length(a1),sd=0.2)
mdata&lt;-fdata(mdata)
nb&lt;-floor(seq(5,29,len=5))
l&lt;-2^(-5:15)
out&lt;-optim.basis(mdata,lambda=l,numbasis=nb,type.basis="fourier")
matplot(t(out$gcv),type="l",main="GCV with fourier basis")

# out1&lt;-optim.basis(mdata,type.CV = CV.S,lambda=l,numbasis=nb)
# out2&lt;-optim.basis(mdata,lambda=l,numbasis=nb)

# variance calculations
y&lt;-mdata
i&lt;-3
z=qnorm(0.025/np)
fdata.est&lt;-out$fdata.est
var.e&lt;-Var.e(mdata,out$S.opt)
var.y&lt;-Var.y(mdata,out$S.opt)
var.y2&lt;-Var.y(mdata,out$S.opt,var.e)

# estimated fdata and point confidence interval
upper.var.e&lt;-out$fdata.est[["data"]][i,]-z*sqrt(diag(var.e))
lower.var.e&lt;-out$fdata.est[["data"]][i,]+z*sqrt(diag(var.e))
dev.new()
plot(y[i,],lwd=1,ylim=c(min(lower.var.e),max(upper.var.e)))
lines(out$fdata.est[["data"]][i,],col=gray(.1),lwd=1)
lines(out$fdata.est[["data"]][i,]+z*sqrt(diag(var.y)),col=gray(0.7),lwd=2)
lines(out$fdata.est[["data"]][i,]-z*sqrt(diag(var.y)),col=gray(0.7),lwd=2)
lines(upper.var.e,col=gray(.3),lwd=2,lty=2)
lines(lower.var.e,col=gray(.3),lwd=2,lty=2)
legend("top",legend=c("Var.y","Var.error"), col = c(gray(0.7),
gray(0.3)),lty=c(1,2))

## End(Not run)

</code></pre>


</div>