<div class="container">

<table style="width: 100%;"><tr>
<td>runFLPS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct fully latent principal stratification</h2>

<h3>Description</h3>

<p>Conduct fully latent principal stratification
</p>


<h3>Usage</h3>

<pre><code class="language-R">runFLPS(
  inp_data = NULL,
  compiled_stan = NULL,
  outcome = NULL,
  trt = NULL,
  covariate = NULL,
  lv_model = NULL,
  lv_type = NULL,
  priors_input = NULL,
  stan_options = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inp_data</code></td>
<td>
<p>A matrix or data frame containing the input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compiled_stan</code></td>
<td>
<p>An object of S4 class stanmodel produced by the
<code>modelBuilder</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>A character string specifying the outcome variable's name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt</code></td>
<td>
<p>A character string specifying the treatment or control group variable's name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>A character string specifying the covariate variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lv_model</code></td>
<td>
<p>A description of the latent variable model using syntax
akin to the <span class="pkg">lavaan</span> package. Key operators include:
</p>

<ul>
<li> <p><code>=~</code> : Denotes associations between factors and indicators (e.g., F1 =~ v1 + v2 + v3). All indicators associated with the corresponding factor should be
written in the same line with <code>+</code>.
</p>
</li>
<li> <p><code>+</code> : Specifies a series of indicators.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lv_type</code></td>
<td>
<p>A character string indicating the type of latent variable models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors_input</code></td>
<td>
<p>A list specifying the priors or defaults to N(0, 5) if not provided.
Relevant parameters: <code>tau0</code> (group difference), <code>tau1</code> (principal effects),
and <code>omega</code> (effect of latent factors on outcome).
Ensure that the lengths of <code>tau1</code> and <code>omega</code> match the number of factors.
Examples:
</p>

<ul>
<li> <p><code>list(tau0 = c(0, 1), tau1 = c(0.5, 1))</code> : Mean and variance for normal priors.
</p>
</li>
<li> <p><code>list(tau1 = list(c(0.5, 1), c(-0.4, 1)))</code> : For two factors.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stan_options</code></td>
<td>
<p>A list of options for [rstan::stan()], specified as 'name = value'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for the latent variable models
</p>

<ul>
<li>  <p><code>nclass</code> A number specifying the number of latent classes.
</p>
</li>
<li>  <p><code>multilevel</code> A logical indicating if a multilevel structure is present.
</p>
</li>
<li>  <p><code>lv_randomeffect</code> A logical indicating whether to estimate random effects for latent variables.
</p>
</li>
<li> <p><code>group_id</code> A string for grouping variable for multilevel structure.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>flps</code> encompassing a <code>stanfit</code> object.
Components include:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Function call with arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inp_data</code></td>
<td>
<p>The input data frame provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flps_model</code></td>
<td>
<p>The Stan syntax used in [rstan::stan()].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flps_data</code></td>
<td>
<p>Data list used for [rstan::stan()].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flps_fit</code></td>
<td>
<p>Resulting <code>stanfit</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A numeric; Time taken for computation</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>[rstan::stan()]
</p>


<h3>Examples</h3>

<pre><code class="language-R">
inp_data &lt;- flps::makeInpData(
  N       = 200,
  R2Y     = 0.2,
  R2eta   = 0.5,
  omega   = 0.2,
  tau0    = 0.23,
  tau1    = -0.16,
  betaL   = 0.1,
  betaY   = 0.2,
  lambda  = 0.8,
  nitem    = 10,
  nfac    = 1,
  lvmodel = 'rasch' )

res &lt;- runFLPS(
   inp_data = inp_data,
   outcome = "Y",
   trt = "Z",
   covariate = c("X1"),
   lv_type = "rasch",
   lv_model = "F =~ v1 + v2 + v3 + v4 + v5 + v6 + v7 + v8 + v9 + v10",
   stan_options = list(iter = 1000, warmup = 500, cores = 1, chains = 2)
   )


</code></pre>


</div>