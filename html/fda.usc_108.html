<div class="container">

<table style="width: 100%;"><tr>
<td>fregre.basis.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation Functional Regression with scalar response using basis
representation.</h2>

<h3>Description</h3>

<p>Computes functional regression between functional explanatory variables and
scalar response using basis representation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fregre.basis.cv(
  fdataobj,
  y,
  basis.x = NULL,
  basis.b = NULL,
  type.basis = NULL,
  lambda = 0,
  Lfdobj = vec2Lfd(c(0, 0), rtt),
  type.CV = GCV.S,
  par.CV = list(trim = 0),
  weights = rep(1, n),
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdataobj</code></td>
<td>
<p><code>fdata</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Scalar response with length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.x</code></td>
<td>
<p>Basis for functional explanatory data <code>fdataobj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.b</code></td>
<td>
<p>Basis for functional beta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.basis</code></td>
<td>
<p>A vector of character string which determines type of
basis. By default <em>"bspline"</em>. It is only used when <code>basis.x</code> or
<code>basis.b</code> are a vector of number of basis considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A roughness penalty. By default, no penalty <code>lambda=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lfdobj</code></td>
<td>
<p>See eval.penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.CV</code></td>
<td>
<p>Type of cross-validation. By default generalized
cross-validation <code>GCV.S</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.CV</code></td>
<td>
<p>List of parameters for <code>type.CV</code>: <code>trim</code>, the alpha
of the trimming and <code>draw</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code> information about the procedure is printed.
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fregre.basis.cv()</code>  uses validation criterion defined by argument
<code>type.CV</code> to estimate the number of basis elements and/or the penalized
parameter (<code>lambda</code>) that best predicts the response.
</p>
<p>If <code>basis = NULL</code> creates bspline basis.<br></p>
<p>If the functional covariate <code>fdataobj</code> is in a format <code>raw data</code>,
such as matrix or data.frame, creates an object of class <code>fdata</code> with
default attributes, see <code>fdata</code>.<br></p>
<p>If <code>basis.x</code> is a vector of number of basis elements and
<code>basis.b=NULL</code>, the function force the same number of elements in the
basis of <code>x</code> and <code>beta</code>.<br></p>
<p>If <code>basis.x$type=``fourier''</code> and <code>basis.b$type=``fourier''</code>, the
function decreases the number of fourier basis elements on the
<code class="reqn">min(k_{n1},k_{n2})</code>, where <code class="reqn">k_{n1}</code> and
<code class="reqn">k_{n2}</code> are the number of basis element of <code>basis.x</code> and
<code>basis.b</code> respectively.
</p>


<h3>Value</h3>

<p>Return:<br></p>

<ul>
<li> <p><code>fregre.basis</code> Fitted regression object by the best parameters (basis elements for data and beta and lambda penalty). 
</p>
</li>
<li> <p>basis.x.opt: Basis used for functional explanatory data estimation <code>fdata</code>.
</p>
</li>
<li> <p>basis.b.opt: Basis used for for functional <code>beta</code> parameter
estimation. 
</p>
</li>
<li> <p>lambda.opt: <code>lambda</code> value that minimizes CV or GCV method.
</p>
</li>
<li> <p>gcv.opt: Minimum value of CV or GCV method. 
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Ramsay, James O. and Silverman, Bernard W. (2006),
<em>Functional Data Analysis</em>, 2nd ed., Springer, New York.
</p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/">https://www.jstatsoft.org/v51/i04/</a>
</p>


<h3>See Also</h3>

<p>See Also as: <code>fregre.basis</code>,
<code>summary.fregre.fd</code> and <code>predict.fregre.fd</code> .<br>
Alternative method: <code>fregre.pc.cv</code> and
<code>fregre.np.cv</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
x&lt;-tecator$absorp.fdata[1:129]
y=tecator$y$Fat[1:129]
b1&lt;-c(15,21,31)
b2&lt;-c(7,9)
res1=fregre.basis.cv(x,y,basis.x=b1)
res2=fregre.basis.cv(x,y,basis.x=b1,basis.b=b2)
res1$gcv
res2$gcv
l=2^(-4:10)
res3=fregre.basis.cv(x,y,basis.b=b1,type.basis="fourier",
lambda=l,type.CV=GCV.S,par.CV=list(trim=0.15))
res3$gcv

## End(Not run)

</code></pre>


</div>