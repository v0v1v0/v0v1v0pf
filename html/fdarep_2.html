<div class="container">

<table style="width: 100%;"><tr>
<td>Dense2dFPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-Dimensional Functional Principal Component Analysis for dense repeated functional data.</h2>

<h3>Description</h3>

<p>Note: The code works for dense functional data observed on a regular grid, missing values are allowed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Dense2dFPCA(
  X.age.year,
  n,
  num.years,
  num.ages,
  fpca.op = list(),
  pc.num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X.age.year</code></td>
<td>
<p>An n by (num.years x num.ages) input data matrix, such that the ith row of the matrix gives the observed values for the ith individual. The values in each row are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.years</code></td>
<td>
<p>Dimension 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.ages</code></td>
<td>
<p>Dimension 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpca.op</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for the two-dimesnional FPCA; check fdapace::FPCA for available control options and default settings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.num</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for the two-dimensional FPCA; default: chosen by FVE if NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The code works for dense functional data (with missing values), with density in both the direction of (age) dimension 2 and (year) dimension 1.
</p>


<h3>Value</h3>

<p>A list containing the following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>An num.ages by num.years matrix containing the bivariate mean function estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.num</code></td>
<td>
<p>A scalar denoting the selected number of components for the two-dimensional FPCA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.2D.FPCA</code></td>
<td>
<p>A list containing the FPCA output for the fitted two-dimensional FPCA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>An n by pc.num matrix of the estimated scores, such that the ith row of the matrix comprises estimated scores for the ith individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>An (num.years x num.ages) by pc.num matrix of the estimated product eigen functions. The estimated eigenfunctions in the otput eig are in the form of a vector rather than a matrix. For example, the first column in eig gives the first estimated eigenfunction such that <code class="reqn">gamma(s,t) -&gt; eig[ ( (s-1)*num.ages + t ), 1]</code> where LHS is the bivariate function in the usual form and RHS gives the corresponding element in the output vector. The rows are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FVE</code></td>
<td>
<p>A vector of length pc.num, indicating the fraction of total variance explained by each product function, with corresponding 'FVEthreshold'.</p>
</td>
</tr>
</table>
<h3>References</h3>


<ul>
<li> <p><cite>Chen, K., Delicado, P., &amp; M端ller, H. G. (2017). Modelling function-valued stochastic processes, with applications to fertility dynamics. Journal of the Royal Statistical Society Series B: Statistical Methodology, 79(1), 177-196.</cite>
</p>
</li>
<li> <p><cite>Chen, K., &amp; M端ller, H. G. (2012). Modeling repeated functional observations. Journal of the American Statistical Association, 107(500), 1599-1609.</cite>
</p>
</li>
<li> <p><cite>Hall, P.,  M端ller, H.G. and Wang, J.L. (2006). Properties of principal component methods for functional and longitudinal data analysis. Annals of Statistics, 34(3), 1493-1517.</cite>
</p>
</li>
<li> <p><cite>Yao, F., M端ller, H. G., &amp; Wang, J. L. (2005). Functional data analysis for sparse longitudinal data. Journal of the American statistical association, 100(470), 577-590.</cite>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 100 ### sample size
N &lt;- 100
num.ages &lt;- 20 ### dimension 2
num.years &lt;- 15 ### dimension 1
dense_grid &lt;- seq(0,1,length=N)
Lt &lt;- list()
Ly &lt;- list()
for (i in 1:n) {
  Lt[[i]] &lt;- dense_grid ### dense time grid
  y_temp &lt;- matrix(0,num.ages,num.years)
  for (s in 1:num.ages) {
    for (t in 1:num.years) {
      y_temp[s,t] &lt;- y_temp[s,t]+cos(Lt[[i]][t])+rnorm(1,0,0.5)
    }
  }
  Ly[[i]] &lt;- y_temp ### dense functional data
}
X.age.year &lt;- matrix(0,n,num.years*num.ages)
for (i in 1:n) {
  X.age.year[i,] &lt;- as.vector(Ly[[i]]) ### data matrix
}
res &lt;- Dense2dFPCA(X.age.year, n , 15, 20, fpca.op=NULL,pc.num=2)
# Basic output
res$mu
res$pc.num
res$res.2D.FPCA
res$eig
res$FVE
res$pc.num
cumsum(res$FVE)


</code></pre>


</div>