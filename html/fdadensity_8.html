<div class="container">

<table style="width: 100%;"><tr>
<td>GetFVE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Metric-based Fraction of Variance Explained</h2>

<h3>Description</h3>

<p>When FPCA is performed on the log quantile density functions, the fraction of variance explained by the first K components is computed based on 
the density reconstruction and chosen metric.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GetFVE(fpcaObj, dmatrix, dSup, metric = "L2", useAlpha = FALSE, alpha = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fpcaObj</code></td>
<td>
<p>PACE output (FPCA on LQDs)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmatrix</code></td>
<td>
<p>matrix of original densities measures on grid dSup, rows correspond to individual densities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dSup</code></td>
<td>
<p>support for Density domain - max and min mark the boundary of the support.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>metric for measuring variance - 'L2' for Euclidean or 'W' for Wasserstein</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useAlpha</code></td>
<td>
<p>should regularisation be performed to densities in dmatrix? This should be set to TRUE if densities were regularised prior to FPCA (default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>scalar to regularise before computing FVE.  If useAlpha = TRUE, this should match the value used to regularise prior to FPCA (default = 0.01)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The fraction of variance explained (FVE) by the first K principal components corresponding to the LQD functions is computed by taking the K-dimensional
LQD representations, transforming back to densities, and comparing the reconstruction to the original densities using the chosen metric.  If densities were regularised
prior to transformation and FPCA, the same regularisation parameters should be used here.
</p>


<h3>Value</h3>

<p>FVEvector
</p>


<h3>References</h3>

<p><cite>Functional Data Analysis for Density Functions by Transformation to a Hilbert space, Alexander Petersen and Hans-Georg Mueller, 2016</cite>
</p>


<h3>See Also</h3>

<p><code>RegulariseByAlpha,lqd2quantile</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Top50BabyNames)

# Perform Transformation FPCA for male baby name densities
dSup = Top50BabyNames$x
X = FPCAdens(dmatrix = t(Top50BabyNames$dens$male), dSup = dSup, useAlpha = TRUE, 
                   optns = list(dataType = 'Dense', error = FALSE, methodSelectK = 8))

# Compute FVE - must compare to regularized densities 

fveL2 = GetFVE(fpcaObj = X, dmatrix = t(Top50BabyNames$dens$male), dSup = dSup, useAlpha = TRUE)
fveW = GetFVE(fpcaObj = X, dmatrix = t(Top50BabyNames$dens$male), dSup = dSup, 
                   metric = 'W', useAlpha = TRUE)

</code></pre>


</div>