<div class="container">

<table style="width: 100%;"><tr>
<td>psdCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute confidence intervals for PSD-X and PSD X-Y values.</h2>

<h3>Description</h3>

<p>Compute confidence intervals for (traditional) PSD-X and (incremental) PSD X-Y values as requested by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psdCI(
  indvec,
  ptbl,
  n,
  method = c("binomial", "multinomial"),
  bin.type = c("wilson", "exact", "asymptotic"),
  conf.level = 0.95,
  label = NULL,
  digits = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indvec</code></td>
<td>
<p>A numeric vector of 0s and 1s that identify the linear combination of proportions from <code>ptbl</code> that the user is interested in. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptbl</code></td>
<td>
<p>A numeric vector or array that contains the proportion or percentage of all individuals in each length category. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A single numeric of the number of fish used to construct <code>ptbl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string that identifies the confidence interval method to use. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.type</code></td>
<td>
<p>A string that identifies the type of method to use for calculation of the confidence intervals when <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>method="binomial". See details of <code>binCI</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>A number that indicates the level of confidence to use for constructing confidence intervals (default is <code>0.95</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>A single string that can be used to label the row of the output matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>A numeric that indicates the number of decimals to round the result to.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes confidence intervals for (traditional) PSD-X and (incremental) PSD X-Y values. Two methods can be used as chosen with <code>method=</code>. If <code>method="binomial"</code> then the binomial distribution (via <code>binCI()</code>) is used. If <code>method="multinomial"</code> then the multinomial method described by Brenden <em>et al.</em> (2008) is used. This function is defined to compute one confidence interval so <code>method="binomial"</code> is the default. See examples and <code>psdCalc</code> for computing several simultaneous confidence intervals.
</p>
<p>A table of proportions within each length category is given in <code>ptbl</code>. If <code>ptbl</code> has any values greater than 1 then it is assumed that a table of percentages was supplied and the entire table will be divided by 100 to continue. The proportions must sum to 1 (with some allowance for rounding).
</p>
<p>A vector of length equal to the length of <code>ptbl</code> is given in <code>indvec</code> which contains zeros and ones to identify the linear combination of values in <code>ptbl</code> to use to construct the confidence intervals. For example, if <code>ptbl</code> has four proportions then <code>indvec=c(1,0,0,0)</code> would be used to construct a confidence interval for the population proportion in the first category. Alternatively, <code>indvec=c(0,0,1,1)</code> would be used to construct a confidence interval for the population proportion in the last two categories. This vector must not contain all zeros or all ones.
</p>


<h3>Value</h3>

<p>A matrix with columns that contain the computed PSD-X or PSD X-Y value and the associated confidence interval. The confidence interval values were set to zero or 100 if the computed value was negative or greater than 100, respectively.
</p>


<h3>Testing</h3>

<p>The multinomial results match the results given in Brenden <em>et al.</em> (2008).
</p>


<h3>IFAR Chapter</h3>

<p>6-Size Structure.
</p>


<h3>Author(s)</h3>

<p>Derek H. Ogle, <a href="mailto:DerekOgle51@gmail.com">DerekOgle51@gmail.com</a>
</p>


<h3>References</h3>

<p>Ogle, D.H. 2016. <a href="https://fishr-core-team.github.io/fishR/pages/books.html#introductory-fisheries-analyses-with-r">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.
</p>
<p>Brenden, T.O., T. Wagner, and B.R. Murphy. 2008. Novel tools for analyzing proportional size distribution index data. North American Journal of Fisheries Management 28:1233-1242. [Was (is?) from http://qfc.fw.msu.edu/Publications/Publication%20List/2008/Novel%20Tools%20for%20Analyzing%20Proportional%20Size%20Distribution_Brenden.pdf.]
</p>


<h3>See Also</h3>

<p>See <code>psdVal</code>, <code>psdPlot</code>, <code>psdAdd</code>, <code>PSDlit</code>, <code>tictactoe</code>, <code>lencat</code>, and <code>rcumsum</code> for related functionality.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## similar to Brenden et al. (2008)
n &lt;- 997
ipsd &lt;- c(130,491,253,123)/n

## single binomial
psdCI(c(0,0,1,1),ipsd,n=n)
psdCI(c(1,0,0,0),ipsd,n=n,label="PSD S-Q")

## single multinomial
psdCI(c(0,0,1,1),ipsd,n=n,method="multinomial")
psdCI(c(1,0,0,0),ipsd,n=n,method="multinomial",label="PSD S-Q")

## multiple multinomials (but see psdCalc())
lbls &lt;- c("PSD S-Q","PSD Q-P","PSD P-M","PSD M-T","PSD","PSD-P")
imat &lt;- matrix(c(1,0,0,0,
                 0,1,0,0,
                 0,0,1,0,
                 0,0,0,1,
                 0,1,1,1,
                 0,0,1,1),nrow=6,byrow=TRUE)
rownames(imat) &lt;- lbls
imat

mcis &lt;- t(apply(imat,MARGIN=1,FUN=psdCI,ptbl=ipsd,n=n,method="multinomial"))
colnames(mcis) &lt;- c("Estimate","95% LCI","95% UCI")
mcis

## Multiple "Bonferroni-corrected" (for six comparisons) binomial method
bcis &lt;- t(apply(imat,MARGIN=1,FUN=psdCI,ptbl=ipsd,n=n,conf.level=1-0.05/6))
colnames(bcis) &lt;- c("Estimate","95% LCI","95% UCI")
bcis

</code></pre>


</div>