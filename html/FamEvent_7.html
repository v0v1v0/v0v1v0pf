<div class="container">

<table style="width: 100%;"><tr>
<td>penmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a penetrance model</h2>

<h3>Description</h3>

<p>Fits a penetrance model for family data based on a prospective likelihood with ascertainment correction and provides model parameter estimates. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">penmodel(formula, cluster = "famID", gvar = "mgene", parms, cuts = NULL, data, 
design = "pop", base.dist = "Weibull", frailty.dist = "none",
agemin = NULL, robust = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula expression as for other regression models. The response should be a survival object as returned by the <code>Surv</code> function. See the documentation for <code>Surv</code>, <code>lm</code> and <code>formula</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>

<p>Name of cluster variable. Default is <code>"famID"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gvar</code></td>
<td>
<p>Name of genetic variable. Default is <code>"mgene"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>

<p>Vector of initial values for the parameters in the model including baseline parameters and regression coefficients. <code>parms = c(baseparm, coef)</code>, where <code>baseparm</code> includes the initial values for baseline parameters used for <code>base.dist</code>, and <code>coef</code> includes the initial values for regression coefficients for the variables specified in <code>formula</code>. If frailty.dist is specified, the initial value of the frailty parameter should be specified <code>parms = c(baseparm, coef, k)</code>, where <code>k</code> the initial value for the frailty parameter. 
See details for the baseline parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuts</code></td>
<td>
 
<p>Vector of cut points that define the intervals where the hazard function is constant. The <code>cuts</code> should be specified when <code>base.dist="piecewise"</code> and must be strictly positive and finite. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame generated from <code>simfam</code> or data frame containing variables named in the <code>formula</code> and specific variables: <code>famID</code>, <code>indID</code>, <code>gender</code>, <code>currentage</code>, <code>mgene</code>, <code>time</code>, <code>status</code> and <code>weight</code> with <code>attr(data,"agemin")</code> specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Study design of the family data.  Possible choices are: <code>"pop", "pop+", "cli"</code>, <code>"cli+"</code> or <code>"twostage"</code>, where <code>"pop"</code> is for the population-based design with affected probands whose mutation status can be either carrier or non-carrier, <code>"pop+"</code> is similar to <code>"pop"</code> but with mutation carrier probands, <code>"cli"</code> is for the clinic-based design that includes affected probands with at least one parent and one sib affected, <code>"cli+"</code> is similar to <code>"cli"</code> but with mutation carrier probands, and <code>"twostage"</code> is for the two-stage design with oversampling of high risks families. Default is <code>"pop"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.dist</code></td>
<td>

<p>Choice of baseline hazard distributions to fit. Possible choices are: <code>"Weibull"</code>, <code>"loglogistic"</code>, <code>"Gompertz"</code>, <code>"lognormal"</code>, <code>"gamma"</code>, <code>"logBurr"</code>, or <code>"piecewise"</code>. Default is <code>"Weibull"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frailty.dist</code></td>
<td>

<p>Choice of frailty distribution. Possible choices are: <code>"gamma"</code>, <code>"lognormal"</code>, or <code>"none"</code>. Default is <code>"none"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agemin</code></td>
<td>

<p>Minimum age of disease onset or minimum age. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the robust ‘sandwich’ standard errors and variance-covariance matrix are provided, otherwise the conventional standard errors and variance-covariance matrix are provided.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>frailty.dist = "none"</code>, the following penetrance model is fitted to family data with a specified baseline hazard distribution 
  h(t|x<sub>s</sub>, x<sub>g</sub>) = h<sub>0</sub>(t - t<sub>0</sub>)  exp(β<sub>s</sub> * x<sub>s</sub> + β<sub>g</sub> * x<sub>g</sub>),  
where h<sub>0</sub>(t) is the baseline hazards function specified by <code>base.dist</code>, which depends on the shape and scale parameters, λ and ρ; x<sub>s</sub> indicates male (1) and female (0) and x<sub>g</sub> indicates carrier (1) or non-carrier (0) of a gene of interest (major gene). Additional covariates can be added to <code>formula</code> in the model.
</p>
<p>When <code>frailty.dist</code> is specified as either <code>"gamma"</code> or <code>"lognormal"</code>, the follwoing shared frailty model is fitted to family data 

 h(t|X,Z) = h<sub>0</sub>(t - t<sub>0</sub>) Z exp(β<sub>s</sub> * x<sub>s</sub> + β<sub>g</sub> * x<sub>g</sub>), 
where h<sub>0</sub>(t) is the baseline hazard function, t<sub>0</sub> is a minimum age of disease onset, and Z represents a frailty shared within families whose distribution is specified by <code>frailty.dist</code>.
</p>
<p><em>Choice of frailty distributions</em>
</p>
<p><code>frailty.dist = "gamma"</code> assumes <code class="reqn">Z</code> follows Gamma(<code class="reqn">k</code>, <code class="reqn">1/k</code>). 
</p>
<p><code>frailty.dist = "lognormal"</code> assumes <code class="reqn">Z</code> follows log-normal distribution with mean 0 and variance <code class="reqn">1/k</code>.
</p>
<p><code>frailty.dist = "none"</code> shares no frailties within families and assumes independence among family members. 
</p>
<p>For family data arising from population- or clinic-based study designs (<code>design="pop", "pop+"</code>, <code>"cli"</code>, or <code>"cli+"</code>), the parameters of the penetrance model are estimated using the ascertainment-corrected prospective likelihood approach (Choi, Kopciuk and Briollais, 2008).
</p>
<p>For family data arising from a two-stage study design (<code>design="twostage"</code>), model parameters are estimated  using the composite likelihood approach (Choi and Briollais, 2011)
</p>
<p>Note that the baseline parameters include <code>lambda</code> and <code>rho</code>, which represent the scale and shape parameters, respectively, and <code>eta</code>, additional parameter to specify for <code>"logBurr"</code> distribution. For the <code>"lognormal"</code> baseline distribution, <code>lambda</code> and <code>rho</code> represent the location and scale parameters for the normally distributed logarithm, where <code>lambda</code> can take any real values and <code>rho</code> &gt; 0. For the other baselinse distributions, <code>lambda</code> &gt; 0, <code>rho</code> &gt; 0, and <code>eta</code> &gt; 0. When a piecewise constant distribution is specified for the baseline hazards, <code>base.dist="piecewise"</code>, <code>baseparm</code> should specify the initial interval-constant values, one more than the cut points specified by<code>cuts</code>.
</p>
<p>Transformed baseline parameters are used for estimation; log transformation is applied to both scale and shape parameters (<code class="reqn">\lambda, \rho</code>) for <code>"Weibull"</code>, <code>"loglogistic"</code>, <code>"Gompertz"</code> and <code>"gamma"</code> baselines, to (<code class="reqn">\lambda, \rho, \eta</code>) for <code>"logBurr"</code> and to the piecewise constant parameters for a <code>piecewise</code> baseline hazard. For <code>"lognormal"</code> baseline distribution, the log transformation is applied only to <code class="reqn">\rho</code>, not to <code class="reqn">\lambda</code>, which represents the location parameter for the normally distributed logarithm.
</p>
<p>Calculations of penetrance estimates and their standard errors and 95% confidence intervals at given ages can be obtained by <code>penetrance</code> function via Monte-Carlo simulations of the estimated penetrance model.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'penmodel'</code>, including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>

<p>Parameter estimates of transformed baseline parameters and regression coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>

<p>Variance-covariance matrix of parameter estimates obtained from the inverse of Hessian matrix. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov.robust</code></td>
<td>

<p>Robust ‘sandwich’ variance-covariance matrix of parameter estimates when <code>robust=TRUE</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>

<p>Standard errors of parameter estimates obtained from the inverse of Hessian matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.robust</code></td>
<td>

<p>Robust ‘sandwich’ standard errors of parameter estimates when <code>robust=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>Loglikelihood value for the fitted penetrance model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Akaike information criterion (AIC) value of the model; AIC = 2*k - 2*logLik, where k is the number of parameters used in the model.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yun-Hee Choi
</p>


<h3>References</h3>

<p>Choi, Y.-H., Briollais, L., He, W. and Kopciuk, K. (2021) FamEvent: An R Package for Generating and Modeling Time-to-Event Data in Family Designs, Journal of Statistical Software 97 (7), 1-30. doi:10.18637/jss.v097.i07
</p>
<p>Choi, Y.-H., Kopciuk, K. and Briollais, L. (2008) Estimating Disease Risk Associated Mutated Genes in Family-Based Designs, Human Heredity 66, 238-251.
</p>
<p>Choi, Y.-H. and Briollais (2011) An EM Composite Likelihood Approach for Multistage Sampling of Family Data with Missing Genetic Covariates, Statistica Sinica 21, 231-253.
</p>


<h3>See Also</h3>

<p><code>penmodelEM</code>, <code>simfam</code>, <code>penplot</code>, <code>print.penmodel</code>,
<code>summary.penmodel</code>, <code>print.summary.penmodel</code>, <code>plot.penmodel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Family data simulated from population-based design using a Weibull baseline hazard 

set.seed(4321)
fam &lt;- simfam(N.fam = 200, design = "pop+", variation = "none", base.dist = "Weibull", 
       base.parms = c(0.01, 3), vbeta = c(-1.13, 2.35), agemin = 20, allelefreq = 0.02)
 
# Penetrance model fit for simulated family data

fit &lt;- penmodel(Surv(time, status) ~ gender + mgene, cluster = "famID", design = "pop+",
       parms = c(0.01, 3, -1.13, 2.35), data = fam, base.dist = "Weibull")

# Summary of the model parameter estimates from the model fit

summary(fit)

# Plot the lifetime penetrance curves with 95% CIs from the model fit for specific  
# gender and mutation status groups along with their nonparametric penetrance curves  
# based on data excluding probands. 

plot(fit, add.KM = TRUE, conf.int = TRUE, MC = 100)
</code></pre>


</div>