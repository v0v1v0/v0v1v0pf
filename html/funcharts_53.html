<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_mfd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a data set for funcharts</h2>

<h3>Description</h3>

<p>Function used to simulate a data set to illustrate
the use of <code>funcharts</code>.
By default, it creates a data set with three functional covariates,
a functional response generated as a function of the
three functional covariates
through a function-on-function linear model,
and a scalar response generated as a function of the
three functional covariates
through a scalar-on-function linear model.
This function covers the simulation study in Centofanti et al. (2021)
for the function-on-function case and also simulates data in a similar way
for the scalar response case.
It is possible to select the number of functional covariates,
the correlation function type for each functional covariate
and the functional response, moreover
it is possible to provide manually the mean and variance functions
for both functional covariates and the response.
In the default case, the function generates in-control data.
Additional arguments can be used to generate additional
data that are out of control,
with mean shifts according to the scenarios proposed
by Centofanti et al. (2021).
Each simulated observation of a functional variable consists of
a vector of discrete points equally spaced between 0 and 1 (by default
150 points),
generated with noise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_mfd(
  nobs = 1000,
  p = 3,
  R2 = 0.97,
  shift_type_y = "0",
  shift_type_x = c("0", "0", "0"),
  correlation_type_y = "Bessel",
  correlation_type_x = c("Bessel", "Gaussian", "Exponential"),
  d_y = 0,
  d_y_scalar = 0,
  d_x = c(0, 0, 0),
  n_comp_y = 10,
  n_comp_x = 50,
  P = 500,
  ngrid = 150,
  save_beta = FALSE,
  mean_y = NULL,
  mean_x = NULL,
  variance_y = NULL,
  variance_x = NULL,
  sd_y = 0.3,
  sd_x = c(0.3, 0.05, 0.3),
  seed
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>The number of observation to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of functional covariates to simulate. Default value is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>The desired coefficient of determination in the regression
in both the scalar and functional response cases,
Default is 0.97.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift_type_y</code></td>
<td>
<p>The shift type for the functional response.
There are five possibilities: "0" if there is no shift,
"A", "B", "C" or "D" for the corresponding shift types
shown in Centofanti et al. (2021).
Default is "0".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift_type_x</code></td>
<td>
<p>A list of length <code>p</code>, indicating, for each functional covariate,
the shift type. For each element of the list,
there are five possibilities: "0" if there is no shift,
"A", "B", "C" or "D" for the corresponding shift types
shown in Centofanti et al. (2021).
By default, shift is not applied to any functional covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation_type_y</code></td>
<td>
<p>A character vector indicating the type of correlation function for
the functional response.
See  Centofanti et al. (2021)
for more details. Three possible values are available,
namely <code>"Bessel"</code>, <code>"Gaussian"</code> and <code>"Exponential"</code>.
Default value is <code>"Bessel"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation_type_x</code></td>
<td>
<p>A list of <code>p</code> character vectors indicating
the type of correlation function for each
functional covariate.
See  Centofanti et al. (2021)
for more details. For each element of the list,
three possible values are available,
namely <code>"Bessel"</code>, <code>"Gaussian"</code> and <code>"Exponential"</code>.
Default value is <code>c("Bessel", "Gaussian", "Exponential")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_y</code></td>
<td>
<p>A number indicating the severity of the shift type for
the functional response.
Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_y_scalar</code></td>
<td>
<p>A number indicating the severity of the shift type for
the scalar response.
Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_x</code></td>
<td>
<p>A list of <code>p</code> numbers, each indicating the
severity of the shift type for
the corresponding functional covariate.
By default, the severity is set to zero for all functional covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_comp_y</code></td>
<td>
<p>A positive integer number indicating how many principal components
obtained after the eigendecomposiiton of the covariance function
of the functional response variable to retain.
Default value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_comp_x</code></td>
<td>
<p>A positive integer number indicating how many principal components
obtained after the eigendecomposiiton of the covariance function
of the multivariate functional covariates variable to retain.
Default value is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>A positive integer number indicating the number of equally spaced
grid points over which the covariance functions are discretized.
Default value is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>A positive integer number indicating the number of equally spaced
grid points between zero and one
over which all functional observations are discretized before adding
noise. Default value is 150.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_beta</code></td>
<td>
<p>If TRUE, the true regression coefficients of both the function-on-function
and the scalar-on-function models are saved.
Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_y</code></td>
<td>
<p>The mean function of the functional response can be set manually
through this argument. If not NULL, it must be a vector of length
equal to <code>ngrid</code>, providing the values of the mean function of
the functional response discretized on <code>seq(0,1,l=ngrid)</code>.
If NULL, the mean function is generated as done in the simulation study
of Centofanti et al. (2021).
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_x</code></td>
<td>
<p>The mean function of the functional covariates can be set manually
through this argument. If not NULL, it must be a list of vectors,
each with length equal to <code>ngrid</code>,
providing the values of the mean function of
each functional covariate discretized on <code>seq(0,1,l=ngrid)</code>.
If NULL, the mean function is generated as done in the simulation study
of Centofanti et al. (2021).
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance_y</code></td>
<td>
<p>The variance function of the functional response can be set manually
through this argument. If not NULL, it must be a vector of length
equal to <code>ngrid</code>, providing the values of the variance function of
the functional response discretized on <code>seq(0,1,l=ngrid)</code>.
If NULL, the variance function is generated as done in the simulation study
of Centofanti et al. (2021).
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance_x</code></td>
<td>
<p>The variance function of the functional covariates can be set manually
through this argument. If not NULL, it must be a list of vectors,
each with length equal to <code>ngrid</code>,
providing the values of the variance function of
each functional covariate discretized on <code>seq(0,1,l=ngrid)</code>.
If NULL, the variance function is generated as done in the simulation study
of Centofanti et al. (2021).
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_y</code></td>
<td>
<p>A positive number indicating the standard deviation of the generated
noise with which the functional response discretized values are observed.
Default value is 0.3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_x</code></td>
<td>
<p>A vector of <code>p</code> positive numbers indicating the standard deviation
of the generated noise with which the
functional covariates discretized values are observed.
Default value is <code>c(0.3, 0.05, 0.3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Deprecated: use <code>set.seed()</code> before calling
the function for reproducibility.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>X_list</code> is a list of <code>p</code> matrices, each with dimension
<code>nobs</code>x<code>ngrid</code>, containing the simulated
observations of the multivariate functional covariate
</p>
</li>
<li> <p><code>Y</code> is a <code>nobs</code>x<code>ngrid</code> matrix with the simulated
observations of the functional response
</p>
</li>
<li> <p><code>y_scalar</code> is a vector of length <code>nobs</code> with the simulated
observations of the scalar response
</p>
</li>
<li> <p><code>beta_fof</code>, if <code>save_beta = TRUE</code>, is a
list of <code>p</code> matrices, each with dimension <code>P</code>x<code>P</code>
with the discretized functional coefficients of the
function-on-function regression
</p>
</li>
<li> <p><code>beta_sof</code>, if <code>save_beta = TRUE</code>, is a
list of <code>p</code> vectors, each with length <code>P</code>,
with the discretized functional coefficients of the
scalar-on-function regression
</p>
</li>
</ul>
<h3>References</h3>

<p>Centofanti F, Lepore A, Menafoglio A, Palumbo B, Vantini S. (2021)
Functional Regression Control Chart.
<em>Technometrics</em>, 63(3), 281–294. <a href="doi:10.1080/00401706.2020.1753581">doi:10.1080/00401706.2020.1753581</a>
</p>


</div>