<div class="container">

<table style="width: 100%;"><tr>
<td>landmarkreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Landmark Registration of Functional Observations with Differing Ranges
</h2>

<h3>Description</h3>

<p>It is common to see that among a set of functions certain prominent
features such peaks and valleys, called $landmarks$, do not occur
at the same times, or other argument values.  
This is called $phase variation$, and it can be essential to align 
these features before proceeding with further functional data analyses.  
</p>
<p>This function uses the timings of these
features to align or register the curves.  The registration involves
estimating a nonlinear transformation of the argument continuum for each
functional observation.  This transformation is called a warping
function. It must be strictly increasing and smooth.
</p>
<p>Warning:  As of March 2022, landmark registration cannot be done using
function <code>smooth.basis</code> instead of function <code>smooth.morph</code>.  The 
warping function must be strictly monotonic, and we have found that using 
<code>smooth.basis</code> too often violates this contraint.  Function 
<code>smooth.morph</code> ensures monotonicity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">landmarkreg(unregfd, ximarks, x0marks, x0lim, 
             WfdPar=NULL, WfdPar0=NULL, ylambda=1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>unregfd</code></td>
<td>

<p>a functional data object containing the curves to be registered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ximarks</code></td>
<td>

<p>A matrix containing the timings or argument values associated with
the landmarks for the observations in <code>fd</code> to be registered.
The number of rows N equals the number of observations, and the
number of columns NL equals the number of landmarks. These landmark
times must be in the interior of the interval over which the
functions are defined.
Object ximarks may also be a vector or a data.frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0marks</code></td>
<td>

<p>a vector of length NL of times of landmarks for target curve.  If
not supplied, the mean of the landmark times in <code>ximarks</code> is
used.
Object x0marks may also be a vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0lim</code></td>
<td>

<p>A vector of length 2 containing the lower and upper boundary of 
the interval containing <code>x0marks</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WfdPar</code></td>
<td>

<p>a functional parameter object defining the warping functions that
transform time in order to register the curves.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WfdPar0</code></td>
<td>

<p>a functional parameter object defining the inverse warping functions 
that transform time in order to register the curves.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylambda</code></td>
<td>

<p>Smoothing parameter controlling the smoothness of the registered
functions.  It can happen with high dimensional bases that local
wiggles can appear in the registered curves or their derivatives
that are not seen in the unregistered versions.  In this case,
this parameter should be increased to the point where they
disappear.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A value of an arbitrary strictly monotone function at a point <code>x</code>
can be defined as the indefinite integral from a fixed lower boundary 
to <code>x</code> of the exponential of an unconstrained function value 
<code>W(x)</code>.
</p>
<p>We use B-spline basis functions to define function <code>W</code>, and optimize
the coefficients of its B-spline expansion with respect to the
data we are fitting.  The optimized core function <code>W</code> is output 
along with the registered functions, the warping function qnd the inverse
warping function.
</p>
<p>It is essential that the location of every landmark be clearly defined
in each of the curves as well as the template function.  If this is
not the case, consider using the continuous registration function
<code>register.fd</code>.  
</p>
<p>Not much curvature is usually required in the warping functions, so a
rather lower power basis, usually B-splines, is suitable for defining
the functional parameter argument <code>WfdPar</code>.  A registration with
a few prominent landmarks is often a good preliminary to using the
more sophisticated but more lengthy process in <code>register.fd</code>.
</p>


<h3>Value</h3>

<p>a named list of length 4 with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fdreg</code></td>
<td>

<p>a functional data object for the registered curves.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warpfd</code></td>
<td>

<p>a functional data object for the warping functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warpinvfd</code></td>
<td>

<p>a functional data object for the inverse warping functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wfd</code></td>
<td>

<p>a functional data object for the core function defining
the strictly monotone warping function.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), 
<em>Functional Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), 
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>register.fd</code>,
<code>landmarkreg</code>,
<code>smooth.morph</code>
</p>


</div>