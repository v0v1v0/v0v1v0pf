<div class="container">

<table style="width: 100%;"><tr>
<td>StructurePickers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Functions to find split-plot or left-adjusted designs </h2>

<h3>Description</h3>

<p>Functions to restructure a fractional factorial by permuting the base factors 
such that the leftmost base factors have a suitable alias structure for the 
problem at hand; meant for expert users
</p>


<h3>Usage</h3>

<pre><code class="language-R">splitpick(k, gen, k.WP, nfac.WP, show=10)
leftadjust(k, gen, early=NULL, show=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> the number of base factors (designs have <code>2^k</code> runs) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p> vector of generating columns from Yates matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.WP</code></td>
<td>
<p> integer number of base factors used for whole plot generation; 
there will be <code>2^k.WP</code> plots in the design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfac.WP</code></td>
<td>
<p> integer number of whole plot factors, must not be smaller than <code>k.WP</code>;
the other <code>k + length(gen)</code> factors are split-plot factors, i.e. 
they change within plots </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p> numeric integer indicating how many results are to be shown;
for function <code>splitpick</code>, this number also determines how many designs 
are investigated;
the other two functions investigate all designs and show the best results only </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early</code></td>
<td>
<p> number that indicates how many “leftmost” factors are 
needed in the design; used by <code>FrF2</code> for accomodating hard-to-change 
factors </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions exploit the fact that a factorial design can be arranged such 
that the <code>2^k.WP-1</code> leftmost columns have exactly <code>2^k.WP</code> 
different patterns. They can thus accomodate whole plot effects if <code>2^k.WP</code> 
plots are available; also, with a specially rearranged version of the Yates matrix, 
the leftmost columns can have particularly few or particularly many level changes, 
cf. e.g. Cheng, Martin and Tang 1998.
</p>
<p>By permuting the <code>k</code> base factors , the functions try to find <code>2^k.WP</code> 
ones that accomodate the current needs, if taken as the first base factors. They are 
used by function <code>FrF2</code>, if a user requests an automatically-generated 
split-plot design or a design with some factors declared hard-to-change.
</p>
<p>There may be a possibility to better accomodate the experimenters needs within 
a given design by trying different sets of base factors. This is not done 
in these functions. Also, custom user needs may be better fulfilled, if an expert 
user directly uses one of these functions for inspecting the possibilities, rather 
than relying on the automatic selection routine in function <code>FrF2</code>. 
</p>


<h3>Value</h3>

<p>Both functions output a list of entries with information on at most <code>show</code> suitable 
permutations. <code>splitpick</code> ends with an error, if no suitable 
solution can be found.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>orig</code></td>
<td>
<p>original generator column numbers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basics</code></td>
<td>
<p>named vector with the following entries: <br>
for function <code>splitpick</code>, 
entries are the number of runs, the number of plots, the
number of whole plot factors and the number of split-plot factors <br>
for function <code>leftadjust</code>, 
entries are the number of runs, the number of factors, 
and - if <code>early</code> is not NULL - the entry for <code>early</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p>matrix with rows containing permutations of base factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.WP</code></td>
<td>
<p>for <code>splitpick</code> only; <br> 
vector of resolutions for the respective rows of perms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpos</code></td>
<td>
<p>for <code>leftadjust</code> only; <br> 
vector of maximum positions for the <code>early</code> leftmost factors for the respective rows of perms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.early</code></td>
<td>
<p>for <code>leftadjust</code> only; <br> 
vector of numbers of base factors needed for spanning the <code>early</code> leftmost factors for the respective rows of perms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>matrix the rows of which contain the generator columns 
for the respective rows of perms</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Ulrike Groemping </p>


<h3>References</h3>

 
<p>Cheng, C.-S., Martin, R.J., and Tang, B. (1998). 
Two-level factorial designs with extreme numbers of level changes. <em>Annals of Statistics</em> 
<b>26</b>, 1522-1539.
</p>


<h3>See Also</h3>

<p> See Also <code>FrF2</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">## leftadjusting MA design from table 6.22 in BHH2, 9 factors, 32 runs
## NOTE: nevertheless not as well left-adjusted as the isomorphic design 9-4.1 from catlg
leftadjust(5,c(30,29,27,23))
## with option early=4 (i.e. 4 columns as early as possible are requested)
leftadjust(5,c(30,29,27,23),early=4)
leftadjust(5,catlg$'9-4.1'$gen,early=4)

## look for a split plot design in 32 runs with 7 factors, 
##       3 of which are whole plot factors, 
##       and 8 plots
splitpick(5,catlg$'7-2.1'$gen,nfac.WP=3,k.WP=3)
</code></pre>


</div>