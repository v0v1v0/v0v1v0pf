<div class="container">

<table style="width: 100%;"><tr>
<td>confint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates Confidence Intervals for Global and Small-Area Estimations</h2>

<h3>Description</h3>

<p>Calculates Confidence Intervals for Global and Small-Area Estimations
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'onephase'
confint(object, parm, level = 0.95, adjust.method = "none", ...)

## S3 method for class 'twophase'
confint(object, parm, level = 0.95, adjust.method = "none", ...)

## S3 method for class 'threephase'
confint(object, parm, level = 0.95, adjust.method = "none", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>onephase</code>, <code>twophase</code> or <code>threephase</code>,
containing estimation results of the respective estimation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the confidence level required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.method</code></td>
<td>
<p>correction method to obtain simultaneous confidence intervals
for a set of estimates (thus restricted to objects of class <code>"onephase"</code>,
<code>c("smallarea", "twophase")</code> and  <code>c("smallarea", "threephase")</code>).
Available correction methods are <code>c("none","bonferroni")</code>. Defaults to <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, so far ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the estimation method specified, <code>confint()</code> computes confidence intervals as follows:
</p>
<p><code>onephase</code>:
</p>
<p>Two-sided confidence intervals are computed based on the t-distribution with <code>n2 - 1</code> <em>degrees of freedom</em>,
where <code>n2</code> is the number of terrestrial data in the respective inventory domain.
</p>
<p><code>twophase</code>:
</p>
<p>The calculation of the two-sided confidence intervals for <em>global</em> twophase estimates
(objects of class <code>global</code>) are calculated based on the quantiles of the <em>t</em>-distribution
with <code>n2 - p</code> <em>degrees of freedom</em>, where <code>p</code> is the number of parameters used in
the regression model, and <code>n2</code> is the number of terrestrial observations (i.e. <em>local densities</em>)
in the inventory domain.
</p>
<p>The calculation of the two-sided confidence intervals for <em>smallarea</em> twophase estimates
(objects of class <code>smallarea</code>) are calculated based on the quantiles of the <em>t</em>-distribution
with <code>n2G - 1</code> <em>degrees of freedom</em>, where <code>n2G</code> is the number of
terrestrial observations (i.e. <em>local densities</em>) in the smallarea.
</p>
<p><code>threephase</code>:
</p>
<p>The calculation of the two-sided confidence intervals for <em>global</em> threephase estimates
(objects of class <code>global</code>) are calculated based on the quantiles of the <em>t</em>-distribution
with <code>n2 - p</code> <em>degrees of freedom</em>, where <code>p</code> is the number of parameters used in
the <strong>full</strong> regression model, and <code>n2</code> is the number of terrestrial observations
(i.e. <em>local densities</em>) in the inventory domain (note: in notation used here n0, n1 and n2
correspond to the zero, first and second phase sample sizes respectively).
</p>
<p>The calculation of the two-sided confidence intervals for <em>smallarea</em> theephase estimates
(objects of class <code>smallarea</code>) are calculated based on the quantiles of the <em>t</em>-distribution
with <code>n2G - 1</code> <em>degrees of freedom</em>, where <code>n2G</code> is the number of
terrestrial observations (i.e. <em>local densities</em>) in the smallarea.
</p>


<h3>Value</h3>

<p><code>confint</code> returns a list of  the following 3 components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>a <code>data.frame</code> containing the columns:
</p>

<ul>
<li> <p><code>area</code> the domain, i.e. small area
</p>
</li>
<li> <p><code>ci_lower_ext</code> the lower confidence limit based on the external variance
</p>
</li>
<li> <p><code>ci_upper_ext</code> the upper confidence limit based on the external variance
</p>
</li>
<li> <p><code>ci_lower_g</code>   the lower confidence limit based on the g-weight variance
</p>
</li>
<li> <p><code>ci_upper_g</code>   the upper confidence limit based on the g-weight variance
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the applied confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.method</code></td>
<td>
<p>the adjustment method applied to retrieve simultaneous confidence intervals</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>In the special case of <em>synthetic</em> smallarea estimations, the two-sided confidence intervals
are calculated based on the quantiles of the <em>t</em>-distribution
with <code>n2 - p</code> <em>degrees of freedom</em>, i.e. based on the global sample size.
</p>
<p>The confidence intervals for <em>synthetic</em> smallarea estimations do not account for the potential
bias of a linear model that was fit in a large forest area and applied to a small area.  Thus,
the coverage rates for confidence intervals produced by synthetic estimators may be less than
the nominal level of confidence.
</p>
<p>In case of cluster-sampling, <code>n2G</code> is the number of terrestrial clusters
(a cluster constitutes the sample unit). This is automatically considered by <code>confint</code>.
</p>
<p>The adjustment methods passed to <code>adjust.method</code> are designed to achieve
<em>simultaneous</em> confidence intervals by correcting the confidence level given by <code>level</code>.
The use of this option is recommended if a set of estimates contained in a <code>onephase</code>- or
<code>smallarea</code>-object should be compared by their confidence intervals. It ensures that the
percentage of confidence intervals containing the true value will correspond to
the nominal confidence level.
</p>


<h3>References</h3>

<p>Hill, A., Massey, A. F. (2021). <em>The R Package forestinventory: Design-Based Global and Small
Area Estimations for Multiphase Forest Inventories.</em> Journal of Statistical Software, 97(4), 1-40.
</p>
<p>Mandallaz, D. (2013). <em>Design-based properties of some small-area estimators in forest inventory
with two-phase sampling.</em> Canadian Journal of Forest Research, 43(5), 441-449.
</p>
<p>Mandallaz, D., Breschan, J., &amp; Hill, A. (2013). <em>New regression estimators in forest inventories
with two-phase sampling and partially exhaustive information: a design-based monte carlo approach
with applications to small-area estimation.</em> Canadian Journal of Forest Research,
43(11), 1023-1031.
</p>
<p>Mandallaz, D. (2013). <em>A three-phase sampling extension of the generalized regression estimator
with partially exhaustive information.</em> Canadian Journal of Forest Research,
44(4), 383-388.
</p>
<p>Benjamini, Y., and Hochberg, Y. (1995). <em>Controlling the false discovery rate:
a practical and powerful approach to multiple testing.</em>
Journal of the Royal Statistical Society Series B 57, 289-300.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Calculate twophase estimations by extended pseudosynthetic estimator
#  for 4 small areas ("A", "B", "C", "D") using the grisons-dataset:
sae.est &lt;- twophase(formula = tvol ~ mean + stddev + max + q75,
                    data = grisons,
                    phase_id = list(phase.col = "phase_id_2p", terrgrid.id = 2),
                    small_area = list(sa.col = "smallarea",
                                      areas = c("A", "B","C", "D"),
                                      unbiased = TRUE))

## calculate 95%-confidence intervals for each small area:
confint(sae.est)

## calculate simultaneous 95%-confidence intervals using 'bonferroni'-method:
confint(sae.est, adjust.method = "bonferroni")
</code></pre>


</div>