<div class="container">

<table style="width: 100%;"><tr>
<td>forsearch_lme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create Statistics Of Forward Search For a Linear Mixed Effects Database
</h2>

<h3>Description</h3>

<p>Prepares summary statistics at each stage of forward search for subsequent
plotting. Forward search is conducted in four steps: Step 0 to set up accounting for 
group structure, Step 1 to identify minimal set of observations to estimate unknown 
fixed parameters, Step 2 to identify the order of the remaining observations, and a
final stage to extract the intermediate statistics based on increasing sample size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">forsearch_lme(fixedform, alldata, randomform, initial.sample=1000, n.obs.per.level=1, 
   skip.step1=NULL, unblinded=TRUE, begin.diagnose = 100, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fixedform</code></td>
<td>
<p>2-sided formula for fixed effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alldata</code></td>
<td>
<p>data frame, first column of which must be "Observation"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomform</code></td>
<td>
<p>1-sided formula for random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.sample</code></td>
<td>
<p>Number of observations in Step 1 of forward search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs.per.level</code></td>
<td>
<p>Number of observations per level of (possibly crossed) 
factor levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip.step1</code></td>
<td>
<p>NULL or a vector of integers for observations to be included
in Step 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unblinded</code></td>
<td>
<p>TRUE causes printing of presumed analysis structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin.diagnose</code></td>
<td>
<p>Numeric indicator of place in coding to begin printing 
diagnostic information. 0 prints all information, 100 prints none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>TRUE causes function identifier to display before and after 
run</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>data will be grouped within the function, regardless of initial 
layout. Step 2 is determined by the results of Step 1, which itself is random.
So, it is possible to reproduce the entire run by using the skip.step1 argument.
Variables in the randomform formula must be character variables, but *not* factors</p>


<h3>Value</h3>

<p>LIST
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Number of observations in Step 1 </code></td>
<td>
<p>Number of observations included in Step 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Step 1 observation numbers</code></td>
<td>
<p>Observation numbers useful in skipping step 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rows by outer subgroup</code></td>
<td>
<p>List of row numbers, by outer subgroup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rows by outer-inner subgroups</code></td>
<td>
<p>List of row numbers, by outer-inner subgroup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rows in stage </code></td>
<td>
<p>Observation numbers of rows included at each stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma </code></td>
<td>
<p>Estimate of random error at final stage; used to standardize all residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Standardized residuals</code></td>
<td>
<p>Matrix of errors at each stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fixed parameter estimates</code></td>
<td>
<p>Matrix of parameter estimates at each stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Random parameter estimates</code></td>
<td>
<p>Matrix of parameter estimates at each stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Leverage </code></td>
<td>
<p>Matrix of leverage of each observation at each stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Modified Cook distance</code></td>
<td>
<p>Estimate of sum of squared changes in parameter estimates at each stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dims </code></td>
<td>
<p>Dims from fit of lme function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t statistics </code></td>
<td>
<p>t statistics for each fixed parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fit statistics </code></td>
<td>
<p>AIC, BIC, and log likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Call </code></td>
<td>
<p>Call to this function</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>William R. Fairweather
</p>


<h3>References</h3>

<p>Atkinson, A and M Riani. Robust Diagnostic Regression Analysis, Springer, New York, 2000.
Pinheiro, JC and DM Bates. Mixed-Effects Models in S and S-Plus, Springer, New York, 2000.
https://CRAN.R-project.org/package=nlme
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Multiple regression in grouped data
Observation &lt;- 1:16
y &lt;- runif(16)
x1 &lt;- runif(16)
x2 &lt;- runif(16)
x3 &lt;- runif(16)
group &lt;- as.factor(rep(c("G1","G2"),each=8))
lmetest1 &lt;- data.frame(Observation,y,x1,x2,x3,group)

forsearch_lme(fixedform=y~x1+x2+x3, alldata=lmetest1, randomform= ~1|group, 
   n.obs.per.level=1, initial.sample=200)
## Not run: 

# Analysis of variance in grouped data
Observation &lt;- 1:60
y &lt;- runif(60)
AN1 &lt;- as.factor(c(rep("A1",5),rep("A2",5),rep("A3",5)))
AN1 &lt;- c(AN1,AN1,AN1,AN1)
AN2 &lt;- as.factor(c(rep("B1",15),rep("B2",15)))
AN2 &lt;- c(AN2,AN2)
group &lt;- as.factor(rep(c("G1","G2"),each=30))
lmetest2 &lt;- data.frame(Observation,y,AN1,AN2,group)

forsearch_lme(fixedform=y~AN1*AN2, alldata=lmetest2, randomform= ~1|group,
             initial.sample=500)

# Analysis of covariance in grouped data

Observation &lt;- 1:120
y &lt;- runif(120)
AN1 &lt;- as.factor(c(rep("A1",10),rep("A2",10),rep("A3",10)))
AN1 &lt;- c(AN1,AN1,AN1,AN1)
AN2 &lt;- as.factor(c(rep("B1",10),rep("B2",10)))
AN2 &lt;- c(AN2,AN2,AN2,AN2,AN2,AN2)
COV &lt;- runif(120)
group &lt;- as.factor(rep(c("G1","G2"),each=30))
group &lt;- c(group,group)
lmetest3 &lt;- data.frame(Observation,y,AN1,AN2,COV,group)

forsearch_lme(fixedform=y~AN1*AN2+COV, alldata=lmetest3, randomform= ~ 1 | group,
        initial.sample=500)

## End(Not run)
</code></pre>


</div>