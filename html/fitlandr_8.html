<div class="container">

<table style="width: 100%;"><tr>
<td>fit_2d_vf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a 2D vector field</h2>

<h3>Description</h3>

<p>Estimate a 2D vector field from intensive longitudinal data. Two methods can be used: Multivariate Vector Field Kernel Estimator (MVKE, using <code>MVKE()</code>), or Sparse Vector Field Consensus (SparseVFC, using <code>SparseVFC::SparseVFC()</code>). Note that the input data are automatically normalized before being sent to the estimation engines to make sure the default parameter settings are close to the optimal. Therefore, you do not need to scale up or down the parameters of <code>MVKE()</code> or <code>SparseVFC::SparseVFC()</code>. We suggest the MVKE method to be used for psychological data because it has more realistic assumptions and produces more reasonable output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_2d_vf(
  data,
  x,
  y,
  lims,
  n = 20,
  vector_position = "start",
  na_action = "omit_data_points",
  method = c("MVKE", "MVKE"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data set used for estimating the vector field.
Should be a data frame or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Characters to indicate the name of the two variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lims</code></td>
<td>
<p>The limits of the range for the vector field estimation as <code style="white-space: pre;">⁠c(&lt;xl&gt;, &lt;xu&gt;, &lt;yl&gt;, &lt;yu&gt;)⁠</code>. If missing, the range of the data extended by 10% for both sides will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of equally spaced points in each axis, at which the vectors are to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector_position</code></td>
<td>
<p>Only useful if <code>method == "VFC"</code>. One of "start", "middle", or "end", representing the position of the vectors. If "start", for example, the starting point of a vector is regarded as the position of the vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_action</code></td>
<td>
<p>One of "omit_data_points" or "omit_vectors". If using "omit_data_points", then only the <code>NA</code> points are omitted, and the points before and after an <code>NA</code> will form a vector. If using "omit_vectors", then the vectors will be omitted if either of its points is <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of "MVKE" or "VFC".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed to <code>MVKE()</code> or <code>SparseVFC::SparseVFC()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>vectorfield</code> object.
</p>


<h3>See Also</h3>

<p><code>plot.vectorfield()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data
single_output_grad &lt;- simlandr::sim_fun_grad(length = 200, seed = 1614)
# fit the vector field
v2 &lt;- fit_2d_vf(single_output_grad, x = "x", y = "y", method = "MVKE")
plot(v2)
</code></pre>


</div>