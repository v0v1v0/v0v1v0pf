<div class="container">

<table style="width: 100%;"><tr>
<td>fregre.gls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Functional Linear Model Using Generalized Least Squares</h2>

<h3>Description</h3>

<p>This function fits a functional linear model using generalized least
squares. The errors are allowed to be correlated and/or have unequal
variances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fregre.gls(
  formula,
  data,
  correlation = NULL,
  basis.x = NULL,
  basis.b = NULL,
  rn,
  lambda,
  weights = NULL,
  subset,
  method = c("REML", "ML"),
  control = list(),
  verbose = FALSE,
  criteria = "GCCV1",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a two-sided linear formula object describing the model, with
the response on the left of a <code>~</code> operator and the terms, separated by
<code>+</code> operators, on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables named in
<code>model</code>, <code>correlation</code>, <code>weights</code>, and <code>subset</code>. By
default the variables are taken from the environment from which <code>gls</code>
is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional <code>corStruct</code> object describing the
within-group correlation structure. See the documentation of
<code>corClasses</code> for a description of the available <code>corStruct</code>
classes. If a grouping variable is to be used, it must be specified in the
<code>form</code> argument to the <code>corStruct</code> constructor. Defaults to
<code>NULL</code>, corresponding to uncorrelated errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.x</code></td>
<td>
<p>List of basis for functional explanatory data estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.b</code></td>
<td>
<p>List of basis for <code class="reqn">\beta(t)</code> parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rn</code></td>
<td>
<p>List of Ridge parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>List of Roughness penalty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as a
formula, it is used as the argument to <code>varFixed</code>, corresponding
to fixed variance weights. See the documentation on <code>varClasses</code>
for a description of the available <code>varFunc</code> classes. Defaults
to <code>NULL</code>, corresponding to homoscedastic errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating which subset of the rows of
<code>data</code> should be used in the fit. This can be a logical vector, or a
numeric vector indicating which observation numbers are to be included, or a
character vector of the row names to be included.  All observations are
included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the log-likelihood
is maximized.  Defaults to <code>"REML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to
replace the default values returned by the function
<code>glsControl</code>.  Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an optional logical value. If <code>TRUE</code> information on the
evolution of the iterative algorithm is printed. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>GCCV criteria, see <code>GCCV.S</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for this generic require additional arguments.
None are used in this methodl.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>"gls"</code> representing the functional linear
model fit. Generic functions such as <code>print</code>, <code>plot</code>, and
<code>summary</code> have methods to show the results of the fit.<br> 
See <code>glsObject</code> for the components of the fit. The functions
<code>resid</code>, <code>coef</code> and <code>fitted</code>, can be
used to extract some of its components.<br> 
Beside, the class(z) is "gls", "lm" and "fregre.lm" with the following
objects: 
</p>

<ul>
<li> <p><code>sr2:</code> Residual variance. 
</p>
</li>
<li> <p><code>Vp:</code> Estimated covariance matrix for the parameters. 
</p>
</li>
<li> <p><code>lambda:</code> A roughness penalty.
</p>
</li>
<li> <p><code>basis.x:</code> Basis used for <code>fdata</code> or <code>fd</code> covariates.
</p>
</li>
<li> <p><code>basis.b:</code> Basis used for beta parameter estimation. 
</p>
</li>
<li> <p><code>beta.l:</code> List of estimated beta parameter of functional covariates. 
</p>
</li>
<li> <p><code>data:</code> List that containing the variables in the model. 
</p>
</li>
<li> <p><code>formula:</code> formula used in ajusted model. 
</p>
</li>
<li> <p><code>formula.ini:</code> formula in call.
</p>
</li>
<li> <p><code>W:</code> inverse of covariance matrix 
</p>
</li>
<li> <p><code>correlation:</code> See glsObject for the components of the fit. 
</p>
</li>
</ul>
<h3>References</h3>

<p>Oviedo de la Fuente, M., Febrero-Bande, M., Pilar Munoz, and
Dominguez, A.  (2018). Predicting seasonal influenza transmission using 
functional regression models with temporal dependence. PloS one, 13(4), e0194250.
<a href="https://doi.org/10.1371/journal.pone.0194250">doi:10.1371/journal.pone.0194250</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
data(tecator)
x=tecator$absorp.fdata
x.d2&lt;-fdata.deriv(x,nderiv=)
tt&lt;-x[["argvals"]]
dataf=as.data.frame(tecator$y)

# plot the response
plot(ts(tecator$y$Fat))

nbasis.x=11;nbasis.b=7
basis1=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.x)
basis2=create.bspline.basis(rangeval=range(tt),nbasis=nbasis.b)
basis.x=list("x.d2"=basis1)
basis.b=list("x.d2"=basis2)
ldata=list("df"=dataf,"x.d2"=x.d2)
res.gls=fregre.gls(Fat~x.d2,data=ldata, correlation=corAR1(),
                   basis.x=basis.x,basis.b=basis.b)
summary(res.gls)                   

## End(Not run)
</code></pre>


</div>