<div class="container">

<table style="width: 100%;"><tr>
<td>phenology_thermal_time</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction of phenological stages using a thermal time model</h2>

<h3>Description</h3>

<p>The function predicts phenological phases for a climate series
using a certain starting date and forcing heat requirements data.
The thermal time model used in the function considers that
only heat accumulated from a set date to a given sum explain the
date of occurrence of the phenological stage (i.e, it assumes that
dormancy release occurs before that date). The function is independent
of the method used to calculate forcing heat, so that forcing heat can
be supplied either as GDD or GDH. The function allows predicting several
stages (or the same for different cultivars), by supplying
a dataframe in which each row contains the day for starting forcing
and heat requirements for a phenological stage.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phenology_thermal_time(GD_day, Reqs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>GD_day</code></td>
<td>
<p>a dataframe with daily forcing accumulation. It
must contain the columns Year, Month, Day, DOY, GD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reqs</code></td>
<td>
<p>a dataframe in which each row contains the start date
for forcing and the heat requirements of one phenological stage. 
It must contain the columns Dreq (the start date) and Freq (the forcing 
heat requirements).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>dataframe with the predicted dates of occurrence of each phenological 
stage defined in Reqs. Columns are Dreq and Freq (start date and forcing heat 
requirements for the phenological stage), Season, Dreq_Year and Dreq_DOY 
(year and day of the year in which forcing begins), Freq_Year and Freq_DOY 
(year and day of the year of occurrence the phenological stage).
</p>


<h3>Author(s)</h3>

<p>Carlos Miranda, <a href="mailto:carlos.miranda@unavarra.es">carlos.miranda@unavarra.es</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Calculate GDD values from a climate dataset with daily temperature data,
# using a base temperature of 0 C and format it to be compatible with 
# phenology_thermal_time
library(magrittr)
library(dplyr)
library(lubridate)
Tudela_GDD &lt;- GDD_linear(Tudela_DW,0) %&gt;% rename(GD=GDD)
# Create a dataframe with start dates and forcing requirements for
# bloom and veraison in the GFV model for 'Chardonnay' (Parker et al, 
# 2013, Agric Forest Meteorol 180:249-264) in the format required for 
# the function
Dreq &lt;- c(60,60) 
Freq &lt;- c(1217,2547)
Chardonnay_reqs &lt;- as.data.frame(cbind(Dreq,Freq))
# Obtain the predicted dates 
Phenology_Chardonnay &lt;- phenology_thermal_time(Tudela_GDD,Chardonnay_reqs)

</code></pre>


</div>