<div class="container">

<table style="width: 100%;"><tr>
<td>cov.weighted</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted covariance matrices</h2>

<h3>Description</h3>

<p>Returns a list containing estimates of the weighted mean and covariance matrix
of the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cov.weighted(x, weights = rep(1, nrow(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame. As usual, rows are observations and columns are
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a non-negative and non-zero vector of weights for each
observation. Its length must equal the number of rows of <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The covariance matrix is divided by the number of observations, which arise for
instance, when we use the class of elliptical contoured distributions. Thus,
</p>
<p style="text-align: center;"><code class="reqn">W_n = \sum\limits_{i=1}^n w_i, \qquad \overline{\bold{x}}_n = \frac{1}{W_n} 
    \sum\limits_{i=1}^n w_i\bold{x}_i \qquad \bold{S}_n = \frac{1}{n} \sum\limits_{i=1}^n 
    w_i (\bold{x}_i - \overline{\bold{x}}_n)(\bold{x}_i - \overline{\bold{x}}_n)^T.</code>
</p>

<p>This differs from the behaviour of function <code>cov.wt</code>. 
</p>


<h3>Value</h3>

<p>A list containing the following named components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>an estimate for the center (mean) of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>the estimated (weighted) covariance matrix.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Clarke, M.R.B. (1971).
Algorithm AS 41: Updating the sample mean and dispersion matrix.
<em>Applied Statistics</em> <b>20</b>, 206-209.
</p>


<h3>See Also</h3>

<p><code>cov.wt</code>, <code>cov</code> and <code>var</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- cbind(1:10, c(1:3, 8:5, 8:10))
z0 &lt;- cov.weighted(x) # all weights are 1
D2 &lt;- Mahalanobis(x, center = z0$mean, cov = z0$cov)
p &lt;- ncol(x)
wts &lt;- (p + 1) / (1 + D2) # nice weights!
z1 &lt;- cov.weighted(x, weights = wts)
z1
</code></pre>


</div>