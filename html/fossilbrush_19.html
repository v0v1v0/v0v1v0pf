<div class="container">

<table style="width: 100%;"><tr>
<td>pacmacro_ranges</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>pacmacro_ranges</h2>

<h3>Description</h3>

<p>Function to apply a modification of Pacman trimming to
macrofossil data. The function generates a densified
occurrence record using the same methods as <code>densify</code>
then trim the upper and lower ranges by a user-defined
percentage. The full and trimmed ranges are then
compared against each other to test if the FAD and the
LAD for a taxon form a long tail in its distribution.
Multiple tail thresholds can be supplied, but all test
to see if the sum of the FAD and LAD which exceeds the
trimmed range constitute the threshold proportion of the
total range for than taxon, e.g. does the FAD and the
LAD outside of the trimmed range comprise a quarter
(<code>tail.flag = 0.25</code>) of the taxon range?
</p>


<h3>Usage</h3>

<pre><code class="language-R">pacmacro_ranges(
  x,
  rank = "genus",
  srt = "max_ma",
  end = "min_ma",
  step = 1,
  density = 0.1,
  top = 5,
  bottom = 5,
  tail.flag = 0.35,
  method = c("histogram", "kernel")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A stratigraphic occurrence dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>The column name in x containing the taxon
names for which trimmed ranges will be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srt</code></td>
<td>
<p>A column name in x denoting the occurrence FADs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>A column name in x denoting the occurrence LADs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>A positive integer specifying the time window size
(i.e. the duration represented by each row in the output matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>A positive numeric specifying the step size for
densifying records. This should ideally be smaller than step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top</code></td>
<td>
<p>The percentage by which the top of the range will
be trimmed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom</code></td>
<td>
<p>The percentage by which the bottom of the range
will be trimmed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail.flag</code></td>
<td>
<p>a numeric vector of proportions in the range
0 &gt; x &gt; 1 which will be used to test for long tails</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for quantifying occurrence density. By
default both histogram and kernel density will be used</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the user specifies a specific method (e.g. method = "kernel"),
the returned value will be a data.frame containing the taxa as row names,
the original taxon ranges (FAD, LAD), their ranges as trimmed by the
specified value (default FAD95, LAD95), and the tail status (0 = none, 1 = tail)
at the user-specified tail proportions. If method is not specified, the result
will be a list of 2 data.frames, one for each method
</p>


<h3>Source</h3>

<p>Pacman procedure modified from https://rdrr.io/github/plannapus/CONOP9companion/src/R/pacman.R.
</p>


<h3>References</h3>

<p>Lazarus et al (2012) Paleobiology
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load dataset
data("brachios")
# subsample brachios to make for a short example runtime
set.seed(1)
brachios &lt;- brachios[sample(1:nrow(brachios), 1000),]
# run pacmacro
pacm &lt;- pacmacro_ranges(brachios, tail.flag = c(0.3, 0.35, 0.4),
                        rank = "genus", srt = "max_ma", end = "min_ma")
</code></pre>


</div>