<div class="container">

<table style="width: 100%;"><tr>
<td>ridge</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ridge regression</h2>

<h3>Description</h3>

<p>Fit a linear model by ridge regression, returning an object of class <code>"ridge"</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ridge(formula, data, subset, lambda = 1.0, method = "GCV", ngrid = 200, tol = 1e-07,
  maxiter = 50, na.action, x = FALSE, y = FALSE, contrasts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> an object of class <code>"formula"</code> (or one that
can be coerced to that class): a symbolic description of the model to
be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> an optional data frame, list or environment (or object coercible
by <code>as.data.frame</code> to a data frame) containing the variables in
the model. If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which <code>ridge</code>
is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p> an optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> a function which indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> setting of
<code>options</code>, and is <code>na.fail</code> if that is unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p> a scalar or vector of ridge constants. A value of 0 corresponds
to ordinary least squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> the method for choosing the ridge parameter lambda. If <code>method = "none"</code>,
then lambda is 'fixed'. If <code>method = "GCV"</code> (the default) then the ridge
parameter is chosen automatically using the generalized cross validation (GCV) criterion.
For <code>method = "grid"</code>, optimal value of lambda is selected computing the GCV
criterion over a grid. If <code>method = "MSE"</code> the optimal ridge parameter is selected
minimizing the mean squared estimation error criterion, this is the <code>ORPS1</code>
subroutine by Lee (1987).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>number of elements in the grid used to compute the GCV criterion.
Only required if <code>method = "grid"</code> and <code>lambda</code> is a scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> tolerance for the optimization of the GCV criterion. Default is <code>1e-7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p> maximum number of iterations. The default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p> logicals.  If <code>TRUE</code> the corresponding components of
the fit (the model matrix, the response) are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p> an optional list. See the <code>contrasts.arg</code> of
<code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments to be passed to the low level regression
fitting functions (not implemented).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>ridge</code> function fits in linear ridge regression <b>without</b> scaling or centering
the regressors and the response. In addition, If an intercept is present in the model, its
coefficient is penalized.)
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p> dimensions of model matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p> a named vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> a named vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p> the fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RSS</code></td>
<td>
<p> the residual sum of squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edf</code></td>
<td>
<p> the effective number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GCV</code></td>
<td>
<p> vector (if <code>method = "grid"</code>) of GCV values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HKB</code></td>
<td>
<p> HKB estimate of the ridge constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LW</code></td>
<td>
<p> LW estimate of the ridge constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p> vector (if <code>method = "grid"</code>) of lambda values; otherwise, for
methods <code>method = "none"</code>, <code>"GCV"</code> or <code>"MSE"</code>, the value of ridge
parameter used by the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal</code></td>
<td>
<p> value of lambda with the minimum GCV (only relevant if <code>method = "grid"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p> number of iterations performed by the algorithm (only relevant if <code>method = "MSE"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p> the <code>terms</code> object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p> (only where relevant) the contrasts used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> if requested, the response used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> if requested, the model matrix used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> if requested, the model frame used.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Golub, G.H., Heath, M., Wahba, G. (1979).
Generalized cross-validation as a method for choosing a good ridge parameter.
<em>Technometrics</em> <b>21</b>, 215-223.
</p>
<p>Hoerl, A.E., Kennard, R.W., Baldwin, K.F. (1975).
Ridge regression: Some simulations.
<em>Communication in Statistics</em> <b>4</b>, 105-123.
</p>
<p>Hoerl, A.E., Kennard, R.W. (1970).
Ridge regression: Biased estimation of nonorthogonal problems.
<em>Technometrics</em> <b>12</b>, 55-67.
</p>
<p>Lawless, J.F., Wang, P. (1976).
A simulation study of ridge and other regression estimators.
<em>Communications in Statistics</em> <b>5</b>, 307-323.
</p>
<p>Lee, T.S (1987).
Algorithm AS 223: Optimum ridge parameter selection.
<em>Applied Statistics</em> <b>36</b>, 112-118.
</p>


<h3>See Also</h3>

<p><code>lm</code>, <code>ols</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">z &lt;- ridge(GNP.deflator ~ ., data = longley, lambda = 4, method = "grid")
z # ridge regression on a grid over seq(0, 4, length = 200)

z &lt;- ridge(GNP.deflator ~ ., data = longley)
z # ridge parameter selected using GCV (default)
</code></pre>


</div>