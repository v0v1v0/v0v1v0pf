<div class="container">

<table style="width: 100%;"><tr>
<td>sync_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time Series Trend Synchronicity Test</h2>

<h3>Description</h3>

<p>Nonparametric test for synchronicity of parametric trends in multiple time series
(Lyubchich and Gel 2016).
The method tests whether <code class="reqn">N</code> observed time series exhibit the same trend
of some pre-specified smooth parametric form.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sync_test(
  formula,
  B = 1000,
  Window = NULL,
  q = NULL,
  j = NULL,
  ar.order = NULL,
  ar.method = "HVK",
  ic = "BIC"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>",
specifying the form of the common parametric time trend to be tested
in a <code class="reqn">T</code> by <code class="reqn">N</code> matrix of time series
(time series in columns). Variable <code class="reqn">t</code> should be used to specify the form of
the trend, where <code class="reqn">t</code> is specified within the function as a regular sequence
on the interval (0,1]. See ‘Examples’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap simulations to obtain empirical critical values.
Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Window</code></td>
<td>
<p>scalar or <code class="reqn">N</code>-vector with lengths of the local windows (factors).
If only one value is set, the same <code>Window</code> is applied to each time series.
An <code class="reqn">N</code>-vector gives a specific window for each time series.
If <code>Window</code> is not specified, an automatic algorithm for optimal
window selection is applied as a default option (see ‘Details’).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>scalar from 0 to 1 to define the set of possible windows <code>T*q^j</code>
and to automatically select an optimal window for each time series.
Default is <code class="reqn">3/4</code>. This argument is ignored if the <code>Window</code> is set by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>numeric vector to define the set of possible windows <code>T*q^j</code>
and to automatically select an optimal window for each time series.
Default is <code>c(8:11)</code>. This argument is ignored if the <code>Window</code> is set by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.order</code></td>
<td>
<p>order of the autoregressive filter when <code>ic = "none"</code>,
or the maximal order for IC-based filtering. Default is <code>round(10*log10(T))</code>.
The <code>ar.order</code> can be a scalar or <code class="reqn">N</code>-vector. If scalar, the same
<code>ar.order</code> is applied to each time series. An <code class="reqn">N</code>-vector specifies
a separate <code>ar.order</code> for each time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.method</code></td>
<td>
<p>method of estimating autoregression coefficients.
Default <code>"HVK"</code> delivers robust difference-based estimates by
Hall and Van Keilegom (2003). Alternatively,
options of <code>ar</code> function can be used, such as <code>"burg"</code>,
<code>"ols"</code>, <code>"mle"</code>, and <code>"yw"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>information criterion used to select the order of autoregressive filter (AIC of BIC),
considering models of orders <code class="reqn">p=</code> 0,1,...,<code>ar.order</code>.
If <code>ic = "none"</code>, the AR(<code class="reqn">p</code>) model with <code class="reqn">p=</code> <code>ar.order</code> is used,
without order selection.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Arguments <code>Window</code>, <code>j</code>, and <code>q</code> are used to set windows
for the local regression. Current version of the function assumes two options:
(1) user specifies one fixed window for each time series using the argument
<code>Window</code> (if <code>Window</code> is set, <code>j</code> and <code>q</code> are ignored),
and (2) user specifies a set of windows by <code>j</code> and <code>q</code> to apply
this set to each time series and to select an optimal window using a heuristic
<code class="reqn">m</code>-out-of-<code class="reqn">n</code> subsampling algorithm (Bickel and Sakov 2008).
The option of selecting windows automatically for some of the time series,
while for other time series the window is fixed, is not available yet.
If none of these three arguments is set, default <code>j</code> and <code>q</code> are used.
Values <code>T*q^j</code> are mapped to the largest previous integer, then only
those greater than 2 are used.
</p>
<p>See more details in Lyubchich and Gel (2016)
and Lyubchich (2016).
</p>


<h3>Value</h3>

<p>A list of class <code>"htest"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>name of the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>name of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p><code class="reqn">p</code>-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>list with elements <code>common_trend_estimates</code>,
<code>ar_order_used</code>, <code>Window_used</code>, <code>wavk_obs</code>, and
<code>all_considered_windows</code>. The latter is a table with bootstrap and
asymptotic test results for all considered windows, that is, without adaptive
selection of the local window.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yulia R. Gel, Vyacheslav Lyubchich, Ethan Schaeffer, Xingyu Wang
</p>


<h3>References</h3>

<p>Bickel PJ, Sakov A (2008).
“On the choice of <code class="reqn">m</code> in the <code class="reqn">m</code> out of <code class="reqn">n</code> bootstrap and confidence bounds for extrema.”
<em>Statistica Sinica</em>, <b>18</b>(3), 967–985.<br><br> Hall P, Van Keilegom I (2003).
“Using difference-based methods for inference in nonparametric regression with time series errors.”
<em>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</em>, <b>65</b>(2), 443–456.
<a href="https://doi.org/10.1111/1467-9868.00395">doi:10.1111/1467-9868.00395</a>.<br><br> Lyubchich V (2016).
“Detecting time series trends and their synchronization in climate data.”
<em>Intelligence. Innovations. Investments</em>, <b>12</b>, 132–137.<br><br> Lyubchich V, Gel YR (2016).
“A local factor nonparametric test for trend synchronism in multiple time series.”
<em>Journal of Multivariate Analysis</em>, <b>150</b>, 91–104.
<a href="https://doi.org/10.1016/j.jmva.2016.05.004">doi:10.1016/j.jmva.2016.05.004</a>.
</p>


<h3>See Also</h3>

<p><code>ar</code>, <code>HVK</code>, <code>WAVK</code>,
<code>wavk_test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Fix seed for reproducible simulations:
set.seed(1)

# Simulate two autoregressive time series of length n without trend
#(i.e., with zero or constant trend)
# and arrange the series into a matrix:
n &lt;- 200
y1 &lt;- arima.sim(n = n, list(order = c(1, 0, 0), ar = c(0.6)))
y2 &lt;- arima.sim(n = n, list(order = c(1, 0, 0), ar = c(-0.2)))
Y &lt;- cbind(y1, y2)
plot.ts(Y)


#Test H0 of a common linear trend:
## Not run: 
    sync_test(Y ~ t, B = 500)

## End(Not run)
# Sample output:
##	Nonparametric test for synchronism of parametric trends
##
##data:  Y
##Test statistic = -0.0028999, p-value = 0.7
##alternative hypothesis: common trend is not of the form Y ~ t.
##sample estimates:
##$common_trend_estimates
##               Estimate Std. Error    t value  Pr(&gt;|t|)
##(Intercept) -0.02472566  0.1014069 -0.2438261 0.8076179
##t            0.04920529  0.1749859  0.2811958 0.7788539
##
##$ar.order_used
##         y1 y2
##ar.order  1  1
##
##$Window_used
##       y1 y2
##Window 15  8
##
##$all_considered_windows
## Window    Statistic p-value Asympt. p-value
##      8 -0.000384583   0.728       0.9967082
##     11 -0.024994408   0.860       0.7886005
##     15 -0.047030164   0.976       0.6138976
##     20 -0.015078579   0.668       0.8714980
##
##$wavk_obs
##[1]  0.05827148 -0.06117136

# Add a time series y3 with a different linear trend and re-apply the test:
y3 &lt;- 1 + 3*((1:n)/n) + arima.sim(n = n, list(order = c(1, 0, 0), ar = c(-0.2)))
Y2 &lt;- cbind(Y, y3)
plot.ts(Y2)
## Not run: 
    sync_test(Y2 ~ t, B = 500)
## End(Not run)
# Sample output:
##	Nonparametric test for synchronism of parametric trends
##
##data:  Y2
##Test statistic = 0.48579, p-value &lt; 2.2e-16
##alternative hypothesis: common trend is not of the form Y2 ~ t.
##sample estimates:
##$common_trend_estimates
##              Estimate Std. Error  t value     Pr(&gt;|t|)
##(Intercept) -0.3632963 0.07932649 -4.57976 8.219360e-06
##t            0.7229777 0.13688429  5.28167 3.356552e-07
##
##$ar.order_used
##         Y.y1 Y.y2 y3
##ar.order    1    1  0
##
##$Window_used
##       Y.y1 Y.y2 y3
##Window    8   11  8
##
##$all_considered_windows
## Window Statistic p-value Asympt. p-value
##      8 0.4930069       0    1.207378e-05
##     11 0.5637067       0    5.620248e-07
##     15 0.6369703       0    1.566057e-08
##     20 0.7431621       0    4.201484e-11
##
##$wavk_obs
##[1]  0.08941797 -0.07985614  0.34672734

#Other hypothesized trend forms can be specified, for example:
## Not run: 
    sync_test(Y ~ 1) #constant trend
    sync_test(Y ~ poly(t, 2)) #quadratic trend
    sync_test(Y ~ poly(t, 3)) #cubic trend

## End(Not run)

</code></pre>


</div>