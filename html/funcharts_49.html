<div class="container">

<table style="width: 100%;"><tr>
<td>RoMFCC_PhaseII</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Multivariate Functional Control Charts - Phase II</h2>

<h3>Description</h3>

<p>It calculates the Hotelling's and SPE monitoring statistics
needed to plot the Robust Multivariate Functional Control Chart in Phase II.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RoMFCC_PhaseII(mfdobj_new, mod_phase1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mfdobj_new</code></td>
<td>
<p>A multivariate functional data object of class mfd, containing the
Phase II observations to be monitored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_phase1</code></td>
<td>
<p>Output obtained by applying the function <code>RoMFCC_PhaseI</code>
to perform Phase I. See <code>RoMFCC_PhaseI</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> with as many rows as the number of
multivariate functional observations in the phase II data set and
the following columns:
</p>

<ul>
<li>
<p> one <code>id</code> column identifying the multivariate functional observation
in the phase II data set,
</p>
</li>
<li>
<p> one <code>T2</code> column containing the Hotelling T2 statistic
calculated for all observations,
</p>
</li>
<li>
<p> one column per each functional variable,
containing its contribution to the T2 statistic,
</p>
</li>
<li>
<p> one <code>spe</code> column containing the SPE statistic calculated
for all observations,
</p>
</li>
<li> <p><code>T2_lim</code> gives the upper control limit of
the Hotelling's T2 control chart,
</p>
</li>
<li> <p><code>spe_lim</code> gives the upper control limit of the SPE control chart
</p>
</li>
</ul>
<h3>References</h3>

<p>Capezza, C., Centofanti, F., Lepore, A., Palumbo, B. (2024)
Robust Multivariate Functional Control Charts.
<em>Technometrics</em>, <a href="doi:10.1080/00401706.2024.2327346">doi:10.1080/00401706.2024.2327346</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(funcharts)
mfdobj &lt;- get_mfd_list(air, n_basis = 5)
nobs &lt;- dim(mfdobj$coefs)[2]
set.seed(0)
ids &lt;- sample(1:nobs)
mfdobj1 &lt;- mfdobj[ids[1:100]]
mfdobj_tuning &lt;- mfdobj[ids[101:300]]
mfdobj2 &lt;- mfdobj[ids[-(1:300)]]
mod_phase1 &lt;- RoMFCC_PhaseI(mfdobj = mfdobj1,
                            mfdobj_tuning = mfdobj_tuning)
phase2 &lt;- RoMFCC_PhaseII(mfdobj_new = mfdobj2,
                         mod_phase1 = mod_phase1)
plot_control_charts(phase2)

## End(Not run)
</code></pre>


</div>