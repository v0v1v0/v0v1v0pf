<div class="container">

<table style="width: 100%;"><tr>
<td>utils-adapt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Integrator for multivariate distributions</h2>

<h3>Description</h3>

<p>The function is for adaptive quadrature. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">adapt(ndim, lower, upper, functn, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
   
<p>the dimension of the integral. By default NUll, no longer
used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>

<p>vector of at least length <code>ndim</code> of the lower bounds 
on the integral.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
	
<p>vector of at least length <code>ndim</code> of the upper bounds 
on the integral.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functn</code></td>
<td>
	
<p>an R function which should take a single vector argument and 
possibly some parameters and return the function value at 
that point. <code>functn</code> must return a single numeric value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
	
<p>other parameters to be passed to the underlying function.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned value is a list of three items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>integral</code></td>
<td>
   
<p>the value of the integral.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
 
<p>the estimated relative error.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functionEvaluations</code></td>
<td>
 
<p>the number of times the function was evaluated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnCode</code></td>
<td>
 
<p>the actual integer return code of the C routine.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>In 2007 the package <code>adapt</code> was removed from the CRAN 
repository, due to unclear license conditions. Nevertheless,
formerly available versions can still be obtained from the CRAN 
<a href="https://cran.r-project.org/package=adapt">archive</a>.
Package <code>adapt</code> used FORTRAN code from Professor Genz.
</p>
<p>From 2007 until 2013 the package <code>fMultivar</code> used an builtin
licensed by Professor Genz to Rmetrics. This version is still 
available in the current package, have a look into the folder 
<code>deprecated</code>.
</p>
<p>2013 the contributed package <code>cubature</code> was added to the CRAN
repository. This provides an alternative n-dimensional integration 
routine. We recommend to use the function <code>adaptIntegrate</code> 
directly from the package <code>cubature</code> which allows adaptive 
multivariate integration over hypercubes. It is a wrapper around 
the pure C, GPLed implementation by Steven G. Johnson.
</p>
<p>Since 2014 <code>fMultivar</code> uses also the C Version based 
implementation of Johnson. The former function <code>adapt</code>
has been replaced by a wrapper function calling <code>adaptIntegrate</code>.
The arguments <code>ndim</code>, <code>lower</code>, <code>upper</code>, and
<code>functn</code> have been remeined the same, control parameters have
been adapted to the function <code>cubature::adaptIntegrate</code>.
</p>


<h3>Author(s)</h3>

<p>Balasubramanian Narasimhan
</p>


<h3>References</h3>

<p>See: http://ab-initio.mit.edu/wiki/index.php/Cubature.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Check that dnorm2d is normalized:
  
   # Normal Density:
   density &lt;- function(x) dnorm2d(x=x[1], y = x[2])
      
   # Calling Cubature:
   BIG &lt;- c(99, 99)
   cubature::adaptIntegrate(f=density, lowerLimit=-BIG, upperLimit=BIG)
   cubature::adaptIntegrate(f=density, low=-BIG, upp=BIG, tol=1e-7)
    
   # Using the Wrapper:
   adapt(lower=-BIG, upper=BIG, functn=density) 
   adapt(lower=-BIG, upper=BIG, functn=density, tol=1e-7)$integral

</code></pre>


</div>