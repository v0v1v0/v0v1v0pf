<div class="container">

<table style="width: 100%;"><tr>
<td>multifabCIhom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multigroup FAB t-intervals for the homoscedastic model</h2>

<h3>Description</h3>

<p>Computation of 1-alpha FAB t-intervals for homoscedastic 
multigroup data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multifabCIhom(y, g, alpha = 0.05, prop = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a group membership vector, of the same length as y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the type I error rate, so 1-alpha is the coverage rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>the proportion of groups to obtain the sample variance estimate</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each group j, this function computes an estimate of 
the parameters in a hierarchical model for means 
using data from other groups, and uses this information to 
construct a FAB t-interval for group j. These intervals have 
1-alpha frequentist coverage, assuming within-group normality and that
the within group variance is the same across groups.
</p>


<h3>Author(s)</h3>

<p>Chaoyu Yu
</p>


<h3>Examples</h3>

<pre><code class="language-R">## -- simulate the data
mu = 0; sigma2 = 10; tau2 = 1; p =100; 
theta = rnorm(p,mu,sqrt(tau2))
ns = round(runif(p,2,18))
Y=c()
for(i in 1:p){
 d2 = rnorm(ns[i],theta[i],sqrt(sigma2))
 d1 = rep(i,ns[i])
 d = cbind(d1,d2)
 Y = rbind(Y,d)}
y = Y[,2]
g = Y[,1]

## -- FAB t-intervals
FCI = multifabCIhom(y,g)  

## -- UMAU t-intervals 
ybar&lt;-tapply(y,g,mean) ; ssd&lt;-tapply(y,g,sd) ; n&lt;-table(g) 
qtn&lt;-cbind( qt(.025,n-1),  qt(.975,n-1) ) 
UCI&lt;-sweep(sweep(qtn,1,ssd/sqrt(n),"*"),1,ybar,"+") 

mean( (UCI[,2]-UCI[,1])/(FCI[,2]-FCI[,1]) , na.rm=TRUE)


</code></pre>


</div>