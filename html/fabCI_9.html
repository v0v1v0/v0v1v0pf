<div class="container">

<table style="width: 100%;"><tr>
<td>multifabCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multigroup FAB t-intervals</h2>

<h3>Description</h3>

<p>Computation of 1-alpha FAB t-intervals for heteroscedastic
multigroup data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multifabCI(y, g, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a group membership vector, of the same length as y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the type I error rate, so 1-alpha is the coverage rate</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each group j, this function computes an estimate of 
the parameters in a hierarchical model for means and variances
from data other than group j, and uses this information to 
construct a FAB t-interval for group j. These intervals have 
1-alpha frequentist coverage, assuming within-group normality.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class="language-R">## -- simulated data
p&lt;-10 ; n&lt;-10
y&lt;-rnorm(n*p) ; g&lt;-rep(1:p,n) 

## -- more interesting data takes longer 
# data(radon) ; y&lt;-radon[,2] ; g&lt;-radon[,1] 

## -- FAB t-intervals
FCI&lt;-multifabCI(y,g) 

## -- UMAU t-intervals 
ybar&lt;-tapply(y,g,mean) ; ssd&lt;-tapply(y,g,sd) ; n&lt;-table(g) 
qtn&lt;-cbind( qt(.025,n-1),  qt(.975,n-1) ) 
UCI&lt;-sweep(sweep(qtn,1,ssd/sqrt(n),"*"),1,ybar,"+") 

mean( (UCI[,2]-UCI[,1])/(FCI[,2]-FCI[,1]) , na.rm=TRUE)

</code></pre>


</div>