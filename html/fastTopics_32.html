<div class="container">

<table style="width: 100%;"><tr>
<td>predict.poisson_nmf_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict Methods for Poisson NMF and Multinomial Topic Model</h2>

<h3>Description</h3>

<p>Predict loadings based on previously fit Poisson NMF,
or predict topic proportions based on previously fit multinomial
topic model. This can be thought of as projecting data points onto
a previously estimated set of factors <code>fit$F</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'poisson_nmf_fit'
predict(object, newdata, numiter = 20, ...)

## S3 method for class 'multinom_topic_model_fit'
predict(object, newdata, numiter = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class “poisson_nmf_fit” or
“multinom_topic_model_fit”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional counts matrix. If omitted, the loadings
estimated in the original data are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numiter</code></td>
<td>
<p>The number of updates to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to
<code>fit_poisson_nmf</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A loadings matrix with one row for each data point and one
column for each topic or factor. For
<code>predict.multinom_topic_model_fit</code>, the output can also be
interpreted as a matrix of estimated topic proportions, in which
<code>L[i,j]</code> is the proportional contribution of topic j to data
point i.
</p>


<h3>See Also</h3>

<p><code>fit_poisson_nmf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulate a 175 x 1,200 counts matrix.
set.seed(1)
dat &lt;- simulate_count_data(175,1200,k = 3)

# Split the data into training and test sets.
train &lt;- dat$X[1:100,]
test &lt;- dat$X[101:175,]

# Fit a Poisson non-negative matrix factorization using the
# training data.
fit &lt;- init_poisson_nmf(train,F = dat$F,init.method = "random")
fit &lt;- fit_poisson_nmf(train,fit0 = fit)

# Compare the estimated loadings in the training data against the
# loadings used to simulate these data.
Ltrain &lt;- predict(fit)
plot(dat$L[1:100,],Ltrain,pch = 20,col = "darkblue")
abline(a = 0,b = 1,col = "magenta",lty = "dotted",
       xlab = "true",ylab = "estimated")

# Next, predict loadings in unseen (test) data points, and compare
# these predictions against the loadings that were used to simulate
# the test data.
Ltest &lt;- predict(fit,test)
plot(dat$L[101:175,],Ltest,pch = 20,col = "darkblue",
     xlab = "true",ylab = "estimated")
abline(a = 0,b = 1,col = "magenta",lty = "dotted")

# Simulate a 175 x 1,200 counts matrix.
set.seed(1)
dat &lt;- simulate_multinom_gene_data(175,1200,k = 3)

# Split the data into training and test sets.
train &lt;- dat$X[1:100,]
test &lt;- dat$X[101:175,]

# Fit a topic model using the training data.
fit &lt;- init_poisson_nmf(train,F = dat$F,init.method = "random")
fit &lt;- fit_poisson_nmf(train,fit0 = fit)
fit &lt;- poisson2multinom(fit)

# Compare the estimated topic proportions in the training data against
# the topic proportions used to simulate these data.
Ltrain &lt;- predict(fit)
plot(dat$L[1:100,],Ltrain,pch = 20,col = "darkblue")
abline(a = 0,b = 1,col = "magenta",lty = "dotted",
       xlab = "true",ylab = "estimated")

# Next, predict loadings in unseen (test) data points, and compare
# these predictions against the loadings that were used to simulate
# the test data.
Ltest &lt;- predict(fit,test)
plot(dat$L[101:175,],Ltest,pch = 20,col = "darkblue",
     xlab = "true",ylab = "estimated")
abline(a = 0,b = 1,col = "magenta",lty = "dotted")


</code></pre>


</div>