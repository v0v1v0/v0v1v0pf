<div class="container">

<table style="width: 100%;"><tr>
<td>kerfon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Functional Kernel estimation </h2>

<h3>Description</h3>

<p>Modelization of <code>fdata</code> using functional kernel.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kerfon(data, x, r, hmin, hmax, na.rm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A <code>fdata</code> object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> The name of the studied variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p> Number of observations used to cross validate the model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmin</code></td>
<td>
<p> Minimal value of the bandwidth. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmax</code></td>
<td>
<p> Maximal value of the bandwidth. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p> Logical. Does the <code>n.a.</code> need to be removed. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function constructs a functional kernel model and performs the
estimation of it's bandwidth.
</p>
<p>One nonparametric way to deal with the conditional expectation
<code class="reqn">\rho(x)=\mbox{I$\!$E}\left[  X_{i}\left|  X_{i-1}=x\right.  \right]</code>, where <code class="reqn">\left(X_{i}\right)</code> is a
$H$-valued process, is to consider a predictor inspired by the
classical kernel regression, as in Nadaraja and Watson. This estimator
is defined by :
</p>
<p style="text-align: center;"><code class="reqn">\hat{\rho}_{h_{n}}(x)=\frac{\sum\limits_{i=1}^{n-1}X_{i+1}\cdot%
      K\left(\frac{\left\|  X_{i}-x\right\|  _{H}}{h_{n}}\right)%
    }{\sum\limits_{i=1}^{n-1}K\left(  \frac{\left\|  X_{i}-x\right\|%
	_{H}}{h_{n}}\right)},x\in H</code>
</p>

<p>Where K is a kernel, <code class="reqn">\left\|.\right\|  _{H}</code> is the
norm in H, and <code class="reqn">h_n</code> is the bandwidth (<code class="reqn">\in
    \mbox{I$\!$R}^+_*</code>).
</p>
<p>The function <code>kerfon</code> use the cross validation to determinate a
value for <code class="reqn">h_n</code>. This method have been chosen because of the
lack of theoretical results about this model. The parameters
<code>hmin</code> and <code>hmax</code> are used, when provided, to control the
permissible values of <code class="reqn">h_n</code>. By default, those parameters are
respectively equals to <code class="reqn">\sigma/8</code> and <code class="reqn">4*\sigma</code>, where
<code class="reqn">\sigma</code> is the estimated squared root of the variance operator of
X. To choose the value of <code class="reqn">h_n</code>, you need to provide the same
value for both <code>hmin</code> and <code>hmax</code>.
</p>
<p>During the cross-validation, considering that the fdata object
<code>x</code> contains <code class="reqn">n</code> observations, the function use the first
<code class="reqn">(n-r)</code> observations as the past values, and compute the mean
square norm of the errors on the last <code class="reqn">r</code> observations.
</p>
<p>Of course, if the model created is then used to compute prediction
through <code>predict.kerfon</code>, the whole set of observations (the
<code class="reqn">n</code> observations) are used as the past values.
</p>
<p>As <code>fdata</code> object may contains several variables, a way is
provided to select the studied variable (the function only works
with one variable for the moment).
</p>


<h3>Value</h3>

<p>A kerfon object. A method for the <code>print</code> function is
provided.
</p>
<p>For information, the object is a list with the following elements :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the bandwidth (three values : optimal, minimum, maximum)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the name of the chosen variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>the past values for <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydata</code></td>
<td>
<p>the associated values for <code>x</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> J. Damon </p>


<h3>See Also</h3>

 <p><code>predict.kerfon</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # Simulation of a FARX process
  data1 &lt;- simul.farx(m=10,n=400,base=base.simul.far(20,5),
                base.exo=base.simul.far(20,5),
                d.a=matrix(c(0.5,0),nrow=1,ncol=2),
                alpha.conj=matrix(c(0.2,0),nrow=1,ncol=2),
                d.rho=diag(c(0.45,0.90,0.34,0.45)),
                alpha=diag(c(0.5,0.23,0.018)),
                d.rho.exo=diag(c(0.45,0.90,0.34,0.45)),
                cst1=0.0)

  # Cross validation
  model1 &lt;- kerfon(data=data1, x="X", r=10, na.rm=TRUE)
  print(model1)
</code></pre>


</div>