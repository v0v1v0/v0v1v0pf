<div class="container">

<table style="width: 100%;"><tr>
<td>randomCV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross Validation of Prediction Models</h2>

<h3>Description</h3>

<p>The data set will be divided into a random train set and a test sets. The train set will be modeled by the user provided fitting 
method. Each fitting method must have a prediction function that will be used to predict the outcome of the test set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	randomCV(theData = NULL,
             theOutcome = "Class",
             fittingFunction=NULL, 
             trainFraction = 0.5,
             repetitions = 100,
             trainSampleSets=NULL,
             featureSelectionFunction=NULL,
             featureSelection.control=NULL,
             asFactor=FALSE,
             addNoise=FALSE,
             classSamplingType=c("Proportional",
                                  "Balanced",
                                  "Augmented",
                                  "LOO"),
              testingSet=NULL,
             ...
             )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theData</code></td>
<td>

<p>The data-frame for cross-validation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theOutcome</code></td>
<td>

<p>The name of the outcome
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fittingFunction</code></td>
<td>

<p>The fitting function used to model the data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainFraction</code></td>
<td>

<p>The percentage of the data to be used for training
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repetitions</code></td>
<td>

<p>The number of times that the CV process will be repeated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainSampleSets</code></td>
<td>

<p>A set of train samples
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>featureSelectionFunction</code></td>
<td>

<p>The feature selection function to be used to filter out irrelevant features
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>featureSelection.control</code></td>
<td>

<p>The parameters to control the feature selection function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asFactor</code></td>
<td>

<p>Set theOutcome as factor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addNoise</code></td>
<td>

<p>if TRUE will add 0.1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classSamplingType</code></td>
<td>

<p>if "Proportional": proportional to the data classes. 
"Augmented": Augment samples to balance training class
"Balanced": All class in training set have the same samples
"LOO": Leave one out per class
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testingSet</code></td>
<td>

<p>An extra set for testing Models
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Parameters to be passed to the fitting function
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>testPredictions</code></td>
<td>

<p>All the predicted outcomes. Is a data matrix with three columns c("Outcome","Model","Prediction"). Each row has a prediction for a given test subject
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainPredictions</code></td>
<td>

<p>All the predicted outcomes in the train data set. Is a data matrix with three columns c("Outcome","Model","Prediction"). Each row has a prediction for a given test subject
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medianTest</code></td>
<td>

<p>The median of the test prediction for each subject
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medianTrain</code></td>
<td>

<p>The median of the prediction for each train subject
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxstaTest</code></td>
<td>

<p>The statistics of the boxplot for test data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxstaTrain</code></td>
<td>

<p>The statistics of the boxplot for train data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainSamplesSets</code></td>
<td>

<p>The id of the subjects used for training
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectedFeaturesSet</code></td>
<td>

<p>A list with all the features used at each training cycle
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>featureFrequency</code></td>
<td>

<p>A order table object that describes how many times a feature was selected.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jaccard</code></td>
<td>

<p>The jaccard index of the features as well as the average number of features used for prediction
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theTimes</code></td>
<td>

<p>The CPU time analysis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.list</code></td>
<td>

<p>If fit method returns the formulas: the agregated list of formulas
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jose G. Tamez-Pena</p>


<h3>Examples</h3>

<pre><code class="language-R">	## Not run: 

        ### Cross Validation Example ####
        # Start the graphics device driver to save all plots in a pdf format
        pdf(file = "CrossValidationExample.pdf",width = 8, height = 6)

        # Get the stage C prostate cancer data from the rpart package
        data(stagec,package = "rpart")

        # Prepare the data. Create a model matrix with interactions but no event time 
        stagec$pgtime &lt;- NULL
        stagec$eet &lt;- as.factor(stagec$eet)
        options(na.action = 'na.pass')
        stagec_mat &lt;- cbind(pgstat = stagec$pgstat,
                         as.data.frame(model.matrix(pgstat ~ .*.,stagec))[-1])
        fnames &lt;- colnames(stagec_mat)
        fnames &lt;- str_replace_all(fnames,":","__")
        colnames(stagec_mat) &lt;- fnames

        # Impute the missing data
        dataCancerImputed &lt;- nearestNeighborImpute(stagec_mat)
        dataCancerImputed[,1:ncol(dataCancerImputed)] &lt;- sapply(dataCancerImputed,as.numeric)

        # Cross validating a Random Forest classifier
        cvRF &lt;- randomCV(dataCancerImputed,"pgstat",
                         randomForest::randomForest,
                         trainFraction = 0.8, 
                         repetitions = 10,
                         asFactor = TRUE);

        # Evaluate the prediction performance of the Random Forest classifier
        RFStats &lt;- predictionStats_binary(cvRF$medianTest,
        plotname = "Random Forest",cex = 0.9);

        # Cross validating a BSWiMS with the same train/test set
        cvBSWiMS &lt;- randomCV(fittingFunction = BSWiMS.model,
        	trainSampleSets = cvRF$trainSamplesSets);

        # Evaluate the prediction performance of the BSWiMS classifier
        BSWiMSStats &lt;- predictionStats_binary(cvBSWiMS$medianTest,
        	plotname = "BSWiMS",cex = 0.9);

        # Cross validating a LDA classifier with a t-student filter
        cvLDA &lt;- randomCV(dataCancerImputed,"pgstat",MASS::lda,
                          trainSampleSets = cvRF$trainSamplesSets,
                          featureSelectionFunction = univariate_tstudent,
                          featureSelection.control = list(limit = 0.5,thr = 0.975));

        # Evaluate the prediction performance of the LDA classifier
        LDAStats &lt;- predictionStats_binary(cvLDA$medianTest,plotname = "LDA",cex = 0.9);

        # Cross validating a QDA classifier with LDA t-student features and RF train/test set
        cvQDA &lt;- randomCV(fittingFunction = MASS::qda,
                          trainSampleSets = cvRF$trainSamplesSets,
                          featureSelectionFunction = cvLDA$selectedFeaturesSet);

        # Evaluate the prediction performance of the QDA classifier
        QDAStats &lt;- predictionStats_binary(cvQDA$medianTest,plotname = "QDA",cex = 0.9);

        #Create a barplot with 95
        errorciTable &lt;- rbind(RFStats$berror,
        	BSWiMSStats$berror,
        	LDAStats$berror,
        	QDAStats$berror)

        bpCI &lt;- barPlotCiError(as.matrix(errorciTable),metricname = "Balanced Error",
                        	   thesets =  c("Classifier Method"),
                        	   themethod = c("RF","BSWiMS","LDA","QDA"),
                        	   main = "Balanced Error",
                        	   offsets = c(0.5,0.15),
                        	   scoreDirection = "&lt;",
                        	   ho = 0.5,
                        	   args.legend = list(bg = "white",x = "topright"),
                        	   col = terrain.colors(4));



        dev.off()
	
## End(Not run)
</code></pre>


</div>