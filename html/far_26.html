<div class="container">

<table style="width: 100%;"><tr>
<td>predict.far</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Forecasting of FARX(1) model </h2>

<h3>Description</h3>

<p>Forecasting using FAR(1) or FARX(1) model
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'far'
predict(object, ..., newdata=NULL, label, na.rm=TRUE, positive=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> A <code>far</code> object result of the <code>far</code> function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p> A data matrix (one column for each observation) used to
predict the FAR(1) model from the values in newdata, or <code>NULL</code>
to predict one step forward with the data in <code>object</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p> A vector of character giving the dates to associate to
the predicted observations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p> Logical. Does the <code>n.a.</code> need to be removed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive</code></td>
<td>
<p> Logical. Does the result must be forced to positive values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional arguments. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes one step forward prediction for a
<code>far</code> model.
</p>
<p>Use the <code>newdata</code> option to input the past values,
and the <code>label</code> option value to define the labels for the new
observations. Notices that the output as the same length as
<code>newdata</code> in the case of a FAR model, and the length of
<code>newdata</code> minus one in the case of a FARX model. This is due to
the time shift of the exogeneous variable: <code class="reqn">X_{t+1}</code> and
<code class="reqn">Y_{t}</code> are used in the computation of
<code class="reqn">\hat{Y}_{t+1}</code>.
</p>
<p>In some special context, the user may need to suppress the
<code>na.rm</code> observations with the <code>na.rm</code> option, or force the
prediction to be positive with the <code>positive</code> option (in this
case the result will be maximum of 0 and the predicted value).
</p>


<h3>Value</h3>

<p>A <code>fdata</code> object.
</p>


<h3>Author(s)</h3>

<p> J. Damon </p>


<h3>See Also</h3>

<p><code>far</code>, <code>pred.persist</code>,
<code>predict.kerfon</code>. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Simulation of a FARX process
  data1 &lt;- simul.farx(m=10,n=400,base=base.simul.far(20,5),
                base.exo=base.simul.far(20,5),
                d.a=matrix(c(0.5,0),nrow=1,ncol=2),
                alpha.conj=matrix(c(0.2,0),nrow=1,ncol=2),
                d.rho=diag(c(0.45,0.90,0.34,0.45)),
                alpha=diag(c(0.5,0.23,0.018)),
                d.rho.exo=diag(c(0.45,0.90,0.34,0.45)),
                cst1=0.0)

  # Cross validation (joined and separate)
  model1.cv &lt;- far.cv(data=data1, y="X", x="Z", kn=8, ncv=10, cvcrit="X",
                center=FALSE, na.rm=FALSE, joined=TRUE)
  model2.cv &lt;- far.cv(data=data1, y="X", x="Z", kn=c(4,4), ncv=10, cvcrit="X",
                center=FALSE, na.rm=FALSE, joined=FALSE)
  print(model1.cv)
  print(model2.cv)
  k1 &lt;- model1.cv$minL2[1]
  k2 &lt;- model2.cv$minL2[1:2]

  # Modelization of the FARX process (joined and separate)
  model1 &lt;- far(data=data1, y="X", x="Z", kn=k1,
                center=FALSE, na.rm=FALSE, joined=TRUE)
  model2 &lt;- far(data=data1, y="X", x="Z", kn=k2,
                center=FALSE, na.rm=FALSE, joined=FALSE)

  # Predicting values
  pred1 &lt;- predict(model1,newdata=data1)
  pred2 &lt;- predict(model2,newdata=data1)
  # Persistence
  persist1 &lt;- pred.persist(select.fdata(data1,date=1:399),x="X")
  # Real values
  real1 &lt;- select.fdata(data1,date=2:400)

  errors0 &lt;- persist1[[1]]-real1[[1]]
  errors1 &lt;- pred1[[1]]-real1[[1]]
  errors2 &lt;- pred2[[1]]-real1[[1]]

  # Norm of observations
  summary(real1)
  # Persistence
  summary(as.fdata(errors0))
  # FARX models
  summary(as.fdata(errors1))
  summary(as.fdata(errors2))
</code></pre>


</div>