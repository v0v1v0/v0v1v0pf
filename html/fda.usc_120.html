<div class="container">

<table style="width: 100%;"><tr>
<td>fregre.np</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional regression with scalar response using non-parametric kernel
estimation</h2>

<h3>Description</h3>

<p>Computes functional regression between functional explanatory variables and
scalar response using kernel estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fregre.np(
  fdataobj,
  y,
  h = NULL,
  Ker = AKer.norm,
  metric = metric.lp,
  type.S = S.NW,
  par.S = list(w = 1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdataobj</code></td>
<td>
<p><code>fdata</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Scalar response with length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Bandwidth, <code>h&gt;0</code>. Default argument values are provided as the
5%â€“quantile of the distance between <code>fdataobj</code> curves, see
<code>h.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ker</code></td>
<td>
<p>Type of asymmetric kernel used, by default asymmetric normal
kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>Metric function, by default <code>metric.lp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.S</code></td>
<td>
<p>Type of smothing matrix <code>S</code>. By default <code>S</code> is
calculated by Nadaraya-Watson kernel estimator (<code>S.NW</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.S</code></td>
<td>
<p>List of parameters for <code>type.S</code>: <code>w</code>, the weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed for <code>metric.lp</code> o other
metric function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The non-parametric functional regression model can be written as follows </p>
<p style="text-align: center;"><code class="reqn">y_i =r(X_i)+\epsilon_i</code>
</p>
<p> where the unknown smooth real function <code class="reqn">r</code> is
estimated using kernel estimation by means of
</p>
<p style="text-align: center;"><code class="reqn">\hat{r}(X)=\frac{\sum_{i=1}^{n}{K(h^{-1}d(X,X_{i}))y_{i}}}{\sum_{i=1}^{n}{K(h^{-1}d(X,X_{i}))}}</code>
</p>
<p> where <code class="reqn">K</code> is an
kernel function (see <code>Ker</code> argument), <code>h</code> is the smoothing
parameter and <code class="reqn">d</code> is a metric or a semi-metric (see <code>metric</code>
argument).
</p>
<p>The distance between curves is calculated using the <code>metric.lp</code>
although any other semimetric could be used (see
<code>semimetric.basis</code> or <code>semimetric.NPFDA</code> functions).
The kernel is applied to a metric or semi-metrics that provides non-negative
values, so it is common to use asymmetric kernels. Different asymmetric
kernels can be used, see <code>Kernel.asymmetric</code>.<br></p>


<h3>Value</h3>

<p>Return:
</p>

<ul>
<li> <p>call The matched call. 
</p>
</li>
<li> <p>fitted.values Estimated scalar response. 
</p>
</li>
<li> <p>H Hat matrix. 
</p>
</li>
<li> <p>residuals <code>y</code> minus <code>fitted values</code>. 
</p>
</li>
<li> <p>df.residual The residual degrees of freedom. 
</p>
</li>
<li> <p>r2 Coefficient of determination. 
</p>
</li>
<li> <p>sr2 Residual variance. 
</p>
</li>
<li> <p>y Response. 
</p>
</li>
<li> <p>fdataobj Functional explanatory data. 
</p>
</li>
<li> <p>mdist Distance matrix between <code>x</code> and <code>newx</code>.
</p>
</li>
<li> <p>Ker Asymmetric kernel used. 
</p>
</li>
<li> <p>h.opt smoothing parameter or' bandwidth.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Ferraty, F. and Vieu, P. (2006). <em>Nonparametric functional
data analysis.</em> Springer Series in Statistics, New York. <br></p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/">https://www.jstatsoft.org/v51/i04/</a>
</p>
<p>Hardle, W. <em>Applied Nonparametric Regression</em>. Cambridge University
Press, 1994.
</p>


<h3>See Also</h3>

<p>See Also as: <code>fregre.np.cv</code>,
<code>summary.fregre.fd</code> and <code>predict.fregre.fd</code> .<br>
Alternative method: <code>fregre.basis</code>,cand <code>fregre.pc</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tecator)
absorp=tecator$absorp.fdata
ind=1:129
x=absorp[ind,]
y=tecator$y$Fat[ind]

res.np=fregre.np(x,y,Ker=AKer.epa)
summary(res.np)
res.np2=fregre.np(x,y,Ker=AKer.tri)
summary(res.np2)

# with other semimetrics.
res.pca1=fregre.np(x,y,Ker=AKer.tri,metri=semimetric.pca,q=1)
summary(res.pca1)
res.deriv=fregre.np(x,y,metri=semimetric.deriv)
summary(res.deriv)
x.d2=fdata.deriv(x,nderiv=1,method="fmm",class.out='fdata')
res.deriv2=fregre.np(x.d2,y)
summary(res.deriv2)
x.d3=fdata.deriv(x,nderiv=1,method="bspline",class.out='fdata')
res.deriv3=fregre.np(x.d3,y)
summary(res.deriv3)

## End(Not run)

</code></pre>


</div>