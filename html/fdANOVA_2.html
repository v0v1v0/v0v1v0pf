<div class="container">

<table style="width: 100%;"><tr>
<td>fmanova.ptbfr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Permutation Tests Based on a Basis Function Representation for FMANOVA Problem
</h2>

<h3>Description</h3>

<p>Performs the permutation tests based on a basis function representation for multivariate analysis of variance for functional data, i.e., the W, LH, P and R tests. For details of the tests, see Section 2.2 of the vignette file (<code>vignette("fdANOVA", package = "fdANOVA")</code>).
</p>
<p>We consider independent vectors of random functions </p>
<p style="text-align: center;"><code class="reqn">\mathbf{X}_{ij}(t)=(X_{ij1}(t),\dots,X_{ijp}(t))^{\top}\in SP_p(\boldsymbol{\mu}_i,\mathbf{\Gamma}),</code>
</p>
 <p><code class="reqn">i=1,\dots,l,</code> <code class="reqn">j=1,\dots,n_{i}</code> defined over the interval <code class="reqn">I=[a,b]</code>, where <code class="reqn">SP_{p}(\boldsymbol{\mu},\boldsymbol{\Gamma})</code> is a set of <code class="reqn">p</code>-dimensional stochastic processes with mean vector <code class="reqn">\boldsymbol{\mu}(t)</code>, <code class="reqn">t\in I</code> and covariance function <code class="reqn">\boldsymbol{\Gamma}(s, t)</code>, <code class="reqn">s,t\in I</code>. Let <code class="reqn">n=n_1+\dots+n_l</code>. In the multivariate analysis of variance problem for functional data (FMANOVA), we have to test the null hypothesis as follows:
</p>
<p style="text-align: center;"><code class="reqn">
H_0:\boldsymbol{\mu}_1(t)=\dots=\boldsymbol{\mu}_l(t),\ t\in I.
</code>
</p>

<p>The alternative is the negation of the null hypothesis. We assume that each functional observation is observed on a common grid of <code class="reqn">\mathcal{T}</code> design time points equally spaced in <code class="reqn">I</code> (see Section 3.1 of the vignette file, <code>vignette("fdANOVA", package = "fdANOVA")</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmanova.ptbfr(x = NULL, group.label, int, B = 1000,
              parallel = FALSE, nslaves = NULL,
              basis = c("Fourier", "b-spline", "own"),
              own.basis, own.cross.prod.mat,
              criterion = c("BIC", "eBIC", "AIC", "AICc", "NO"),
              commonK = c("mode", "min", "max", "mean"),
              minK = NULL, maxK = NULL, norder = 4, gamma.eBIC = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of <code class="reqn">\mathcal{T}\times n</code> matrices of data, whose each column is a discretized version of a function  and rows correspond to design time points. The <code class="reqn">m</code>th element of this list contains the data of <code class="reqn">m</code>th feature, <code class="reqn">m=1,\dots,p</code>. Its default values is <code>NULL</code>, because a basis representation of the data can be given instead of raw observations (see the parameter <code>own.basis</code> below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.label</code></td>
<td>
<p>a vector containing group labels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>a vector of two elements representing the interval <code class="reqn">I=[a,b]</code>. When it is not specified, it is determined by a number of design time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a number of permutation replicates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>a logical indicating whether to use parallelization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nslaves</code></td>
<td>
<p>if <code>parallel = TRUE</code>, a number of slaves. Its default value means that it will be equal to a number of logical processes of a computer used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>a choice of basis of functions used in the basis function representation of the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>own.basis</code></td>
<td>
<p>if <code>basis = "own"</code>, a list of length <code class="reqn">p</code>, whose elements are <code class="reqn">K_m\times n</code> matrices (<code class="reqn">m=1,\dots,p</code>) with columns containing the coefficients of the basis function representation of the observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>own.cross.prod.mat</code></td>
<td>
<p>if <code>basis = "own"</code>, a <code class="reqn">KM\times KM</code> cross product matrix corresponding to a basis used to obtain the list <code>own.basis</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>a choice of information criterion for selecting the optimum value of <code class="reqn">K_m</code>, <code class="reqn">m=1,\dots,p</code>. <code>criterion = "NO"</code> means that <code class="reqn">K_m</code> are equal to the parameter <code>maxK</code> defined below. Further remarks about this argument are the same as for the function <code>fanova.tests</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>commonK</code></td>
<td>
<p>a choice of method for selecting the common value for all observations from the values of <code class="reqn">K_m</code> corresponding to all processes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minK</code></td>
<td>
<p>a minimum value of <code class="reqn">K_m</code>. Further remarks about this argument are the same as for the function <code>fanova.tests</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>a maximum value of <code class="reqn">K_m</code>. Further remarks about this argument are the same as for the function <code>fanova.tests</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norder</code></td>
<td>
<p>if <code>basis = "b-spline"</code>, an integer specifying the order of b-splines.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.eBIC</code></td>
<td>
<p>a <code class="reqn">\gamma\in[0,1]</code> parameter in the eBIC.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with class "fmanovaptbfr" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a value of the statistic W.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalueW</code></td>
<td>
<p>p-value for the W test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LH</code></td>
<td>
<p>a value of the statistic LH.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalueLH</code></td>
<td>
<p>p-value for the LH test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>a value of the statistic P.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalueP</code></td>
<td>
<p>p-value for the P test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>a value of the statistic R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalueR</code></td>
<td>
<p>p-value for the R test,</p>
</td>
</tr>
</table>
<p>the values of parameters used and eventually
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list containing the data given in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Km</code></td>
<td>
<p>a vector <code class="reqn">(K_1,\dots,K_p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KM</code></td>
<td>
<p>a maximum of a vector <code>Km</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tomasz Gorecki, Lukasz Smaga
</p>


<h3>References</h3>

<p>Gorecki T, Smaga L (2015). A Comparison of Tests for the One-Way ANOVA Problem for
Functional Data. Computational Statistics 30, 987-1010.
</p>
<p>Gorecki T, Smaga L (2017). Multivariate Analysis of Variance for Functional Data. Journal of Applied Statistics 44, 2172-2189.
</p>


<h3>See Also</h3>

<p><code>fanova.tests</code>, <code>fmanova.trp</code>, <code>plotFANOVA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some of the examples may run some time.

# gait data (both features)
library(fda)
gait.data.frame &lt;- as.data.frame(gait)
x.gait &lt;- vector("list", 2)
x.gait[[1]] &lt;- as.matrix(gait.data.frame[, 1:39])
x.gait[[2]] &lt;- as.matrix(gait.data.frame[, 40:78])

# vector of group labels
group.label.gait &lt;- rep(1:3, each = 13)

# the tests based on a basis function representation with default parameters
set.seed(123)
(fmanova1 &lt;- fmanova.ptbfr(x.gait, group.label.gait))
summary(fmanova1)

# the tests based on a basis function representation with non-default parameters
set.seed(123)
fmanova2 &lt;- fmanova.ptbfr(x.gait, group.label.gait, int = c(0.025, 0.975), B = 5000,
                          basis = "b-spline", criterion = "eBIC", commonK = "mean",
                          minK = 5, maxK = 20, norder = 4, gamma.eBIC = 0.7)
summary(fmanova2)

# the tests based on a basis function representation
# with predefined basis function representation
library(fda)
fbasis &lt;- create.fourier.basis(c(0, nrow(x.gait[[1]])), 17)
own.basis &lt;- vector("list", 2)
own.basis[[1]] &lt;- Data2fd(1:nrow(x.gait[[1]]), x.gait[[1]], fbasis)$coefs
own.basis[[2]] &lt;- Data2fd(1:nrow(x.gait[[2]]), x.gait[[2]], fbasis)$coefs
own.cross.prod.mat &lt;- diag(rep(1, 17))
set.seed(123)
fmanova3 &lt;- fmanova.ptbfr(group.label = group.label.gait,
                          B = 1000, basis = "own",
                          own.basis = own.basis,
                          own.cross.prod.mat = own.cross.prod.mat)
summary(fmanova3)

library(fda)
fbasis &lt;- create.bspline.basis(c(0, nrow(x.gait[[1]])), 20, norder = 4)
own.basis &lt;- vector("list", 2)
own.basis[[1]] &lt;- Data2fd(1:nrow(x.gait[[1]]), x.gait[[1]], fbasis)$coefs
own.basis[[2]] &lt;- Data2fd(1:nrow(x.gait[[2]]), x.gait[[2]], fbasis)$coefs
own.cross.prod.mat &lt;- inprod(fbasis, fbasis)
set.seed(123)
fmanova4 &lt;- fmanova.ptbfr(group.label = group.label.gait,
                          B = 1000, basis = "own",
                          own.basis = own.basis,
                          own.cross.prod.mat = own.cross.prod.mat)
summary(fmanova4)

</code></pre>


</div>