<div class="container">

<table style="width: 100%;"><tr>
<td>predict.sfplsim.FASSMR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Prediction for SFPLSIM and MFPLSIM (using FASSMR) 
</h2>

<h3>Description</h3>

<p><code>predict</code> S3 method for: 
</p>

<ul>
<li>
<p> Semi-functional partial linear single-index model (SFPLSIM) fitted using <code>sfplsim.kernel.fit</code> or <code>sfplsim.kNN.fit</code>. 
</p>
</li>
<li>
<p> Multi-functional partial linear single-index model (MFPLSIM) fitted using <code>FASSMR.kernel.fit</code> or <code>FASSMR.kNN.fit</code>.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sfplsim.kernel'
predict(object, newdata.x = NULL, newdata.z = NULL,
  y.test = NULL, option = NULL, ...)
## S3 method for class 'sfplsim.kNN'
predict(object, newdata.x = NULL, newdata.z = NULL, 
  y.test = NULL, option = NULL, ...)
## S3 method for class 'FASSMR.kernel'
predict(object, newdata.x = NULL, newdata.z = NULL,
  y.test = NULL, option = NULL, ...)
## S3 method for class 'FASSMR.kNN'
predict(object, newdata.x = NULL, newdata.z = NULL,
  y.test = NULL, option = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Output of the functions mentioned in the <code>Description</code> (i.e. an object of the class <code>sfplsim.kernel</code>, <code>sfplsim.kNN</code>, <code>FASSMR.kernel</code> or <code>FASSMR.kNN</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata.x</code></td>
<td>

<p>A matrix containing new observations of the functional covariate in the functional-single index component collected by row.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata.z</code></td>
<td>

<p>Matrix containing the new observations of the scalar covariates (SFPLSIM) or of the scalar covariates coming from the discretisation  of a curve (MFPLSIM), collected by row. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.test</code></td>
<td>

<p>(optional) A vector containing the new observations of the response.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>

<p>Allows the choice between 1 and 2. The default is 1. See the section <code>Details</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two options are provided to obtain the predictions of the response for <code>newdata.x</code> and <code>newdata.z</code>: 
</p>

<ul>
<li>
<p> If <code>option=1</code>, we maintain all the estimations (<code>k.opt</code> or <code>h.opt</code>, <code>theta.est</code> and <code>beta.est</code>) to predict the functional single-index component of the model. 
</p>
</li>
<li>
<p> If <code>option=2</code>, we maintain <code>theta.est</code> and <code>beta.est</code>, while the tuning parameter (<code class="reqn">h</code> or <code class="reqn">k</code>) is selected again to predict the functional single-index component of the model. This selection is performed using the leave-one-out cross-validation criterion in the associated functional single-index model.
</p>
</li>
</ul>
<h3>Value</h3>

<p>The function returns the predicted values of the response (<code>y</code>) for <code>newdata.x</code> and <code>newdata.z</code>. If <code>!is.null(y.test)</code>, it also provides the mean squared error of prediction (<code>MSEP</code>) computed as <code>mean((y-y.test)^2)</code>.
If <code>is.null(newdata.x)</code> or <code>is.null(newdata.z)</code>, then the function returns the fitted values.
</p>


<h3>Author(s)</h3>

<p>German Aneiros Perez <a href="mailto:german.aneiros@udc.es">german.aneiros@udc.es</a> 
</p>
<p>Silvia Novo Diaz  <a href="mailto:snovo@est-econ.uc3m.es">snovo@est-econ.uc3m.es</a>
</p>


<h3>See Also</h3>

<p><code>sfplsim.kernel.fit</code>, <code>sfplsim.kNN.fit</code>, <code>FASSMR.kernel.fit</code>  or <code>FASSMR.kNN.fit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Tecator")
y&lt;-Tecator$fat
X&lt;-Tecator$absor.spectra2
z1&lt;-Tecator$protein       
z2&lt;-Tecator$moisture

#Quadratic, cubic and interaction effects of the scalar covariates.
z.com&lt;-cbind(z1,z2,z1^2,z2^2,z1^3,z2^3,z1*z2)
train&lt;-1:160
test&lt;-161:215

#SFPLSIM fit. Convergence errors for some theta are obtained.
s.fit.kernel&lt;-sfplsim.kernel.fit(x=X[train,], z=z.com[train,], y=y[train],
            max.q.h=0.35,lambda.min.l=0.01, factor.pn=2, nknot.theta=4,
            criterion="BIC", range.grid=c(850,1050), 
            nknot=20, max.iter=5000)
s.fit.kNN&lt;-sfplsim.kNN.fit(y=y[train],x=X[train,], z=z.com[train,], 
        max.knn=20,lambda.min.l=0.01, factor.pn=2, nknot.theta=4,
        criterion="BIC",range.grid=c(850,1050), 
        nknot=20, max.iter=5000)


predict(s.fit.kernel,newdata.x=X[test,],newdata.z=z.com[test,],
  y.test=y[test],option=2)
predict(s.fit.kNN,newdata.x=X[test,],newdata.z=z.com[test,],
  y.test=y[test],option=2)


data(Sugar)
y&lt;-Sugar$ash
x&lt;-Sugar$wave.290
z&lt;-Sugar$wave.240

#Outliers
index.y.25 &lt;- y &gt; 25
index.atip &lt;- index.y.25
(1:268)[index.atip]


#Dataset to model
x.sug &lt;- x[!index.atip,]
z.sug&lt;- z[!index.atip,]
y.sug &lt;- y[!index.atip]

train&lt;-1:216
test&lt;-217:266

m.fit.kernel &lt;- FASSMR.kernel.fit(x=x.sug[train,],z=z.sug[train,], 
                  y=y.sug[train],  nknot.theta=2, 
                  lambda.min.l=0.03, max.q.h=0.35,num.h = 10, 
                  nknot=20,criterion="BIC", max.iter=5000)


m.fit.kNN&lt;- FASSMR.kNN.fit(x=x.sug[train,],z=z.sug[train,], y=y.sug[train], 
            nknot.theta=2, lambda.min.l=0.03, 
            max.knn=20,nknot=20,criterion="BIC",max.iter=5000)


predict(m.fit.kernel,newdata.x=x.sug[test,],newdata.z=z.sug[test,],
  y.test=y.sug[test],option=2)
predict(m.fit.kNN,newdata.x=x.sug[test,],newdata.z=z.sug[test,],
  y.test=y.sug[test],option=2)

</code></pre>


</div>