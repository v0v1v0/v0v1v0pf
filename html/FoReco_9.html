<div class="container">

<table style="width: 100%;"><tr>
<td>cscov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-sectional covariance matrix approximation</h2>

<h3>Description</h3>

<p>This function provides an approximation of the cross-sectional base forecasts errors
covariance matrix using different reconciliation methods (see Wickramasuriya et al.,
2019 and Di Fonzo and Girolimetto, 2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cscov(comb = "ols", n = NULL, agg_mat = NULL, res, mse = TRUE,
      shrink_fun = shrink_estim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>comb</code></td>
<td>
<p>A string specifying the reconciliation method.
</p>

<ul>
<li>
<p> Ordinary least squares:
</p>

<ul><li>
<p> "<code>ols</code>" (<em>default</em>) - identity error covariance matrix.
</p>
</li></ul>
</li>
<li>
<p> Weighted least squares:
</p>

<ul>
<li>
<p> "<code>str</code>" - structural variances.
</p>
</li>
<li>
<p> "<code>wls</code>" - series variances (uses <code>res</code>).
</p>
</li>
</ul>
</li>
<li>
<p> Generalized least squares:
</p>

<ul><li>
<p> "<code>shr</code>"/"<code>sam</code>" - shrunk/sample covariance (uses <code>res</code>).
</p>
</li></ul>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of variables (<code class="reqn">n = n_a + n_b</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_mat</code></td>
<td>
<p>A (<code class="reqn">n_a \times n_b</code>) numeric matrix representing the cross-sectional
aggregation matrix. It maps the <code class="reqn">n_b</code> bottom-level (free)
variables into the <code class="reqn">n_a</code> upper (constrained) variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>An (<code class="reqn">N \times n</code>) optional numeric matrix containing the in-sample
residuals. This matrix is used to compute some covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>If <code>TRUE</code> (<em>default</em>) the residuals used to compute the covariance
matrix are not mean-corrected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrink_fun</code></td>
<td>
<p>Shrinkage function of the covariance matrix, shrink_estim (<em>default</em>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A (<code class="reqn">n \times n</code>) symmetric positive (semi-)definite matrix.
</p>


<h3>References</h3>

<p>Di Fonzo, T. and Girolimetto, D. (2023), Cross-temporal forecast reconciliation:
Optimal combination method and heuristic alternatives, <em>International Journal
of Forecasting</em>, 39, 1, 39-57. <a href="https://doi.org/10.1016/j.ijforecast.2021.08.004">doi:10.1016/j.ijforecast.2021.08.004</a>
</p>
<p>Wickramasuriya, S.L., Athanasopoulos, G. and Hyndman, R.J. (2019), Optimal forecast
reconciliation for hierarchical and grouped time series through trace minimization,
<em>Journal of the American Statistical Association</em>, 114, 526, 804-819.
<a href="https://doi.org/10.1080/01621459.2018.1448825">doi:10.1080/01621459.2018.1448825</a>
</p>


<h3>See Also</h3>

<p>Cross-sectional framework: 
<code>csboot()</code>,
<code>csbu()</code>,
<code>cslcc()</code>,
<code>csmo()</code>,
<code>csrec()</code>,
<code>cstd()</code>,
<code>cstools()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Aggregation matrix for Z = X + Y
A &lt;- t(c(1,1))
# (10 x 3) in-sample residuals matrix (simulated)
res &lt;- t(matrix(rnorm(n = 30), nrow = 3))

cov1 &lt;- cscov("ols", n = 3)          # OLS methods
cov2 &lt;- cscov("str", agg_mat = A)   # STR methods
cov3 &lt;- cscov("wls", res = res)      # WLS methods
cov4 &lt;- cscov("shr", res = res)      # SHR methods
cov5 &lt;- cscov("sam", res = res)      # SAM methods

# Custom covariance matrix
cscov.ols2 &lt;- function(comb, x) diag(x)
cscov(comb = "ols2", x = 3) # == cscov("ols", n = 3)

</code></pre>


</div>