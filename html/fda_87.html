<div class="container">

<table style="width: 100%;"><tr>
<td>fd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Define a Functional Data Object
</h2>

<h3>Description</h3>

<p>This is the constructor function for objects of the <code>fd</code> class.
Each function that sets up an object of this class must call this
function.  This includes functions  <code>smooth.basis</code>, <code>density.fd</code>, and so forth
that estimate functional data objects that smooth or otherwise
represent data.  Ordinarily, users of the functional data analysis
software will not need to call this function directly, but these notes
are valuable to understanding the components of a <code>list</code> of class
<code>fd</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fd(coef=NULL, basisobj=NULL, fdnames=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>

<p>a vector, matrix, or three-dimensional array of coefficients.
</p>
<p>The first dimension (or elements of a vector) corresponds to basis
functions.
</p>
<p>A second dimension corresponds to the number of functional
observations, curves or replicates.  If <code>coef</code> is a vector, it
represents only a single functional observation.
</p>
<p>If <code>coef</code> is an array, the third dimension corresponds to
variables for multivariate functional data objects.
</p>
<p>A functional data object is "univariate" if <code>coef</code> is a vector
or matrix and "multivariate" if it is a three-dimensional array.
</p>
<p>if(is.null(coef)) coef &lt;- rep(0, basisobj[['nbasis']])
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basisobj</code></td>
<td>

<p>a functional basis object defining the basis
</p>
<p><code>
      if(is.null(basisobj)){
	if(is.null(coef)) basisobj &lt;- basisfd()
	else {
	  rc &lt;- range(coef)
	  if(diff(rc)==0) rc &lt;- rc+0:1
	  nb &lt;- max(4, nrow(coef))
	  basisobj &lt;- create.bspline.basis(rc, nbasis = nb)
	}
      }
    </code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdnames</code></td>
<td>

<p>A list of length 3, each member being a string vector containing
labels for the levels of the corresponding dimension of the discrete
data.  The first dimension is for argument values, and is given the
default name "time", the second is for replications, and is given
the default name "reps", and the third is for functions, and is
given the default name "values".
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To check that an object is of this class, use function
<code>is.fd</code>.
</p>
<p>Normally only developers of new functional data analysis
functions will actually need to use this function.
</p>


<h3>Value</h3>

<p>A functional data object (i.e., having class <code>fd</code>), which is a
list with components named <code>coefs</code>, <code>basis</code>, and
<code>fdnames</code>.
</p>


<h3>Source</h3>

<p>Ramsay, James O., and Silverman, Bernard W. (2006), <em>Functional
Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), <em>Applied
Functional Data Analysis</em>, Springer, New York
</p>


<h3>See Also</h3>

<p><code>smooth.basis</code>
<code>smooth.fdPar</code>
<code>smooth.basisPar</code>
<code>density.fd</code>
<code>create.bspline.basis</code>
<code>arithmetic.fd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
## default
##
fd()
oldpar &lt;- par(no.readonly=TRUE)
##
## The simplest b-spline basis:  order 1, degree 0, zero interior knots:
##       a single step function
##
bspl1.1    &lt;- create.bspline.basis(norder=1, breaks=0:1)
fd.bspl1.1 &lt;- fd(0, basisobj=bspl1.1)

fd.bspl1.1a &lt;- fd(basisobj=bspl1.1)

all.equal(fd.bspl1.1, fd.bspl1.1a)

# TRUE

# the following three lines shown an error in a non-cran check:
# if(!CRAN()) {
#   fd.bspl1.1b &lt;- fd(0)
# }

##
## Cubic spline:  4  basis functions
##
bspl4 &lt;- create.bspline.basis(nbasis=4)
plot(bspl4)
parab4.5 &lt;- fd(c(3, -1, -1, 3)/3, bspl4)
# = 4*(x-.5)^2
plot(parab4.5)

##
## Fourier basis
##
f3 &lt;- fd(c(0,0,1), create.fourier.basis())
plot(f3)
# range over +/-sqrt(2), because
# integral from 0 to 1 of cos^2 = 1/2
# so multiply by sqrt(2) to get
# its square to integrate to 1.

##
## subset of an fd object
##

gaitbasis3 &lt;- create.fourier.basis(nbasis=5)
gaittime = (1:20)/21
gaitfd3    &lt;- smooth.basis(gaittime, gait, gaitbasis3)$fd
gaitfd3[1]
par(oldpar)
</code></pre>


</div>