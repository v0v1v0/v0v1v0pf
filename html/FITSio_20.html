<div class="container">

<table style="width: 100%;"><tr>
<td>writeFITSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Write a FITS image (multi-dimensional numeric array) to disk</h2>

<h3>Description</h3>

<p>Write a FITS image (multi-dimensional numeric array) to disk.
</p>


<h3>Usage</h3>

<pre><code class="language-R">writeFITSim(X, file = "R.fits", type = "double",
bscale = 1, bzero = 0, c1 = NA, c2 = NA,
crpixn = NA, crvaln = NA, cdeltn = NA, ctypen = NA, cunitn = NA,
axDat = NA, header = '')

writeFITSim16i(X, file = "R.fits", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Multi-dimensional numeric data array; see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Output filename.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type to write: single or double precision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bscale</code></td>
<td>
<p>Global scaling factor, FITS standard meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bzero</code></td>
<td>
<p>Global shift, FITS standard meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>Character string comment line for header.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c2</code></td>
<td>
<p>Character string comment line for header.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crpixn</code></td>
<td>
<p>Vector of reference pixel numbers for axes, FITS
standard meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crvaln</code></td>
<td>
<p>Vector of values at reference pixels, FITS standard meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdeltn</code></td>
<td>
<p>Vector of axis increments per pixel, FITS standard meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctypen</code></td>
<td>
<p>String vector of descriptive labels for axis, FITS
standard meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cunitn</code></td>
<td>
<p>String vector of physical units for axis, FITS standard
meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axDat</code></td>
<td>
<p>Data frame with axis data (optional), see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p>Header (optional) as 80-character card images.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments as defined above, as needed, for
<code>writeFITSim16i</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>writeFITSim</code> and <code>writeFITSim16i</code> write multi-dimensional
data arrays and
header information to FITS-format files.  A single image is a
two-dimensional array; data cubes contain two dimensions plus one
additional dimension for each (often velocity) plane.
</p>
<p>Axis data may be given as a data frame <code>axDat</code>, typically from
<code>readFITS</code> or, if that is missing, by individual vectors for
<code>crpixn, crvaln</code>, etc.  <code>axDat</code> has priority over individual
vectors.  <code>axDat</code> may be edited easily with e.g.
<code>axDat &lt;- edit(axDat)</code>.
</p>
<p>Header data may be added to that the function automatically generates.
No or little editing is needed if the header is taken from an existing
file by e.g. <code>readFITSheader</code>: <code>writeFITSim</code> will
remove reserved keywords in the header that conflict with those
generated and add the END statement.  See <code>modifyHeader</code>
for functions to add to or modify the header.
</p>
<p><code>writeFITSim</code> writes integer or float data matching the data type in
the input array.  <code>writeFITSim16i</code> scales and shifts
the input to write
16-bit integer data with the maximum precision allowed by word
length.  FITS variables BSCALE and BZERO are automatically updated to
allow reconstruction of the original data values.  In cases where full
precision is not needed, this can reduce file sizes by a factor of
about four compared with a double-precision float.
</p>


<h3>Value</h3>

<p>FITS file written to disk.
</p>


<h3>Note</h3>

<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active devlopement with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code>readFITS</code>, <code>readFITSheader</code>,
<code>modifyHeader</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Make data array with axis information, write to disk
X &lt;- matrix(1:15, ncol = 3)
filename &lt;- paste(tempdir(), "test.fits", sep="")
writeFITSim(X, file = filename, c1 = "Test FITS file",
            crpixn = c(1,1), crvaln = c(10, 100), cdeltn = c(8, 2),
            ctypen = c("Distance", "Time"),
            cunitn = c("Furlongs", "Fortnights"))
## Read back in, modify data offset, header, and axis data information,
## then write modified version as new file
Z &lt;-  readFITS(filename)
Z$imDat &lt;- Z$imDat + 300
Z$header &lt;- addKwv('SCALE', 1.03, 'test header mod', header=Z$header)
# Z$axDat &lt;- edit(Z$axDat)  # interactive edits
Z$axDat$cdelt
Z$axDat$cdelt[2] &lt;- 20
Z$axDat$cdelt
writeFITSim(Z$imDat, file=filename, axDat=Z$axDat, header=Z$header)


### 3-dimensional array example
## Write sample file
X &lt;- array(1:210, dim = c(10, 7, 3))
writeFITSim(X, filename)
## Read back in and display plane 2, no axis scale markings
Z &lt;-  readFITS(filename)
dim(Z$imDat[,,2])
image(Z$imDat[,,2], xaxt = "n", yaxt = "n")
str(Z)
print(Z$axDat)

## Clean up files after examples to avoid clutter
unlink(filename)

### Note: either of the writeFITSim() calls here could be replaced
###       with writeFITSim16i() calls with the identical argument.
</code></pre>


</div>