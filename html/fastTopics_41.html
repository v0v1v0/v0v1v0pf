<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_count_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Count Data from Poisson NMF Model</h2>

<h3>Description</h3>

<p>Simulate a counts matrix <code>X</code> such that
<code>X[i,j]</code> is Poisson with rate (mean) <code>Y[i,j]</code>, where
<code>Y = tcrossprod(L,F)</code>, <code>L</code> is an n x k loadings
(“activations”) matrix, and <code>F</code> is an m x k factors
(“basis vectors”) matrix. The entries of matrix <code>L</code> are
drawn uniformly at random between zero and <code>lmax</code>, and the
entries of matrix <code>F</code> are drawn uniformly at random between 0
and <code>fmax</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_count_data(n, m, k, fmax = 1, lmax = 1, sparse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of rows in simulated count matrix. The number of
rows should be at least 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of columns in simulated count matrix. The number of
columns should be at least 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of factors, or “topics”, used to determine
Poisson rates. The number of topics should be 1 or more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>Factors are drawn uniformly at random between zero and
<code>fmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmax</code></td>
<td>
<p>Loadings are drawn uniformly at random between zero and
<code>lmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>If <code>sparse = TRUE</code>, convert the counts matrix to
a sparse matrix in compressed, column-oriented format; see
<code>sparseMatrix</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that only minimal argument checking is performed. This
function is mainly used to simulate small data sets for the examples
and package tests.
</p>


<h3>Value</h3>

<p>The return value is a list containing the counts matrix
<code>X</code> and the factorization, <code>F</code> and <code>L</code>, used to
generate the counts.
</p>


</div>