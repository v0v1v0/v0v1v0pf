<div class="container">

<table style="width: 100%;"><tr>
<td>fit_mvst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate parameters of a multivariate (generalized hyperbolic) skewed t distribution to fit data</h2>

<h3>Description</h3>

<p>Estimate parameters of a multivariate (generalized hyperbolic) skewed Student's t distribution to fit data,
namely, the location vector, the scatter matrix, the skewness vector, and the degrees of freedom.
The estimation is based on the maximum likelihood estimation (MLE) and the algorithm is
obtained from the expectation-maximization (EM) method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_mvst(
  X,
  nu = NULL,
  gamma = NULL,
  initial = NULL,
  max_iter = 500,
  ptol = 0.001,
  ftol = Inf,
  PXEM = TRUE,
  return_iterates = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data matrix containing the multivariate time series (each column is one time series).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Degrees of freedom of the skewed <code class="reqn">t</code> distribution (otherwise it will be iteratively estimated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Skewness vector of the skewed <code class="reqn">t</code> distribution (otherwise it will be iteratively estimated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>List of initial values of the parameters for the iterative estimation method.
Possible elements include:
</p>
<ul>
<li>
<p><code>nu</code>: default is <code>4</code>,
</p>
</li>
<li>
<p><code>mu</code>: default is the data sample mean,
</p>
</li>
<li>
<p><code>gamma</code>: default is the sample skewness vector,
</p>
</li>
<li>
<p><code>scatter</code>: default follows from the scaled sample covariance matrix,
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Integer indicating the maximum number of iterations for the iterative estimation
method (default is <code>500</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptol</code></td>
<td>
<p>Positive number indicating the relative tolerance for the change of the variables
to determine convergence of the iterative method (default is <code>1e-3</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftol</code></td>
<td>
<p>Positive number indicating the relative tolerance for the change of the log-likelihood
value to determine convergence of the iterative method (default is <code>Inf</code>, so it is
not active). Note that using this argument might have a computational cost as a convergence
criterion due to the computation of the log-likelihood (especially when <code>X</code> is high-dimensional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PXEM</code></td>
<td>
<p>Logical value indicating whether to use the parameter expansion (PX) EM method to accelerating the convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_iterates</code></td>
<td>
<p>Logical value indicating whether to record the values of the parameters (and possibly the
log-likelihood if <code>ftol &lt; Inf</code>) at each iteration (default is <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value indicating whether to allow the function to print messages (default is <code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates the parameters of a (generalized hyperbolic) multivariate Student's t distribution (<code>mu</code>,
<code>scatter</code>, <code>gamma</code> and <code>nu</code>) to fit the data via the expectation-maximization (EM) algorithm.
</p>


<h3>Value</h3>

<p>A list containing (possibly) the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Location vector estimate (not the mean).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Skewness vector estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scatter</code></td>
<td>
<p>Scatter matrix estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Degrees of freedom estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>Mean vector estimate: </p>
<pre>  mean = mu + nu/(nu-2) * gamma</pre>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>Covariance matrix estimate: </p>
<pre>  cov = nu/(nu-2) * scatter + 2*nu^2 / (nu-2)^2 / (nu-4) * gamma*gamma'</pre>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>Boolean denoting whether the algorithm has converged (<code>TRUE</code>) or the maximum number
of iterations <code>max_iter</code> has been reached (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_iterations</code></td>
<td>
<p>Number of iterations executed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpu_time</code></td>
<td>
<p>Elapsed overall CPU time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_likelihood_vs_iterations</code></td>
<td>
<p>Value of log-likelihood over the iterations (if <code>ftol &lt; Inf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterates_record</code></td>
<td>
<p>Iterates of the parameters (<code>mu</code>, <code>scatter</code>, <code>nu</code>,
and possibly <code>log_likelihood</code> (if <code>ftol &lt; Inf</code>)) along the iterations
(if <code>return_iterates = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpu_time_at_iter</code></td>
<td>
<p>Elapsed CPU time at each iteration (if <code>return_iterates = TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rui Zhou, Xiwen Wang, and Daniel P. Palomar
</p>


<h3>References</h3>

<p>Aas Kjersti and Ingrid Hobæk Haff. "The generalized hyperbolic skew Student’s t-distribution,"
Journal of financial econometrics, pp. 275-309, 2006.
</p>


<h3>See Also</h3>

<p><code>fit_mvt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm)       # to generate heavy-tailed data
library(fitHeavyTail)

# parameter setting
N &lt;- 5
T &lt;- 200
nu &lt;- 6
mu &lt;- rnorm(N)
scatter &lt;- diag(N)
gamma &lt;- rnorm(N)   # skewness vector

# generate GH Skew t data
taus &lt;- rgamma(n = T, shape = nu/2, rate = nu/2)
X &lt;- matrix(data = mu, nrow = T, ncol = N, byrow = TRUE) +
     matrix(data = gamma, nrow = T, ncol = N, byrow = TRUE) / taus +
     rmvnorm(n = T, mean = rep(0, N), sigma = scatter) / sqrt(taus)

# fit skew t model
fit_mvst(X)

# setting lower limit for nu (e.g., to guarantee existence of co-skewness and co-kurtosis matrices)
options(nu_min = 8.01)
fit_mvst(X)

</code></pre>


</div>