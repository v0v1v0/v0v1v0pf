<div class="container">

<table style="width: 100%;"><tr>
<td>funreg.permutation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Do a permutation test for functional regression</h2>

<h3>Description</h3>

<p>Performs a permutation F test (Ramsay, Hooker, and Graves, 2009, p. 145)
for the significance of a functional covariate, and a permutation
likelihood ratio test.  The permutation test function currently doesn't allow models
with multiple functional covariates, but 
subject-level covariates are allowed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">funreg.permutation(object, num.permute = 500, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class funreg</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.permute</code></td>
<td>
<p>The number of permutations to use.  Ramsay, Hooker and Graves (2009) 
recommended “several hundred” (p. 145), but for a quicker initial look
it might suffice to use 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An optional random number seed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with several components. First, 
<code>pvalue.F</code> is the p-value for the F test.  Second, <code>conf.int.for.pvalue.F</code> is
the confidence interval for estimating the p-value that would
be obtained from the dataset as <code>num.permute</code> approached infinity. 
The idea of a confidence interval for a p-value is explained further by 
Sen (2013), with a STATA example. 
Third, <code>orig.F</code> is the F statistic calculated on the original
dataset. Last, <code>permuted.F</code> is the vector of F statistics calculated
on each of the random permuted datasets.  Also included are <code>pvalue.LR</code>,
<code>conf.int.for.pvalue.LR</code>,  <code>orig.LR</code>, <code>permuted.LR</code> for
the permutation test with a likelihood ratio statistic.
A more conservative alternative formula for the p-value is used in 
<code>pvalue.F.better</code> and <code>pvalue.LR.better</code>.  
It is not obvious whether to define the p-value as the 
proportion of permuted datasets with statistics less than or equal to
the original, or simply less than the original.  This should usually not 
matter, as a tie is not likely.  We made the arbitrary decision to use 
the former here because it was presented in this way in the 
Wikipedia article for permutation tests.                                     
The conservative alternative formula is 
the number of less extreme permuted datasets plus one,
over the total number of datasets plus one.  Adding one to the numerator
and denominator is suggested by some authors, partly  in order to prevent
a nonsensical zero p-value (Onghena &amp; May, 1995; Phipson, Belinda &amp; Smyth, 2010).
</p>


<h3>References</h3>

<p>Onghena, P., &amp; May, R. B. (1995). Pitfalls in computing and interpreting
randomization test p values: A commentary on Chen and Dunlap.
Behavior Research Methods, Instruments, &amp; Computers, 27(3), 408-411. DOI: 10.3758/BF03200438.
</p>
<p>Phipson, Belinda and Smyth, Gordon K. (2010) Permutation P-values 
Should Never Be Zero:  Calculating Exact P-values When Permutations
Are Randomly Drawn.  Statistical Applications
in Genetics and Molecular Biology: Vol. 9: Iss. 1, Article 39. DOI: 10.2202/1544-6115.1585.    
</p>
<p>Ramsay, J. O., Hooker, G., &amp; Graves, S. (2009). Functional
data analysis with R and MATLAB. NY: Springer.
</p>
<p>Sen, S. (2014) Permutation Tests.
</p>


</div>