<div class="container">

<table style="width: 100%;"><tr>
<td>dr.pds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get the partial duration series for streamflow droughts</h2>

<h3>Description</h3>

<p>This function returns the partial duration series for streamflow droughts 
based on a moving window quantile threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dr.pds(TS, Qdr = 0.2, WinSize = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TS</code></td>
<td>
<p>output from <code>create.ts</code> containing a data.frame of flow
time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qdr</code></td>
<td>
<p>Numeric value of the drought threshold quantile.  Default is 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WinSize</code></td>
<td>
<p>Numeric value specifying the size of the moving window in
days.  Default is 30.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function defines a daily streamflow threshold and finds the 
partial duration series of streamflow droughts.  Drought events are 
identified in the daily streamflow time series with the threshold level approach.
In this function, the threshold is 
defined by a moving quantile, where daily threshold values are based on
the 80th percentile of the flow duration curve from a 30-day moving window 
(Beyene et al. 2014). With this method, every day of the year has a different
threshold based on the streamflow measured on the day, the 15 days before 
the day, and the 15 days after the day. The size of the moving window can be 
modified with the WinSize argument, and the percentile can be modified with the
Qdr argument.
</p>


<h3>Value</h3>

<p>Returns the input TS data.frame with "Thresh" and "BelowThresh" 
columns appended. The Thresh column contains the daily flow threshold, and 
the BelowThresh column is a binary indicating whether the flow on each day 
was below the drought threshold.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>References</h3>

<p>Beyene, B.S., Van Loon, A.F., Van Lanen, H.A.J., Torfs, P.J.J.F., 2014. 
Investigation of variable threshold level approaches for hydrological drought 
identification. Hydrol. Earth Syst. Sci. Discuss. 11, 12765-12797. 
http://dx.doi.org/10.5194/hessd-11-12765-2014.
</p>


<h3>See Also</h3>

<p>See <code>create.ts</code> to format the input flow series.
</p>
<p>See <code>mqt</code> to return only the daily moving quantile threshold.
</p>
<p>See <code>dr.events</code> to pool drought events, remove minor events,
and calculate metrics.
</p>
<p>See <code>dr.seas</code> to calculate metrics for streamflow droughts 
that start in a specific month or months.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cania.sub.ts)
pds &lt;- dr.pds(cania.sub.ts)
pds &lt;- subset(pds, pds$BelowThresh==TRUE)

# plot the flow time series with black and the drought events in red
plot(cania.sub.ts$Date, cania.sub.ts$Flow, ylab="m3/s", xlab="", type="l")
points(pds$Date, pds$Flow, pch=19, cex=0.7, col="red")
</code></pre>


</div>