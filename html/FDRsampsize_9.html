<div class="container">

<table style="width: 100%;"><tr>
<td>n.fdr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the sample size that meets desired FDR and power criteria</h2>

<h3>Description</h3>

<p>Find smallest sample size that meets requirements for average power and FDR</p>


<h3>Usage</h3>

<pre><code class="language-R">n.fdr (ave.pow, fdr, pow.func, eff.size, null.effect, lam = 0.95, 
    eps = 1e-04, n0 = 5, n1 = 500, tol = 1e-06, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ave.pow</code></td>
<td>
<p>required average power (scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>required FDR (scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow.func</code></td>
<td>
<p>name of R function that computes statistical power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eff.size</code></td>
<td>
<p>effect size vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.effect</code></td>
<td>
<p>Value of effect size that indicates null</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>p-value at which to evaluate ensemble PDF</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>epsilon for numerical differentiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>smallest sample size to be considered for bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>maximum sample size to be considered for bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for solving for alpha in iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional agruments for the functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This performs the sample size calculation without checking whether the
minimum or maximum sample size satisfy the desired requirements.  The fdr.sampsize
function checks these conditions and then calls n.fdr.  Thus, many users will
may prefer to use the sampsize.fdr function instead of n.fdr.</p>


<h3>Value</h3>

<p>a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a sample size estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the p-value cut-off</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.hat</code></td>
<td>
<p>an approximation to the expected value of the FDR estimate given n </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ave.pow</code></td>
<td>
<p>the average power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.act</code></td>
<td>
<p>the actual FDR given n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.hat</code></td>
<td>
<p>expected value of the pi.hat estimator given n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>act.pi</code></td>
<td>
<p>actual pi0</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>A Onar-Thomas, S Pounds. "FDRsampsize: An R package to Perform Generalized Power and Sample Size Calculations for Planning Studies that use the False Discovery Rate to Measure Significance", Manuscript 2015.
</p>
<p>Pounds, Stan, and Cheng Cheng. "Sample size determination for the false discovery rate." Bioinformatics 21.23 (2005): 4263-4271.
</p>
<p>Jung, Sin-Ho. "Sample size for FDR-control in microarray data analysis." Bioinformatics 21.14 (2005): 3097-3104.</p>


</div>