<div class="container">

<table style="width: 100%;"><tr>
<td>humann2meco</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transform 'HUMAnN' metagenomic results to 'microtable' object.</h2>

<h3>Description</h3>

<p>Transform 'HUMAnN' metagenomic results to microtable object, reference: Franzosa et al. (2018) &lt;doi:10.1038/s41592-018-0176-y&gt;.
</p>


<h3>Usage</h3>

<pre><code class="language-R">humann2meco(
  feature_table,
  db = c("MetaCyc", "KEGG", "gene")[1],
  sample_table = NULL,
  match_table = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>feature_table</code></td>
<td>
<p>file path of 'HUMAnN' output abundance table; Please see the example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>default "MetaCyc"; one of "MetaCyc", "KEGG" or "gene"; "MetaCyc" or "KEGG" means the input feature table is pathway abundance.
"gene" represents the abundance of genes, such as 'eggNOG', 'KO' and 'EC'. 
When using "gene", the generated tax_table has only taxonomic lineages and gene name, no higher functional levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_table</code></td>
<td>
<p>default NULL; sample metadata table; If provided, must be one of the several types of formats: <br>
1) comma seperated file with the suffix csv or tab seperated file with suffix tsv or txt; <br>
2) Excel type file with the suffix xlsx or xls; require <code>readxl</code> package to be installed; <br>
3) <code>data.frame</code> object from R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match_table</code></td>
<td>
<p>default NULL; a two column table used to replace the sample names in feature table; Must be two columns without column names;
The first column must be raw sample names same with those in feature table, 
the second column must be new sample names same with the rownames in sample_table; Please also see the example files.
If provided, must be one of the several types of formats: <br>
1) comma seperated file with the suffix csv or tab seperated file with suffix tsv/txt; <br>
2) Excel type file with the suffix xlsx or xls; require <code>readxl</code> package to be installed; <br>
3) <code>data.frame</code> object from R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>parameter passed to <code>microtable$new</code> function of <code>microeco</code> package, such as <code>auto_tidy</code> parameter.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>microtable</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(file2meco)
library(microeco)
library(magrittr)
sample_file_path &lt;- system.file("extdata", "example_metagenome_sample_info.tsv", 
  package="file2meco")
match_file_path &lt;- system.file("extdata", "example_metagenome_match_table.tsv", package="file2meco")
# MetaCyc pathway examples
# use the raw data files stored inside the package for MetaCyc pathway database based analysis
abund_file_path &lt;- system.file("extdata", "example_HUMAnN_MetaCyc_abund.tsv", package="file2meco")
# the default db is "MetaCyc"
humann2meco(abund_file_path, db = "MetaCyc")
humann2meco(abund_file_path, db = "MetaCyc", sample_table = sample_file_path, 
  match_table = match_file_path)
test &lt;- humann2meco(abund_file_path, db = "MetaCyc", sample_table = sample_file_path, 
  match_table = match_file_path)
test$tidy_dataset()
# rel = FALSE sum original abundance instead of relative abundance
test$cal_abund(select_cols = 1:3, rel = FALSE)
test$taxa_abund$Superclass1 %&lt;&gt;% .[!grepl("unclass", rownames(.)), ]
# use_percentage = FALSE disable percentage for relative abundance
test1 &lt;- trans_abund$new(test, taxrank = "Superclass1", ntaxa = 10, use_percentage = FALSE)
# reassign ylab title instead of default 'Relative Abundance'
test1$ylabname &lt;- "Abundance (RPK)"
# bar_full = FALSE show original abundance instead of normalized 0-1
test1$plot_bar(facet = "Group", bar_full = FALSE)
# select both function and taxa
test$cal_abund(select_cols = c("Superclass1", "Phylum", "Genus"), rel = TRUE)
test1 &lt;- trans_abund$new(test, taxrank = "Phylum", ntaxa = 10, delete_taxonomy_lineage = TRUE)
test1$plot_bar(facet = "Group")
test$taxa_abund$Phylum %&lt;&gt;% .[!grepl("unclass", rownames(.)), ]
test1 &lt;- trans_abund$new(test, taxrank = "Phylum", ntaxa = 10, delete_taxonomy_lineage = FALSE)
test1$plot_bar(facet = "Group")
# functional biomarker
test$cal_abund(select_cols = 1:3, rel = TRUE)
test$taxa_abund$Superclass1 %&lt;&gt;% .[!grepl("unclass", rownames(.)), ]
test$taxa_abund$Superclass2 %&lt;&gt;% .[!grepl("unclass", rownames(.)), ]
test$taxa_abund$pathway %&lt;&gt;% .[!grepl("unclass", rownames(.)), ]
test1 &lt;- trans_diff$new(test, method = "lefse", group = "Group")
test1$plot_diff_bar(use_number = 1:20)
# taxa biomarker
test$cal_abund(select_cols = 4:9, rel = TRUE)
test$taxa_abund$Phylum %&lt;&gt;% .[!grepl("unclass", rownames(.)), ]
test1 &lt;- trans_diff$new(test, method = "lefse", group = "Group", p_adjust_method = "none")
test1$plot_diff_bar(threshold = 2)
#############################################################
# KEGG pathway examples
abund_file_path &lt;- system.file("extdata", "example_HUMAnN_KEGG_abund.tsv", package="file2meco")
humann2meco(abund_file_path, db = "KEGG")
test &lt;- humann2meco(abund_file_path, db = "KEGG", 
  sample_table = sample_file_path, match_table = match_file_path)
test$tax_table %&lt;&gt;% subset(Level.1 != "unclassified")
test$tidy_dataset()
test$cal_abund(select_cols = 1:3, rel = FALSE)
# use_percentage = FALSE disable percentage for relative abundance
test1 &lt;- trans_abund$new(test, taxrank = "Level.2", ntaxa = 10, use_percentage = FALSE)
# or use ggplot2::ylab to change ylab title
test1$ylabname &lt;- "Abundance (RPK)"
test1$plot_bar(facet = "Group", bar_full = FALSE)
# select both function and taxa
test$cal_abund(select_cols = c("Level.1", "Phylum", "Genus"), rel = TRUE)
test1 &lt;- trans_abund$new(test, taxrank = "Phylum", ntaxa = 10, delete_taxonomy_lineage = FALSE)
test1$plot_bar(facet = "Group")
# functional biomarker
test$cal_abund(select_cols = 1:3, rel = TRUE)
test1 &lt;- trans_diff$new(test, method = "lefse", group = "Group")
test1$plot_diff_bar(threshold = 3)
# taxa biomarker
test$cal_abund(select_cols = 4:9, rel = TRUE)
test1 &lt;- trans_diff$new(test, method = "lefse", group = "Group", p_adjust_method = "none")
test1$plot_diff_bar(threshold = 2)

</code></pre>


</div>