<div class="container">

<table style="width: 100%;"><tr>
<td>VarObj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fréchet Variance Trajectory for densities</h2>

<h3>Description</h3>

<p>Modeling time varying density objects with respect to $L^2$-Wasserstein distance by Fréchet variance trajectory
</p>


<h3>Usage</h3>

<pre><code class="language-R">VarObj(tgrid, yin = NULL, hin = NULL, din = NULL, qin = NULL, optns = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tgrid</code></td>
<td>
<p>Time grid vector for the time varying object data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yin</code></td>
<td>
<p>An array or list of lists holding the samples of observations. If <code>yin</code> is an array, it has size <code>n</code> x <code>length(tgrid)</code> x numbers of samples holding the observation, such that <code>yin[i,j,]</code> holds the observations to the ith sample at the jth time grid. If <code>yin</code> is a list of lists, <code>yin[[i]][[j]]</code> holds the observations to the ith sample at the jth time grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hin</code></td>
<td>
<p>A list of lists holding the histogram for each subject. <code>hin[[i]][[j]]</code> holds the histogram to the ith sample at the jth time grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>din</code></td>
<td>
<p>A three dimension array of size <code>n</code> x <code>length(tgrid)</code> x <code>length(optns$dSup)</code> holding the observed densities, such that <code>din[i,j,]</code> holds the observed density function taking values on <code>optns$dSup</code> corresponding to the ith sample at the jth time grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qin</code></td>
<td>
<p>A three dimension array of size <code>n</code> x <code>length(tgrid)</code> x <code>length(optns$qSup)</code> holding the observed quantiles, such that <code>din[i,j,]</code> holds the observed density function taking values on <code>optns$qSup</code> corresponding to the ith sample at the jth time grid.
Note that only one of <code>yin</code>, <code>hin</code>, <code>din</code> and <code>qin</code> needs to be input. If more than one of them are specified, <code>yin</code> overwrites <code>hin</code>, <code>hin</code> overwrites <code>din</code> and <code>din</code> overwrites <code>qin</code>.
where each row holds the observations for one subject on the common grid <code>tGrid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optns</code></td>
<td>
<p>a list of options control parameters specified by <code>list(name=value)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Available control options are <code>qSup</code>, <code>nqSup</code>, <code>dSup</code> and other options in FPCA of fdapace.
</p>


<h3>Value</h3>

<p>A list of the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tgridout</code></td>
<td>
<p>Time grid vector for the output time varying object data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Numbers of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>A vector of dimension <code>length(tgridout)</code> giving the mean function support on <code>tgridout</code> of the Fréchet variance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A vector of dimension <code>K</code> containing eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A <code>length(tgridout)</code> X <code>K</code> matrix containing eigenfunctions support on <code>tgridout</code> of the Fréchet variance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xiEst</code></td>
<td>
<p>A <code>n</code> X <code>K</code> matrix containing the FPC estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumFVE</code></td>
<td>
<p>A vector of dimension <code>K</code> with the fraction of the cumulative total variance explained with each additional FPC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FPCAObj</code></td>
<td>
<p>FPCA Object of Fréchet variance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tgridin</code></td>
<td>
<p>Input <code>tgrid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qSup</code></td>
<td>
<p>A vector of dimension <code>length(tgridin)</code> giving the domain grid of quantile functions <code>qout</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qout</code></td>
<td>
<p>A three dimension array of dimension <code>n</code> x <code>length(tgridin)</code> x <code>length(qSup)</code> holding the observed quantiles, such that <code>qout[i,j,]</code> holds the observed density function taking values on <code>qSup</code> corresponding to the ith sample at the jth time grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmean</code></td>
<td>
<p>A <code>length(tgridin)</code> X <code>length(qSup)</code> matrix containing the time varying Fréchet mean function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarTraj</code></td>
<td>
<p>A <code>n</code> X <code>length(tgridin)</code> matrix containing the variance trajectory.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><cite>Dubey, P., &amp; Müller, H. G. (2021). Modeling Time-Varying Random Objects and Dynamic Networks. Journal of the American Statistical Association, 1-33.</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1)
#use yin 
tgrid = seq(1, 50, length.out = 50)
dSup = seq(-10, 60, length.out = 100)
yin = array(dim=c(30, 50, 100))
for(i in 1:30){
  yin[i,,] = t(sapply(tgrid, function(t){
    rnorm(100, mean = rnorm(1, mean = 1, sd = 1/t))
  }))
}
result1 = VarObj(tgrid, yin = yin)
plot(result1$phi[,1])
plot(result1$phi[,2])
yin2 = replicate(30, vector("list", 50), simplify = FALSE)
for(i in 1:30){
  for(j in 1:50){
    yin2[[i]][[j]] = yin[i,j,]
  }}
result1 = VarObj(tgrid, yin = yin2)

# use hin
tgrid = seq(1, 50, length.out = 50)
dSup = seq(-10, 60, length.out = 100)
hin =  replicate(30, vector("list", 50), simplify = FALSE)
for(i in 1:30){
  for (j in 1:50){
    hin[[i]][[j]] = hist(yin[i,j,])
  }
}
result2 = VarObj(tgrid, hin = hin)

# use din
tgrid = seq(1, 50, length.out = 50)
dSup = seq(-10, 60, length.out = 100)
din = array(dim=c(30, 50, 100))
for(i in 1:30){
  din[i,,] = t(sapply(tgrid, function(t){
    dnorm(dSup, mean = rnorm(1, mean = t, sd = 1/t))
  }))
}
result3 = VarObj(tgrid, din = din, optns=list(dSup = dSup))

# use qin
tgrid = seq(1, 50, length.out = 50)
qSup = seq(0.00001,1-0.00001,length.out = 100)
qin = array(dim=c(30, 50, 100))
for(i in 1:30){
  qin[i,,] = t(sapply(tgrid, function(t){
    qnorm(qSup, mean = rnorm(1, mean = t, sd = 1/t))
  }))
}
result4 = VarObj(tgrid, qin = qin, optns=list(qSup = round(qSup, 4)))

</code></pre>


</div>