<div class="container">

<table style="width: 100%;"><tr>
<td>funeigen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform eigenfunction decomposition on functional covariate</h2>

<h3>Description</h3>

<p>A function to do the eigenfunction decomposition
as part of a penalized functional regression as in Goldsmith et al. (2011)
</p>


<h3>Usage</h3>

<pre><code class="language-R">funeigen(id, time, x, num.bins = 35, preferred.num.eigenfunctions = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A vector of subject ID's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A vector of measurement times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A single functional predictor represented as a vector or a one-column matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.bins</code></td>
<td>
<p>The number of knots used in the spline basis for the
beta function. The default is based on the  Goldsmith et al. (2011) 
sample code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preferred.num.eigenfunctions</code></td>
<td>
<p>The number of eigenfunctions to use in approximating the 
covariance function of x (see Goldsmith et al., 2011)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The algorithm for this function follows that of "sparse_simulation.R", which was
written on Nov. 13, 2009, by Jeff Goldsmith; Goldsmith noted that he used some code from Chongzhi Di for the part about
handling sparsity.  "sparse_simulation.R" was part of the supplementary material for
Goldsmith, Bobb, Crainiceanu, Caffo, and Reich (2011).
The <code>num.bins</code> parameter corresponds to  <code>N.fit</code> in Goldsmith et al, <code>sparse_simulation.R</code> and 
<code>preferred.num.eigenfunctions</code> corresponds to <code>Kz</code> in Goldsmith et al.
</p>


<h3>References</h3>

<p>Goldsmith, J., Bobb, J., Crainiceanu, C. M., Caffo, B., and Reich, D.
(2011). Penalized functional regression. Journal of Computational
and Graphical Statistics, 20(4), 830-851. DOI: 10.1198/jcgs.2010.10007.
</p>


<h3>See Also</h3>

<p><code>fitted.funeigen</code>, <code>link{plot.funeigen}</code>
</p>


</div>