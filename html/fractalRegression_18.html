<div class="container">

<table style="width: 100%;"><tr>
<td>mra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale Regression Analysis (MRA)</h2>

<h3>Description</h3>

<p>Fast function for computing multiscale regression analysis (MRA) on long time series. Combining DFA with ordinary least square regression, MRA
is a form of fractal regression that can be used to estimate asymmetric and multiscale regression coefficients between two variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mra(x, y, order, scales)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A real valued vector (i.e., time series data) to be analyzed. A key
difference between DCCA and MRA is that MRA produces asymmetric estiamtes. 
That is, x is assumed to be an independent variable and y is assumed to be 
a dependent variable. MRA should be used when one of the time series in 
question is usefully cast as the independent variable. That is, x is assumed
to effect change in y. If no such causal relationship is anticipated, use
DCCA instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A real valued vector (i.e., time series data) to be analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>is an integer indicating the polynomial order used for 
detrending the local windows (e.g, 1 = linear, 2 = quadratic, etc.). There 
is not a pre-determined limit on the order of the polynomial order but the 
user should avoid using a large polynomial on small windows. This can result
in overfitting and non-meaningful estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>An integer vector of scales over which to compute correlation. 
Unlike univariate DFA, MRA does not require that scales be in log units.
Scale intervals can be sequential, for example, when the analysis is 
exploratory and no a priori hypotheses have been made about the scale of 
correlation. A small subset of targeted scales may also be investigated 
where scale-specific research questions exist. We have found that windows
smaller than say 8 observations create stability problems due to 
overfitting. This is espcially when the order of the fitting polynomial is 
large.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mathematical treatment of the MRA algorithm and its performance can be found in Kristoufek (2015) and Likens et al. (2019).
</p>
<p>Note that under conditions with linear and quadratic trends, Likens et al. (2019) found that there was a systematic positive bias in the <code class="reqn">\beta</code> estimates for larger scales.
Using a polynomial detrending order of 2 or greater was shown to attenuate this bias.
</p>


<h3>Value</h3>

<p>The object returned from the mra() function is a list including the following:
</p>
 
<ul>
<li> <p><code>scales</code> indicates the values of the scales used for estimates
</p>
</li>
<li> <p><code>betas</code> are the scale specific <code class="reqn">\beta</code> estimates of the influence of x on y
</p>
</li>
<li> <p><code>r2</code> is the scale specific r-squared value of the model fit (i.e., variance in y accounted for by x at that scale)
</p>
</li>
<li> <p><code>t_observed</code> is the estimated t-statistic for a given <code class="reqn">\beta</code> at a given scale. 
</p>
</li>
</ul>
<h3>References</h3>

<p>Kristoufek, L. (2015). Detrended fluctuation analysis as a regression framework: Estimating dependence at different scales. Physical Review E, 91(2), 022802.
</p>
<p>Likens, A. D., Amazeen, P. G., West, S. G., &amp; Gibbons, C. T. (2019). Statistical properties of Multiscale Regression Analysis: Simulation and application to human postural control. Physica A: Statistical Mechanics and its Applications, 532, 121580.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Here is a simple example for running MRA using a white noise and pink noise time series.
# For more detailed examples, see the vignette. 

noise &lt;- rnorm(5000)

pink.noise &lt;- fgn_sim(n = 5000, H = 0.9)

scales &lt;- logscale(scale_min = 10, scale_max = 1250, scale_ratio = 1.1)

mra.out &lt;- mra(x = noise, y = pink.noise, order = 1, scales = scales)



</code></pre>


</div>