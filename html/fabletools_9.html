<div class="container">

<table style="width: 100%;"><tr>
<td>aggregate_key</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand a dataset to include other levels of aggregation</h2>

<h3>Description</h3>

<p>Uses the structural specification given in <code>.spec</code> to aggregate a time
series. A grouped structure is specified using <code>grp1 * grp2</code>, and a nested
structure is specified via <code>parent / child</code>. Aggregating the key structure is
commonly used with forecast reconciliation to produce coherent forecasts over
some hierarchy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aggregate_key(.data, .spec, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A tsibble.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.spec</code></td>
<td>
<p>The specification of aggregation structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>&lt;<code>data-masking</code>&gt; Name-value pairs of
summary functions. The name will be the name of the variable in the result.
</p>
<p>The value can be:
</p>

<ul>
<li>
<p> A vector of length 1, e.g. <code>min(x)</code>, <code>n()</code>, or <code>sum(is.na(y))</code>.
</p>
</li>
<li>
<p> A data frame, to add multiple columns from a single expression.
</p>
</li>
</ul>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Returning values with size 0 or &gt;1 was
deprecated as of 1.1.0. Please use <code>reframe()</code> for this instead.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is experimental, and is subject to change in the future.
</p>
<p>The way in which the measured variables are aggregated is specified in a
similar way to how <code style="white-space: pre;">⁠[dplyr::summarise()]⁠</code> is used.
</p>


<h3>See Also</h3>

<p><code>reconcile()</code>, <code>is_aggregated()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tsibble)
tourism %&gt;% 
  aggregate_key(Purpose * (State / Region), Trips = sum(Trips))

</code></pre>


</div>