<div class="container">

<table style="width: 100%;"><tr>
<td>adfCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic Distribution-Free Covariance Matrix of Covariances</h2>

<h3>Description</h3>

<p>Function for computing an asymptotic distribution-free covariance matrix of
covariances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adfCov(X, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Optional vector of criterion scores.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>adfCovMat</code></td>
<td>
<p>Asymptotic distribution-free estimate of the
covariance matrix of covariances</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Jeff Jones and Niels Waller
</p>


<h3>References</h3>

<p>Browne, M. W. (1984). Asymptotically distribution-free methods
for the analysis of covariance structures. <em>British Journal of
Mathematical and Statistical Psychology, 37,</em> 62â€“83.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Generate non-normal data using monte1
set.seed(123)

## we will simulate data for 1000 subjects
N &lt;- 1000

## R = the desired population correlation matrix among predictors
R &lt;- matrix(c(1, .5, .5, 1), 2, 2)

## Consider a regression model with coefficient of determination (Rsq):
Rsq &lt;- .50

## and vector of standardized regression coefficients
Beta &lt;- sqrt(Rsq/t(sqrt(c(.5, .5))) %*% R %*% sqrt(c(.5, .5))) * sqrt(c(.5, .5))

## generate non-normal data for the predictors (X)
## x1 has expected skew = 1 and kurtosis = 3
## x2 has expected skew = 2 and kurtosis = 5
X &lt;- monte1(seed = 123, nvar = 2, nsub = N, cormat = R, skewvec = c(1, 2), 
           kurtvec = c(3, 5))$data
           
## generate criterion scores 
y &lt;- X %*% Beta + sqrt(1-Rsq)*rnorm(N)

## Create ADF Covariance Matrix of Covariances
adfCov(X, y)

#&gt;         11       12       13       22       23       33
#&gt; 11 3.438760 2.317159 2.269080 2.442003 1.962584 1.688631
#&gt; 12 2.317159 3.171722 2.278212 3.349173 2.692097 2.028701
#&gt; 13 2.269080 2.278212 2.303659 2.395033 2.149316 2.106310
#&gt; 22 2.442003 3.349173 2.395033 6.275088 4.086652 2.687647
#&gt; 23 1.962584 2.692097 2.149316 4.086652 3.287088 2.501094
#&gt; 33 1.688631 2.028701 2.106310 2.687647 2.501094 2.818664
</code></pre>


</div>