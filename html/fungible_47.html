<div class="container">

<table style="width: 100%;"><tr>
<td>fsIndeterminacy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Understanding Factor Score Indeterminacy with Finite Dimensional Vector Spaces</h2>

<h3>Description</h3>

<p>This function illustrates the algebra of factor score indeterminacy 
using concepts from finite dimensional vector spaces. Given any factor loading 
matrix, factor correlation matrix, and desired sample size, the program will 
compute a matrix of observed scores and multiple sets of factors
scores.  Each set of (m common and p unique) factors scores will fit the model 
perfectly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fsIndeterminacy(
  Lambda = NULL,
  Phi = NULL,
  N = NULL,
  X = NULL,
  SeedX = NULL,
  SeedBasis = NULL,
  SeedW = NULL,
  SeedT = 1,
  DoFCorrection = TRUE,
  Print = "short",
  Digits = 3,
  Example = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>(Matrix) A p x m matrix of factor loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>(Matrix) An m x m factor correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>(Integer) The desired sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>(Matrix) an optional N x p matrix of observed scores. Note that the observed scores
are expected to fit the factor model (as they will if they are generated 
from simFA and Population = TRUE is specified). Default (<code>X = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SeedX</code></td>
<td>
<p>(Integer) Starting seed for generating the matrix of observed scores, X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SeedBasis</code></td>
<td>
<p>(Integer) Starting seed for generating a basis for all scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SeedW</code></td>
<td>
<p>(Integer) Starting seed for generating a weight matrix that is 
used to construct those parts of the factor scores that lie outside of span(X).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SeedT</code></td>
<td>
<p>(Integer) Starting seed for generating a rotation matrix that 
creates a new set of factor scores from an existing set of scores such that 
the new set also perfectly fits the factor model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DoFCorrection</code></td>
<td>
<p>(Logical) Degrees of freedom correction.  If DoFCorrection = TRUE
then var(x) = 1/(N-1) * t(x) %*% x; else var(x) = 1/N * t(x) %*% x. 
Default (<code>DoFCorrection = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Print</code></td>
<td>
<p>(Character) If <code>Print = "none"</code> no summary information
will be printed.  If <code>Print = "short"</code> then basic output for evaluating
the factor scores will be printed. If <code>Print = "long"</code> extended output
will be printed. Default (<code>Print = "short"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Digits</code></td>
<td>
<p>(Integer) Sets the number of significant digits to print when
printing is requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Example</code></td>
<td>
<p>(Logical) If Example = TRUE the program will
execute the orthogonal two factor model  described  in Waller (2021).</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><strong>"Sigma"</strong>: The p x p model implied covariance matrix.
</p>
</li>
<li> <p><strong>"X"</strong>:  An N x p data matrix for the observed variables. 
</p>
</li>
<li> <p><strong>"Fhat"</strong>: An N x (m + p) matrix of regression factor score estimates. 
</p>
</li>
<li> <p><strong>"Fi"</strong>:  A possible set of common and unique factor scores.
</p>
</li>
<li> <p><strong>"Fj"</strong>: The set of factor scores that are minimally correlated with Fi. 
</p>
</li>
<li> <p><strong>"Fk"</strong>: Another set of common and unique factor scores. 
Note that in a 1-factor model, Fk = Fi.
</p>
</li>
<li> <p><strong>"Fl"</strong>: The set of factor scores that are minimally correlated with Fk. 
Note that in a 1-factor model, Fj = Fl. 
</p>
</li>
<li> <p><strong>"Ei"</strong>: Residual scores for Fi.
</p>
</li>
<li> <p><strong>"Ej"</strong>: Residual scores for Fj.
</p>
</li>
<li> <p><strong>"Ek"</strong>: Residual scores for Fk.
</p>
</li>
<li> <p><strong>"El"</strong>: Residual scores for Fl. 
</p>
</li>
<li> <p><strong>"L"</strong>: The factor loading super matrix.
</p>
</li>
<li> <p><strong>"C"</strong>: The factor correlation super matrix.
</p>
</li>
<li> <p><strong>"V"</strong>: A (non unique) basis for R^N.
</p>
</li>
<li> <p><strong>"W"</strong>: Weight matrix for generating  Zi.
</p>
</li>
<li> <p><strong>"Tmat"</strong>: The orthogonal transformation matrix used to construct Fk  from Fi .
</p>
</li>
<li> <p><strong>"B</strong>:  The matrix that takes Ei to Ek (Ek = Ei B).
</p>
</li>
<li> <p><strong>"Bstar"</strong> In an orthogonal factor model, Bstar takes Fi to Fk (Fk = Fi Bstar). 
In an oblique model the program returns Bstar=NULL.
</p>
</li>
<li> <p><strong>"P"</strong>: The matrix that imposes the proper covariance structure on Ei.
</p>
</li>
<li> <p><strong>"SeedX"</strong>: Starting seed for X.   
</p>
</li>
<li> <p><strong>"SeedBasis"</strong>: Starting seed for the basis. 
</p>
</li>
<li> <p><strong>"SeedW"</strong>: Starting seed for weight matrix W. 
</p>
</li>
<li> <p><strong>"SeedT"</strong>: Starting seed for rotation matrix T.
</p>
</li>
<li> <p><strong>"Guttman"</strong>:  Guttman indeterminacy measures for the common and unique factors.
</p>
</li>
<li> <p><strong>"CovFhat"</strong>: Covariance matrix of estimated factor scores.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Niels G. Waller (nwaller@umn.edu)
</p>


<h3>References</h3>

<p>Guttman, L.  (1955).  The determinacy of factor score matrices 
with applications for five other problems of common factor theory.  
<em>British Journal of Statistical Psychology, 8</em>, 65-82.
</p>
<p>Ledermann, W.  (1938).  The orthogonal transformation of a factorial matrix 
into itself.  <em>Psychometrika, 3</em>, 181-187.
</p>
<p>Schönemann, P. H. (1971). The minimum average correlation 
between equivalent sets of uncorrelated factors. <em>Psychometrika, 36</em>, 
21-30.
</p>
<p>Steiger, J. H. and Schonemann, P. H.  (1978).  In Shye, S. (Ed.), 
<em>A history of factor indeterminacy</em> (pp. 136–178). San  Francisco: Jossey-Bass.
</p>
<p>Waller, N. G. (2021) Understanding factor indeterminacy through the lens of finite 
dimensional vector spaces. Manuscript under review.
</p>


<h3>See Also</h3>

<p>Other Factor Analysis Routines: 
<code>BiFAD()</code>,
<code>Box26</code>,
<code>GenerateBoxData()</code>,
<code>Ledermann()</code>,
<code>SLi()</code>,
<code>SchmidLeiman()</code>,
<code>faAlign()</code>,
<code>faEKC()</code>,
<code>faIB()</code>,
<code>faLocalMin()</code>,
<code>faMB()</code>,
<code>faMain()</code>,
<code>faScores()</code>,
<code>faSort()</code>,
<code>faStandardize()</code>,
<code>faX()</code>,
<code>fals()</code>,
<code>fapa()</code>,
<code>fareg()</code>,
<code>orderFactors()</code>,
<code>print.faMB()</code>,
<code>print.faMain()</code>,
<code>promaxQ()</code>,
<code>summary.faMB()</code>,
<code>summary.faMain()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># ---- Example 1: ----
# To run the example in Waller (2021) enter:
out1 &lt;- fsIndeterminacy(Example = TRUE)

# ---- Example 1: Extended Version: ----

N &lt;- 10 # number of observations
# Generate Lambda: common factor loadings 
#          Phi: Common factor correlation matrix

Lambda &lt;- matrix(c(.8,  0,
                   .7,  0,
                   .6,  0,
                    0, .5,
                    0, .4,
                    0, .3), 6, 2, byrow=TRUE)

out1  &lt;- fsIndeterminacy(Lambda,
                         Phi = NULL,    # orthogonal model
                         SeedX = 1,     # Seed for X
                         SeedBasis = 2, # Seed for Basis
                         SeedW = 3,     # Seed for Weight matrix
                         SeedT = 5,     # Seed for Transformation matrix
                         N = 10,        # Number of subjects
                         Print = "long",
                         Digits = 3)

# Four sets of factor scores
  Fi &lt;- out1$Fi
  Fj &lt;- out1$Fj
  Fk &lt;- out1$Fk
  Fl &lt;- out1$Fl

# Estimated Factor scores
  Fhat &lt;- out1$Fhat

# B wipes out Fhat (in an orthogonal model)
  B &lt;- out1$B
  round( cbind(Fhat[1:5,1:2], (Fhat %*% B)[1:5,1:2]), 3) 

# B takes Ei -&gt; Ek
  Ei &lt;- out1$Ei
  Ek &lt;- out1$Ek
  Ek - (Ei %*% B)

# The Transformation Approach
# Bstar takes Fi --&gt; Fk
  Bstar &lt;- out1$Bstar
  round( Fk - Fi %*% Bstar, 3)

# Bstar L' = L'
  L &lt;- out1$L
  round( L %*% t(Bstar), 3)[,1:2]  


# ---- Example 3 ----
# We choose a different seed for T

out2  &lt;- fsIndeterminacy(Lambda , 
                        Phi = NULL, 
                        X = NULL,
                        SeedX = 1,     # Seed for X 
                        SeedBasis = 2, #  Seed for Basis
                        SeedW = 3,     #  Seed for Weight matrix
                        SeedT = 4,     # Seed for Transformation matrix
                        N,             
                        Print = "long",
                        Digits = 3,
                        Example = FALSE)
 Fi &lt;- out2$Fi
 Fj &lt;- out2$Fj
 Fk &lt;- out2$Fk
 Fl &lt;- out2$Fl
 X  &lt;- out2$X
 
# Notice that all sets of factor scores are model consistent 
 round( t( solve(t(Fi) %*% Fi) %*% t(Fi) %*% X) ,3)
 round( t( solve(t(Fj) %*% Fj) %*% t(Fj) %*% X) ,3)
 round( t( solve(t(Fk) %*% Fk) %*% t(Fk) %*% X) ,3)
 round( t( solve(t(Fl) %*% Fl) %*% t(Fl) %*% X) ,3)
 
# Guttman's Indeterminacy Index
round( (1/N * t(Fi) %*% Fj)[1:2,1:2], 3)

</code></pre>


</div>