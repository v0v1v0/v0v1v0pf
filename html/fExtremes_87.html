<div class="container">

<table style="width: 100%;"><tr>
<td>GpdModelling</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GPD Distributions for Extreme Value Theory</h2>

<h3>Description</h3>

<p>A collection and description to functions to fit and to simulate 
processes that are generated from the generalized Pareto distribution. 
Two approaches for parameter estimation are provided: Maximum 
likelihood estimation and the probability weighted moment method.
<br></p>
<p>The GPD modelling functions are:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>gpdSim</code> </td>
<td style="text-align: left;"> generates data from the GPD, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>gpdFit</code> </td>
<td style="text-align: left;"> fits empirical or simulated data to the distribution, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>print</code> </td>
<td style="text-align: left;"> print method for a fitted GPD object of class ..., </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>plot</code> </td>
<td style="text-align: left;"> plot method for a fitted GPD object, </td>
</tr>
<tr>
<td style="text-align: left;"> 
    <code>summary</code> </td>
<td style="text-align: left;"> summary method for a fitted GPD object. </td>
</tr>
</table>
<h3>Usage</h3>

<pre><code class="language-R">gpdSim(model = list(xi = 0.25, mu = 0, beta = 1), n = 1000,
    seed = NULL)
gpdFit(x, u = quantile(x, 0.95), type = c("mle", "pwm"), information = 
    c("observed", "expected"), title = NULL, description = NULL, ...)

## S4 method for signature 'fGPDFIT'
show(object)
## S3 method for class 'fGPDFIT'
plot(x, which = "ask", ...)
## S3 method for class 'fGPDFIT'
summary(object, doplot = TRUE, which = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>

<p>a character string which allows for a brief description.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doplot</code></td>
<td>

<p>a logical. Should the results be plotted?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>

<p>whether standard errors should be calculated with
<code>"observed"</code> or <code>"expected"</code> information. This only applies
to the maximum likelihood method; for the probability-weighted moments
method <code>"expected"</code> information is used if possible.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>[gpdSim] - <br>
a list with components <code>shape</code>, <code>location</code> and 
<code>scale</code> giving the parameters of the GPD distribution.
By default the shape parameter has the value 0.25, the
location is zero and the scale is one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>[rgpd][gpdSim\ - <br>
the number of observations to be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>[summary] - <br>
a fitted object of class <code>"gpdFit"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>[gpdSim] - <br>
an integer value to set the seed for the random number generator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>a character string which allows for a project title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>a character string selecting the desired estimation method, either
<code>"mle"</code> for the maximum likelihood method or <code>"pwm"</code> for 
the probability weighted moment method. By default, the first will 
be selected. Note, the function <code>gpd</code> uses <code>"ml"</code>.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>the threshold value.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>if <code>which</code> is set to <code>"ask"</code> the function will 
interactively ask which plot should be displayed. By default
this value is set to <code>FALSE</code> and then those plots will
be displayed for which the elements in the logical vector
<code>which</code> ar set to <code>TRUE</code>; by default all four
elements are set to <code>"all"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>[dgpd] - <br>
a numeric vector of quantiles.
<br>
[gpdFit] - <br>
the data vector. Note, there are two different names
for the first argument <code>x</code> and <code>data</code> depending 
which function name is used, either <code>gpdFit</code> or the 
EVIS synonym <code>gpd</code>.
<br>
[print][plot] - <br>
a fitted object of class <code>"gpdFit"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi, mu, beta</code></td>
<td>

<p><code>xi</code> is the shape parameter, 
<code>mu</code> the location parameter,
and <code>beta</code> is the scale parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>control parameters and plot parameters optionally passed to the 
optimization and/or plot function. Parameters for the optimization
function are passed to components of the <code>control</code> argument of
<code>optim</code>.  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Generalized Pareto Distribution:</b>
<br><br>
Compute density, distribution function, quantile function and 
generates random variates for the Generalized Pareto Distribution.
</p>
<p><b>Simulation:</b>
<br><br><code>gpdSim</code> simulates data from a Generalized Pareto 
distribution.
<br></p>
<p><b>Parameter Estimation:</b>
<br><br><code>gpdFit</code> fits the model parameters either by the probability 
weighted moment method or the maxim log likelihood method. 
The function returns an object of class <code>"gpd"</code> 
representing the fit of a generalized Pareto model to excesses over 
a high threshold. The fitting functions use the probability weighted 
moment method, if method <code>method="pwm"</code> was selected, and the 
the general purpose optimization function <code>optim</code> when the 
maximum likelihood estimation, <code>method="mle"</code> or <code>method="ml"</code> 
is chosen.
<br></p>
<p><b>Methods:</b>
<br><br><code>print.gpd</code>, <code>plot.gpd</code> and <code>summary.gpd</code> are print, 
plot, and summary methods for a fitted object of class <code>gpdFit</code>. 
The plot method provides four different plots for assessing fitted 
GPD model. 
<br></p>
<p><b>gpd* Functions:</b>
<br><br><code>gpdqPlot</code> calculates quantile estimates and confidence intervals 
for high quantiles above the threshold in a GPD analysis, and adds a 
graphical representation to an existing plot. The GPD approximation in 
the tail is used to estimate quantile. The <code>"wald"</code> method uses 
the observed Fisher information matrix to calculate confidence interval. 
The <code>"likelihood"</code> method reparametrizes the likelihood in terms 
of the unknown quantile and uses profile likelihood arguments to 
construct a confidence interval. 
<br></p>
<p><code>gpdquantPlot</code> creates a plot showing how the estimate of a 
high quantile in the tail of a dataset based on the GPD approximation 
varies with threshold or number of extremes. For every model 
<code>gpdFit</code> is called. Evaluation may be slow. Confidence intervals 
by the Wald method may be fastest.
<br></p>
<p><code>gpdriskmeasures</code> makes a rapid calculation of point estimates 
of prescribed quantiles and expected shortfalls using the output of the
function <code>gpdFit</code>. This function simply calculates point estimates 
and (at present) makes no attempt to calculate confidence intervals for 
the risk measures. If confidence levels are required use <code>gpdqPlot</code> 
and <code>gpdsfallPlot</code> which interact with graphs of the tail of a loss
distribution and are much slower.  
<br></p>
<p><code>gpdsfallPlot</code> calculates expected shortfall estimates, in other
words tail conditional expectation and confidence intervals for high  
quantiles above the threshold in a GPD analysis. A graphical 
representation to an existing plot is added. Expected shortfall is 
the expected size of the loss, given that a particular quantile of the 
loss distribution is exceeded. The GPD approximation in the tail is used 
to estimate expected shortfall. The likelihood is reparametrized  in 
terms of the unknown expected shortfall and profile likelihood arguments 
are used to construct a confidence interval. 
<br></p>
<p><code>gpdshapePlot</code> creates a plot showing how the estimate of shape 
varies with threshold or number of extremes. For every model 
<code>gpdFit</code> is called. Evaluation may be slow.  
<br></p>
<p><code>gpdtailPlot</code> produces a plot of the tail of the underlying 
distribution of the data.
</p>


<h3>Value</h3>

<p><code>gpdSim</code>
<br>
returns a vector of datapoints from the simulated 
series.
</p>
<p><code>gpdFit</code> 
<br>
returns an object of class <code>"gpd"</code> describing the 
fit including parameter estimates and standard errors. 
</p>
<p><code>gpdQuantPlot</code>
<br>
returns invisible a table of results.
</p>
<p><code>gpdShapePlot</code>
<br>
returns invisible a table of results.
</p>
<p><code>gpdTailPlot</code>
<br>
returns invisible a list object containing 
details of the plot is returned invisibly. This object should be 
used as the first argument of <code>gpdqPlot</code> or <code>gpdsfallPlot</code> 
to add quantile estimates or expected shortfall estimates to the 
plot. 
</p>


<h3>Author(s)</h3>

<p>Alec Stephenson for the functions from R's <code>evd</code> package, <br>
Alec Stephenson for the functions from R's <code>evir</code> package, <br>
Alexander McNeil for the EVIS functions underlying the <code>evir</code> package, <br>
Diethelm Wuertz for this <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>-port.
</p>


<h3>References</h3>

<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997);
<em>Modelling Extremal Events</em>, Springer. 
</p>
<p>Hosking J.R.M., Wallis J.R., (1987);
<em>Parameter and quantile estimation for the generalized
Pareto distribution</em>,   
Technometrics 29, 339â€“349.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## gpdSim  -
   x = gpdSim(model = list(xi = 0.25, mu = 0, beta = 1), n = 1000)
## gpdFit - 
   par(mfrow = c(2, 2), cex = 0.7)  
   fit = gpdFit(x, u = min(x), type = "pwm") 
   print(fit)
   summary(fit)   
</code></pre>


</div>