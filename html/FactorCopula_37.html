<div class="container">

<table style="width: 100%;"><tr>
<td>rFactorTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of 1- and 2-factor tree copula models for item response data</h2>

<h3>Description</h3>

<p>Simulating item response data from the 1- and 2-factor tree copula models.</p>


<h3>Usage</h3>

<pre><code class="language-R">r1factortree(n, d, A, copname1, copnametree, theta1, delta,K)
r2factortree(n, d, A, copname1, copname2, copnametree,theta1, theta2, delta,K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Number of observed variables/items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p><code class="reqn">d \times d</code> vine array with <code class="reqn">1,...,d</code> on diagonal, note only the first row and diagnoal values are used for the 1-truncated vine model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>
<p>copula parameter vector of size <code class="reqn">d</code> for items with the first factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>
<p>copula parameter vector of size <code class="reqn">d</code> for items with the second factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>copula parameter vector of size <code class="reqn">d-1</code> for the 1-truncated vine tree (conditional dependence).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copname1</code></td>
<td>
<p>A name of a bivariate copula that link each of the oberved variabels with the first factor (note only a single copula family for all items with the factor). Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copname2</code></td>
<td>
<p>A name of a bivariate copula that link each of the oberved variabels with the second factor (note only a single copula family for all items with the factor). Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnametree</code></td>
<td>
<p>A name of a bivariate copula that link each of the oberved variabels with one another given the factors in the 1-truncated vine (note only a single copula family for all tree). Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of categories for the observed variables/items.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Data matrix of dimension <code class="reqn">n \times d</code>, where <code class="reqn">n</code> is the sample size, and <code class="reqn">d</code> is the total number of observed variables/items.
</p>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <br>
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman &amp; Hall, London.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2022b)
Factor tree copula models for item response data.
<em>Arxiv e-prints</em>, &lt;arXiv: 2201.00339&gt;. <a href="https://arxiv.org/abs/2201.00339">https://arxiv.org/abs/2201.00339</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># ---------------------------------------------------
# ---------------------------------------------------
#Sample size
n = 500

#Ordinal Variables  ---------------------------------
d = 5

#Categories for ordinal  ----------------------------
K = 5
# ---------------------------------------------------
#              1-2-factor tree copula model
# ---------------------------------------------------
#Copula parameters
theta1 = rep(3, d)
theta2 = rep(2, d)
delta = rep(1.5, d-1)

#Copula names
copulaname_1f = "gum"
copulaname_2f = "gum"
copulaname_vine = "gum"

#vine array
#Dvine
d=5
A=matrix(0,d,d)
A[1,]=c(1,c(1:(d-1)))
diag(A)=1:d



#----------------- Simulating data ------------------
#1-factor tree copula
data_1ft = r1factortree(n, d, A, copulaname_1f, copulaname_vine, 
theta1, delta,K)
#2-factor tree copula
data_2ft = r2factortree(n, d, A, copulaname_1f, copulaname_2f, 
copulaname_vine, theta1,theta2, delta,K)
</code></pre>


</div>