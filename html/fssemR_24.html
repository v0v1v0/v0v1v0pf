<div class="container">

<table style="width: 100%;"><tr>
<td>multiRegression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>multiRegression</h2>

<h3>Description</h3>

<p>Ridge regression on multiple conditions, initialization of FSSEM algorithm
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiRegression(Xs, Ys, Sk, gamma, n, p, k, trans = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xs</code></td>
<td>
<p>eQTL matrices. eQTL matrix can be matrix/list of multiple conditions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Hyperparameter for ridge regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of eQTLs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>if rows for sample, trans = TRUE, otherwise, trans = FALSE. Default FALSE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>fit List of SEM model
</p>

<dl>
<dt>Bs</dt>
<dd>
<p> coefficient matrices of gene regulatory networks</p>
</dd>
<dt>fs</dt>
<dd>
<p> eQTL's coefficients w.r.t each gene</p>
</dd>
<dt>Fs</dt>
<dd>
<p> coefficient matrices of eQTL-gene effect</p>
</dd>
<dt>mu</dt>
<dd>
<p> Bias vector</p>
</dd>
<dt>sigma2</dt>
<dd>
<p> estimate of covariance in SEM</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">seed = 1234
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
## If we assume that different condition has different genetics perturbations (eQTLs)
## data$Data$X = list(data$Data$X, data$Data$X)
gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
                           N, Ng, Nk)
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
</code></pre>


</div>