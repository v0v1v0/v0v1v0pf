<div class="container">

<table style="width: 100%;"><tr>
<td>bg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set background color</h2>

<h3>Description</h3>

<p>Change background color of selected rows and
columns of a flextable. A function can be used instead of
fixed colors.
</p>
<p>When <code>bg</code> is a function, it is possible to color cells based on values
located in other columns, using hidden columns (those not used by
argument <code>colkeys</code>) is a common use case. The argument <code>source</code>
has to be used to define what are the columns to be used for the color
definition and the argument <code>j</code> has to be used to define where to apply
the colors and only accept values from <code>colkeys</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bg(x, i = NULL, j = NULL, bg, part = "body", source = j)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a flextable object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>rows selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>columns selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>color to use as background color. If a function, function need to return
a character vector of colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>partname of the table (one of 'all', 'body', 'header', 'footer')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>if bg is a function, source is specifying the dataset column to be used
as argument to <code>bg</code>. This is only useful if j is colored with values contained in
other columns.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Word does not allow you to apply transparency to table cells or paragraph shading.
</p>


<h3>See Also</h3>

<p>Other sugar functions for table style: 
<code>align()</code>,
<code>bold()</code>,
<code>color()</code>,
<code>empty_blanks()</code>,
<code>font()</code>,
<code>fontsize()</code>,
<code>highlight()</code>,
<code>italic()</code>,
<code>keep_with_next()</code>,
<code>line_spacing()</code>,
<code>padding()</code>,
<code>rotate()</code>,
<code>tab_settings()</code>,
<code>valign()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ft_1 &lt;- flextable(head(mtcars))
ft_1 &lt;- bg(ft_1, bg = "wheat", part = "header")
ft_1 &lt;- bg(ft_1, i = ~ qsec &lt; 18, bg = "#EFEFEF", part = "body")
ft_1 &lt;- bg(ft_1, j = "drat", bg = "#606060", part = "all")
ft_1 &lt;- color(ft_1, j = "drat", color = "white", part = "all")
ft_1

if (require("scales")) {
  ft_2 &lt;- flextable(head(iris))
  colourer &lt;- col_numeric(
    palette = c("wheat", "red"),
    domain = c(0, 7)
  )
  ft_2 &lt;- bg(ft_2,
    j = c(
      "Sepal.Length", "Sepal.Width",
      "Petal.Length", "Petal.Width"
    ),
    bg = colourer, part = "body"
  )
  ft_2
}
</code></pre>


</div>