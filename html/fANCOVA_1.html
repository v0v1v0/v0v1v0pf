<div class="container">

<table style="width: 100%;"><tr>
<td>loess.ancova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a semiparametric ANCOVA model with a local polynomial smoother
</h2>

<h3>Description</h3>

<p>Fit a semiparametric ANCOVA model with a local polynomial smoother. The specific model considered here is
</p>
<p>y_ij= g_i + m(x_ij) + e_ij,
</p>
<p>where the parametric part of the model, g_i, is a factor variable; the nonparametric part of the model, m(.), is a nonparametric smooth function; e_ij are independent identically distributed errors. The errors e_ij do not have to be independent N(0, sigma^2) errors. The errors can be heteroscedastic, i.e., e_ij = sigma_i(x_ij) * u_ij, where u_ij are independent identically distributed errors with mean 0 and variance 1. The model is fitted by the direct estimation method (Speckman, 1988), or by the backfitting method (Buja, Hastie and Tibshirani, 1989; Hastie and Tibshirani, 1990).
</p>


<h3>Usage</h3>

<pre><code class="language-R">loess.ancova(x, y, group, degree = 2, criterion = c("aicc", "gcv"), 
		family = c("gaussian", "symmetric"), method=c("Speckman", "Backfitting"), 
		iter = 10, tol = 0.01, user.span = NULL, plot = FALSE, 
		data.points = FALSE, legend.position = "topright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector or two-column matrix of covariate values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a vector of response values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>a vector of group indicators that has the same length as y.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>

<p>the degree of the local polynomials to be used. It can ben 0, 1 or 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>

<p>the criterion for automatic smoothing parameter selection: “aicc” denotes bias-corrected AIC criterion, “gcv” denotes generalized cross-validation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>if “gaussian” fitting is by least-squares, and if “symmetric” a re-descending M estimator is used with Tukey's biweight function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>if “Speckman” the direct estimation method by Speckman (1988) will be used, and if “Backfitting” The model is fitted by the backfitting method (Buja, Hastie and Tibshirani, 1989; Hastie and Tibshirani, 1990).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>the number of iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>the number of tolerance in the iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user.span</code></td>
<td>

<p>the user-defined parameter which controls the degree of smoothing. If it is not specified, the smoothing parameter will be selected by “aicc” or “gcv” criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>if TRUE (when x is one-dimensional), the fitted curves for all groups will be generated; if TRUE (when x is two-dimensional), only the smooth component in the model will be plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.points</code></td>
<td>

<p>if TRUE, the data points will be displayed in the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>

<p>the position of legend in the plot: “topright”, “topleft”, “bottomright”, “bottomleft”, etc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>control parameters.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fit a local polynomial regression with automatic smoothing parameter selection. The predictor x can either one-dimensional or two-dimensional.
</p>


<h3>Value</h3>

<p>a list of a vector of the parametric estimates and an object of class “loess”.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>


<h3>References</h3>

<p>Speckman, P. (1988). Kernel Smoothing in Partial Linear Models. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, 50, 413–436.
</p>
<p>Buja, A., Hastie, T. J. and Tibshirani, R. J. (1989). Linear smoothers and additive
models (with discussion). <em>Annals of Statistics</em>, 17, 453–555.
</p>
<p>Hastie, T. J. and Tibshirani, R. J. (1990). <em>Generalized Additive Models</em>. Vol. 43 of
Monographs on Statistics and Applied Probability, Chapman and Hall, London.
</p>


<h3>See Also</h3>

<p><code>loess</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fit semiparametric ANCOVA model
set.seed(555)
n1 &lt;- 80
x1 &lt;- runif(n1,min=0, max=3)
sd1 &lt;- 0.3
e1 &lt;- rnorm(n1,sd=sd1)
y1 &lt;- 3*cos(pi*x1/2)  + 6 + e1

n2 &lt;- 75
x2 &lt;- runif(n2, min=0, max=3)
sd2 &lt;- 0.2
e2 &lt;- rnorm(n2, sd=sd2)
y2 &lt;- 3*cos(pi*x2/2) + 3 + e2

n3 &lt;- 90
x3 &lt;- runif(n3, min=0, max=3)
sd3 &lt;- 0.3
e3 &lt;- rnorm(n3, sd=sd3)
y3 &lt;- 3*cos(pi*x3/2)  + e3

data.bind &lt;- rbind(cbind(x1,y1,1), cbind(x2,y2,2),cbind(x3,y3,3))
data.bind &lt;- data.frame(data.bind)
colnames(data.bind)=c('x','y','group') 

x &lt;- data.bind[,1]
y &lt;- data.bind[,2]
group &lt;- data.bind[,3]

loess.ancova(x,y,group, plot=TRUE, data.points=TRUE)

## Fit semiparametric ANCOVA model when the predictor is two-dimensional
n1 &lt;- 100
x11 &lt;- runif(n1,min=0, max=3)
x12 &lt;- runif(n1,min=0, max=3)
sd1 &lt;- 0.2
e1 &lt;- rnorm(n1,sd=sd1)
y1 &lt;- sin(2*x11) + sin(2*x12)  + e1

n2 &lt;- 100
x21 &lt;- runif(n2, min=0, max=3)
x22 &lt;- runif(n2, min=0, max=3)
sd2 &lt;- 0.25
e2 &lt;- rnorm(n2, sd=sd2)
y2 &lt;- sin(2*x21) + sin(2*x22) + 1 + e2

n3 &lt;- 120
x31 &lt;- runif(n3, min=0, max=3)
x32 &lt;- runif(n3, min=0, max=3)
sd3 &lt;- 0.25
e3 &lt;- rnorm(n3, sd=sd3)
y3 &lt;- sin(2*x31) + sin(2*x32) + 3 + e3

data.bind &lt;- rbind(cbind(x11, x12 ,y1,1), cbind(x21, x22, y2,2),cbind(x31, x32,y3,3))
data.bind &lt;- data.frame(data.bind)
colnames(data.bind)=c('x1','x2', 'y','group') 

loess.ancova(data.bind[,c(1,2)], data.bind$y, data.bind$group, plot=TRUE)
</code></pre>


</div>