<div class="container">

<table style="width: 100%;"><tr>
<td>PEL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo empirical likelihood estimator</h2>

<h3>Description</h3>

<p>Produces estimates for population totals using the pseudo empirical likelihood estimator from survey data obtained
from a dual frame sampling design. Confidence intervals for the population total are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PEL(ysA, ysB, pi_A, pi_B, domains_A, domains_B, N_A = NULL, N_B = NULL, 
N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, xsBFrameB = NULL, 
XA = NULL, XB = NULL, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "a" and "ab".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are "b" and "ba".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pseudo empirical likelihood estimator for the population mean is computed as
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{Y}}_{PEL} = \frac{N_a}{N}\hat{\bar{Y}}_a + \frac{\eta N_{ab}}{N}\hat{\bar{Y}}_{ab}^A + \frac{(1 - \eta) N_{ab}}{N}\hat{\bar{Y}}_{ab}^B + \frac{N_b}{N}\hat{\bar{Y}}_b</code>
</p>

<p>where <code class="reqn">\hat{\bar{Y}}_a = \sum_{k \in s_a}\hat{p}_{ak}y_k, \hat{\bar{Y}}_{ab} = \sum_{k \in s_{ab}^A}\hat{p}_{abk}^Ay_k, \hat{\bar{Y}}_{ab}^B = \sum_{k \in s_{ab}^B}\hat{p}_{abk}^By_k</code>
and <code class="reqn">\hat{\bar{Y}}_b = \sum_{k \in s_b}\hat{p}_{bk}y_k</code> with <code class="reqn">\hat{p}_{ak}, \hat{p}_{abk}^A, \hat{p}_{abk}^B</code> and <code class="reqn">\hat{p}_{bk}</code> the weights resulting of applying the pseudo empirical likelihood procedure to a determined function under a determined set of constraints, depending on the case. 
Furthermore, <code class="reqn">\eta \in (0,1)</code>. In this case, <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> have been supposed known and no additional auxiliary variables have been considered. This is not happening in some cases.
Function covers following scenarios:
</p>

<ul>
<li>
<p> There is not any additional auxiliary variable 
</p>

<ul>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li>
</ul>
</li>
<li>
<p> At least, one additional auxiliary variable is available 
</p>

<ul>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li>
</ul>
</li>
</ul>
<p>Explicit variance of this estimator is not easy to obtain. Instead, confidence intervals can be computed through the bi-section method. This method constructs intervals in the form <code class="reqn">\{\theta|r_{ns}(\theta) &lt; \chi_1^2(\alpha)\}</code>, 
where <code class="reqn">\chi_1^2(\alpha)</code> is the <code class="reqn">1 - \alpha</code> quantile from a <code class="reqn">\chi^2</code> distribution with one degree of freedom and <code class="reqn">r_{ns}(\theta)</code> represents the so called pseudo empirical log likelihood ratio statistic, 
which can be obtained as a difference of two pseudo empirical likelihood functions.
</p>


<h3>Value</h3>

<p><code>PEL</code> returns an object of class "EstimatorDF" which is a list with, at least, the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td>
</tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table><tr style="vertical-align: top;">
<td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td>
</tr></table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Rao, J. N. K. and Wu, C. (2010)
<em>Pseudo Empirical Likelihood Inference for Multiple Frame Surveys</em>.
Journal of the American Statistical Association, 105, 1494 - 1503.
</p>
<p>Wu, C. (2005)
<em>Algorithms and R codes for the pseudo empirical likelihood methods in survey sampling</em>.
Survey Methodology, Vol. 31, 2, pp. 239 - 243.
</p>


<h3>See Also</h3>

<p><code>JackPEL</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate pseudo empirical likelihood estimator for variable Feeding, without
#considering any auxiliary information
PEL(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate pseudo empirical estimator for variable Clothing when the frame
#sizes and the overlap domain size are known
PEL(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191, N_ab = 601)

#Finally, let calculate pseudo empirical likelihood estimator and a 90% confidence interval
#for population total for variable Feeding, considering Income and Metres2 as auxiliary 
#variables and with frame sizes and overlap domain size known.
PEL(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B =  1191, N_ab = 601, xsAFrameA = DatA$Inc, xsBFrameA = DatB$Inc, 
xsAFrameB = DatA$M2, xsBFrameB = DatB$M2, XA = 4300260, XB = 176553, 
conf_level = 0.90)
</code></pre>


</div>