<div class="container">

<table style="width: 100%;"><tr>
<td>faX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factor Extraction (faX) Routines</h2>

<h3>Description</h3>

<p>This function can be used to extract an unrotated factor structure matrix 
using the following algorithms: (a) unweighted least squares ("fals"); 
(b) maximum likelihood ("faml"); (c) iterated principal axis factoring ("fapa");
and (d) principal components analysis ("pca").
</p>


<h3>Usage</h3>

<pre><code class="language-R">faX(R, n = NULL, numFactors = NULL, facMethod = "fals", faControl = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>(Matrix) A correlation matrix used for factor extraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>(Numeric) Sample size associated with the correlation matrix. 
Defaults to n = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numFactors</code></td>
<td>
<p>(Numeric) The number of factors to extract for subsequent rotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facMethod</code></td>
<td>
<p>(Character) The method used for factor extraction. The 
supported options are "fals" for unweighted least squares, "faml" for maximum 
likelihood, "fapa" for iterated principal axis factoring, and "pca" for 
principal components analysis. The default method is "fals".
</p>

<ul>
<li> <p><strong>"fals"</strong>: Factors are extracted using the unweighted least 
squares estimation procedure using the <code>fals</code> function.
</p>
</li>
<li> <p><strong>"faml"</strong>: Factors are extracted using the maximum likelihood 
estimation procedure using the <code>factanal</code> function.
</p>
</li>
<li> <p><strong>"faregLS"</strong>: Factors are extracted using regularized 
least squares factor analysis using the <code>fareg</code> function. 
</p>
</li>
<li> <p><strong>"faregML"</strong>: Factors are extracted using regularized 
maximum likelihood factor using the <code>fareg</code> function. 
</p>
</li>
<li> <p><strong>"fapa"</strong>: Factors are extracted using the iterated principal 
axis factoring estimation procedure using the <code>fapa</code> function.
</p>
</li>
<li> <p><strong>"pca"</strong>: Principal components are extracted. 
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faControl</code></td>
<td>
<p>(List) A list of optional parameters passed to the factor 
extraction (<code>faX</code>) function.
</p>

<ul>
<li> <p><strong>treatHeywood</strong>: (Logical) In <code>fals</code>, if treatHeywood is 
true, a penalized least squares function is used to bound the communality 
estimates below 1.0. Defaults to treatHeywood = TRUE.
</p>
</li>
<li> <p><strong>nStart</strong>: (Numeric) The number of starting values to be tried 
in <code>faml</code>. Defaults to nStart = 10.
</p>
</li>
<li> <p><strong>start</strong>: (Matrix) NULL or a matrix of starting values, each column 
giving an initial set of uniquenesses. Defaults to start = NULL. 
</p>
</li>
<li> <p><strong>maxCommunality</strong>: (Numeric) In <code>faml</code>, set the maximum 
communality value for the estimated solution. Defaults to maxCommunality = .995.
</p>
</li>
<li> <p><strong>epsilon</strong>: (Numeric) In <code>fapa</code>, the numeric threshold 
designating when the algorithm has converged. Defaults to epsilon = 1e-4.
</p>
</li>
<li> <p><strong>communality</strong>: (Character) The method used to estimate the 
initial communality values in <code>fapa</code>. Defaults to communality = 'SMC'.
</p>

<ul>
<li> <p><strong>"SMC"</strong>: Initial communalities are estimated by taking the 
squared multiple correlations of each indicator after regressing the 
indicator on the remaining variables.
</p>
</li>
<li> <p><strong>"maxr"</strong>: Initial communalities equal the largest 
(absolute value) correlation in each column of the correlation matrix.
</p>
</li>
<li> <p><strong>"unity"</strong>: Initial communalities equal 1.0 for all variables.
</p>
</li>
</ul>
</li>
<li> <p><strong>maxItr</strong>: (Numeric) In <code>fapa</code>, the maximum number of 
iterations to reach convergence. Defaults to maxItr = 15,000.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>


<ul><li> <p><strong>Initial communality estimate</strong>: According to Widaman and 
Herringer (1985), the initial communality estimate does not have much 
bearing on the resulting solution <em>when the a stringent convergence 
criterion is used</em>. In their analyses, a convergence criterion of .001 
(i.e., slightly less stringent than the default of 1e-4) is sufficiently 
stringent to produce virtually identical communality estimates irrespective 
of the initial estimate used. It should be noted that all four methods for 
estimating the initial communality in Widaman and Herringer (1985) are the 
exact same used in this function. Based on their findings, it is not 
recommended to use a convergence criterion lower than 1e-3.
</p>
</li></ul>
<h3>Value</h3>

<p>This function returns a list of output relating to the extracted factor loadings.
</p>

<ul>
<li> <p><strong>loadings</strong>: (Matrix) An unrotated factor structure matrix.
</p>
</li>
<li> <p><strong>h2</strong>: (Vector) Vector of final communality estimates.
</p>
</li>
<li> <p><strong>faFit</strong>: (List) A list of additional factor extraction output.
</p>

<ul>
<li> <p><strong>facMethod</strong>: (Character) The factor extraction routine.
</p>
</li>
<li> <p><strong>df</strong>: (Numeric) Degrees of Freedom from the maximum 
likelihood factor extraction routine.
</p>
</li>
<li> <p><strong>n</strong>: (Numeric) Sample size associated with the correlation matrix.
</p>
</li>
<li> <p><strong>objectiveFunc</strong>: (Numeric) The evaluated objective function for the 
maximum likelihood factor extraction routine. 
</p>
</li>
<li> <p><strong>RMSEA</strong>: (Numeric) Root mean squared error of approximation 
from Steiger &amp; Lind (1980). Note that bias correction is computed if the 
sample size is provided.
</p>
</li>
<li> <p><strong>testStat</strong>: (Numeric) The significance test statistic for the maximum 
likelihood procedure. Cannot be computed unless a sample size is provided. 
</p>
</li>
<li> <p><strong>pValue</strong>: (Numeric) The p value associated with the significance test 
statistic for the maximum likelihood procedure. Cannot be computed unless 
a sample size is provided. 
</p>
</li>
<li> <p><strong>gradient</strong>: (Matrix) The solution gradient for the least squares factor 
extraction routine. 
</p>
</li>
<li> <p><strong>maxAbsGradient</strong>: (Numeric) The maximum absolute value of the 
gradient at the least squares solution. 
</p>
</li>
<li> <p><strong>Heywood</strong>: (Logical) TRUE if a Heywood case was produced.
</p>
</li>
<li> <p><strong>converged</strong>: (Logical) TRUE if the least squares or 
principal axis factor extraction routine converged. 
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>


<ul>
<li>
<p> Casey Giordano (Giord023@umn.edu)
</p>
</li>
<li>
<p> Niels G. Waller (nwaller@umn.edu)
</p>
</li>
</ul>
<h3>References</h3>

<p>Jung, S. &amp; Takane, Y.  (2008).  Regularized common factor analysis.  
New trends in psychometrics, 141-149.
</p>
<p>Steiger, J. H., &amp; Lind, J. (1980). Paper presented at the annual 
meeting of the Psychometric Society. <em>Statistically-based tests for the 
number of common factors.</em>
</p>
<p>Widaman, K. F., &amp; Herringer, L. G. (1985). Iterative least squares 
estimates of communality: Initial estimate need not affect stabilized value. 
<em>Psychometrika, 50</em>(4), 469-477.
</p>


<h3>See Also</h3>

<p>Other Factor Analysis Routines: 
<code>BiFAD()</code>,
<code>Box26</code>,
<code>GenerateBoxData()</code>,
<code>Ledermann()</code>,
<code>SLi()</code>,
<code>SchmidLeiman()</code>,
<code>faAlign()</code>,
<code>faEKC()</code>,
<code>faIB()</code>,
<code>faLocalMin()</code>,
<code>faMB()</code>,
<code>faMain()</code>,
<code>faScores()</code>,
<code>faSort()</code>,
<code>faStandardize()</code>,
<code>fals()</code>,
<code>fapa()</code>,
<code>fareg()</code>,
<code>fsIndeterminacy()</code>,
<code>orderFactors()</code>,
<code>print.faMB()</code>,
<code>print.faMain()</code>,
<code>promaxQ()</code>,
<code>summary.faMB()</code>,
<code>summary.faMain()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate an example factor structure matrix
lambda &lt;- matrix(c(.62, .00, .00,
                   .54, .00, .00,
                   .41, .00, .00,
                   .00, .31, .00,
                   .00, .58, .00,
                   .00, .62, .00,
                   .00, .00, .38,
                   .00, .00, .43,
                   .00, .00, .37),
                 nrow = 9, ncol = 3, byrow = TRUE)

## Find the model implied correlation matrix
R &lt;- lambda %*% t(lambda)
diag(R) &lt;- 1

## Extract (principal axis) factors using the factExtract function
Out1 &lt;- faX(R          = R,
            numFactors = 3,
            facMethod  = "fapa",
            faControl  = list(communality = "maxr",
                              epsilon     = 1e-4))

## Extract (least squares) factors using the factExtract function
Out2 &lt;- faX(R          = R,
            numFactors = 3,
            facMethod  = "fals",
            faControl  = list(treatHeywood = TRUE))

</code></pre>


</div>