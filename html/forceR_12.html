<div class="container">

<table style="width: 100%;"><tr>
<td>find_strongest_peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Peaks</h2>

<h3>Description</h3>

<p>Identifies peaks in a first iteration and optimizes the starts and ends of the strongest peaks per species in a second iteration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_strongest_peaks(
  df,
  no.of.peaks = 5,
  initial.threshold = 0.05,
  slope.length.start = 5,
  slope.length.end = 5,
  slope.thresh.start = 0.02,
  slope.thresh.end = 0.02,
  path.data = NULL,
  path.plots = NULL,
  show.progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A data frame or tibble in the below format. The columns <code>t</code> (= time), <code>force</code> and <code>measurement</code>
(= measurement ID) must be present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.of.peaks</code></td>
<td>
<p>A numeric value defining how many peaks per <code>species</code> (not per <code>measurement</code>") should be identified. The function will always return
the strongest peaks. Default: <code>5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.threshold</code></td>
<td>
<p>A numeric value defining the threshold (in % of the maximum force of the measurement)
that is used during the first iteration. Default: <code>0.05</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.length.start</code></td>
<td>
<p>A numeric value defining the window size (in time steps) of
slope calculation for peak starts during the second iteration. Default: <code>5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.length.end</code></td>
<td>
<p>A numeric value defining the window size (in time steps) of
slope calculation for peak ends during the second iteration. Default: <code>5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.thresh.start</code></td>
<td>
<p>A numeric value defining the threshold at which to stop the sliding window and save the
current time point as the actual start of the current peak. Default: <code>0.04</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.thresh.end</code></td>
<td>
<p>A numeric value defining the threshold at which to stop the sliding window and save the
current time point as the actual end of the current peak. Default: <code>0.04</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.data</code></td>
<td>
<p>A string character defining where to save the results. If <code>NULL</code> (default),
data is not stored in a file. Default: <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.plots</code></td>
<td>
<p>A string character defining where to save the plots. Default: <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.progress</code></td>
<td>
<p>A logical value indicating if progress should be
printed to the console. Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input data frame <code>df</code> needs to contain the following columns:</p>

<table>
<tr>
<td style="text-align: center;">
   <strong><code>t</code></strong> </td>
<td style="text-align: center;"> <strong><code>force</code></strong> </td>
<td style="text-align: center;"> <strong><code>measurement</code></strong> </td>
</tr>
<tr>
<td style="text-align: center;">
   <code>t.1</code> </td>
<td style="text-align: center;"> <code>force.1</code> </td>
<td style="text-align: center;"> <code>measurement.1</code> </td>
</tr>
<tr>
<td style="text-align: center;">
   <code>...</code> </td>
<td style="text-align: center;"> <code>...</code> </td>
<td style="text-align: center;"> <code>...</code> </td>
</tr>
<tr>
<td style="text-align: center;">
   <code>t.n</code> </td>
<td style="text-align: center;"> <code>force.n</code> </td>
<td style="text-align: center;"> <code>measurement.m</code> </td>
</tr>
<tr>
<td style="text-align: center;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>Creates a tibble in the following format and saves it as a CSV-file:
The column <strong><code>species</code></strong> contains one species per row<br> (<code style="white-space: pre;">⁠species.1 ... species.n⁠</code>).
</p>
<p>The column <strong><code>measurements</code></strong> contains as many measurements as <code>no.of.peaks</code>, separated by '<code style="white-space: pre;">⁠;⁠</code>':<br> (<code style="white-space: pre;">⁠measurement.1; ...; measurements.no.of.peaks⁠</code>).
</p>
<p>The column <strong><code>starts</code></strong> contains as many peak starts as <code>no.of.peaks</code>, separated by '<code style="white-space: pre;">⁠;⁠</code>':<br> (<code style="white-space: pre;">⁠start.1; ...; start.no.of.peaks⁠</code>).
</p>
<p>The column <strong><code>ends</code></strong> contains as many peak ends as <code>no.of.peaks</code>, separated by '<code style="white-space: pre;">⁠;⁠</code>':<br> (<code style="white-space: pre;">⁠end.1; ...; end.no.of.peaks⁠</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(dplyr)
# Using the forceR::df.all.200.tax dataset:

# reduce dataset (only rows 40 to 95 of species A (containing data of
  # measurement 1 and 2 (m_01 and m_02)))
df.all.200.tax_filtered &lt;- forceR::df.all.200.tax[40:95, ] %&gt;%
  filter(species == "species_A")

# find the 4 strongest peaks
peaks.df &lt;- find_strongest_peaks(df = df.all.200.tax_filtered,
                                 no.of.peaks = 4)

# plot results (three peaks in measurement 1, 1 peak in measurement 2):
# plot_peaks(df.peaks = peaks.df,
#            df.data = df.all.200.tax_filtered,
#            additional.msecs = 20)

</code></pre>


</div>