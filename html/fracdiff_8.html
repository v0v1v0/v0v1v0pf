<div class="container">

<table style="width: 100%;"><tr>
<td>fracdiff.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate fractional ARIMA Time Series</h2>

<h3>Description</h3>

<p>Generates simulated long-memory time series data from the
fractional ARIMA(p,d,q) model.  This is a test problem generator for
<code>fracdiff</code>.
</p>
<p>Note that the MA coefficients have <em>inverted</em> signs
compared to other parametrizations, see the details in
<code>fracdiff</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fracdiff.sim(n, ar = NULL, ma = NULL, d,
             rand.gen = rnorm, innov = rand.gen(n+q, ...),
             n.start = NA, backComp = TRUE, allow.0.nstart = FALSE,
             start.innov = rand.gen(n.start, ...),
             ..., mu = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>length of the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar</code></td>
<td>
<p>vector of autoregressive parameters; empty by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma</code></td>
<td>
<p>vector of moving average parameters; empty by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>fractional differencing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand.gen</code></td>
<td>
<p>a function to generate the innovations; the default,
<code>rnorm</code> generates white N(0,1) noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>innov</code></td>
<td>
<p>an optional times series of innovations.  If not
provided, <code>rand.gen()</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.start</code></td>
<td>
<p>length of “burn-in” period.  If <code>NA</code>, the
default, the same value as in <code>arima.sim</code> is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backComp</code></td>
<td>
<p>logical indicating if back compatibility with older
versions of <code>fracdiff.sim</code> is desired.  Otherwise, for
<code>d = 0</code>, compatibility with <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s <code>arima.sim</code> is
achieved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow.0.nstart</code></td>
<td>
<p>logical indicating if <code>n.start = 0</code> should
be allowed even when <code class="reqn">p + q &gt; 0</code>.  This not recommended unless
for producing the same series as with older versions of
<code>fracdiff.sim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.innov</code></td>
<td>
<p>an optional vector of innovations to be used for
the burn-in period.  If supplied there must be at least
<code>n.start</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for <code>rand.gen()</code>.  Most usefully,
the standard deviation of the innovations generated by <code>rnorm</code>
can be specified by <code>sd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>time series mean (added at the end).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the following elements :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar, ma, d, mu, n.start</code></td>
<td>
<p>same as input</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>fracdiff</code>, also for references;
<code>arima.sim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Pretty (too) short to "see" the long memory
fracdiff.sim(100, ar = .2, ma = .4, d = .3)

## longer with "extreme" ar:
r &lt;- fracdiff.sim(n=1500, ar=-0.9, d= 0.3)
plot(as.ts(r$series))

## Show that  MA  coefficients meaning is inverted
## compared to   stats :: arima :

AR &lt;- 0.7
MA &lt;- -0.5
n.st &lt;- 2

AR &lt;- c(0.7, -0.1)
MA &lt;- c(-0.5, 0.4)
n &lt;- 512 ; sd &lt;- 0.1
n.st &lt;- 10

set.seed(101)
Y1 &lt;- arima.sim(list(ar = AR, ma = MA), n = n, n.start = n.st, sd = sd)
plot(Y1)

# For our fracdiff, reverse the MA sign:
set.seed(101)
Y2 &lt;- fracdiff.sim(n = n, ar = AR, ma = - MA, d = 0,
                   n.start = n.st, sd = sd)$series
lines(Y2, col=adjustcolor("red", 0.5))
## .. no, you don't need glasses ;-)  Y2 is Y1 shifted slightly

##' rotate left by k (k &lt; 0: rotate right)
rot &lt;- function(x, k) {
  stopifnot(k == round(k))
  n &lt;- length(x)
  if(k &lt;- k %% n) x[c((k+1):n, 1:k)] else x
}
k &lt;- n.st - 2
Y2.s &lt;- rot(Y2, k)
head.matrix(cbind(Y1, Y2.s))
plot(Y1, Y2.s); i &lt;- (n-k+1):n
text(Y1[i], Y2.s[i], i, adj = c(0,0)-.1, col=2)

## With  backComp = FALSE,  get *the same* as arima.sim():
set.seed(101)
Y2. &lt;- fracdiff.sim(n = n, ar = AR, ma = - MA, d = 0,
                    n.start = n.st, sd = sd, backComp = FALSE)$series
stopifnot( all.equal( c(Y1), Y2., tolerance= 1e-15))
</code></pre>


</div>