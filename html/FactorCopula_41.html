<div class="container">

<table style="width: 100%;"><tr>
<td>Select.FactorTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model selection of the 1- and 2-factor tree copula models for item response data</h2>

<h3>Description</h3>

<p>Heuristic algorithms that automatically select the bivariate parametric copula families and 1-truncated vine tree structure for the 1- and 2-factor tree copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class="language-R">selectFactorTrVine(y,rmat,alg)
copselect1FactorTree(y, A, copnames, gl)
copselect2FactorTree(y, A, copnames, gl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the item reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmat</code></td>
<td>
<p>Polychoric correlation matrix of y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>1-truncated vine selection using partial and polychoric correlations. Choose a number from (1,2,3). 
<b>1</b>: Partial correlation selection algorithm for 1-factor tree copula.
<b>2</b>: Partial correlation selection algorithm for 2-factor tree copula.
<b>3</b>: Polychoric correlation selection algorithm for 1-factor/2-factor tree copulas, here any other correlation matrix (rmat) can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p><code class="reqn">d \times d</code> vine array with <code class="reqn">1,...,d</code> on diagonal, note only the first row and diagnoal values are used for the 1-truncated vine model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames</code></td>
<td>
<p>A vector with the names of possible candidates of bivariate copulas to be selected for the 1-factor/2-factor copula models for item response data. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model selection involves two separate steps. At the first step we select the 1-truncated vine or Markov tree structure assuming our models are constructed with BVN copulas. We find the maximum spanning tree which is a tree on all nodes that maximizes the pairwise dependencies using the well-known algorithm of Prim (1957).   That is we find the tree with <code class="reqn">d-1</code> edges <code class="reqn">\mathcal{E}</code> that minimizes 
<code class="reqn">\sum_{\mathcal{E}}\log(1-r_{jk}^2).</code>
The minimum spanning tree algorithm of Prim (1957)
guarantees to find the optimal solution when edge weights between nodes  are given by <code class="reqn">\log(1-r_{jk}^2)</code>. 
We use two  different measures of pairwise dependence <code class="reqn">r_{jk}</code>. The first measure is the estimated  polychoric correlation (Olsson, 1979). The second measures of pairwise dependence is  the partial correlation which is based on the  factor copula models in   Nikoloulopoulos and Joe (2015) with BVN copulas;  for more details see Kadhem and Nikoloulopoulos (2022).  We call polychoric and partial correlation selection algorithm when the pairwise dependence is the polychoric and partial correlation, respectively.
</p>
<p>At the the second step, we sequentially select suitable bivariate copulas to account for any tail dependence/asymmetry. We start from the 1st tree that includes copulas connecting the observed variables to the first factor and then we iterate over a set of copula candidates and select suitable bivariate copulas in the subsequent trees. We select only one copula family for all the edges in each tree to ease interpretation.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>“1Factor copulas”</code></td>
<td>
<p>The selected bivariate linking copulas for the first factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>“2Factor copulas”</code></td>
<td>
<p>The selected bivariate linking copulas for the second factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>“Vine tree copulas”</code></td>
<td>
<p>The selected bivariate linking copulas for the 1-truncated vine tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>“log-likelihood”</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>“estimated taus”</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F1treeA</code></td>
<td>
<p>Vine array for the 1-factor tree copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F2treeA</code></td>
<td>
<p>Vine array for the 2-factor tree copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmat_f1</code></td>
<td>
<p>Partial correlation matrix for the 1-factor tree copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmat_f2</code></td>
<td>
<p>Partial correlation matrix for the 2-factor tree copula.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sayed H. Kadhem <br>
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Fontenla, M. (2014).
<em>optrees: Optimal Trees in Weighted Graphs</em>.
R package version 1.0.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2022)
Factor tree copula models for item response data.
<em>Arxiv e-prints</em>, &lt;arXiv: 2201.00339&gt;. <a href="https://arxiv.org/abs/2201.00339">https://arxiv.org/abs/2201.00339</a>.
</p>
<p>Nikoloulopoulos, A.K. and Joe, H. (2015)
Factor copula models with item response data.
<em>Psychometrika</em>, <b>80</b>, 126–150. <a href="https://doi.org/10.1007/s11336-013-9387-4">doi:10.1007/s11336-013-9387-4</a>.
</p>
<p>Olsson, F. (1979) Maximum likelihood estimation of the polychoric correlation coefficient. <em>Psychometrika</em>, <b>44</b>, 443–460.
</p>
<p>Prim, R. C. (1957) Shortest connection networks and some generalizations. <em>The Bell System Technical Journal</em>, <b>36</b>, 1389–1401.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#------------------------------------------------
# Setting quadreture points
nq &lt;- 5
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                    PTSD Data
#------------------             -----------------
data(PTSD)
ydat=PTSD

#------------------------------------------------
#vine tree structure
#selecting vine tree based on polychoric corr
rmat=polychoric0(ydat)$p
A.polychoric=selectFactorTrVine(y=ydat,rmat,alg=3)

#selecting bivariate copulas for the 1-2-factor tree
# listing the possible copula candidates:
copnames=c("gum", "rgum")

f1tree_model = copselect1FactorTree(ydat, A.polychoric$VineTreeA, 
copnames, gl)
f2tree_model = copselect2FactorTree(ydat, A.polychoric$VineTreeA, 
copnames, gl)


</code></pre>


</div>