<div class="container">

<table style="width: 100%;"><tr>
<td>impute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputing Trait Information</h2>

<h3>Description</h3>

<p>Imputing incomplete trait information, with the possibility of using phylogenetic information
</p>


<h3>Usage</h3>

<pre><code class="language-R">impute(
  traits,
  phylo = NULL,
  addingSpecies = FALSE,
  nEigen = 10,
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>traits</code></td>
<td>
<p>A matrix or data.frame containing trait information with missing values. The rows correspond to observations (generally species) and the columns to the variables (generally traits). Traits can be continuous and/or categorical. Row names of the <code>traits</code> object must contain the names of the species. We recommend writing species name in the format "Genus_species" or "Genus species".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>(optional) A phylogenetic tree (an object of class "phylo") containing the evolutionary relationships between species. <code>phylo</code> is used to estimate phylogenetic eigenvectors that are added to the <code>traits</code> matrix. Not all species in <code>traits</code> need to be necessarily included in <code>phylo</code>, despite this is highly recommended. Note that in order to assign phylogenetic information to species reliably, the names in <code>phylo$tip.label</code> must be exactly the same as <code>row.names(traits)</code>, although not necessarily in the same order. Note that computing cophenetic distances for very large trees (ca. 30,000 species) can result in memory allocation problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addingSpecies</code></td>
<td>
<p>Logical, defaults to FALSE. Should species present in the trait matrix but not in the phylogeny be added to the phylogeny? If TRUE, the <code>phytools::add.species.to.genus</code> function is used to add species to the root of the genus (in case there are any other congeneric species in the tree). Note that <code>phytools::add.species.to.genus</code> has other arguments that provide more flexibility, but those are not considered here for simplicity; users who want to make use of those options can instead modify their phylogenetic tree beforehand.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nEigen</code></td>
<td>
<p>The number of phylogenetic eigenvectors to be considered. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>Logical, defaults to TRUE. Should the function return messages?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>impute</code> imputes trait values in trait matrices with incomplete trait information. It uses the Random Forest approach implemented in the <code>missForest</code> package. Phylogenetic information can be incorporated in the imputation in the form of a phylogenetic tree, from which a number of phylogenetic eigenvectors are added to the trait matrix.
</p>


<h3>Value</h3>

<p>The function returns a list containing both the original trait data (incomplete) and the imputed trait data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# GSPFF_missing dataset includes &gt;10,000 species.
# Preparing and imputing this data takes very long time.
# Let's select a small random subset:
selectSPS &lt;- 200
set.seed(2)
subset_traits &lt;- GSPFF_missing[sample(1:nrow(GSPFF_missing), selectSPS), ]
deleteTips &lt;- setdiff(phylo$tip.label, rownames(subset_traits))
subset_phylo &lt;- ape::drop.tip(phylo, tip = deleteTips)
GSPFF_subset &lt;- impute(traits = subset_traits, phylo = subset_phylo, addingSpecies = TRUE)
pca &lt;- princomp(GSPFF_subset$imputed)
funtest &lt;- funspace(pca)
plot(funtest, pnt = TRUE, pnt.cex = 0.2, arrows = TRUE)
summary(funtest)


</code></pre>


</div>