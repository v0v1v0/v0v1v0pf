<div class="container">

<table style="width: 100%;"><tr>
<td>CovHT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance estimator between two Horvitz - Thompson estimators</h2>

<h3>Description</h3>

<p>Computes the covariance estimator between two Horvitz - Thompson estimators of population total from survey data obtained from a single stage sampling design
</p>


<h3>Usage</h3>

<pre><code class="language-R">CovHT(y, x, pikl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of size n containing information about first variable of interest in the sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of size n containing information about second variable of interest in the sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pikl</code></td>
<td>
<p>A square numeric matrix of dimension n containing first and second order inclusion probabilities for units included in the sample</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Covariance estimator between two Horvitz - Thompson estimators of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Cov}(\hat{Y}_{HT}, \hat{X}_{HT}) = \sum_{k \in s}\sum_{l \in s} \frac{\pi_{kl} - \pi_k \pi_l}{\pi_{kl}}\frac{y_k}{\pi_k}\frac{x_l}{\pi_l}</code>
</p>



<h3>Value</h3>

<p>A numeric value representing covariance estimator between two Horvitz - Thompson estimators for population total for considered values
</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952)
<em>A generalization of sampling without replacement from a finite universe.</em>
Journal of the American Statistical Association, 47, 663 - 685
@references Sarndal, C. E., Swensson, B. and Wretman, J. (1992)
<em>Model Assisted Survey Sampling</em>. Springer-Verlag. New York.
</p>


<h3>See Also</h3>

<p><code>HT</code> <code>VarHT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##########   Example 1   ##########
Indicators &lt;- c(1, 2, 3, 4, 5)
X &lt;- c(13, 18, 20, 14, 9)
Y &lt;- c(2, 0.5, 1.2, 3.3, 2)
#Let draw two simple random samples without replacement of size 2
s &lt;- sample(Indicators, 2)
sX &lt;- X[s]
sY &lt;- Y[s]
#Now, let calculate the associated probability matrix with first and
#second order inclusion probabilities
Ps &lt;- matrix(c(0.4,0.2, 0.2,0.4), 2, 2)
CovHT(sX, sY, Ps)

##########   Example 2   ##########
data(DatA)
attach(DatA)
data(PiklA)
#Let calculate Horvitz - Thompson estimator for total of variable Clothing in Frame A.
HT(Clo, ProbA)
#Let calculate Horvitz - Thompson estimator for total of variable Feeding in Frame A.
HT(Feed, ProbA)
#And now, let compute the covariance between the previous estimators
CovHT(Clo, Feed, PiklA)
</code></pre>


</div>