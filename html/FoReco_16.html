<div class="container">

<table style="width: 100%;"><tr>
<td>csmo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-sectional middle-out reconciliation</h2>

<h3>Description</h3>

<p>The middle-out forecast reconciliation (Athanasopoulos et al., 2009) combines
top-down (cstd) and bottom-up (csbu) for genuine hierarchical/grouped
time series. Given the base forecasts of variables at an intermediate
level <code class="reqn">l</code>, it performs
</p>

<ul>
<li>
<p> a top-down approach for the levels <code class="reqn">&lt;l</code>;
</p>
</li>
<li>
<p> a bottom-up approach for the levels <code class="reqn">&gt;l</code>.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">csmo(base, agg_mat, id_rows = 1, weights, normalize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>A (<code class="reqn">h \times n_l</code>) numeric matrix containing the <code class="reqn">l</code>-level
base forecast; <code class="reqn">n_l</code> is the number of variables at level <code class="reqn">l</code>, and
<code class="reqn">h</code> is the forecast horizon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_mat</code></td>
<td>
<p>A (<code class="reqn">n_a \times n_b</code>) numeric matrix representing the cross-sectional
aggregation matrix. It maps the <code class="reqn">n_b</code> bottom-level (free)
variables into the <code class="reqn">n_a</code> upper (constrained) variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_rows</code></td>
<td>
<p>A numeric vector indicating the <code class="reqn">l</code>-level rows of <code>agg_mat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A (<code class="reqn">h \times n_b</code>) numeric matrix containing the proportions for the
bottom time series; <code class="reqn">h</code> is the forecast horizon, and <code class="reqn">n_b</code> is the total number
of bottom variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>If <code>TRUE</code> (<em>default</em>), the <code>weights</code> will sum to 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A (<code class="reqn">h \times n</code>) numeric matrix of cross-sectional reconciled forecasts.
</p>


<h3>References</h3>

<p>Athanasopoulos, G., Ahmed, R. A. and Hyndman, R.J. (2009) Hierarchical forecasts
for Australian domestic tourism. <em>International Journal of Forecasting</em> 25(1),
146â€“166. <a href="https://doi.org/10.1016/j.ijforecast.2008.07.004">doi:10.1016/j.ijforecast.2008.07.004</a>
</p>


<h3>See Also</h3>

<p>Middle-out reconciliation: 
<code>ctmo()</code>,
<code>temo()</code>
</p>
<p>Cross-sectional framework: 
<code>csboot()</code>,
<code>csbu()</code>,
<code>cscov()</code>,
<code>cslcc()</code>,
<code>csrec()</code>,
<code>cstd()</code>,
<code>cstools()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# Aggregation matrix for Z = X + Y, X = XX + XY and Y = YX + YY
A &lt;- matrix(c(1,1,1,1,1,1,0,0,0,0,1,1), 3, byrow = TRUE)
# (3 x 2) top base forecasts vector (simulated), forecast horizon = 3
baseL2 &lt;- matrix(rnorm(2*3, 5), 3, 2)
# Same weights for different forecast horizons
fix_weights &lt;- runif(4)
reco &lt;- csmo(base = baseL2, agg_mat = A, id_rows = 2:3, weights = fix_weights)

# Different weights for different forecast horizons
h_weights &lt;- matrix(runif(4*3), 3, 4)
recoh &lt;- csmo(base = baseL2, agg_mat = A, id_rows = 2:3, weights = h_weights)

</code></pre>


</div>