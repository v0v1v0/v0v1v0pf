<div class="container">

<table style="width: 100%;"><tr>
<td>krige</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Kriging function
</h2>

<h3>Description</h3>

<p>Variogram analysis and kriging prediction used to analyze feedback and
change-in-feedback across space. This function is
grounded on the function <code>autoKrige</code> in the <code>automap</code>
package, grounded itself on the <code>gstat</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">krige(coordinates, statistic, grid, krige.param=NULL, plots=TRUE,
    variog.param=list(npoints=50,nsim=99,plot.numbers=0.04))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coordinates</code></td>
<td>
<p>a 2-column matrix with latitudes and longitudes of observation sites.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>a numeric vector specifying the values, at observation sites, of the statistic to be predicted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>a list of arguments defining the grid over which the statistic is predicted:
</p>

<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p>a numeric vector of longitudes.</p>
</dd>
<dt>
<code>y</code>:</dt>
<dd>
<p>a numeric vector of latitudes.</p>
</dd>
<dt>
<code>border</code>:</dt>
<dd>
<p>a character string that names the region in the world within which the statistic will be predicted. This is a character string in the database <code>world</code>; see the function <code>map</code> in the <code>maps</code> package.</p>
</dd>
<dt>
<code>proj</code>:</dt>
<dd>
<p>a projection definition; see the function <code>project</code> in the <code>proj4</code> package.</p>
</dd>
<dt>
<code>degrees</code>:</dt>
<dd>
<p>a logical indicating  if  the lat/long coordinates are assumed to be in degrees (if <code>degrees = TRUE</code>), or in radians (if <code>degrees = FALSE</code>).</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>krige.param</code></td>
<td>
<p>a character string equal either to "x+y", "x" or "y"
indicating whether the coordinates (and which coordinates) have to be
accounted for in the trend in universal kriging; default is NULL, indicating that
ordinary kriging without trend is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>

<p>a logical indicating if plots characterizing the variogram analysis and the kriging prediction are produced (if <code>plots = TRUE</code>) or not (if <code>plots = FALSE</code>), default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variog.param</code></td>
<td>
<p>a list of arguments used to display the variography,  :
</p>

<dl>
<dt>
<code>npoints</code>:</dt>
<dd>
<p>a numeric value specifying the number of points at
which the variogram model is calculated, default is 50.</p>
</dd>
<dt>
<code>nsim</code>:</dt>
<dd>
<p>a numeric value specifying the number of Monte Carlo
simulations used to compute the envelope, default
is 99.</p>
</dd>
<dt>
<code>plot.numbers</code>:</dt>
<dd>
<p>a numeric value specifyng the relative
distance to be used between circles representing the empirical
semivariogram and texts providing the number of point pairs used for
computing each value of the empirical semivariogram, default is
0.04 (if <code>plot.numbers = 0</code>, these texts are not displayed).</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>plots = TRUE</code>, four plots are produced. Plot 1:
Estimation of the semivariogram of the statistic (dots: sample
semivariogram; solid curve: theoretical semivariogram; dashed
curves: Monte-Carlo envelopes. Plot 2: Boxplots of kriging prediction (left) and kriging standard error (right). Plot 3: Kriging prediction. Plot 4: Kriging standard error.
</p>


<h3>Value</h3>

<p>a list of items characterizing the variogram analysis and the kriging prediction:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>the list of arguments in the call of the <code>krige</code> function except the argument <code>plots</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAP</code></td>
<td>
<p>a list allowing to draw the border of the study region that can be made of several polygons. This is the output of the function <code>map</code> in the <code>maps</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>a 2-column matrix providing the coordinates (in degrees) of the nodes of the prediction locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.region</code></td>
<td>
<p>a logical vector indicating, for each grid node whose coordinates are given in  the 2-column matrix <code>grid</code>, if the node is in the study region or not. The study region is defined by <code>MAP</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>krige</code></td>
<td>
<p>a list providing the result the variography and the spatial prediction. This is the output of the function <code>autoKrige</code> in the <code>automap</code> package.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>krige</code> function uses some of the functionalities of
the <code>map</code> function in the <code>maps</code> package, and of a few
functions in the <code>gstat</code> and <code>automap</code> package. To
fully exploit the functionalities of these external functions
(in particular <code>autoKrige</code>), the <code>krige</code> function should be extended.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><code>rain.feedback.stats</code>, <code>map</code> in the <code>maps</code> package, <code>autoKrige</code>  and <code>autofitVariogram</code> in the <code>automap</code> package
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### load data of feedback and change-in-feedback indices in 88 sites across Australia
data(rain.feedback.stats)

#### spatial coordinates of the 88 sites
coord=rain.feedback.stats[,3:4]

#### feedback index
stat1=rain.feedback.stats[["Feedback.whole.period"]]

#### variogram analysis and kriging of feedback index
## computer intensive stage
## Not run: 
par(mfrow=c(2,2), mar=c(5.1,4.1,4.1,4.1))
kr1=krige(coordinates=coord, statistic=stat1,
   grid=list(x=seq(110,155,0.25),y=seq(-45,-11,0.25),border="Australia", 
      proj="+proj=lcc +lat_1=-18 +lat_2=-36 +lat0=-25 +lon_0=140",degrees=TRUE),
   plots=TRUE)

## the plot style from the \code{automap} package can be obtained as follows:
plot(kr1$krige)

## End(Not run)

</code></pre>


</div>