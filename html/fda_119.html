<div class="container">

<table style="width: 100%;"><tr>
<td>intensity.fd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Intensity Function for Point Process
</h2>

<h3>Description</h3>

<p>The intensity $mu$ of a series of event times that obey a
homogeneous Poisson process is the mean number of events per unit time.
When this event rate varies over time, the process is said to be
nonhomogeneous, and $mu(t)$, and is estimated by this function
<code>intensity.fd</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">intensity.fd(x, WfdParobj, conv=0.0001, iterlim=20,
             dbglev=1, returnMatrix=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector containing a strictly increasing series of event times.
These event times assume that the the events begin to be observed
at time 0, and therefore are times since the beginning of
observation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WfdParobj</code></td>
<td>

<p>a functional parameter object estimating the log-intensity function
$W(t) = log[mu(t)]$ .
Because the intensity function $mu(t)$ is necessarily positive,
it is represented by <code>mu(x) = exp[W(x)]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>a convergence criterion, required because the estimation
process is iterative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>

<p>maximum number of iterations that are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbglev</code></td>
<td>

<p>either 0, 1, or 2.  This controls the amount information printed out on
each iteration, with 0 implying no output, 1 intermediate output level,
and 2 full output.  If levels 1 and 2 are used, turn off the output
buffering option.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnMatrix</code></td>
<td>

<p>logical:  If TRUE,  a two-dimensional is returned using a
special class from the Matrix package.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The intensity function $I(t)$ is almost the same thing as a
probability density function $p(t)$ estimated by function
<code>densify.fd</code>.  The only difference is the absence of
the normalizing constant $C$ that a density function requires
in order to have a unit integral.
The goal of the function is provide a smooth intensity function
estimate that approaches some target intensity by an amount that is
controlled by the linear differential operator <code>Lfdobj</code> and
the penalty parameter in argument <code>WfdPar</code>.
For example, if the first derivative of
$W(t)$ is penalized heavily, this will force the function to
approach a constant, which in turn will force the estimated Poisson
process itself to be nearly homogeneous.
To plot the intensity function or to evaluate it,
evaluate <code>Wfdobj</code>, exponentiate the resulting vector.
</p>


<h3>Value</h3>

<p>A named list of length 4 containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Wfdobj</code></td>
<td>
<p>a functional data object defining function $W(x)$ that
optimizes the fit to the data of the monotone function that it defines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Flist</code></td>
<td>

<p>a named list containing three results for the final converged solution:
(1)
<b>f</b>: the optimal function value being minimized,
(2)
<b>grad</b>: the gradient vector at the optimal solution,   and
(3)
<b>norm</b>: the norm of the gradient vector at the optimal solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iternum</code></td>
<td>
<p>the number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterhist</code></td>
<td>
<p>a <code>iternum+1</code> by 5 matrix containing the iteration
history.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), 
<em>Functional Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), 
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>density.fd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">oldpar &lt;- par(no.readonly=TRUE)
#  Generate 101 Poisson-distributed event times with
#  intensity or rate two events per unit time
N  &lt;- 101
mu &lt;- 2
#  generate 101 uniform deviates
uvec &lt;- runif(rep(0,N))
#  convert to 101 exponential waiting times
wvec &lt;- -log(1-uvec)/mu
#  accumulate to get event times
tvec &lt;- cumsum(wvec)
tmax &lt;- max(tvec)
#  set up an order 4 B-spline basis over [0,tmax] with
#  21 equally spaced knots
tbasis &lt;- create.bspline.basis(c(0,tmax), 23)
#  set up a functional parameter object for W(t),
#  the log intensity function.  The first derivative
#  is penalized in order to smooth toward a constant
lambda &lt;- 10
Wfd0 &lt;- fd(matrix(0,23,1),tbasis)
WfdParobj &lt;- fdPar(Wfd0, 1, lambda)
#  estimate the intensity function
Wfdobj &lt;- intensity.fd(tvec, WfdParobj)$Wfdobj
#  get intensity function values at 0 and event times
events &lt;- c(0,tvec)
intenvec &lt;- exp(eval.fd(events,Wfdobj))
#  plot intensity function
plot(events, intenvec, type="b")
lines(c(0,tmax),c(mu,mu),lty=4)
par(oldpar)
</code></pre>


</div>