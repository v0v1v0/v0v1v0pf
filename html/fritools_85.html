<div class="container">

<table style="width: 100%;"><tr>
<td>tapply</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply a Function Over a Ragged Array</h2>

<h3>Description</h3>

<p>This is a modified version of <code>base::tapply</code> to
allow for <code>data.frame</code>s to be passed as <code>X</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tapply(object, index, func = NULL, ..., default = NA, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>See <code>base::tapply</code> <em>X</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>See <code>base::tapply</code> <em>INDEX</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>See <code>base::tapply</code> <em>FUN</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>See <code>base::tapply</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default</code></td>
<td>
<p>See <code>base::tapply</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>See <code>base::tapply</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>See <code>base::tapply</code>.
</p>


<h3>See Also</h3>

<p>Other bits and pieces: 
<code>golden_ratio()</code>,
<code>is_difftime_less()</code>,
<code>is_valid_primary_key()</code>,
<code>r_cmd_install()</code>,
<code>str2num()</code>,
<code>strip_off_attributes()</code>,
<code>throw()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">result &lt;- fritools::tapply(warpbreaks[["breaks"]], warpbreaks[, -1], sum)
expectation &lt;- base::tapply(warpbreaks[["breaks"]], warpbreaks[, -1], sum)
RUnit::checkIdentical(result, expectation)
data("mtcars")
s &lt;- stats::aggregate(x = mtcars[["mpg"]],
                      by = list(mtcars[["cyl"]], mtcars[["vs"]]),
                      FUN = mean)
t &lt;- base::tapply(X = mtcars[["mpg"]],
                  INDEX = list(mtcars[["cyl"]], mtcars[["vs"]]),
                  FUN = mean)
if (require("reshape", quietly = TRUE)) {
    suppressWarnings(tm &lt;- na.omit(reshape::melt(t)))
    if (RUnit::checkEquals(s, tm, check.attributes = FALSE))
        message("Works!")
}
message("If you don't pass weigths, this is equal to:")
w &lt;- base::tapply(X = mtcars[["mpg"]], INDEX = list(mtcars[["cyl"]],
                                                    mtcars[["vs"]]),
                  FUN = stats::weighted.mean)
all.equal(w, t, check.attributes = FALSE)
message("But how do you pass those weights?")
# we define a wrapper to pass the column names for a data.frame:
weighted_mean &lt;- function(df, x, w) {
    stats::weighted.mean(df[[x]], df[[w]])
}
if (RUnit::checkIdentical(stats::weighted.mean(mtcars[["mpg"]],
                                               mtcars[["wt"]]),
                          weighted_mean(mtcars, "mpg", "wt")))
    message("Works!")
message("base::tapply can't deal with data.frames:")
try(base::tapply(X = mtcars, INDEX = list(mtcars[["cyl"]], mtcars[["vs"]]),
                 FUN = weighted_mean, x = "mpg", w = "wt"))
wm &lt;- fritools::tapply(object = mtcars, index = list(mtcars[["cyl"]],
                                                mtcars[["vs"]]),
                       func = weighted_mean, x = "mpg", w = "wt")
subset &lt;- mtcars[mtcars[["cyl"]] == 6 &amp; mtcars[["vs"]] == 0, c("mpg", "wt")]
stats::weighted.mean(subset[["mpg"]], subset[["wt"]]) == wm
</code></pre>


</div>