<div class="container">

<table style="width: 100%;"><tr>
<td>ExtremeIndex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extremal Index Estimation</h2>

<h3>Description</h3>

<p>A collection and description of functions to simulate
time series with a known extremal index, and to estimate 
the extremal index by four different kind of methods, 
the blocks method, the reciprocal mean cluster size 
method, the runs method, and the method of Ferro and
Segers.
<br></p>
<p>The functions are:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>thetaSim</code> </td>
<td style="text-align: left;"> Simulates a time Series with known theta, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>blockTheta</code> </td>
<td style="text-align: left;"> Computes theta from Block Method, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>clusterTheta</code> </td>
<td style="text-align: left;"> Computes theta from Reciprocal Cluster Method, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>runTheta</code> </td>
<td style="text-align: left;"> Computes theta from Run Method, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>ferrosegersTheta</code> </td>
<td style="text-align: left;"> Computes Theta according to Ferro and Segers, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>exindexPlot</code> </td>
<td style="text-align: left;"> Calculate and Plot Theta(1,2,3), </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>exindexesPlot</code> </td>
<td style="text-align: left;"> Calculate Theta(1,2) and Plot Theta(1). </td>
</tr>
</table>
<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'fTHETA'
show(object)

thetaSim(model = c("max", "pair"), n = 1000, theta = 0.5)

blockTheta(x, block = 22, quantiles = seq(0.950, 0.995, length = 10),
    title = NULL, description = NULL)
clusterTheta(x, block = 22, quantiles = seq(0.950, 0.995, length = 10),
    title = NULL, description = NULL)
runTheta(x, block = 22, quantiles = seq(0.950, 0.995, length = 10),
    title = NULL, description = NULL)
ferrosegersTheta(x, quantiles = seq(0.950, 0.995, length = 10),
    title = NULL, description = NULL)
    
exindexPlot(x, block = c("monthly", "quarterly"), start = 5, end = NA, 
    doplot = TRUE, plottype = c("thresh", "K"), labels = TRUE, ...)
    
exindexesPlot(x, block = 22, quantiles = seq(0.950, 0.995, length = 10), 
    doplot = TRUE, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>

<p>[*Theta] - <br>
an integer value, the block size. Currently only integer specified
block sizes are supported.
<br>
[exindex*Plot] - <br>
the block size. Either <code>"monthly"</code>, <code>"quarterly"</code> or
an integer value. An integer value is interpreted as the number 
of data values in each successive block. The default value is
<code>"monthly"</code> which corresponds for daily data to an approximately
22-day periods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>

<p>a character string which allows for a brief description.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doplot</code></td>
<td>

<p>a logical, should the results be plotted?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>whether or not axes should be labelled. If set to <code>FALSE</code>
then user specified labels can be passed through the <code>"..."</code>
argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>[thetaSim] - <br>
a character string denoting the name of the model. Either 
<code>"max"</code> or <code>"pair"</code>, the first representing the 
maximum Frechet series, and the second the paired exponential
series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>[thetaSim] - <br>
an integer value, the length of the time series to be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object of class <code>"fTHETA"</code> as returned by the functions
<code>*Theta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plottype</code></td>
<td>

<p>[exindexPlot] - <br>
whether plot is to be by increasing threshold (<code>thresh</code>) 
or increasing K value (<code>K</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>

<p>[exindexesPlot] - <br>
a numeric vector of quantile values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start, end</code></td>
<td>

<p>[exindexPlot] - <br><code>start</code> is the lowest value of <code>K</code> at which to plot 
a point, and <code>end</code> the highest value; <code>K</code> is the
number of blocks in which a specified threshold is exceeded.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>[thetaSim] - <br>
a numeric value between 0 and 1 setting the value of the
extremal index for the maximum Frechet time series. (Not used
in the case of the paired exponential series.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>a character string which allows for a project title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a 'timeSeries' object or any other object which can be transformed
by the function <code>as.vector</code> into a numeric vector. <code>"monthly"</code>
and <code>"quarterly"</code> blocks require <code>x</code> to be an object of
class <code>"timeSeries"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments passed to the plot function.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>exindexPlot</code>
<br>
returns a data frame of results with the 
following columns: <code>N</code>, <code>K</code>, <code>un</code>, <code>theta2</code>,
and <code>theta</code>. A plot with <code>K</code> on the lower x-axis and
threshold Values on the upper x-axis versus the extremal index
is displayed.
</p>
<p><code>exindexesPlot</code>
<br>
returns a data.frame with four columns: 
<code>thresholds</code>, <code>theta1</code>, <code>theta2</code>, and <code>theta3</code>.
A plot with quantiles on the x-axis and versus the extremal indexes
is displayed.
</p>


<h3>Author(s)</h3>

<p>Alexander McNeil, for parts of the <code>exindexPlot</code> function, and <br>
Diethelm Wuertz for the <code>exindexesPlot</code> function.
</p>


<h3>References</h3>

<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997);
<em>Modelling Extremal Events</em>, 
Springer. Chapter 8, 413â€“429.  
</p>


<h3>See Also</h3>

<p><code>hillPlot</code>,
<code>gevFit</code>. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Extremal Index for the right and left tails 
## of the BMW log returns:
   data(bmwRet)
   par(mfrow = c(2, 2), cex = 0.7)
   library(timeSeries)
   exindexPlot( as.timeSeries(bmwRet), block = "quarterly")
   exindexPlot(-as.timeSeries(bmwRet), block = "quarterly")   
   
## Extremal Index for the right and left tails 
## of the BMW log returns:
   exindexesPlot( as.timeSeries(bmwRet), block = 65)
   exindexesPlot(-as.timeSeries(bmwRet), block = 65)   
</code></pre>


</div>