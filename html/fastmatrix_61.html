<div class="container">

<table style="width: 100%;"><tr>
<td>sherman.morrison</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sherman-Morrison formula</h2>

<h3>Description</h3>

<p>The Sherman-Morrison formula gives a convenient expression for the inverse of the
rank 1 update <code class="reqn">(\bold{A} + \bold{bd}^T)</code> where <code class="reqn">\bold{A}</code> is a <code class="reqn">n\times n</code>
matrix and <code class="reqn">\bold{b}</code>, <code class="reqn">\bold{d}</code> are <code class="reqn">n</code>-dimensional vectors. Thus
</p>
<p style="text-align: center;"><code class="reqn">(\bold{A} + \bold{bd}^T)^{-1} = \bold{A}^{-1} - \frac{\bold{A}^{-1}\bold{bd}^T
  \bold{A}^{-1}}{1 + \bold{d}^T\bold{A}^{-1}\bold{b}}.</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">sherman.morrison(a, b, d = b, inverted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p> a numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p> a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p> a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverted</code></td>
<td>
<p> logical. If <code>TRUE</code>, <code>a</code> is supposed to contain its <em>inverse</em>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Method of <code>sherman.morrison</code> calls BLAS level 2 subroutines <code>DGEMV</code> and
<code>DGER</code> for computational efficiency.
</p>


<h3>Value</h3>

<p>a square matrix of the same order as <code>a</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 10
ones &lt;- rep(1, n)
a &lt;- 0.5 * diag(n)
z &lt;- sherman.morrison(a, ones, 0.5 * ones)
z
</code></pre>


</div>