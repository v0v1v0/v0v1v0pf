<div class="container">

<table style="width: 100%;"><tr>
<td>simulation_model3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convenience function for generating functional data</h2>

<h3>Description</h3>

<p>This model generates outliers that are magnitude outliers for a part of the
domain. The main model is of the form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + e_i(t),</code>
</p>
<p> with
contamination model of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + qk_iI_{T_i \le t} + e_i(t)</code>
</p>

<p>where: <code class="reqn">t\in [0,1]</code>, <code class="reqn">e_i(t)</code> is a Gaussian process with zero mean and
covariance function of the form: </p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp(-\beta|t-s|^\nu),</code>
</p>

<p><code class="reqn">k_i \in \{-1, 1\}</code> with <code class="reqn">P(k_i = -1) = P(k_i=1) = 0.5</code>,
<code class="reqn">q</code> is a constant controlling how far the outliers are from the mass of the
data, <code class="reqn">I</code> is an indicator function, and <code class="reqn">T_i</code> is a uniform random variable between
an interval <code class="reqn">[a, b] \subset [0,1]</code>.
Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulation_model3(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  mu = 4,
  q = 6,
  a = 0.1,
  b = 0.9,
  kprob = 0.5,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 3",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The mean value of the functions. Set to <code>4</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A value indicating the shift of the outliers from the mean function.
Used to control how far the outliers are from the mean function. Set to <code>8</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>
<p>values values specifying the interval <code class="reqn">[a,b]</code> for the uniform distribution
from which <code class="reqn">T_i</code> is drawn in the contamination model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kprob</code></td>
<td>
<p>A value between <code class="reqn">0</code> and <code class="reqn">1</code> indicating the probability that an outlier will
be above or below the mean function. Can be used to control the amount of outliers above
or below the mean. Set to <code class="reqn">0.5</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">dt &lt;- simulation_model3(plot = TRUE)
dt$true_outliers
dim(dt$data)
</code></pre>


</div>