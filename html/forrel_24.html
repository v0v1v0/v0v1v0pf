<div class="container">

<table style="width: 100%;"><tr>
<td>powerPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exclusion/inclusion power plots</h2>

<h3>Description</h3>

<p>This function offers four different visualisations of exclusion/inclusion
powers, particularly for missing person cases. Output from <code>MPPsims()</code> may be
fed directly as input to this function. The actual plotting is done with
<code>ggplot2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerPlot(
  ep,
  ip = NULL,
  type = 1,
  majorpoints = TRUE,
  minorpoints = TRUE,
  ellipse = FALSE,
  col = NULL,
  labs = NULL,
  jitter = FALSE,
  alpha = 1,
  stroke = 1.5,
  shape = "circle",
  size = 1,
  hline = NULL,
  vline = NULL,
  xlim = NULL,
  ylim = NULL,
  xlab = NULL,
  ylab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ep, ip</code></td>
<td>
<p>Lists of equal length, with outputs from one or more runs of
<code>missingPersonEP()</code> and <code>missingPersonIP()</code> respectively. Alternatively,
<code>ep</code> can be a single output from <code>MPPsims()</code>, in which case <code>ip</code> should be
NULL. See Examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Plot type; either 1, 2, 3 or 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>majorpoints</code></td>
<td>
<p>A logical indicating whether "major" points should be
drawn (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minorpoints</code></td>
<td>
<p>A logical indicating whether "minor" points should be
drawn (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>A logical. If TRUE, data ellipsis are drawn for each group
containing more than 1 element. NB: This fails with a warning if all points
in a group fall on a line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A colour vector, recycle to match the top level length of <code>ep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs</code></td>
<td>
<p>A character of the same length as <code>ep</code>. If NULL, the names of
<code>ep</code> are used, if present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>A logical (default: FALSE). If TRUE, a small jitter is added to
the major points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Transparency for minor points (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stroke</code></td>
<td>
<p>Border width for major points (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Either "circle", "square", "diamond", "triangleUp" or
"triangleDown", determining the shapes of both minor and major points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Point size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hline, vline</code></td>
<td>
<p>Single numbers indicating positions for
horizontal/vertical "threshold" lines. If NULL (default), no lines are
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>Axis limits; automatically chosen if NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Axis labels; automatically chosen if NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot types are as follows:
</p>
<p><code>type = 1</code>: x = Exclusion power; y = Inclusion power
</p>
<p><code>type = 2</code>: x = Exclusion odds ratio; y = Inclusion odds ratio
</p>
<p><code>type = 3</code>: x = Expected number of exclusions; y = average log(LR)
</p>
<p><code>type = 4</code>: x = Exclusion power; y = average LR
</p>
<p>In the most general case <code>ep</code> (and similarly for <code>ip</code>) can be a list of lists
of <code>EPresult</code> objects. We refer to the inner lists as "groups". A group may
consist of a single output, or several (typically many simulations of the
same situation). Points within the same group are always drawn with the same
colour and shape.
</p>
<p>When plotting several groups, two sets of points are drawn by default:
</p>

<ul>
<li>
<p> Major points: Group means.
</p>
</li>
<li>
<p> Minor points: Individual points in groups with more than one element.
</p>
</li>
</ul>
<p>The parameters <code>majorpoints</code> and <code>minorpoints</code> control which of the above
points are included.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot object.
</p>


<h3>See Also</h3>

<p><code>MPPsims()</code>, <code>missingPersonEP()</code>, <code>missingPersonEP()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Example 1: Comparing the power of 3 reference families ###

# Frequencies for 2 STR markers
db = NorwegianFrequencies[1:2]  # Increase!

# Define pedigrees and simulate data
PAR = nuclearPed(1, child = "MP") |&gt;
  profileSim(markers = db, ids = 1)
SIB = nuclearPed(2) |&gt; relabel(old = 4, new = "MP") |&gt;
  profileSim(markers = db, ids = 3)
GRA = linearPed(2) |&gt; relabel(old = 5, new = "MP") |&gt;
  profileSim(markers = db, ids = 1)

# Collect in list and plot
peds = list(PAR = PAR, SIB = SIB, GRA = GRA)
plotPedList(peds, marker = 1, hatched = typedMembers, frames = FALSE,
            col = list(red = "MP"))

# Compute exclusion/inclusion powers:
ep = lapply(peds, function(y)
  missingPersonEP(y, missing = "MP", verbose = FALSE))

ip = lapply(peds, function(y)    # increase nsim!
  missingPersonIP(y, missing = "MP", nsim = 5, threshold = 10, verbose = FALSE))

# Plot
powerPlot(ep, ip, size = 2)

# Different plot type, not dependent of `threshold`
powerPlot(ep, ip, size = 2, type = 3)



### Example 2: Exploring powers for different sets of available relatives

# Create trio pedigree
ref = nuclearPed(father = "fa", mother = "mo", child = "MP")

# Add empty marker with 5 alleles
ref = addMarker(ref, alleles = 1:5)

# Alternatives for genotyping
sel = list("fa", c("fa", "mo"))

# Simulate power for each selection
simData = MPPsims(ref, selections = sel, nProfiles = 3, lrSims = 5,
                  thresholdIP = 2, seed = 123, numCores = 1)

# Power plot 1: EP vs IP
powerPlot(simData, type = 1)
powerPlot(simData, type = 1, minorpoints = FALSE, hline = 0.8)




# Change shape, and modify legend order
powerPlot(simData[3:1], type = 1, shape = c("ci", "sq", "di"))

# Zoom in, and add threshold lines
powerPlot(simData, type = 1, xlim = c(0.2, 1), ylim = c(0.5, 1),
          hline = 0.8, vline = 0.8)

# Power plot 3: Expected number of exclusions vs E[log LR]
powerPlot(simData, type = 3)

# With horizontal/vertical lines
powerPlot(simData, type = 3, hline = log10(2), vline = 1)

# Plot 4: Illustrating the general inequality ELR &gt; 1/(1-EP)
powerPlot(simData, type = 4)



</code></pre>


</div>