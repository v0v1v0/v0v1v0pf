<div class="container">

<table style="width: 100%;"><tr>
<td>pval.estimate.eta0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Proportion of Null p-Values</h2>

<h3>Description</h3>

<p><code>pval.estimate.eta0</code> estimates the proportion eta0 of null p-values in a given
vector of p-values. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">pval.estimate.eta0(p, method=c("smoother", "bootstrap", "conservative",
   "adaptive", "quantile"), lambda=seq(0,0.9,0.05), 
   diagnostic.plot=TRUE, q=0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>algorithm used to estimate the proportion of null p-values.
Available options are
"conservative" , "adaptive", "bootstrap", quantile, and "smoother" (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>optional tuning parameter vector needed for "bootstrap"
and "smoothing" methods (defaults to <code>seq(0,0.9,0.05)</code>)
- see Storey (2002) and Storey and Tibshirani (2003).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostic.plot</code></td>
<td>
<p>if <code>TRUE</code> (the default) the histogram of the p-values together
with the estimate of <code>eta0</code> null line is plotted.  This is useful to
visually check the fit of the estimated proportion of null p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantile used for estimating eta0 - only if <code>method</code>="quantile"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This quantity <code>eta0</code>, i.e.  the proportion eta0 of null p-values in a given
vector of p-values, is an important parameter 
when controlling  the false discovery rate (FDR).  A conservative choice is
eta0 = 1 but a choice closer to the true value will increase efficiency
and power 
- see   Benjamini and Hochberg (1995, 2000) and Storey (2002) for details.
</p>
<p>The function <code>pval.estimate.eta0</code> provides five algorithms: the "conservative"
method always returns eta0 = 1  (Benjamini and Hochberg, 1995), "adaptive"
uses the approach suggested in Benjamini and Hochberg (2000), "bootstrap"
employs the method from Storey (2002), "smoother" uses the smoothing spline
approach in Storey and Tibshirani (2003), and "quantile" is a simplified version
of "smoother".
</p>


<h3>Value</h3>

<p>The estimated proportion eta0 of null p-values. 
</p>


<h3>Author(s)</h3>

<p>Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>
<p>Adapted in part from code by Y. Benjamini and J.D. Storey. 
</p>


<h3>References</h3>

<p><em>"conservative" procedure:</em> Benjamini, Y., and Y. Hochberg (1995)  Controlling the false
discovery rate: a practical and powerful approach to multiple testing.
<em>J. Roy. Statist. Soc. B</em>, <b>57</b>, 289–300.
</p>
<p><em>"adaptive" procedure:</em> Benjamini, Y., and Y. Hochberg (2000) The adaptive control
of the false discovery rate in multiple hypotheses testing with independent statistics.
<em>J. Behav. Educ. Statist.</em>, <b>25</b>, 60–83.
</p>
<p><em>"bootstrap" procedure:</em> Storey, J. D. (2002) A direct approach to false
discovery rates.
<em>J. Roy. Statist. Soc. B.</em>, <b>64</b>, 479–498.
</p>
<p><em>"smoother" procedure:</em> Storey, J. D., and R. Tibshirani (2003)
Statistical significance for genome-wide experiments. 
<em>Proc. Nat. Acad. Sci. USA</em>, <b>100</b>, 9440-9445.
</p>
<p><em>"quantile" procedure:</em> similar to smoother, except that the lower q
quantile of all eta0 computed in dependence of lambda is taken as overall estimate of eta0.
</p>


<h3>See Also</h3>

<p><code>fdrtool</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load "fdrtool" library and p-values
library("fdrtool")
data(pvalues)


# Proportion of null p-values for different methods
pval.estimate.eta0(pvalues, method="conservative")
pval.estimate.eta0(pvalues, method="adaptive")
pval.estimate.eta0(pvalues, method="bootstrap")
pval.estimate.eta0(pvalues, method="smoother")
pval.estimate.eta0(pvalues, method="quantile")
</code></pre>


</div>