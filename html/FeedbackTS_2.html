<div class="container">

<table style="width: 100%;"><tr>
<td>after.minus.before</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computation of after-before differences around key days
</h2>

<h3>Description</h3>

<p>Computation of after-before differences around key days using using data <code class="reqn">K</code> days before and after each key day.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	after.minus.before(data, operator)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>either a KDD object, a KDD.yearly.average object, or a matrix with an odd number of rows corresponding built as the <code>before.after</code> slot of a KDD object or a KDD.yearly.average object. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>operator</code></td>
<td>

<p>a character string specifying the transformation of the raw values, must be one of <code>"dmv"</code>, <code>"dmpiv"</code> or <code>"dmgiv"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>operator = "dmv"</code> (difference of mean values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> of the time series are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K y_{i+k}\right) - \left(\frac{1}{K}\sum_{k=1}^K  y_{i-k}\right)=\frac{1}{K}\sum_{k=1}^K (y_{i+k}-y_{i-k}),
	</code>
</p>

<p>where <code class="reqn">i</code> is the date of the key day, <code class="reqn">K</code> is the number of days considered after and before the key day (specified when <code>data</code> is provided).
</p>
<p>If <code>operator = "dmpiv"</code> (difference of means of positive indicator values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K 1(y_{i+k}&gt;0)\right) - \left(\frac{1}{K}\sum_{k=1}^K  1(y_{i-k}&gt;0)\right)=\frac{1}{K}\sum_{k=1}^K \{1(y_{i+k}&gt;0)-1(y_{i-k}&gt;0)\},
	</code>
</p>

<p>where <code class="reqn">1(\cdot)</code> is the indicator function.
</p>
<p>If <code>operator = "dmgiv"</code> (difference of means of greater indicator values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K
	1(y_{i+k}&gt;y_{i-k})\right) - \left(\frac{1}{K}\sum_{k=1}^K
	1(y_{i-k}&gt;y_{i+k})\right).
      </code>
</p>



<h3>Value</h3>

<p>A numeric vector providing for each key day the value of the after-before difference.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p>KDD, KDD.yearly.average, kdd.from.raw.data, rain.site.6008
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)

#### compute and plot after-before differences of KDD 
par(mfrow=c(2,2), mar=c(5.1,4.1,4.1,4.1))

## using option dmpiv (difference of means of positive indicator values)
amb1=after.minus.before(KDD,"dmpiv")
plot(KDD["day"],amb1,type="l",xlab="Day",ylab="After-Before")
abline(h=0,lty="dashed",col="grey")
plot(KDD["day"],cumsum(amb1),type="l",xlab="Day",ylab="Cumul After-Before")
abline(h=0,lty="dashed",col="grey")

## using option dmv (difference of means of values)
amb2=after.minus.before(KDD,"dmv")
plot(KDD["day"],amb2,type="l",xlab="Day",ylab="After-Before")
abline(h=0,lty="dashed",col="grey")
plot(KDD["day"],cumsum(amb2),type="l",xlab="Day",ylab="Cumul After-Before")
abline(h=0,lty="dashed",col="grey")
</code></pre>


</div>