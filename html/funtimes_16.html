<div class="container">

<table style="width: 100%;"><tr>
<td>GombayCPA_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Change Point Detection in Autoregressive Time Series</h2>

<h3>Description</h3>

<p>The function detects change points in autoregressive (AR) models for time series. Changes
can be detected in any of <code>p + 2</code> (mean, var, phi) autoregressive parameters where <code>p</code>
is the order of the AR model. The test statistic is based on the efficient score vector (Gombay 2008).
</p>


<h3>Usage</h3>

<pre><code class="language-R">GombayCPA_test(
  y,
  a.order,
  alternatives = c("two-sided", "greater", "lesser", "temporary"),
  crit.type = c("asymptotic", "bootstrap"),
  num.bootstrap = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector that contains univariate time-series observations. Missing values are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.order</code></td>
<td>
<p>order of the autoregressive model which must be a non-negative integer number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternatives</code></td>
<td>
<p>a string parameter that specifies a type of the test (i.e., "two-sided",
"greater", "lesser", and "temporary").  The option "temporary" examines the temporary change
in one of the parameters (Gombay 2008).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit.type</code></td>
<td>
<p>method of obtaining critical values: "asymptotic" (default) or "bootstrap".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.bootstrap</code></td>
<td>
<p>number of bootstrap replications if <code>crit.type = "bootstrap"</code>.
The default number is 1000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function tests for a temporary change and a change in specific model parameters.
Critical values can be estimated via asymptotic distribution <code>"asymptotic"</code> (i.e., the
default option) or sieve bootstrap <code>"bootstrap"</code>. The function employs internal
function <code>change.point</code> and sieve bootstrap <code>change.point.sieve</code> function.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>points of change for each parameter. The value of the <code>"alternatives"</code>
determines the return:
"temporary" – returns max, min, and abs.max points;
"greater" – returns max points;
"lesser" –  returns min points;
"two-sided" – returns abs.max.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>test statistic values for change points in mean, var, phi.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.values</code></td>
<td>
<p><code>p-value</code> of the change point test.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Palina Niamkova, Dorcas Ofori-Boateng, Yulia R. Gel
</p>


<h3>References</h3>

<p>Gombay E (2008).
“Change detection in autoregressive time series.”
<em>Journal of Multivariate Analysis</em>, <b>99</b>(3), 451–464.
<a href="https://doi.org/10.1016/j.jmva.2007.01.003">doi:10.1016/j.jmva.2007.01.003</a>.
</p>


<h3>See Also</h3>

<p><code>mcusum.test</code>  change point test for regression and
<code>terrorism</code> dataset used in the Example 2
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Example 1:

#Simulate some time series:
series_1 = arima.sim(n = 100, list(order = c(2,0,0), ar = c(-0.7, -0.1)))
series_2 = arima.sim(n = 200, list(order = c(2,0,0), ar = c(0.1, -0.6)))
main_series = c(series_1, series_2)

result11 = GombayCPA_test(series_1, 2, "two-sided")
result11 #== No change point ===#

result12 = GombayCPA_test(main_series, 2, "two-sided")
result12  #=== One change at phi values ===#

result13 = GombayCPA_test(main_series, 2, "two-sided", "bootstrap")
result13  #=== One change at phi values ===#



#Example 2:

#From the package 'Ecdat' consider a time series with annual world number of victims of
#terrorism in the US from 1970 till 2016:
c.data = Ecdat::terrorism['nkill.us']
nkill.us.ts &lt;- ts(c.data, start = 1970, end = 2016)

#Now perform a change point detection with one sided tests:
GombayCPA_test(nkill.us.ts, 0, "lesser")
GombayCPA_test(nkill.us.ts, 0, "greater")
nkill.us.ts[32]
year = 1970 + 31
print(year)
plot(nkill.us.ts)

#In both cases we find that the change point is located at the position 31 or 32. We can
# examine it further by checking the value of this position (using: nkill.us.ts[32]) as well as
# by plotting the graph (using: plot(nkill.us.ts)). The detected change point corresponds to
#the year of 2001, when the 9/11 attack happened.

## End(Not run)

</code></pre>


</div>