<div class="container">

<table style="width: 100%;"><tr>
<td>fts.rma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate functional moving average processes</h2>

<h3>Description</h3>

<p>Generate a functional moving average process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fts.rma(
  n = 100,
  d = 11,
  Psi = NULL,
  op.norms = NULL,
  noise = "mnorm",
  sigma = diag(d:1)/d,
  df = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>dimension of the underlying multivariate VAR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>an array of <code class="reqn">p\geq 1</code> coefficient matrices (need to be square matrices). <code>Psi[,,k]</code> is the k-th coefficient
matrix. If <code>Psi</code> is provided then <code>d=dim(Psi)[1]</code>. If no value is set then we generate a functional autoregressive
process of order 1. Then, <code>Psi[,,1]</code> is proportional to <code class="reqn">\exp(-|i-j|\colon 1\leq i, j\leq d)</code> and such that
Hilbert-Schmidt norm of the corresponding lag-1 MA operator is 1/2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>op.norms</code></td>
<td>
<p>a vector with non-negative scalar entries to which the <code>Psi</code> are supposed to be scaled.
The length of the vector must equal to the order of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p><code>"mnorm"</code> for normal noise or <code>"mt"</code> for student t noise. If
not specified <code>"mvnorm"</code> is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>covariance  or scale matrix of the coefficients corresponding to functional innovations. The default value
is <code>diag(d:1)/d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freqdom if <code>noise = "mt"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpose is to simulate a functional autoregressive process of the form
</p>
<p style="text-align: center;"><code class="reqn">
X_t(u)=\sum_{k=1}^p \int_0^1\Psi_k(u,v) X_{t-k}(v)dv+\varepsilon_t(u),\quad 1\leq t\leq n.
</code>
</p>

<p>Here we assume that the observations lie in a finite dimensional subspace of the function space spanned by
Fourier basis functions <code class="reqn">\boldsymbol{b}^\prime(u)=(b_1(u),\ldots, b_d(u))</code>. That is <code class="reqn">X_t(u)=\boldsymbol{b}^\prime(u)\boldsymbol{X}_t</code>, <code class="reqn">\varepsilon_t(u)=\boldsymbol{b}^\prime(u)\boldsymbol{\varepsilon}_t</code> and <code class="reqn">\Psi_k(u,v)=\boldsymbol{b}^\prime(u)\boldsymbol{\Psi}_k \boldsymbol{b}(v)</code>. Then it follows that
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{X}_t=\boldsymbol{\Psi}_1\boldsymbol{X}_{t-1}+\cdots+ \boldsymbol{\Psi}_p\boldsymbol{X}_{t-p}+\boldsymbol{\varepsilon}_t.
</code>
</p>

<p>Hence the dynamic of the functional time series is described by a VAR(<code class="reqn">p</code>) process.
</p>
<p>In this mathematical model the law of <code class="reqn">\boldsymbol{\varepsilon}_t</code> is determined by <code>noise</code>. The matrices <code>Psi[,,k]</code>
correspond to <code class="reqn">\boldsymbol{\Psi}_k</code>. If <code>op.norms</code> is provided, then the coefficient matrices will be rescaled, such that
the Hilbert-Schmidt norms of <code class="reqn">\boldsymbol{\Psi}_k</code> correspond to the vector.
</p>


<h3>Value</h3>

<p>An object of class <code>fd</code>.
</p>


<h3>See Also</h3>

<p>The multivariate equivalent in the <code>freqdom</code> package: <code>rma</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a FMA process without burnin (starting from 0)
fts = fts.rma(n = 5, d = 5)
plot(fts)

# Generate observations with very strong dependance
fts = fts.rma(n = 100, d = 5, op.norms = 0.999)
plot(fts)

# Generate observations with very strong dependance and noise
# from the multivariate t distribution
fts = fts.rma(n = 100, d = 5, op.norms = 0.999, noise = "mt")
plot(fts)
</code></pre>


</div>