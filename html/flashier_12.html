<div class="container">

<table style="width: 100%;"><tr>
<td>flash_factors_fix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fix flash factors</h2>

<h3>Description</h3>

<p>Fixes loadings <code class="reqn">\ell_{\cdot k}</code> or factors <code class="reqn">f_{\cdot k}</code>
for one or more factor/loadings pairs, so that their values are not
updated during subsequent backfits. For a given pair, either the loadings
or factor can be fixed, but not both, and either all entries or a subset
can be fixed. To unfix, use function <code>flash_factors_unfix</code>. See
<code>flash_factors_init</code> for an example of usage.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flash_factors_fix(
  flash,
  kset,
  which_dim = c("factors", "loadings"),
  fixed_idx = NULL,
  use_fixed_in_ebnm = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>flash</code></td>
<td>
<p>A <code>flash</code> or <code>flash_fit</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kset</code></td>
<td>
<p>A vector of integers indexing the factor/loadings pairs whose
loadings or factors are to be fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_dim</code></td>
<td>
<p>Whether to fix factors or loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_idx</code></td>
<td>
<p>If <code>fixed_idx = NULL</code>, then all loadings or factor
values will be fixed. If only a subset are to be fixed,
then <code>fixed_idx</code> should be an appropriately-sized vector or
matrix of values that can be coerced to logical. For example, if
a subset of loadings for two factor/loadings pairs are to be fixed, then
<code>fixed_idx</code> should be a length-<code class="reqn">n</code> vector or an <code class="reqn">n</code> by 2
matrix (where <code class="reqn">n</code> is the number of rows in the data matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_fixed_in_ebnm</code></td>
<td>
<p>By default, fixed elements are ignored when
solving the EBNM subproblem in order to estimate the prior <code class="reqn">\hat{g}</code>.
This behavior can be changed by setting <code>use_fixed_in_ebnm = TRUE</code>.
This is a global setting which applies to all factor/loadings pairs;
behavior cannot vary from one factor/loadings pair to another.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>flash</code> object from argument <code>flash</code>, with
factors or loadings fixed as specified.
</p>


</div>