<div class="container">

<table style="width: 100%;"><tr>
<td>FB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fuller-Burmeister estimator</h2>

<h3>Description</h3>

<p>Produces estimates for population totals and means using the Fuller - Burmeister estimator from survey data obtained
from a dual frame sampling desing. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FB(ysA, ysB, pi_A, pi_B, domains_A, domains_B, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "a" and "ab".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are "b" and "ba".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fuller-Burmeister estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{FB} = \hat{Y}_a^A + \hat{\beta_1}\hat{Y}_{ab}^A + (1 - \hat{\beta_1})\hat{Y}_{ab}^B + \hat{Y}_b^B + \hat{\beta_2}(\hat{N}_{ab}^A - \hat{N}_{ab}^B)</code>
</p>

<p>where optimal values for <code class="reqn">\hat{\beta}</code> to minimize variance of the estimator are:
</p>
<p style="text-align: center;"><code class="reqn">
   \left( \begin{array}{c}
       \hat{\beta}_1\\
       \hat{\beta}_2
   \end{array} \right)
       = -
   \left( \begin{array}{cc}
       \hat{V}(\hat{Y}_{ab}^A - \hat{Y}_{ab}^B) &amp; \widehat{Cov}(\hat{Y}_{ab}^A - \hat{Y}_{ab}^B, \hat{N}_{ab}^A - \hat{N}_{ab}^B)\\
       \widehat{Cov}(\hat{Y}_{ab}^A - \hat{Y}_{ab}^B, \hat{N}_{ab}^A - \hat{N}_{ab}^B) &amp; \hat{V}(\hat{N}_{ab}^A - \hat{N}_{ab}^B)
   \end{array} \right)^{-1}
       \times</code>
</p>

<p style="text-align: center;"><code class="reqn">
   \left( \begin{array}{c}
       \widehat{Cov}(\hat{Y}_a^A + \hat{Y}_b^B + \hat{Y}_{ab}^B, \hat{Y}_{ab}^A - \hat{Y}_{ab}^B)\\
       \widehat{Cov}(\hat{Y}_a^A + \hat{Y}_b^B + \hat{Y}_{ab}^B, \hat{N}_{ab}^A - \hat{N}_{ab}^B)
   \end{array} \right)
   </code>
</p>

<p>Due to Fuller-Burmeister estimator is not defined for estimating population sizes, estimation of the mean is computed as <code class="reqn">\hat{Y}_{FB} / \hat{N}_H</code>, where <code class="reqn">\hat{N}_H</code>
is the estimation of the population size using Hartley estimator.
Estimated variance for the Fuller-Burmeister estimator can be obtained through expression
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{FB}) = \hat{V}(\hat{Y}_a^A) + \hat{V}(\hat{Y}^B) + 
    \hat{\beta}_1[\widehat{Cov}(\hat{Y}_a^A, \hat{Y}_{ab}^A) - \widehat{Cov}(\hat{Y}^B, \hat{Y}_{ab}^B)]</code>
</p>
 
<p style="text-align: center;"><code class="reqn"> + \hat{\beta}_2[\widehat{Cov}(\hat{Y}_a^A, \hat{N}_{ab}^A) - \widehat{Cov}(\hat{Y}^B, \hat{N}_{ab}^B)]
 </code>
</p>

<p>If both first and second order probabilities are known, variances and covariances involved in calculation of <code class="reqn">\hat{\beta}</code> and <code class="reqn">\hat{V}(\hat{Y}_{FB})</code> are estimated using functions <code>VarHT</code> and <code>CovHT</code>, respectively. If
only first order probabilities are known, variances are estimated using Deville's method and covariances are estimated using following expression
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Cov}(\hat{X}, \hat{Y}) = \frac{\hat{V}(X + Y) - \hat{V}(X) - \hat{V}(Y)}{2}</code>
</p>



<h3>Value</h3>

<p><code>FB</code> returns an object of class "EstimatorDF" which is a list with, at least, the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td>
</tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table><tr style="vertical-align: top;">
<td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td>
</tr></table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Fuller, W.A. and Burmeister, L.F. (1972).
<em>Estimation for Samples Selected From Two Overlapping Frames</em> ASA Proceedings of the Social Statistics Sections, 245 - 249.
</p>


<h3>See Also</h3>

<p><code>Hartley</code> <code>JackFB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate Fuller-Burmeister estimator for variable Clothing
FB(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate Fuller-Burmeister estimator and a 90% confidence interval
#for variable Leisure, considering only first order inclusion probabilities
FB(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$Domain, 
DatB$Domain, 0.90)
</code></pre>


</div>