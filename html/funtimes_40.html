<div class="container">

<table style="width: 100%;"><tr>
<td>wavk_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>WAVK Trend Test</h2>

<h3>Description</h3>

<p>Nonparametric test to detect (non-)monotonic parametric trends in time series
(based on Lyubchich et al. 2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wavk_test(
  formula,
  factor.length = c("user.defined", "adaptive.selection"),
  Window = NULL,
  q = 3/4,
  j = c(8:11),
  B = 1000,
  method = c("boot", "asympt"),
  ar.order = NULL,
  ar.method = "HVK",
  ic = "BIC",
  out = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>", specifying the
form of the parametric time trend to be tested. Variable <code class="reqn">t</code> should be used
to specify the form, where <code class="reqn">t</code> is specified within the function as a regular
sequence on the interval (0,1]. See <code>Examples</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.length</code></td>
<td>
<p>method to define the length of local windows (factors).
Default option<br><code>"user.defined"</code> allows setting only one value of the argument
<code>Window</code>. The option <code>"adaptive.selection"</code> sets <code>method = "boot"</code>
and employs heuristic <code class="reqn">m</code>-out-of-<code class="reqn">n</code> subsampling algorithm
(Bickel and Sakov 2008) to select an optimal window from the set
of possible windows <code>length(x)*q^j</code> whose values are mapped to the largest
previous integer and greater than 2. Vector <code>x</code> is the time series tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Window</code></td>
<td>
<p>length of the local window (factor), default is
<code>round(0.1*length(x))</code>, where <code>x</code> is the time series tested.
This argument is ignored if<br><code>factor.length = "adaptive.selection"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>scalar from 0 to 1 to define the set of possible windows when
<code>factor.length =</code> <code>"adaptive.selection"</code>. Default is <code class="reqn">3/4</code>.
This argument is ignored if<br><code>factor.length =</code> <code>"user.defined"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>numeric vector to define the set of possible windows when
<code>factor.length =</code> <code>"adaptive.selection"</code>. Default is <code>c(8:11)</code>.
This argument is ignored if<br><code>factor.length = "user.defined"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap simulations to obtain empirical critical values.
Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method of obtaining critical values: from asymptotical (<code>"asympt"</code>)
or bootstrap (<code>"boot"</code>) distribution.
If <code>factor.length =</code> <code>"adaptive.selection"</code> the option <code>"boot"</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.order</code></td>
<td>
<p>order of the autoregressive model when <code>ic = "none"</code>, or
the maximal order for IC-based filtering. Default is
<code>round(10*log10(length(x)))</code>, where <code>x</code> is the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.method</code></td>
<td>
<p>method of estimating autoregression coefficients.
Default <code>"HVK"</code> delivers robust difference-based estimates by
Hall and Van Keilegom (2003). Alternatively,
options of <code>ar</code> function can be used, such as <code>"burg"</code>,
<code>"ols"</code>, <code>"mle"</code>, and <code>"yw"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>information criterion used to select the order of autoregressive filter (AIC of BIC),
considering models of orders <code class="reqn">p=</code> 0,1,...,<code>ar.order</code>.
If <code>ic = "none"</code>, the AR(<code class="reqn">p</code>) model with <code class="reqn">p=</code> <code>ar.order</code> is used,
without order selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>logical value indicates whether the full output should be shown.
Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See more details in Lyubchich and Gel (2016)
and Lyubchich (2016).
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>name of the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>name of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p><code class="reqn">p</code>-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>window that was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>list with the following elements: estimated trend coefficients;
user-defined or IC-selected AR order; estimated AR coefficients; and,
if <code>factor.length =</code> <code>"adaptive.selection"</code>,
test results for all considered windows.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yulia R. Gel, Vyacheslav Lyubchich, Ethan Schaeffer
</p>


<h3>References</h3>

<p>Bickel PJ, Sakov A (2008).
“On the choice of <code class="reqn">m</code> in the <code class="reqn">m</code> out of <code class="reqn">n</code> bootstrap and confidence bounds for extrema.”
<em>Statistica Sinica</em>, <b>18</b>(3), 967–985.<br><br> Hall P, Van Keilegom I (2003).
“Using difference-based methods for inference in nonparametric regression with time series errors.”
<em>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</em>, <b>65</b>(2), 443–456.
<a href="https://doi.org/10.1111/1467-9868.00395">doi:10.1111/1467-9868.00395</a>.<br><br> Lyubchich V (2016).
“Detecting time series trends and their synchronization in climate data.”
<em>Intelligence. Innovations. Investments</em>, <b>12</b>, 132–137.<br><br> Lyubchich V, Gel YR (2016).
“A local factor nonparametric test for trend synchronism in multiple time series.”
<em>Journal of Multivariate Analysis</em>, <b>150</b>, 91–104.
<a href="https://doi.org/10.1016/j.jmva.2016.05.004">doi:10.1016/j.jmva.2016.05.004</a>.<br><br> Lyubchich V, Gel YR, El-Shaarawi A (2013).
“On detecting non-monotonic trends in environmental time series: a fusion of local regression and bootstrap.”
<em>Environmetrics</em>, <b>24</b>(4), 209–226.
<a href="https://doi.org/10.1002/env.2212">doi:10.1002/env.2212</a>.
</p>


<h3>See Also</h3>

<p><code>ar</code>, <code>HVK</code>, <code>WAVK</code>,
<code>sync_test</code>, <code>vignette("trendtests", package = "funtimes")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fix seed for reproducible simulations:
set.seed(1)

#Simulate autoregressive time series of length n with smooth quadratic trend:
n &lt;- 100
tsTrend &lt;- 1 + 2*(1:n/n) + 4*(1:n/n)^2
tsNoise &lt;- arima.sim(n = n, list(order = c(2, 0, 0), ar = c(-0.7, -0.1)))
U &lt;- tsTrend + tsNoise
plot.ts(U)

#Test H0 of a linear trend, with m-out-of-n selection of the local window:
## Not run: 
    wavk_test(U ~ t, factor.length = "adaptive.selection")
## End(Not run)
# Sample output:
##	Trend test by Wang, Akritas, and Van Keilegom (bootstrap p-values)
##
##data:  U
##WAVK test statistic = 5.3964, adaptively selected window = 4, p-value &lt; 2.2e-16
##alternative hypothesis: trend is not of the form U ~ t.

#Test H0 of a quadratic trend, with m-out-of-n selection of the local window
#and output of all results:
## Not run: 
    wavk_test(U ~ poly(t, 2), factor.length = "adaptive.selection", out = TRUE)
## End(Not run)
# Sample output:
##	Trend test by Wang, Akritas, and Van Keilegom (bootstrap p-values)
##
##data:  U
##WAVK test statistic = 0.40083, adaptively selected window = 4, p-value = 0.576
##alternative hypothesis: trend is not of the form U ~ poly(t, 2).
##sample estimates:
##$trend_coefficients
##(Intercept) poly(t, 2)1 poly(t, 2)2
##   3.408530   17.681422    2.597213
##
##$AR_order
##[1] 1
##
##$AR_coefficients
##         phi_1
##[1] -0.7406163
##
##$all_considered_windows
## Window WAVK-statistic p-value
##      4     0.40083181   0.576
##      5     0.06098625   0.760
##      7    -0.57115451   0.738
##     10    -1.02982929   0.360

# Test H0 of no trend (constant trend) using asymptotic distribution of statistic.
wavk_test(U ~ 1, method = "asympt")
# Sample output:
##	Trend test by Wang, Akritas, and Van Keilegom (asymptotic p-values)
##
##data:  U
##WAVK test statistic = 25.999, user-defined window = 10, p-value &lt; 2.2e-16
##alternative hypothesis: trend is not of the form U ~ 1.

</code></pre>


</div>