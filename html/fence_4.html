<div class="container">

<table style="width: 100%;"><tr>
<td>fence.NF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fence model selection (Nonparametric Model)</h2>

<h3>Description</h3>

<p>Fence model selection (Noparametric Model)
</p>


<h3>Usage</h3>

<pre><code class="language-R">fence.NF(full, data, spline, ps = 1:3, qs = NA, B = 100, grid = 101,
  bandwidth = NA, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>formula of full model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline</code></td>
<td>
<p>variable needed for spline terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps</code></td>
<td>
<p>order of power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qs</code></td>
<td>
<p>number of knots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap sample, parametric for lmer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>grid for c</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>bandwidth for kernel smooth function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A grid of lambda values</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>list all model candidates with p polynomial degrees and q knots in the model space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qd_matrix</code></td>
<td>
<p>list a matrix of QM - QM.tilde for all model candidates. Each row is for each bootrap sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>list the value of bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_mat</code></td>
<td>
<p>list a matrix of selected models at each c values in grid (in columns). Each row is for each bootstrap sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq_mat</code></td>
<td>
<p>list a matrix of coverage probabilities (frequency/smooth_frequency) of each selected models for a given c value (index)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>list the adaptive choice of c value from which the parsimonious model is selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>penalty (or smoothing) parameter estimate given selected p and q</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel_model</code></td>
<td>
<p>list the selected (parsimonious) model given the adaptive c value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.est.u</code></td>
<td>
<p>A list of coefficient estimates given a lambda value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.x.hat</code></td>
<td>
<p>A vector of fitted values obtained from a given lambda value and beta.est.u</p>
</td>
</tr>
</table>
<p>@note The current Fence method in Nonparametric model focuses on one spline variable. 
This method can be extended to a general case with more than one spline variables, and includes non-spline variables.
</p>


<h3>Author(s)</h3>

<p>Jiming Jiang Jianyang Zhao J. Sunil Rao Bao-Qui Tran Thuan Nguyen
</p>


<h3>References</h3>


<ul>
<li>
<p>Jiang J., Rao J.S., Gu Z., Nguyen T. (2008),  Fence Methods for Mixed Model Selection. The Annals of Statistics, 36(4): 1669-1692
</p>
</li>
<li>
<p>Jiang J., Nguyen T., Rao J.S. (2009), A Simplified Adaptive Fence Procedure. Statistics and Probability Letters, 79, 625-629
</p>
</li>
<li>
<p>Jiang J., Nguyen T., Rao J.S. (2010), Fence Method for Nonparametric Small Area Estimation. Survey Methodology, 36, 1, 3-11
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
require(fence)
n = 100
set.seed(1234)
x=runif(n,0,3)
y = 1-x+x^2- 2*(x-1)^2*(x&gt;1) + 2*(x-2)^2*(x&gt;2) + rnorm(n,sd=.2)
lambda=exp((c(1:60)-30)/3)
data=data.frame(cbind(x,y))   
test_NF = fence.NF(full=y~x, data=data, spline='x', ps=c(1:3), qs=c(2,5), B=1000, lambda=lambda)
plot(test_NF)
summary &lt;- summary(test_NF) 
model_sel &lt;- summary[[1]]
model_sel
lambda_sel &lt;- summary[[2]]
lambda_sel

## End(Not run)
</code></pre>


</div>