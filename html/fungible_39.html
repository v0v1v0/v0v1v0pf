<div class="container">

<table style="width: 100%;"><tr>
<td>fapa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Iterated Principal Axis Factor Analysis (fapa)</h2>

<h3>Description</h3>

<p>This function applies the iterated principal axis factoring method to extract an unrotated factor structure matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fapa(
  R,
  numFactors = NULL,
  epsilon = 1e-04,
  communality = "SMC",
  maxItr = 15000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>(Matrix) A correlation matrix to be analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numFactors</code></td>
<td>
<p>(Numeric) The number of factors to extract.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>(Numeric) A numeric threshold to designate whether the function has converged. The default value is 1e-4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>communality</code></td>
<td>
<p>(Character) The routine requires an initial estimate of the communality values. There are three options (see below) with "SMC" (i.e., squared multiple correlation) being the default.
</p>

<ul>
<li> <p><strong>"SMC"</strong>: Initial communalities are estimated by taking the squared multiple correlations of each indicator after regressing the indicator on the remaining variables. The following equation is employed to find the squared multiple correlation: <code class="reqn">1 - 1 / diag(R^-1)</code>.
</p>
</li>
<li> <p><strong>"maxr"</strong>: Initial communalities equal the largest (absolute value) correlation in each column of the correlation matrix.
</p>
</li>
<li> <p><strong>"unity"</strong>: Initial communalities equal 1.0 for all variables.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxItr</code></td>
<td>
<p>(Numeric) The maximum number of iterations to reach convergence. The default is 15,000.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul><li> <p><strong>Initial communality estimate</strong>: The choice of the initial communality estimate can impact the resulting principal axis factor solution.
</p>

<ul>
<li> <p><strong>Impact on the Estimated Factor Structure</strong>: According to Widaman and Herringer (1985), the initial communality estimate does not have much bearing on the resulting solution <em>when a stringent convergence criterion is used</em>. In their analyses, a convergence criterion of .001 (i.e., slightly less stringent than the default of 1e-4) is sufficiently stringent to produce virtually identical communality estimates irrespective of the initial estimate used. Based on their findings, it is not recommended to use a convergence criterion lower than 1e-3.
</p>
</li>
<li> <p><strong>Impact on the Iteration Procedure</strong>: The initial communality estimates have little impact on the <em>final factor structure</em> but they can impact the iterated procedure. It is possible that poor communality estimates produce a non-positive definite correlation matrix (i.e., eigenvalues &lt;= 0) whereas different communality estimates  result in a converged solution. If the fapa procedure fails to converge due to a non-positive definite matrix, try using different communality estimates before changing the convergence criterion.
</p>
</li>
</ul>
</li></ul>
<h3>Value</h3>

<p>The main output is the matrix of unrotated factor loadings.
</p>

<ul>
<li> <p><strong>loadings</strong>: (Matrix) A matrix of unrotated factor loadings extracted via iterated principal axis factoring.
</p>
</li>
<li> <p><strong>h2</strong>: (Vector) A vector containing the resulting communality values.
</p>
</li>
<li> <p><strong>iterations</strong>: (Numeric) The number of iterations required to converge.
</p>
</li>
<li> <p><strong>converged</strong>: (Logical) TRUE if the iterative procedure converged.
</p>
</li>
<li> <p><strong>faControl</strong>: (List) A list of the control parameters used to generate the factor structure.
</p>

<ul>
<li> <p><strong>epsilon</strong>: (Numeric) The convergence criterion used for evaluating each iteration.
</p>
</li>
<li> <p><strong>communality</strong>: (Character) The method for estimating the initial communality values.
</p>
</li>
<li> <p><strong>maxItr</strong>: (Numeric) The maximum number of allowed iterations to reach convergence.
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>


<ul>
<li>
<p> Casey Giordano (Giord023@umn.edu)
</p>
</li>
<li>
<p> Niels G. Waller (nwaller@umn.edu)
</p>
</li>
</ul>
<h3>References</h3>

<p>Widaman, K. F., &amp; Herringer, L. G. (1985). Iterative least squares estimates of communality: Initial estimate need not affect stabilized value. <em>Psychometrika, 50</em>(4), 469-477.
</p>


<h3>See Also</h3>

<p>Other Factor Analysis Routines: 
<code>BiFAD()</code>,
<code>Box26</code>,
<code>GenerateBoxData()</code>,
<code>Ledermann()</code>,
<code>SLi()</code>,
<code>SchmidLeiman()</code>,
<code>faAlign()</code>,
<code>faEKC()</code>,
<code>faIB()</code>,
<code>faLocalMin()</code>,
<code>faMB()</code>,
<code>faMain()</code>,
<code>faScores()</code>,
<code>faSort()</code>,
<code>faStandardize()</code>,
<code>faX()</code>,
<code>fals()</code>,
<code>fareg()</code>,
<code>fsIndeterminacy()</code>,
<code>orderFactors()</code>,
<code>print.faMB()</code>,
<code>print.faMain()</code>,
<code>promaxQ()</code>,
<code>summary.faMB()</code>,
<code>summary.faMain()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate an example factor structure matrix
lambda &lt;- matrix(c(.62, .00, .00,
                   .54, .00, .00,
                   .41, .00, .00,
                   .00, .31, .00,
                   .00, .58, .00,
                   .00, .62, .00,
                   .00, .00, .38,
                   .00, .00, .43,
                   .00, .00, .37),
                 nrow = 9, ncol = 3, byrow = TRUE)

## Find the model implied correlation matrix
R &lt;- lambda %*% t(lambda)
diag(R) &lt;- 1

## Extract factors using the fapa function
Out1 &lt;- fapa(R           = R,
             numFactors  = 3,
             communality = "SMC")

## Call fapa through the factExtract function
Out2 &lt;- faX(R          = R,
            numFactors = 3,
            facMethod  = "fapa",
            faControl  = list(communality = "maxr",
                              epsilon     = 1e-4))

## Check for equivalence of the two results
all.equal(Out1$loadings, Out2$loadings)


</code></pre>


</div>