<div class="container">

<table style="width: 100%;"><tr>
<td>var.fd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Variance, Covariance, and Correlation Surfaces for
Functional Data Object(s)   
</h2>

<h3>Description</h3>

<p>Compute variance, covariance, and / or correlation functions for
functional data.  
</p>
<p>These are two-argument functions and therefore define surfaces. If
only one functional data object is supplied, its variance or
correlation function is computed.  If two are supplied, the covariance
or correlation function between them is 
computed.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">var.fd(fdobj1, fdobj2=fdobj1)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>fdobj1, fdobj2</code></td>
<td>

<p>a functional data object.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>a two-argument or bivariate functional data object representing the
variance, covariance or correlation surface for a single functional
data object or the covariance between two functional data objects or
between different variables in a multivariate functional data object.
</p>


<h3>Value</h3>

<p>An list object of class <code>bifd</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>

<p>the coefficient array with dimensions fdobj1[["basis"]][["nbasis"]]
by fdobj2[["basis"]][["nbasis"]] giving the coefficients of the 
covariance matrix in terms of the bases used by fdobj1 and
fdobj2.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sbasis</code></td>
<td>

<p>fdobj1[["basis"]]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbasis</code></td>
<td>

<p>fdobj2[["basis"]]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bifdnames</code></td>
<td>

<p>dimnames list for a 4-dimensional 'coefs' array.  If
length(dim(coefs)) is only 2 or 3, the last 2 or 1 component of
bifdnames is not used with dimnames(coefs).  
</p>
</td>
</tr>
</table>
<p>Examples below illustrate this structure in simple
cases.  
</p>


<h3>References</h3>

<p>Ramsay, James O., Hooker, Giles, and Graves, Spencer (2009),
<em>Functional data analysis with R and Matlab</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2005), 
<em>Functional Data Analysis, 2nd ed.</em>, Springer, New York.
</p>
<p>Ramsay, James O., and Silverman, Bernard W. (2002), 
<em>Applied Functional Data Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>mean.fd</code>, 
<code>sd.fd</code>, 
<code>std.fd</code>
<code>stdev.fd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">oldpar &lt;- par(no.readonly=TRUE)
##
## Example with 2 different bases 
##
daybasis3 &lt;- create.fourier.basis(c(0, 365))
daybasis5 &lt;- create.fourier.basis(c(0, 365), 5)
tempfd3 &lt;- with(CanadianWeather, smooth.basis(day.5, 
       dailyAv[,,"Temperature.C"], 
       daybasis3, fdnames=list("Day", "Station", "Deg C"))$fd )
precfd5 &lt;- with(CanadianWeather, smooth.basis(day.5, 
       dailyAv[,,"log10precip"],
       daybasis5, fdnames=list("Day", "Station", "Deg C"))$fd )

# Compare with structure described above under 'value':
str(tempPrecVar3.5 &lt;- var.fd(tempfd3, precfd5))

##
## The following produces contour and perspective plots
##

# Evaluate at a 53 by 53 grid for plotting

daybasis65 &lt;- create.fourier.basis(rangeval=c(0, 365), nbasis=65)

daytempfd &lt;- with(CanadianWeather, smooth.basis(day.5, 
       dailyAv[,,"Temperature.C"],
       daybasis65, fdnames=list("Day", "Station", "Deg C"))$fd )
str(tempvarbifd &lt;- var.fd(daytempfd))

str(tempvarmat  &lt;- eval.bifd(weeks,weeks,tempvarbifd))
# dim(tempvarmat)= c(53, 53)

par(mfrow=c(1,2), pty="s")
#contour(tempvarmat, xlab="Days", ylab="Days")
contour(weeks, weeks, tempvarmat, 
        xlab="Daily Average Temperature",
        ylab="Daily Average Temperature",
        main=paste("Variance function across locations\n",
          "for Canadian Anual Temperature Cycle"),
        cex.main=0.8, axes=FALSE)
axisIntervals(1, atTick1=seq(0, 365, length=5), atTick2=NA, 
            atLabels=seq(1/8, 1, 1/4)*365,
            labels=paste("Q", 1:4) )
axisIntervals(2, atTick1=seq(0, 365, length=5), atTick2=NA, 
            atLabels=seq(1/8, 1, 1/4)*365,
            labels=paste("Q", 1:4) )
persp(weeks, weeks, tempvarmat,
      xlab="Days", ylab="Days", zlab="Covariance")
mtext("Temperature Covariance", line=-4, outer=TRUE)
par(oldpar)

</code></pre>


</div>