<div class="container">

<table style="width: 100%;"><tr>
<td>percentile_score</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distribution accuracy measures</h2>

<h3>Description</h3>

<p>These accuracy measures can be used to evaluate how accurately a forecast
distribution predicts a given actual value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">percentile_score(.dist, .actual, na.rm = TRUE, ...)

quantile_score(
  .dist,
  .actual,
  probs = c(0.05, 0.25, 0.5, 0.75, 0.95),
  na.rm = TRUE,
  ...
)

CRPS(.dist, .actual, n_quantiles = 1000, na.rm = TRUE, ...)

distribution_accuracy_measures
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.dist</code></td>
<td>
<p>The distribution of fitted values from the model, or forecasted values from the forecast.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.actual</code></td>
<td>
<p>A vector of responses matching the fitted values
(for forecast accuracy, <code>new_data</code> must be provided).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Remove the missing values before calculating the accuracy measure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for each measure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A vector of probabilities at which the metric is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_quantiles</code></td>
<td>
<p>The number of quantiles to use in approximating CRPS when an exact solution is not available.</p>
</td>
</tr>
</table>
<h3>Format</h3>

<p>An object of class <code>list</code> of length 2.
</p>


<h3>Quantile/percentile score (pinball loss)</h3>

<p>A quantile (or percentile) score evaluates how accurately a set of quantiles
(or percentiles) from the distribution match the given actual value. This
score uses a pinball loss function, and can be calculated via the average of
the score function given below:
</p>
<p>The score function <code class="reqn">s_p(q_p,y)</code> is given by <code class="reqn">(1-p)(q_p-y)</code> if
<code class="reqn">y &lt; q_p</code>, and <code class="reqn">p(y-q_p)</code> if <code class="reqn">y \ge q_p</code>. Where <code class="reqn">p</code> is the
quantile probability, <code class="reqn">q_p = F^{-1}(p)</code> is the quantile with probability
<code class="reqn">p</code>, and <code class="reqn">y</code> is the actual value.
</p>
<p>The resulting accuracy measure will average this score over all predicted
points at all desired quantiles (defined via the <code>probs</code> argument).
</p>
<p>The percentile score is uses the same method with <code>probs</code> set to all
percentiles <code>probs = seq(0.01, 0.99, 0.01)</code>.
</p>


<h3>Continuous ranked probability score (CRPS)</h3>

<p>The continuous ranked probability score (CRPS) is the continuous analogue of
the pinball loss quantile score defined above. Its value is twice the
integral of the quantile score over all possible quantiles:
</p>
<p style="text-align: center;"><code class="reqn">
  CRPS(F,y) = 2 \int_0^1 s_p(q_p,y) dp
</code>
</p>

<p>It can be computed directly from the distribution via:
</p>
<p style="text-align: center;"><code class="reqn">
  CRPS(F,y) = \int_{-\infty}^\infty (F(x) - 1{y\leq x})^2 dx
</code>
</p>

<p>For some forecast distribution <code class="reqn">F</code> and actual value <code class="reqn">y</code>.
</p>
<p>Calculating the CRPS accuracy measure is computationally difficult for many
distributions, however it can be computed quickly and exactly for Normal and
emperical (sample) distributions. For other distributions the CRPS is
approximated using the quantile score of many quantiles (using the number of
quantiles specified in the <code>n_quantiles</code> argument).
</p>


</div>