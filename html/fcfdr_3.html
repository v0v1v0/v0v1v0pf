<div class="container">

<table style="width: 100%;"><tr>
<td>flexible_cfdr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform Flexible cFDR</h2>

<h3>Description</h3>

<p>Performs Flexible cFDR for continuous auxiliary covariates
</p>


<h3>Usage</h3>

<pre><code class="language-R">flexible_cfdr(
  p,
  q,
  indep_index,
  res_p = 300,
  res_q = 500,
  nxbin = 1000,
  gridp = 50,
  splinecorr = TRUE,
  dist_thr = 0.5,
  locfdr_df = 10,
  plot = TRUE,
  maf = NULL,
  check_indep_cor = TRUE,
  enforce_p_q_cor = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>p-values for principal trait (vector of length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>continuous auxiliary data values (vector of length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indep_index</code></td>
<td>
<p>indices of independent SNPs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res_p</code></td>
<td>
<p>number of grid points in x-direction (<code>p</code>) for KDE estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res_q</code></td>
<td>
<p>number of grid points in y-direction (<code>q</code>) for KDE estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nxbin</code></td>
<td>
<p>number of bins in x-direction (<code>p</code>) for hex-binning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridp</code></td>
<td>
<p>number of data points required in a KDE grid point for left-censoring</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splinecorr</code></td>
<td>
<p>logical value for whether spline correction should be implemented</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_thr</code></td>
<td>
<p>distance threshold for spline correction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locfdr_df</code></td>
<td>
<p><code>df</code> parameter in locfdr function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical value for whether to produce plots to assess KDE fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maf</code></td>
<td>
<p>minor allele frequencies for SNPs to which <code>p</code> and <code>q</code> relate (optional and used to perform MAF matching)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_indep_cor</code></td>
<td>
<p>check that sign of the correlation between <code>p</code> and <code>q</code> is the same in the independent subset as in the whole</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enforce_p_q_cor</code></td>
<td>
<p>if <code>p</code> and <code>q</code> are negatively correlated, flip the sign on <code>q</code> values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>maf</code> is specified, then the independent SNPs will be down-sampled to match the minor allele frequency distribution.
</p>


<h3>Value</h3>

<p>List of length two: (1) data.frame of p-values, q-values and v-values (2) data.frame of auxiliary data (q_low used for left censoring, how many data-points were left censored and/or spline corrected)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# this is a long running example
 
# In this example, we generate some p-values (representing GWAS p-values)
# and some arbitrary auxiliary data values (e.g. representing functional genomic data).
# We use the flexible_cfdr() function to generate v-values using default parameter values.

# generate p
set.seed(1)
n &lt;- 1000
n1p &lt;- 50 
zp &lt;- c(rnorm(n1p, sd=5), rnorm(n-n1p, sd=1))
p &lt;- 2*pnorm(-abs(zp))

# generate q
mixture_comp1 &lt;- function(x) rnorm(x, mean = -0.5, sd = 0.5)
mixture_comp2 &lt;- function(x) rnorm(x, mean = 2, sd = 1)
q &lt;- c(mixture_comp1(n1p), mixture_comp2(n-n1p))

n_indep &lt;- n

flexible_cfdr(p, q, indep_index = 1:n_indep)


</code></pre>


</div>