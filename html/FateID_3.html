<div class="container">

<table style="width: 100%;"><tr>
<td>fateBias</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computation of fate bias</h2>

<h3>Description</h3>

<p>This function computes fate biases for single cells based on expression data from a single cell sequencing experiment. It requires a clustering partition and a target cluster representing a commited state for each trajectory.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fateBias(
  x,
  y,
  tar,
  z = NULL,
  minnr = NULL,
  minnrh = NULL,
  adapt = TRUE,
  confidence = 0.75,
  nbfactor = 5,
  use.dist = FALSE,
  seed = NULL,
  nbtree = NULL,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>expression data frame with genes as rows and cells as columns. Gene IDs should be given as row names and cell IDs should be given as column names. This can be a reduced expression table only including the features (genes) to be used in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>clustering partition. A vector with an integer cluster number for each cell. The order of the cells has to be the same as for the columns of x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tar</code></td>
<td>
<p>vector of integers representing target cluster numbers. Each element of <code>tar</code> corresponds to a cluster of cells committed towards a particular mature state. One cluster per different cell lineage has to be given and is used as a starting point for learning the differentiation trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Matrix containing cell-to-cell distances to be used in the fate bias computation. Default is <code>NULL</code>. In this case, a correlation-based distance is computed from <code>x</code> by <code>1 - cor(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minnr</code></td>
<td>
<p>integer number of cells per target cluster to be selected for classification (test set) in each iteration. For each target cluster, the <code>minnr</code> cells with the highest similarity to a cell in the training set are selected for classification. If <code>z</code> is not <code>NULL</code> it is used as the similarity matrix for this step. Otherwise, <code>1-cor(x)</code> is used. Default value is <code>NULL</code> and <code>minnr</code> is estimated as the minimum of and 20 and half the median of target cluster sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minnrh</code></td>
<td>
<p>integer number of cells from the training set used for classification. From each training set, the <code>minnrh</code> cells with the highest similarity to the training set are selected. If <code>z</code> is not <code>NULL</code> it is used as the similarity matrix for this step. Default value is <code>NULL</code> and <code>minnrh</code> is estimated as the maximum of and 20 and half the median of target cluster sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt</code></td>
<td>
<p>logical. If <code>TRUE</code> then the size of the test set for each target cluster is adapted based on the classification success in the previous iteration. For each target cluster, the number of successfully classified cells is determined, i.e. the number of cells with a minimum fraction of votes given by the <code>confidence</code> parameter for the target cluster, which gave rise to the inclusion of the cell in the test set (see <code>minnr</code>). Weights are then derived by dividing this number by the maximum across all clusters after adding a pseudocount of 1. The test set size <code>minnr</code> is rescaled for each cluster by the respective weight in the next iteration. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>real number between 0 and 1. See <code>adapt</code> parameter. Default is 0.75.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbfactor</code></td>
<td>
<p>positive integer number. Determines the number of trees grown for each random forest. The number of trees is given by the number of columns of th training set multiplied by <code>nbfactor</code>. Default value is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.dist</code></td>
<td>
<p>logical value. If <code>TRUE</code> then the distance matrix is used as feature matrix (i. e. <code>z</code> if not equal to <code>NULL</code> and <code>1-cor(x)</code> otherwise). If <code>FALSE</code>, gene expression values in <code>x</code> are used. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>integer seed for initialization. If equal to <code>NULL</code> then each run will yield slightly different results due to the radomness of the random forest algorithm. Default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbtree</code></td>
<td>
<p>integer value. If given, it specifies the number of trees for each random forest explicitely. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, then print information to console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level function <code>randomForest</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The bias is computed as the ratio of the number of random forest votes for a trajectory and the number of votes for the trajectory with the second largest number of votes. By this means only the trajectory with the largest number of votes will receive a bias &gt;1. The siginifcance is computed based on counting statistics on the difference in the number of votes. A significant bias requires a p-value &lt; 0.05. Cells are assigned to a trajectory if they exhibit a significant bias &gt;1 for this trajectory.
</p>


<h3>Value</h3>

<p>A list with the following three components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>a data frame with the fraction of random forest votes for each cell. Columns represent the target clusters. Column names are given by a concatenation of <code>t</code> and target cluster number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>votes</code></td>
<td>
<p>a data frame with the number of random forest votes for each cell. Columns represent the target clusters. Column names are given by a concatenation of <code>t</code> and target cluster number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>list of vectors. Each component contains the IDs of all cells on the trajectory to a given target cluster. Component names are given by a concatenation of <code>t</code> and target cluster number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rfl</code></td>
<td>
<p>list of randomForest objects for each iteration of the classification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trall</code></td>
<td>
<p>vector of cell ids ordered by the random forest iteration in which they have been classified into one of the target clusters.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">x &lt;- intestine$x
y &lt;- intestine$y
tar &lt;- c(6,9,13)
fb &lt;- fateBias(x,y,tar,minnr=5,minnrh=20,adapt=TRUE,confidence=0.75,nbfactor=5)
head(fb$probs)
</code></pre>


</div>