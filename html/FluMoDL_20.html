<div class="container">

<table style="width: 100%;"><tr>
<td>predict.FluMoDL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for FluMoDL objects</h2>

<h3>Description</h3>

<p>Obtains predictions (predicted daily or weekly deaths) and optionally estimates
standard errors of those predictions
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'FluMoDL'
predict(object, temp = NULL, proxyH1 = NULL,
  proxyH3 = NULL, proxyB = NULL, proxyRSV = NULL, se.fit = FALSE,
  byWeek = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A FluMoDL object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp</code></td>
<td>
<p>A vector of daily mean temperatures. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proxyH1</code></td>
<td>
<p>A vector of daily influenza A(H1N1)pdm09 incidence proxies. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proxyH3</code></td>
<td>
<p>A vector of daily influenza A(H3N2) incidence proxies. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proxyB</code></td>
<td>
<p>A vector of daily influenza B incidence proxies. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proxyRSV</code></td>
<td>
<p>An vector of daily RSV incidence proxies (used only if the FluMoDL
object includes an RSV term). See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>Logical switch indicating if standard errors are required.
Requires <code>byWeek=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byWeek</code></td>
<td>
<p>If <code>TRUE</code>, aggregate fitted estimates by week. Has priority
over argument <code>se.fit</code>. If both <code>se.fit</code> and <code>byWeek</code> are
<code>TRUE</code>, <code>se.fit</code> is set to <code>FALSE</code> and a warning is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Arguments <code>temp</code>, <code>proxyH1</code>, <code>proxyH3</code>, <code>proxyB</code> and
(if <code>hasRSV(object)</code> is <code>TRUE</code>) <code>proxyRSV</code> take a numeric vector
as input, which is recycled to a length of <code>nrow(object$data)</code>. Alternatively
they can take <code>NULL</code>, in which case the respective column of <code>object$data</code>
is used as input. Argument <code>temp</code> can also take the string <code>"MMP"</code>, which
is interpreted as the "Minimum Mortality Point", i.e. the temperature at which
mortality is lowest (found in <code>object$MMP</code>).
</p>
<p>In this way, the <code>predict()</code> method can be flexibly used to calculate the
predicted "baseline" mortality (by setting <code>temp="MMP"</code> and all incidence proxies
to zero), the model-predicted mortality for the actual input (by leaving all input
arguments to their default <code>NULL</code>), or predicted mortalities for any combination of
temperature and incidence proxy inputs.
</p>


<h3>Value</h3>

<p>A vector of daily predicted deaths (corresponding to the rows in
<code>object$data</code>). If <code>byWeek=TRUE</code>, the predictions are automatically
aggregated by week (as per <code>object$data$yearweek</code>) and the vector contains
the respective week (in YYYYWW format) as names.
</p>
<p>If <code>se.fit=TRUE</code>, a list
is returned with elements <code>$fit</code> and <code>$se.fit</code> containing the
(daily) predicted deaths and their associated log standard errors.
</p>
<p>Note that the first 30 elements (or first 5 elements if <code>byWeek=TRUE</code>) will be
<code>NA</code> by default, as FluMoDL uses a maximum lag of 30 days.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(greece) # Use example surveillance data from Greece
m &lt;- with(greece, fitFluMoDL(deaths = daily$deaths,
    temp = daily$temp, dates = daily$date,
    proxyH1 = weekly$ILI * weekly$ppH1,
    proxyH3 = weekly$ILI * weekly$ppH3,
    proxyB = weekly$ILI * weekly$ppB,
    yearweek = weekly$yearweek))
m

# Calculate FluMoDL baseline
baseline &lt;- predict(m, temp="MMP", proxyH1=0, proxyH3=0, proxyB=0, byWeek=TRUE)

# Calculate fitted predictions
fitted &lt;- predict(m, byWeek=TRUE)


# Plot everything
plot(with(m$data, tapply(deaths, yearweek, sum)), type="l",
     xaxt="n", ylab="Weekly deaths", xlab="Time")
points(baseline, type="l", col="blue")
points(fitted, type="l", col="green")
legend("topleft", c("Actual", "Baseline", "Fitted"), lty="solid",
    col=c("black", "blue", "green"), bty="n")


</code></pre>


</div>