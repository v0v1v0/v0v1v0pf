<div class="container">

<table style="width: 100%;"><tr>
<td>LQDT_FPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Log quantile density transform
</h2>

<h3>Description</h3>

<p>Probability density function, cumulative distribution function and quantile density function are three characterizations of a distribution. Of these three, quantile density function is the least constrained. The only constrain is nonnegative. By taking a log transformation, there is no constrain. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">LQDT_FPCA(data, gridpoints, h_scale = 1, M = 3001, m = 5001, lag_maximum = 4, 
		no_boot = 1000, alpha_val = 0.1, p = 5, 
		band_choice = c("Silverman", "DPI"), 
		kernel = c("gaussian", "epanechnikov"), 
		forecasting_method = c("uni", "multi"), 
		varprop = 0.85, fmethod, VAR_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Densities or raw data matrix of dimension N by p, where N denotes sample size and p denotes dimensionality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridpoints</code></td>
<td>
<p>Grid points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_scale</code></td>
<td>
<p>Scaling parameter in the kernel density estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of grid points between 0 and 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of grid points within the data range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag_maximum</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_boot</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_val</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of backward parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band_choice</code></td>
<td>
<p>Selection of optimal bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>Type of kernel function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forecasting_method</code></td>
<td>
<p>Univariate or multivariate time series forecasting method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varprop</code></td>
<td>
<p>Proportion of variance explained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmethod</code></td>
<td>
<p>If <code>forecasting_method = "uni"</code>, specify a particular forecasting method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR_type</code></td>
<td>
<p>If <code>forecasting_method = "multi"</code>, specify a particular type of vector autoregressive model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>1) Transform the densities f into log quantile densities Y and c specifying the value of the cdf at 0 for the target density f.
2) Compute the predictions for future log quantile density and c value.
3) Transform the forecasts in Step 2) into the predicted density f.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L2Diff</code></td>
<td>
<p>L2 norm difference between reconstructed and actual densities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unifDiff</code></td>
<td>
<p>Uniform Metric excluding missing boundary values (due to boundary cutoff)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_reconstruct</code></td>
<td>
<p>Reconstructed densities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_original</code></td>
<td>
<p>Actual densities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dens_fore</code></td>
<td>
<p>Forecast densities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totalMass</code></td>
<td>
<p>Assess loss of mass incurred by boundary cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>m number of grid points</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Han Lin Shang
</p>


<h3>References</h3>

<p>Petersen, A. and Muller, H.-G. (2016) ‘Functional data analysis for density functions by transformation to a Hilbert space’, <em>The Annals of Statistics</em>, <b>44</b>, 183-218.
</p>
<p>Jones, M. C. (1992) ‘Estimating densities, quantiles, quantile densities and density quantiles’, <em>Annals of the Institute of Statistical Mathematics</em>, <b>44</b>, 721-727.
</p>


<h3>See Also</h3>

<p><code>CoDa_FPCA</code>, <code>Horta_Ziegelmann_FPCA</code>, <code>skew_t_fun</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
LQDT_FPCA(data = DJI_return, band_choice = "DPI", kernel = "epanechnikov", 
			forecasting_method = "uni", fmethod = "ets")

## End(Not run)		
</code></pre>


</div>