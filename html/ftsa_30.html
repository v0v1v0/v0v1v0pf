<div class="container">

<table style="width: 100%;"><tr>
<td>Horta_Ziegelmann_FPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Dynamic functional principal component analysis for density forecasting
</h2>

<h3>Description</h3>

<p>Implementation of a dynamic functional principal component analysis to forecast densities.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">Horta_Ziegelmann_FPCA(data, gridpoints, h_scale = 1, p = 5, m = 5001, 
	kernel = c("gaussian", "epanechnikov"), band_choice = c("Silverman", "DPI"), 
	VAR_type = "both", lag_maximum = 6, no_boot = 1000, alpha_val = 0.1, 
	ncomp_select = "TRUE", D_val = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Densities or raw data matrix of dimension N by p, where N denotes sample size and p denotes dimensionality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridpoints</code></td>
<td>
<p>Grid points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_scale</code></td>
<td>
<p>Scaling parameter in the kernel density estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of backward parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of grid points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>Type of kernel function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band_choice</code></td>
<td>
<p>Selection of optimal bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR_type</code></td>
<td>
<p>Type of vector autoregressive process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag_maximum</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_boot</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_val</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp_select</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D_val</code></td>
<td>
<p>A tuning parameter in the <code>super_fun</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>1) Compute a kernel covariance function
2) Via eigen-decomposition, a density can be decomposed into a set of functional principal components and their associated scores
3) Fit a vector autoregressive model to the scores with the order selected by Akaike information criterion
4) By multiplying the estimated functional principal components with the forecast scores, obtain forecast densities
5) Since forecast densities may neither be non-negative nor sum to one, normalize the forecast densities accordingly
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Yhat.fix_den</code></td>
<td>
<p>Forecast density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Grid points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>du</code></td>
<td>
<p>Distance between two successive grid points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ybar_est</code></td>
<td>
<p>Mean of density functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psihat_est</code></td>
<td>
<p>Estimated functional principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etahat_est</code></td>
<td>
<p>Estimated principal component scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etahat_pred_val</code></td>
<td>
<p>Forecast principal component scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected_d0</code></td>
<td>
<p>Selected number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected_d0_pvalues</code></td>
<td>
<p>p-values associated with the selected functional principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetahat_val</code></td>
<td>
<p>Estimated eigenvalues</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Han Lin Shang
</p>


<h3>References</h3>

<p>Horta, E. and Ziegelmann, F. (2018) ‘Dynamics of financial returns densities: A functional approach applied to the Bovespa intraday index’, <em>International Journal of Forecasting</em>, <b>34</b>, 75-88.
</p>
<p>Bathia, N., Yao, Q. and Ziegelmann, F. (2010) ‘Identifying the finite dimensionality of curve time series’, <em>The Annals of Statistics</em>, <b>38</b>, 3353-3386.
</p>


<h3>See Also</h3>

<p><code>CoDa_FPCA</code>, <code>LQDT_FPCA</code>, <code>skew_t_fun</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
Horta_Ziegelmann_FPCA(data = DJI_return, kernel = "epanechnikov", 
				band_choice = "DPI", ncomp_select = "FALSE")

## End(Not run)
</code></pre>


</div>