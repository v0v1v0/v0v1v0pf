<div class="container">

<table style="width: 100%;"><tr>
<td>calc_annual_outside_normal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate annual days above and below normal</h2>

<h3>Description</h3>

<p>This function has been superseded by the <code>calc_annual_normal_days()</code> function.
</p>
<p>Calculates the number of days per year outside of the 'normal' range (typically between 25 and 75th percentiles) for
each day of the year. Upper and lower-range percentiles are calculated for each day of the year of from all years, and then each 
daily flow value for each year is compared. All days above or below the normal range are included. Analysis methodology is based on
Environment and Climate Change Canada's 
<a href="https://www.canada.ca/en/environment-climate-change/services/environmental-indicators/water-quantity-canadian-rivers.html">Water Quantity indicator</a>
from the Canadian Environmental Sustainability Indicators. Calculates statistics from all values from complete years, unless 
specified. Returns a tibble with statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_annual_outside_normal(
  data,
  dates = Date,
  values = Value,
  groups = STATION_NUMBER,
  station_number,
  normal_percentiles = c(25, 75),
  roll_days = 1,
  roll_align = "right",
  water_year_start = 1,
  start_year,
  end_year,
  exclude_years,
  months = 1:12,
  transpose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame of daily data that contains columns of dates, flow values, and (optional) groups (e.g. station numbers).
Leave blank or set to <code>NULL</code> if using <code>station_number</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>Name of column in <code>data</code> that contains dates formatted YYYY-MM-DD. Only required if dates column name is not 
'Date' (default). Leave blank or set to <code>NULL</code> if using <code>station_number</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>Name of column in <code>data</code> that contains numeric flow values, in units of cubic metres per second.
Only required if values column name is not 'Value' (default). Leave blank if using <code>station_number</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Name of column in <code>data</code> that contains unique identifiers for different data sets, if applicable. Only required 
if groups column name is not 'STATION_NUMBER'. Function will automatically group by a column named 'STATION_NUMBER' if 
present. Remove the 'STATION_NUMBER' column beforehand to remove this grouping. Leave blank if using <code>station_number</code> 
argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station_number</code></td>
<td>
<p>Character string vector of seven digit Water Survey of Canada station numbers (e.g. <code>"08NM116"</code>) of
which to extract daily streamflow data from a HYDAT database. Requires <code>tidyhydat</code> package and a HYDAT database.
Leave blank if using <code>data</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normal_percentiles</code></td>
<td>
<p>Numeric vector of two values, lower and upper percentiles, respectively indicating the limits of the 
normal range. Default <code>c(25,75)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roll_days</code></td>
<td>
<p>Numeric value of the number of days to apply a rolling mean. Default <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roll_align</code></td>
<td>
<p>Character string identifying the direction of the rolling mean from the specified date, either by the first 
(<code>'left'</code>), last (<code>'right'</code>), or middle (<code>'center'</code>) day of the rolling n-day group of observations. 
Default <code>'right'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>water_year_start</code></td>
<td>
<p>Numeric value indicating the month (<code>1</code> through <code>12</code>) of the start of water year for
analysis. Default <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_year</code></td>
<td>
<p>Numeric value of the first year to consider for analysis. Leave blank or set well before start date (i.e.
<code>1800</code>) to use from the first year of the source data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_year</code></td>
<td>
<p>Numeric value of the last year to consider for analysis. Leave blank or set well after end date (i.e.
<code>2100</code>) to use up to the last year of the source data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_years</code></td>
<td>
<p>Numeric vector of years to exclude from analysis. Leave blank or set to <code>NULL</code> to include all years.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>months</code></td>
<td>
<p>Numeric vector of months to include in analysis. For example, <code>3</code> for March, <code>6:8</code> for Jun-Aug or 
<code>c(10:12,1)</code> for first four months (Oct-Jan) when <code>water_year_start = 10</code> (Oct). Default summarizes all 
months (<code>1:12</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transpose</code></td>
<td>
<p>Logical value indicating whether to transpose rows and columns of results. Default <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tibble data frame with the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Year</code></td>
<td>
<p>calendar or water year selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Days_Below_Normal</code></td>
<td>
<p>number of days per year below the daily normal (default 25th percentile)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Days_Above_Normal</code></td>
<td>
<p>number of days per year above the daily normal (default 75th percentile)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Days_Outside_Normal</code></td>
<td>
<p>number of days per year below and above the daily normal (default 25/75th percentile)</p>
</td>
</tr>
</table>
<p>Transposing data creates a column of "Statistics" and subsequent columns for each year selected.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Run if HYDAT database has been downloaded (using tidyhydat::download_hydat())
if (file.exists(tidyhydat::hy_downloaded_db())) {

# Calculate statistics with default limits of normal (25 and 75th percentiles)
calc_annual_outside_normal(station_number = "08NM116") 

# Calculate statistics with custom limits of normal
calc_annual_outside_normal(station_number = "08NM116",
                           normal_percentiles = c(10,90))
                           
}
</code></pre>


</div>