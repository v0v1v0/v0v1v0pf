<div class="container">

<table style="width: 100%;"><tr>
<td>make.funreg.basis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make basis for functional regression (for internal use by other package functions)</h2>

<h3>Description</h3>

<p>This is a function for internal use (i.e., a user will not need 
to call it directly for usual data analysis tasks).  Recall that
functional coefficients are estimated as a linear combination of 
basis functions, thus changing a nonparametric into a parametric
estimation problem.  This function constructs the matrix of basis 
function values for doing a functional regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make.funreg.basis(basis.type, deg, num.knots, times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>basis.type</code></td>
<td>
<p>is a character string, either <code>TruncatedPower</code>
or <code>BSpline</code>. This tells whether the basis functions should be
calculated as B-splines (see Eilers and Marx, 1996) or 
as truncated power splines (see Ruppert, Wand, and Carroll, 2003).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deg</code></td>
<td>
<p>is the degree of the basis functions (roughly, their amount 
of complexity) and should generally be 1, 2, or 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.knots</code></td>
<td>
<p>is the number of knots in the basis; the higher 
this is, the more flexible the estimated function will be.  
If it is too low, the estimated function may be too simple
(i.e.,biased towards being too smooth).  If it is
too high, the function may be hard to interpret.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>is the vector of measurement times (more technically, 
real-valued index values for the functional covariate) at which
the basis functions should be evaluated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with two components.  The first,
<code>interior.knot.locations</code>, tells the selected locations on the time
axis for each interior knot. The second, <code>basis.for.betafn</code>,
is a matrix with one row for each time value in the input vector
<code>times</code> and one column for each basis function. It represents
the values of the basis functions themselves.
</p>


<h3>References</h3>

<p>Eilers, P. H. C., and Marx, B. D. (1996). 
Flexible smoothing with B-splines and penalties (with
comments and rejoinder). Statistical Science, 11, 89-121.
</p>
<p>Ruppert, D., Wand, M. P., and Carroll,
R. J. (2003) Semiparametric regression. Cambridge: Cambridge.
</p>


</div>