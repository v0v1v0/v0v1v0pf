<div class="container">

<table style="width: 100%;"><tr>
<td>fracdiff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML Estimates for Fractionally-Differenced ARIMA (p,d,q) models</h2>

<h3>Description</h3>

<p>Calculates the maximum likelihood estimators of the parameters
of a fractionally-differenced ARIMA (p,d,q) model, together (if possible)
with their estimated covariance and correlation matrices and standard
errors, as well as the value of the maximized likelihood.  The
likelihood is approximated using the fast and accurate method of
Haslett and Raftery (1989).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fracdiff(x, nar = 0, nma = 0,
         ar = rep(NA, max(nar, 1)), ma = rep(NA, max(nma, 1)),
         dtol = NULL, drange = c(0, 0.5), h, M = 100, trace = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>time series (numeric vector) for the ARIMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nar</code></td>
<td>
<p>number of autoregressive parameters <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nma</code></td>
<td>
<p>number of moving average parameters <code class="reqn">q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar</code></td>
<td>
<p>initial autoregressive parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma</code></td>
<td>
<p>initial moving average parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtol</code></td>
<td>
<p>interval of uncertainty for <code class="reqn">d</code>.  If <code>dtol</code> is
negative or NULL, the fourth root of machine precision will be used.
<code>dtol</code> will be altered if necessary by the program.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drange</code></td>
<td>
<p>interval over which the likelihood function is to be
maximized as a function of <code class="reqn">d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>size of finite difference interval for numerical derivatives.
By default (or if negative),

<code>h = min(0.1, eps.5 * (1+ abs(cllf)))</code>, where
<code>clff := log. max.likelihood</code> (as returned) and
<code>eps.5 := sqrt(.Machine$double.neg.eps)</code> (typically 1.05e-8).
</p>
<p>This is used to compute a finite difference approximation to the
Hessian, and hence only influences the cov, cor, and std.error
computations; use <code>fracdiff.var()</code> to change this
<em>after</em> the estimation process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of terms in the likelihood approximation (see Haslett
and Raftery 1989).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>optional integer, specifying a trace level.  If positive,
currently the “outer loop” iterations produce one line of
diagnostic output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <span class="pkg">fracdiff</span> package has — for historical reason, namely,
S-plus <code>arima()</code> compatibility — used an unusual
parametrization for the MA part, see also the ‘Details’ section
in <code>arima</code> (in standard <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s <span class="pkg">stats</span> package).
The ARMA (i.e., <code class="reqn">d = 0</code>) model in <code>fracdiff()</code> and
<code>fracdiff.sim()</code> is
</p>
<p style="text-align: center;"><code class="reqn">X_t - a_1X_{t-1} - \cdots - a_pX_{t-p} = e_t - b_1e_{t-1} - \dots - b_qe_{t-q},</code>
</p>

<p>where <code class="reqn">e_i</code> are mean zero i.i.d., for <code>fracdiff()</code>'s
estimation,  <code class="reqn">e_i \sim \mathcal{N}(0,\sigma^2)</code>.
This model indeed has the signs of the MA coefficients <code class="reqn">b_j</code>
<em>inverted</em>, compared to other parametrizations, including
Wikipedia's
<a href="https://en.wikipedia.org/wiki/Autoregressive_moving-average_model">https://en.wikipedia.org/wiki/Autoregressive_moving-average_model</a>
and the one of <code>arima</code>.
</p>
<p>Note that <code>NA</code>'s in the initial values for <code>ar</code> or <code>ma</code>
are replaced by <code class="reqn">0</code>'s.
</p>


<h3>Value</h3>

<p>an object of S3 <code>class</code> <code>"fracdiff"</code>, which is
a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>log.likelihood</code></td>
<td>
<p>logarithm of the maximum likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>optimal fractional-differencing parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar</code></td>
<td>
<p>vector of optimal autoregressive parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma</code></td>
<td>
<p>vector of optimal moving average parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance.dpq</code></td>
<td>
<p>covariance matrix of the parameter estimates
(order : d, ar, ma).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderror.dpq</code></td>
<td>
<p>standard errors of the parameter estimates
<code>c(d, ar, ma)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation.dpq</code></td>
<td>
<p>correlation matrix of the parameter estimates
(order : d, ar, ma).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>interval used for numerical derivatives, see <code>h</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtol</code></td>
<td>
<p>interval of uncertainty for d; possibly altered from input
<code>dtol</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian.dpq</code></td>
<td>
<p>the approximate Hessian matrix <code class="reqn">H</code> of 2nd order
partial derivatives of the likelihood with respect to the
parameters; this is (internally) used to compute
<code>covariance.dpq</code>, the approximate asymptotic covariance matrix as
<code class="reqn">C = (-H)^{-1}</code>.</p>
</td>
</tr>
</table>
<h3>Method</h3>

<p>The optimization is carried out in two levels:<br>
an outer univariate unimodal
optimization in d over the interval <code>drange</code> (typically [0,.5]),
using Brent's <code>fmin</code> algorithm), and<br>
an inner nonlinear least-squares optimization in the AR and MA parameters to
minimize white noise variance (uses the MINPACK subroutine <code>lm</code>DER).
written by Chris Fraley (March 1991).
</p>


<h3>Warning</h3>

<p>The variance-covariance matrix and consequently the standard errors
may be quite inaccurate, see the example in <code>fracdiff.var</code>.
</p>


<h3>Note</h3>

<p>Ordinarily, <code>nar</code> and <code>nma</code> should not be too large (say &lt; 10)
to avoid degeneracy in the model.  The function
<code>fracdiff.sim</code> is available for generating test problems.
</p>


<h3>References</h3>

<p>J. Haslett and A. E. Raftery (1989)
Space-time Modelling with Long-memory Dependence: Assessing Ireland's
Wind Power Resource (with Discussion);
<em>Applied Statistics</em> <b>38</b>, 1–50.
</p>
<p>R. Brent (1973)
<em>Algorithms for Minimization without Derivatives</em>, Prentice-Hall
</p>
<p>J. J. More, B. S. Garbow, and K. E. Hillstrom (1980)
<em>Users Guide for MINPACK-1</em>, Technical Report ANL-80-74,
Applied Mathematics Division, Argonne National Laboratory.
</p>


<h3>See Also</h3>

<p><code>coef.fracdiff</code> and other methods for <code>"fracdiff"</code>
objects;
<code>fracdiff.var()</code> for re-estimation of variances or
standard errors;
<code>fracdiff.sim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ts.test &lt;- fracdiff.sim( 5000, ar = .2, ma = -.4, d = .3)
fd. &lt;- fracdiff( ts.test$series,
                 nar = length(ts.test$ar), nma = length(ts.test$ma))
fd.
## Confidence intervals
confint(fd.)

## with iteration output
fd2 &lt;- fracdiff(ts.test$series, nar = 1, nma = 1, trace = 1)
all.equal(fd., fd2)
</code></pre>


</div>