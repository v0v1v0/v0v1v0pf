<div class="container">

<table style="width: 100%;"><tr>
<td>mle.StructuredFactor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelihood estimation of the bi-factor and second-order copula models for item response data</h2>

<h3>Description</h3>

<p>We approach the estimation  of the bi-factor and second-order copula models for item response data with the IFM method of Joe (2005).</p>


<h3>Usage</h3>

<pre><code class="language-R">mleBifactor(y, copnames1, copnames2, gl, ngrp, grpsize,
hessian, print.level)
mleSecond_order(y, copnames1, copnames2, gl, ngrp, grpsize,
hessian, print.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the item reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames1</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the common factor. <b>For the second-order factor copula</b>: <code class="reqn">G</code>-vector with the names of bivariate copulas that link the each of the group-specific factors with the common factor, where <code class="reqn">G</code> is the number of groups of items. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copnames2</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. <b>For the second-order factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrp</code></td>
<td>
<p>number of non-overlapping groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>If TRUE, the hessian of the negative log-likelihood is calculated during the minimization process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Determines the level of printing which is done during the minimization process; same as in <code>nlm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation is achieved by maximizing  the joint log-likelihood
over the copula parameters  with the univariate cutpoints fixed as estimated at the first step of the proposed two-step estimation approach.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cutpoints</code></td>
<td>
<p>The estimated univariate cutpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEs</code></td>
<td>
<p>The SEs of the Kendall's tau estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br>
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2005)
Asymptotic efficiency of the two-stage estimation method for copula-based models.
<em>Journal of Multivariate Analysis</em>, <b>94</b>, 401–419.
<a href="https://doi.org/10.1016/j.jmva.2004.06.003">doi:10.1016/j.jmva.2004.06.003</a>.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132–157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                     TAS Data
#------------------             -----------------
data(TAS)
#using a subset of the data
#group1: 1,3,6,7,9,13,14
grp1=c(1,3,6)
#group2: 2,4,11,12,17
grp2=c(2,4,11)
#group3: 5,8,10,15,16,18,19,20
grp3=c(5,8,10)
#Rearrange items within testlets
set.seed(123)
i=sample(1:nrow(TAS),500)
ydat=TAS[i,c(grp1,grp2,grp3)]

d=ncol(ydat);d
n=nrow(ydat);n

#size of each group
g1=length(grp1)
g2=length(grp2)
g3=length(grp3)

grpsize=c(g1,g2,g3)#group size
#number of groups
ngrp=length(grpsize)

#BI-FACTOR
copX0 = rep("bvt2", d)
copXg = c(rep("rgum", g1), rep("bvt3", g2+g3))
mle_Bifactor =  mleBifactor(y = ydat, copX0, copXg, gl, ngrp, grpsize, hessian=FALSE, print.level=2)


</code></pre>


</div>