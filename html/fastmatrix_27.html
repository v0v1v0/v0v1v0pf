<div class="container">

<table style="width: 100%;"><tr>
<td>helmert</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helmert matrix</h2>

<h3>Description</h3>

<p>This function returns the Helmert matrix of order <code class="reqn">n</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">helmert(n = 1)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> order of the Helmert matrix.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>A Helmert matrix of order <code class="reqn">n</code> is a square matrix defined as
</p>
<p style="text-align: center;"><code class="reqn">\bold{H}_n = \left[ {\begin{array}{ccccc}
    1/\sqrt{n} &amp; 1/\sqrt{n} &amp; 1/\sqrt{n} &amp; \dots &amp; 1/\sqrt{n} \\
    1/\sqrt{2} &amp; -1/\sqrt{2} &amp; 0 &amp; \dots &amp; 0 \\
    1/\sqrt{6} &amp; 1/\sqrt{6} &amp; -2/\sqrt{6} &amp; \dots &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    \frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \dots &amp; -\frac{(n-1)}{\sqrt{n(n-1)}}
  \end{array}} \right].</code>
</p>

<p>Helmert matrix is orthogonal and is frequently used in the analysis of variance (ANOVA).
</p>


<h3>Value</h3>

<p>Returns an <code class="reqn">n</code> by <code class="reqn">n</code> matrix.
</p>


<h3>References</h3>

<p>Lancaster, H.O. (1965).
The Helmert matrices.
<em>The American Mathematical Monthly</em> <b>72</b>, 4-12.
</p>
<p>Gentle, J.E. (2007).
<em>Matrix Algebra: Theory, Computations, and Applications in Statistics</em>.
Springer, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 1000
set.seed(149)
x &lt;- rnorm(n)

H &lt;- helmert(n)
object.size(H) # 7.63 Mb of storage
K &lt;- H[2:n,]
z &lt;- c(K %*% x)
sum(z^2) # 933.1736

# same that
(n - 1) * var(x)
</code></pre>


</div>