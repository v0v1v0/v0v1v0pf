<div class="container">

<table style="width: 100%;"><tr>
<td>PML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo Maximum Likelihood estimator</h2>

<h3>Description</h3>

<p>Produces estimates for population totals and means using PML estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PML(ysA, ysB, pi_A, pi_B, domains_A, domains_B, N_A, N_B, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "a" and "ab".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are "b" and "ba".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pseudo Maximum Likelihood estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{PML}(\hat{\theta}) = \frac{N_A - \hat{N}_{ab,PML}}{\hat{N}_a}\hat{Y}_a^A + \frac{N_B - \hat{N}_{ab,PML}}{\hat{N}_b}\hat{Y}_b^B + \frac{\hat{N}_{ab,PML}}{\hat{\theta}\hat{N}_{ab}^A + (1 - \hat{\theta})\hat{N}_{ab}^B}[\hat{\theta}\hat{Y}_{ab}^A + (1 - \hat{\theta})\hat{Y}_{ab}^B]</code>
</p>

<p>where <code class="reqn">\hat{\theta} \in [0, 1]</code> and <code class="reqn">\hat{N}_{ab,PML}</code> is the smaller of the roots of the quadratic equation
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\theta}/N_B + (1 - \hat{\theta})/N_A]x^2 - [1 + \hat{\theta}\hat{N}_{ab}^A/N_B + (1 - \hat{\theta})\hat{N}_{ab}^B/N_A]x + \hat{\theta}\hat{N}_{ab}^A + (1 - \hat{\theta})\hat{N}_{ab}^B=0.</code>
</p>
<p> Optimal value for <code class="reqn">\hat{\theta}</code> is <code class="reqn">\frac{\hat{N}_aN_B\hat{V}(\hat{N}_{ab}^B)}{\hat{N}_aN_B\hat{V}(\hat{N}_{ab}^B) + \hat{N}_bN_A\hat{V}(\hat{N}_{ab}^A)}</code>.
Variance is estimated according to following expression
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{PML}(\hat{\theta})) = \hat{V}(\sum_{i \in s_A}\tilde{z}_i^A) + \hat{V}(\sum_{i \in s_B}\tilde{z}_i^B)</code>
</p>

<p>where, <code class="reqn">\tilde{z}_i^A = y_i - \frac{\hat{Y}_a}{\hat{N}_a}</code> if <code class="reqn">i \in a</code> and <code class="reqn">\tilde{z}_i^A = \hat{\gamma}_{opt}(y_i - \frac{\hat{Y}_a}{\hat{N}_a}) + \hat{\lambda} \hat{\phi}</code> if <code class="reqn">i \in ab</code> with
</p>
<p style="text-align: center;"><code class="reqn">\hat{\gamma}_{opt} = \frac{\hat{N}_a N_B \hat{V}(\hat{N}_{ab}^B)}{\hat{N}_a N_B \hat{V}(\hat{N}_{ab}^B) + \hat{N}_b + N_A + \hat{V}(\hat{N}_{ab}^A)}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\lambda} = \frac{n_A/N_A \hat{Y}_{ab}^A + n_B/N_B \hat{Y}_{ab}^B}{n_A/N_A \hat{N}_{ab}^A + n_B/N_B \hat{N}_{ab}^B} - \frac{\hat{Y}_a}{\hat{N}_a} - \frac{\hat{Y}_b}{\hat{N}_b}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\phi} = \frac{n_A \hat{N}_b}{n_A \hat{N}_b + n_B\hat{N}_a}</code>
</p>

<p>Similarly, we define <code class="reqn">\tilde{z}_i^B = y_i - \frac{\hat{Y}_b}{\hat{N}_b}</code> if <code class="reqn">i \in b</code> and <code class="reqn">\tilde{z}_i^B = (1 - \hat{\gamma}_{opt})(y_i - \frac{\hat{Y}_{ba}}{\hat{N}_{ab}}) + \hat{\lambda}(1 - \hat{\phi})</code> if <code class="reqn">i \in ba</code>
</p>


<h3>Value</h3>

<p><code>PML</code> returns an object of class "EstimatorDF" which is a list with, at least, the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td>
</tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table><tr style="vertical-align: top;">
<td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td>
</tr></table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Skinner, C. J. and Rao, J. N. K. (1996)
<em>Estimation in Dual Frame Surveys with Complex Designs</em>. Journal of the American Statistical Association, Vol. 91, 433, 349 - 356.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate Pseudo Maximum Likelihood estimator for population total for variable Clothing
PML(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191)

#Now, let calculate Pseudo Maximum Likelihood estimator for population total for variable
#Feeding, using first order inclusion probabilities
PML(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191)

#Finally, let calculate Pseudo Maximum Likelihood estimator and a 90% confidence interval for 
#population total for variable Leisure
PML(DatA$Lei, DatB$Lei, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191, 0.90)
</code></pre>


</div>