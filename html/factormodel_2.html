<div class="container">

<table style="width: 100%;"><tr>
<td>dproxyme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>dproxyme</h2>

<h3>Description</h3>

<p>This function estimates measurement stochastic matrices of discrete proxy variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dproxyme(
  dat,
  sbar = 2,
  initvar = 1,
  initvec = NULL,
  seed = 210313,
  tol = 0.005,
  maxiter = 200,
  miniter = 10,
  minobs = 100,
  maxiter2 = 1000,
  trace = FALSE,
  weights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A proxy variable data frame list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sbar</code></td>
<td>
<p>A number of discrete types. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initvar</code></td>
<td>
<p>A column index of a proxy variable to initialize the EM algorithm. Default is 1. That is, the proxy variable in the first column of "dat" is used for initialization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initvec</code></td>
<td>
<p>This vector defines how to group the initvar to initialize the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed. Default is 210313 (birthday of this package).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A tolerance for EM algorithm. Default is 0.005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>A maximum number of iterations for EM algorithm. Default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miniter</code></td>
<td>
<p>A minimum number of iterations for EM algorithm. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minobs</code></td>
<td>
<p>Compute likelihood of a proxy variable only if there are more than "minobs" observations. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter2</code></td>
<td>
<p>Maximum number of iterations for "multinom". Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Whether to trace EM algorithm progress. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional weight vector</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of 5 components : </p>

<dl>
<dt>M_param</dt>
<dd>
<p>This is a list of estimated measurement (stochastic) matrices.
The k-th matrix is a measurement matrix of a proxy variable saved in the kth column of dat data frame (or matrix).
The ij-th element in a measurement matrix is the conditional probability of observing j-th (largest) proxy response value conditional on that the latent type is i.</p>
</dd>
<dt>M_param_col</dt>
<dd>
<p>This is a list of column labels of 'M_param' matrices</p>
</dd>
<dt>M_param_row</dt>
<dd>
<p>This is a list of row labels of 'M_param' matrices. It is simply c(1:sbar).</p>
</dd>
<dt>mparam</dt>
<dd>
<p>This is a list of multinomial logit coefficients which were used to compute 'M_param' matrices. These coefficients are useful to compute the likelihood of proxy responses.</p>
</dd>
<dt>typeprob</dt>
<dd>
<p>This is a type probability matrix of size N-by-sbar. The ij-th entry of this matrix gives the probability of observation i to have type j.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Yujung Hwang, <a href="mailto:yujungghwang@gmail.com">yujungghwang@gmail.com</a>
</p>


<h3>References</h3>


<dl>
<dt>Dempster, Arthur P., Nan M. Laird, and Donald B. Rubin (1977)</dt>
<dd>
<p>"Maximum likelihood from incomplete data via the EM algorithm." Journal of the Royal Statistical Society: Series B (Methodological) 39.1 : 1-22. doi: <a href="https://doi.org/10.1111/j.2517-6161.1977.tb01600.x">10.1111/j.2517-6161.1977.tb01600.x</a></p>
</dd>
<dt>Hu, Yingyao (2008)</dt>
<dd>
<p>Identification and estimation of nonlinear models with misclassification error using instrumental variables: A general solution. Journal of Econometrics, 144(1), 27-61. doi: <a href="https://doi.org/10.1016/j.jeconom.2007.12.001">10.1016/j.jeconom.2007.12.001</a></p>
</dd>
<dt>Hu, Yingyao (2017)</dt>
<dd>
<p>The econometrics of unobservables: Applications of measurement error models in empirical industrial organization and labor economics. Journal of Econometrics, 200(2), 154-168. doi: <a href="https://doi.org/10.1016/j.jeconom.2017.06.002">10.1016/j.jeconom.2017.06.002</a></p>
</dd>
<dt>Hwang, Yujung (2021)</dt>
<dd>
<p>Identification and Estimation of a Dynamic Discrete Choice Models with Endogenous Time-Varying Unobservable States Using Proxies. Working Paper.</p>
</dd>
<dt>Hwang, Yujung (2021)</dt>
<dd>
<p>Bounding Omitted Variable Bias Using Auxiliary Data. Working Paper.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">dat1 &lt;- data.frame(proxy1=c(1,2,3),proxy2=c(2,3,4),proxy3=c(4,3,2))
## default minimum num of obs to run an EM algorithm is 10
dproxyme(dat=dat1,sbar=2,initvar=1,minobs=3)
## you can specify weights
dproxyme(dat=dat1,sbar=2,initvar=1,minobs=3,weights=c(0.1,0.5,0.4))


</code></pre>


</div>