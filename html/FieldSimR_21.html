<div class="container">

<table style="width: 100%;"><tr>
<td>unstr_asr_input</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate genetic values based on an unstructured model for GxE interaction - 'AlphaSimR' input
parameters</h2>

<h3>Description</h3>

<p>Creates a list of input parameters for
<a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> to simulate
genetic values in multiple environments for one or more traits based on an unstructured
model for genotype-by-environment (GxE) interaction. <br>
This function utilises the ability of 'AlphaSimR' to simulate correlated traits.
The wrapper function <code>unstr_asr_input()</code> is used to specify the input parameters required in 'AlphaSimR',
and can handle separable and non-separable structures between traits and
environments (see below).
After simulating the genetic values, the wrapper function unstr_asr_output can be used to
generate a data frame with output values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unstr_asr_input(
  ntraits = 1,
  nenvs = 2,
  mean = 0,
  var = 1,
  Tvar = NULL,
  Evar = NULL,
  corA = NULL,
  TcorA = NULL,
  EcorA = NULL,
  meanDD = NULL,
  varDD = NULL,
  TvarDD = NULL,
  EvarDD = NULL,
  corDD = NULL,
  TcorDD = NULL,
  EcorDD = NULL,
  relAA = NULL,
  TrelAA = NULL,
  ErelAA = NULL,
  corAA = NULL,
  TcorAA = NULL,
  EcorAA = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>
<p>Number of traits to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nenvs</code></td>
<td>
<p>Number of environments to be simulated (minimum of two).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>A vector of mean genetic values for each environment-within-trait combination.
If only one value is specified, all combinations will be assigned the same mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>A vector of genetic variances for each environment-within-trait combination.
If only one value is specified, all combinations will be assigned
the same variance. <br><strong>Alternatively</strong>, if a separable structure between traits and environments is desired,
<code>Tvar</code> and <code>Evar</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tvar</code></td>
<td>
<p>A vector of genetic variances for each trait. Must be provided in combination with
<code>Evar</code>. <br><strong>Alternatively</strong>, <code>var</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Evar</code></td>
<td>
<p>A vector of genetic variances for each environment. Must be provided in
combination with <code>Tvar</code>. <br><strong>Alternatively</strong>, <code>var</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corA</code></td>
<td>
<p>A matrix of additive genetic correlations between environment-within-trait
combinations. By default, a diagonal matrix is constructed. <br><strong>Alternatively</strong>, <code>TcorA</code> and <code>EcorA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TcorA</code></td>
<td>
<p>A matrix of additive genetic correlations between traits. Must be provided in
combination with <code>EcorA</code>. <br><strong>Alternatively</strong>, <code>corA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EcorA</code></td>
<td>
<p>A matrix of additive genetic correlations between environments.
Must be provided in combination with <code>TcorA</code>. <br><strong>Alternatively</strong>, <code>corA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanDD</code></td>
<td>
<p>A vector of mean dominance degrees for each environment-within-trait combination
(similar to <code>mean</code>). If only one value is specified, all
combinations will be assigned the same mean. By default, <code>meanDD = NULL</code> and dominance
is not simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varDD</code></td>
<td>
<p>A vector of dominance degree variances for each environment-within-trait
combination (similar to <code>var</code>). If only one value is specified, all
combinations will be assigned the same variance. <br><strong>Alternatively</strong>, if a separable structure between traits and environments is desired,
<code>TvarDD</code> and <code>EvarDD</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TvarDD</code></td>
<td>
<p>A vector of dominance degree variances for each trait (similar to <code>Tvar</code>).
Must be provided in combination with <code>EvarDD</code>. <br><strong>Alternatively</strong>, <code>varDD</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EvarDD</code></td>
<td>
<p>A vector of dominance degree variances for each environment (similar to
<code>Evar</code>). Must be provided in combination with <code>TvarDD</code>. <br><strong>Alternatively</strong>, <code>varDD</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corDD</code></td>
<td>
<p>A matrix of dominance degree correlations between environment-within-trait
combinations (similar to <code>corA</code>). If not specified and dominance is simulated, a
diagonal matrix is constructed. <br><strong>Alternatively</strong>, <code>TcorDD</code> and <code>EcorDD</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TcorDD</code></td>
<td>
<p>A matrix of dominance degree correlations between traits (similar to
<code>TcorA</code>). Must be provided in combination with <code>EcorDD</code>. <br><strong>Alternatively</strong>, <code>corDD</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EcorDD</code></td>
<td>
<p>A matrix of dominance degree correlations between environments (similar to
<code>EcorA</code>). Must be provided in combination with <code>TcorDD</code>. <br><strong>Alternatively</strong>, <code>corDD</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relAA</code></td>
<td>
<p>A vector defining the relative magnitude of additive-by-additive (epistatic) variance
to additive genetic variance for each environment-within-trait combination,
that is in a diploid organism with allele frequency of 0.5. If only one value is specified,
all environment-within-trait combinations will be assigned the same value. By default,
<code>relAA = NULL</code> and epistasis is not simulated. <br><strong>Alternatively</strong>, if a separable structure between traits and environments is desired,
<code>TrelAA</code> and <code>ErelAA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TrelAA</code></td>
<td>
<p>A vector defining the relative magnitude of epistatic variance
to additive genetic variance for each trait. Must be provided in combination
with <code>ErelAA</code>. <br><strong>Alternatively</strong>, <code>relAA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ErelAA</code></td>
<td>
<p>A vector defining the relative magnitude of epistatic variance
to additive genetic variance for each environment. Must be provided in
combination with <code>TrelAA</code>. <br><strong>Alternatively</strong>, <code>relAA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corAA</code></td>
<td>
<p>A matrix of epistatic correlations between environment-within-trait
combinations (similar to <code>corA</code>). If not specified and epistasis is simulated, a
diagonal matrix is constructed. <br><strong>Alternatively</strong>, <code>TcorAA</code> and <code>EcorAA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TcorAA</code></td>
<td>
<p>A matrix of epistatic correlations between traits (similar to <code>TcorA</code>).
Must be provided in combination with <code>EcorAA</code>. <br><strong>Alternatively</strong>, <code>corAA</code> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EcorAA</code></td>
<td>
<p>A matrix of epistatic correlations between environments (similar to
<code>EcorA</code>). Must be provided in combination with <code>TcorAA</code>. <br><strong>Alternatively</strong>, <code>corAA</code> can be specified.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>unstr_asr_input</code> can handle separable and non-separable structures between traits and
environments.
</p>

<ul>
<li>
<p> For separable structures, provide (1) <code>Tvar</code> &amp; <code>Evar</code>, and (2)
<code>TcorA</code> &amp; <code>EcorA</code>.
</p>
</li>
<li>
<p> For non-separable structures, provide (1) <code>var</code>, and (2) <code>corA</code>. <br></p>
</li>
</ul>
<p><strong>Note:</strong> 'AlphaSimR' can simulate different biological effects (see:
<a href="https://gaynorr.github.io/AlphaSimR/reference/SimParam.html">SimParam</a>).
</p>

<ul>
<li>
<p> For additive traits use <code>addTraitA()</code>.
</p>
</li>
<li>
<p> For additive + dominance traits use <code>addTraitAD()</code>.
</p>
</li>
<li>
<p> For additive + epistatic traits use <code>addTraitAE()</code>.
</p>
</li>
<li>
<p> For additive + dominance + epistatic traits use <code>addTraitADE()</code>.
</p>
</li>
</ul>
<p>Check the <code>useVarA</code> argument of these functions when simulating non-additive traits.
</p>


<h3>Value</h3>

<p>A list with input parameters for 'AlphaSimR', which are used to simulate
correlated genetic values based on an unstructured model for GxE interaction.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate genetic values with 'AlphaSimR' for two additive + dominance traits
# in two environments based on an unstructured model.

# 1. Define the genetic architecture of the simulated traits.
# Mean genetic values and mean dominance degrees.
mean &lt;- c(4.9, 5.4, 235.2, 228.5) # Trait 1 x 2 environments, Trait 2 x 2 environments
meanDD &lt;- c(0.4, 0.4, 0.1, 0.1) # Trait 1 and 2, same value for both environments

# Additive genetic variances and dominance degree variances.
var &lt;- c(0.086, 0.12, 15.1, 8.5) # Trait 1 x 2 environments, Trait 2 x 2 environments
varDD &lt;- 0.2 # Same value for all environment-within-trait combinations

# Additive genetic correlations between the two simulated traits.
TcorA &lt;- matrix(c(
  1.0, 0.6,
  0.6, 1.0
), ncol = 2)

# Additive genetic correlations between the two simulated environments.
EcorA &lt;- matrix(c(
  1.0, 0.2,
  0.2, 1.0
), ncol = 2)

# Dominance degree correlations between the four environment-within-trait combinations.
corDD &lt;- diag(4) # Assuming independence

input_asr &lt;- unstr_asr_input(
  ntraits = 2,
  nenvs = 2,
  mean = mean,
  var = var,
  TcorA = TcorA,
  EcorA = EcorA,
  meanDD = meanDD,
  varDD = varDD,
  corDD = corDD
)

</code></pre>


</div>