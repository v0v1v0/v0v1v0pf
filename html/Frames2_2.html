<div class="container">

<table style="width: 100%;"><tr>
<td>CalDF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>DF calibration estimator</h2>

<h3>Description</h3>

<p>Produces estimates for population totals and means using the DF calibration estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalDF(ysA, ysB, pi_A, pi_B, domains_A, domains_B, N_A = NULL, N_B = NULL, 
N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, xsBFrameB = NULL, 
xsT = NULL, XA = NULL, XB = NULL, X = NULL, met = "linear", conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_A</code></td>
<td>
<p>A character vector of length <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are "a" and "ab".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domains_B</code></td>
<td>
<p>A character vector of length <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are "b" and "ba".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsT</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n</code> or a numeric matrix or data frame of dimensions <code class="reqn">n</code> x <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, containing auxiliary information for all units in the entire sample <code class="reqn">s = s_A \cup s_B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, indicating the population totals for the auxiliary variables considered in both frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are "linear", "raking" and "logit". Default is "linear".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>DF calibration estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{CalDF} = \hat{Y}_a + \hat{\eta}\hat{Y}_{ab} + \hat{Y}_b + (1 - \hat{\eta})\hat{Y}_{ba}</code>
</p>

<p>where <code class="reqn">\hat{Y}_a = \sum_{i \in s_a}\tilde{d}_i y_i, \hat{Y}_{ab} = \sum_{i \in s_{ab}}\tilde{d}_i y_i</code>, 
<code class="reqn">\hat{Y}_b = \sum_{i \in s_b}\tilde{d}_i y_i</code> and <code class="reqn">\hat{Y}_{ba} = \sum_{i \in s_{ba}}\tilde{d}_i y_i</code>, with <code class="reqn">\tilde{d}_i</code> calibration weights which are calculated having into account a different set of constraints, depending on the case. For instance, if <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> are all known and no other auxiliary information is available, calibration constraints are
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i \in s_a}\tilde{d}_i = N_a, \sum_{i \in s_{ab}}\tilde{d}_i = N_{ab}, \sum_{i \in s_{ba}}\tilde{d}_i = N_{ba}, \sum_{i \in s_b}\tilde{d}_i = N_b</code>
</p>

<p>Optimal value for <code class="reqn">\hat{\eta}</code> to minimice variance of the estimator is given by <code class="reqn">\hat{V}(\hat{N}_{ba})/(\hat{V}(\hat{N}_{ab}) + \hat{V}(\hat{N}_{ba}))</code>. If both first and second order probabilities are known, variances are estimated using function <code>VarHT</code>. 
If only first order probabilities are known, variances are estimated using Deville's method.
</p>
<p>Function covers following scenarios:
</p>

<ul>
<li>
<p> There is not any additional auxiliary variable 
</p>

<ul>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li>
</ul>
</li>
<li>
<p> At least, information about one additional auxiliary variable is available 
</p>

<ul>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li>
</ul>
</li>
</ul>
<p>To obtain an estimator of the variance for this estimator, one can use Deville's expression
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{CalDF}) = \frac{1}{1-\sum_{k\in s} a_k^2}\sum_{k\in s}(1-\pi_k)\left(\frac{e_k}{\pi_k} - \sum_{l\in s} a_{l} \frac{e_l}{\pi_l}\right)^2</code>
</p>

<p>where <code class="reqn">a_k=(1-\pi_k)/\sum_{l\in s} (1-\pi_l)</code> and <code class="reqn">e_k</code> are the residuals of the regression with auxiliary variables as regressors.
</p>


<h3>Value</h3>

<p><code>CalDF</code> returns an object of class "EstimatorDF" which is a list with, at least, the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td>
</tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table><tr style="vertical-align: top;">
<td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td>
</tr></table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Ranalli, M. G., Arcos, A., Rueda, M. and Teodoro, A. (2013)
<em>Calibration estimation in dual frame surveys</em>. arXiv:1312.0761 [stat.ME]
</p>
<p>Deville, J. C., Sarndal, C. E. (1992)
<em>Calibration estimators in survey sampling.</em>
Journal of the American Statistical Association, 87, 376 - 382
</p>


<h3>See Also</h3>

<p><code>JackCalDF</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate DF calibration estimator for variable Feeding, without
#considering any auxiliary information
CalDF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate DF calibration estimator for variable Clothing when the frame
#sizes and the overlap domain size are known
CalDF(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191, N_ab = 601)

#Finally, let calculate DF calibration estimator and a 90% confidence interval
#for population total for variable Feeding, considering Income as auxiliary variable in 
#frame A and Metres2 as auxiliary variable in frame B and with frame sizes and overlap 
#domain size known.
CalDF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B =  1191, N_ab = 601, xsAFrameA = DatA$Inc, xsBFrameA = DatB$Inc, 
xsAFrameB = DatA$M2, xsBFrameB = DatB$M2, XA = 4300260, XB = 176553, 
conf_level = 0.90)
</code></pre>


</div>