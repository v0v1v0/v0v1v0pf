<div class="container">

<table style="width: 100%;"><tr>
<td>P</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Profile Factor Polynomials</h2>

<h3>Description</h3>

<p>A function to be used in the formula argument in pflm and pfglm. 
It computes polynomials of the basis functions of profile factors to be passed 
in functional models and find optimal designs. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">P(x, deg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A coefficient matrix from the basis expansion of a profile factor. The name passed needs
to match the name of the profile factor in startd in pflm and pfglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deg</code></td>
<td>
<p>The degree of the polynomial effect for the profile factor.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function P is intented to be used in the formula argument in the 
function pflm and pfglm. 
</p>
<p>In the traditional linear models, polynomial effects of factors are handled using the 
function I. However, profile factors are expanded using basis functions
and the coefficients are a matrix instead of a vector. 
</p>
<p>In other words, the function P is an extension to the function I,
but for functional models with profile factors. 
</p>


<h3>Value</h3>

<p>The function returns an attributes list. The list contains the polynomial coefficient matrix,
the argument x, and the argument deg.
</p>


<h3>Author(s)</h3>

<p>Damianos Michaelides &lt;<a href="mailto:dm3g15@soton.ac.uk">dm3g15@soton.ac.uk</a>&gt;, Antony Overstall, Dave Woods
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1:

d &lt;- list(x1=matrix(runif(48), nrow=12))
within(d, example1 &lt;- P(x = x1, deg = 2))


## Example 2: Use the function in a formula
## This example involves finding a D-optimal design for a functional linear model of n=20 runs
## depending on two profile factors. In addition to the main effects, the model includes the
## interaction of the profile factors and the quadratic effect of the second profile factor. 
## The quadratic effect is identified in the formula argument using the \link[fdesigns]{P} function. 

example2 &lt;- pflm(formula = ~ x1 + x2 + x1:x2 + P(x2, 2), nsd = 1, mc.cores = 1,
  npf = 2, tbounds = c(0, 1), nruns = 20, startd=NULL, dx = c(2, 2),
  knotsx = list(c(0.33, 0.66), c(0.25, 0.50, 0.75)), 
  pars = c("power", "power", "bspline", "bspline"), db = c(1, 1, 2, 2), 
  knotsb = list(c(), c(), c(0.25, 0.50, 0.75), c(0.25, 0.50, 0.75)), 
  criterion = "D", lambda = 1, tol = 0.0001, dlbound = -1, dubound = 1, 
  progress = FALSE)

</code></pre>


</div>