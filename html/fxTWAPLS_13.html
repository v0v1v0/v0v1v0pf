<div class="container">

<table style="width: 100%;"><tr>
<td>sse.sample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Sample Specific Errors</h2>

<h3>Description</h3>

<p>Calculate Sample Specific Errors
</p>


<h3>Usage</h3>

<pre><code class="language-R">sse.sample(
  modern_taxa,
  modern_climate,
  fossil_taxa,
  trainfun,
  predictfun,
  nboot,
  nPLS,
  nsig,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA,
  cpus = 4,
  seed = NULL,
  test_mode = FALSE,
  test_it = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fossil_taxa</code></td>
<td>
<p>Fossil taxa abundance data to reconstruct past climates,
each row represents a site to be reconstructed, each column represents a
taxon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trainfun</code></td>
<td>
<p>Training function you want to use, either
<code>WAPLS.w</code> or <code>TWAPLS.w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictfun</code></td>
<td>
<p>Predict function you want to use: if <code>trainfun</code> is
<code>WAPLS.w</code>, then this should be <code>WAPLS.predict.w</code>;
if <code>trainfun</code> is <code>TWAPLS.w</code>, then this should be
<code>TWAPLS.predict.w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>The number of bootstrap cycles you want to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsig</code></td>
<td>
<p>The significant number of components to use to reconstruct past
climates, this can be obtained from the cross-validation results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code>fx</code> function will be used when choosing "bin";
<code>fx_pspline</code> function will be used when choosing "pspline".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpus</code></td>
<td>
<p>Number of CPUs for simultaneous iterations to execute, check
<code>parallel::detectCores()</code> for available CPUs on your machine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_mode</code></td>
<td>
<p>Boolean flag to execute the function with a limited number
of iterations, <code>test_it</code>, for testing purposes only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_it</code></td>
<td>
<p>Number of iterations to use in the test mode.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The bootstrapped standard error for each site.
</p>


<h3>See Also</h3>

<p><code>fx</code>, <code>TWAPLS.w</code>,
<code>TWAPLS.predict.w</code>, <code>WAPLS.w</code>, and
<code>WAPLS.predict.w</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Load reconstruction data
Holocene &lt;- read.csv("/path/to/Holocene.csv")
taxaColMin &lt;- which(colnames(Holocene) == "taxa0")
taxaColMax &lt;- which(colnames(Holocene) == "taxaN")
core &lt;- Holocene[, taxaColMin:taxaColMax]

## SSE
nboot &lt;- 5 # Recommended 1000
nsig &lt;- 3 # This should be got from the random t-test of the cross validation

sse_tf_Tmin2 &lt;- fxTWAPLS::sse.sample(
  modern_taxa = taxa,
  modern_climate = modern_pollen$Tmin,
  fossil_taxa = core,
  trainfun = fxTWAPLS::TWAPLS.w2,
  predictfun = fxTWAPLS::TWAPLS.predict.w,
  nboot = nboot,
  nPLS = 5,
  nsig = nsig,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2,
  seed = 1
)

# Run with progress bar
`%&gt;%` &lt;- magrittr::`%&gt;%`
sse_tf_Tmin2 &lt;- fxTWAPLS::sse.sample(
  modern_taxa = taxa,
  modern_climate = modern_pollen$Tmin,
  fossil_taxa = core,
  trainfun = fxTWAPLS::TWAPLS.w2,
  predictfun = fxTWAPLS::TWAPLS.predict.w,
  nboot = nboot,
  nPLS = 5,
  nsig = nsig,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2,
  seed = 1
) %&gt;% fxTWAPLS::pb()

## End(Not run)

</code></pre>


</div>