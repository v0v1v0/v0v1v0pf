<div class="container">

<table style="width: 100%;"><tr>
<td>One_way_median_polish</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
One-way functional median polish from Sun and Genton (2012)
</h2>

<h3>Description</h3>

<p>Decomposition by one-way functional median polish.
</p>


<h3>Usage</h3>

<pre><code class="language-R">One_way_median_polish(Y, n_prefectures=51, year=1959:2020, age=0:100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The multivariate functional data, which are a  matrix with dimension n by 2p, where n is the sample size and p is the dimensionality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>Vector with the years considered in each population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_prefectures</code></td>
<td>
<p>Number of prefectures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p>Vector with the ages considered in each year.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grand_effect</code></td>
<td>
<p>Grand_effect, a vector of dimension p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_effect</code></td>
<td>
<p>Row_effect, a matrix of dimension length(row_partition_index) by p.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Cristian Felipe Jimenez Varon, Ying Sun, Han Lin Shang
</p>


<h3>References</h3>

<p>C. F. Jimenez Varon, Y. Sun and H. L. Shang (2023) “Forecasting high-dimensional functional time series: Application to sub-national age-specific mortality", arXiv.
\
Sun, Ying, and Marc G. Genton (2012) “Functional Median Polish", Journal of Agricultural, Biological, and Environmental Statistics 17(3), 354-376. 
</p>


<h3>See Also</h3>

<p><code>One_way_Residuals</code>, <code>Two_way_median_polish</code>, <code>Two_way_Residuals</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The US mortality data  1959-2020, for one populations (female) 
# and 3 states (New York, California, Illinois)
# first define the parameters and the row  partitions.
# Define some parameters.
year = 1959:2020
age = 0:100
n_prefectures = 3

#Load the US data. Make sure it is a matrix. 
Y &lt;-  all_hmd_female_data
# Compute the functional median polish decomposition. 
FMP &lt;- One_way_median_polish(Y,n_prefectures=3,year=1959:2020,age=0:100)
# The results
##1. The funcional grand effect
FGE &lt;- FMP$grand_effect
##2. The funcional row effect
FRE &lt;- FMP$row_effect
</code></pre>


</div>