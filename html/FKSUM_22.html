<div class="container">

<table style="width: 100%;"><tr>
<td>fk_sum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast Exact Kernel Sum Evaluation</h2>

<h3>Description</h3>

<p>Computes exact (and binned approximations of) kernel and kernel derivative sums with arbitrary weights/coefficients. Computation is based on the method of Hofmeyr (2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fk_sum(x, omega, h, x_eval = NULL, beta = c(.25,.25),
    nbin = NULL, type = "ksum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of sample points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>numeric vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>numeric bandwidth (must be strictly positive).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_eval</code></td>
<td>
<p>vector of evaluation points. Default is to evaluate at the sample points themselves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>numeric vector of kernel coefficients. Default is c(.25, .25); the smooth order 1 kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbin</code></td>
<td>
<p>integer number of bins for binning approximation. Default is to compute the exact sums.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>one of "ksum": returns the kernel sums, "dksum": returns the kernel derivative sums and "both": returns a matrix cbind(ksum, dksum).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector (if type%in%c("ksum","dksum")) of kernel sums, or kernel derivative sums. A matrix (if type == "both") with kernel sums in its first column and kernel derivative sums in its second column.
</p>


<h3>References</h3>

<p>Hofmeyr, D.P. (2021) "Fast exact evaluation of univariate kernel sums", <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 43(2), 447-458.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Compute density estimates directly with
### kernel sums and constant normalising weights

set.seed(1)
n &lt;- 150000
num_Gauss &lt;- rbinom(1, n, 2 / 3)
x &lt;- c(rnorm(num_Gauss), rexp(n - num_Gauss) + 1)

hs &lt;- seq(.025, .1, length = 5)
xeval &lt;- seq(-4, 8, length = 1000)
ftrue &lt;- 2 / 3 * dnorm(xeval) + 1 / 3 * dexp(xeval - 1)
plot(xeval, ftrue, lwd = 6, col = rgb(.8, .8, .8), xlab = "x",
  ylab = "f(x)", type = "l")

for(i in 1:5) lines(xeval, fk_sum(x, rep(1 / hs[i] / n, n), hs[i],
    x_eval = xeval), lty = i)
</code></pre>


</div>