<div class="container">

<table style="width: 100%;"><tr>
<td>dir_out</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dai &amp; Genton (2019) Directional outlyingness for univariate or multivariate functional data.</h2>

<h3>Description</h3>

<p>Compute the directional outlyingness of a univariate or multivariate functional data
based on Dai and Genton (2019) <a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>
and Dai and Genton (2018) <a href="https://doi.org/10.1080/10618600.2018.1473781">doi:10.1080/10618600.2018.1473781</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dir_out(
  dts,
  data_depth = "random_projections",
  n_projections = 200L,
  seed = NULL,
  return_distance = TRUE,
  return_dir_matrix = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dts</code></td>
<td>
<p>A matrix (or data frame) for univariate functional data (of size <code>n</code> observations by <code>p</code> domain
points) or a 3-dimensional array for multivariate functional data (of size <code>n</code>
observations by <code>p</code> domain points by <code>d</code> dimension).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_depth</code></td>
<td>
<p>The method for computing the depth. The random projection depth is
always used as suggested in Dai and Genton (2018) <a href="https://doi.org/10.1080/10618600.2018.1473781">doi:10.1080/10618600.2018.1473781</a>.
Support for more depth methods will be added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_projections</code></td>
<td>
<p>The number of directions for computing random projection depth. By default,
200 random directions are generated from a scaled uniform distribution between -1 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer indicating the seed to set when generating the random directions. Defaults to NULL
in which case a seed is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_distance</code></td>
<td>
<p>A logical value. If TRUE, returns: a matrix whose columns are
the mean and variation of directional outlyingness, the mahalanobis distance of the
observations of this matrix, and the robust estimate of the mean and covariance of
this matrix (computed using the minimum covariance determinant method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_dir_matrix</code></td>
<td>
<p>A logical value. If TRUE, returns the directional outlyingness
matrix (or array for multivariate functional data). Computed from the chosen <code>depth_depth</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The directional outlyingness, as defined in Dai and Genton (2019)
<a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a> is
</p>
<p style="text-align: center;"><code class="reqn">O(Y, F_Y) = (1/d(Y, F_Y) - 1).v</code>
</p>
<p> where <code class="reqn">d</code> is a depth notion, and <code class="reqn">v</code> is
the unit vector pointing from the median of <code class="reqn">F_Y</code> to <code class="reqn">Y</code>. For univariate and
multivariate functional data, the projection depth is always used as suggested by
Dai and Genton (2019) <a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>.
</p>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean_outlyingness</code></td>
<td>
<p>an <code>n x d</code> matrix of the mean
of directional outlyingness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_outlyingness</code></td>
<td>
<p> a vector of length n containing
the variation of directional outlyingness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ms_matrix</code></td>
<td>
<p> if<code>return_distance</code> = T, an <code>n x (d+1)</code> matrix whose columns are the mean and
variation of directional outlyingness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p> if <code>return_distance</code> = T, a vector of distance computed from the
<code>ms_matrix</code> using a robust estimate of the mean and covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcd_obj</code></td>
<td>
<p> if <code>return_distance</code> = T, a list containing the robust
(minimum covariance determinant) estimate of the mean and covariance of the <code>ms_matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirout_matrix</code></td>
<td>
<p> if <code>return_dir_matrix</code> = T, an n x p (or n x p x d) matrix (or array)
containing the directional outlyingness values for the univariate (or multivariate) functional <code>dts</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Oluwasegun Taiwo Ojo.
</p>


<h3>References</h3>

<p>Dai, W., and Genton, M. G. (2018). Multivariate functional data
visualization and outlier detection. <em>Journal of Computational and Graphical
Statistics</em>, 27(4), 923-934.
</p>
<p>Dai, W., and Genton, M. G. (2019). Directional outlyingness for multivariate functional
data. <em>Computational Statistics &amp; Data Analysis</em>, 131, 50-65.
</p>
<p>Zuo, Y. (2003). Projection-based depth functions and associated medians. <em>The
Annals of Statistics</em>, 31(5), 1460-1490.
</p>


<h3>See Also</h3>

<p><code>msplot</code> for outlier detection using msplot and <code>projection_depth</code>
for multivariate projection depth.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># univariate magnitude model in Dai and Genton (2018).
dt4 &lt;- simulation_model4()
dirout_object &lt;- dir_out(dts = dt4$data, return_distance = TRUE)
</code></pre>


</div>