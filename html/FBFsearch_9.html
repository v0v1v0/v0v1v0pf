<div class="container">

<table style="width: 100%;"><tr>
<td>FBF_LS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moment Fractional Bayes Factor Stochastic Search with Local Prior for DAG Models</h2>

<h3>Description</h3>

<p>Estimate the edge inclusion probabilities for a directed acyclic graph (DAG) from observational data, using the moment fractional Bayes factor approach with local prior.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FBF_LS(Corr, nobs, G_base, h, C, n_tot_mod)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Corr</code></td>
<td>
<p>qxq correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G_base</code></td>
<td>
<p>Base DAG.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Parameter prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Costant who keeps the probability of all local moves bounded away from 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_tot_mod</code></td>
<td>
<p>Maximum number of different models which will be visited by the algorithm, for each equation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of <code>class</code> <code>matrix</code> with the estimated edge inclusion probabilities.</p>


<h3>Author(s)</h3>

<p>Davide Altomare (<a href="mailto:davide.altomare@gmail.com">davide.altomare@gmail.com</a>).
</p>


<h3>References</h3>

<p>D. Altomare, G. Consonni and L. LaRocca (2012).Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors.<em>Article submitted to Biometric Methodology</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(SimDag6) 

Corr=dataSim6$SimCorr[[1]]
nobs=50
q=ncol(Corr)
Gt=dataSim6$TDag

M_q=FBF_LS(Corr, nobs, matrix(0,q,q), 0, 0.01, 1000)

G_med=M_q
G_med[M_q&gt;=0.5]=1
G_med[M_q&lt;0.5]=0 #median probability DAG

#Structural Hamming Distance between the true DAG and the median probability DAG
sum(sum(abs(G_med-Gt))) 


</code></pre>


</div>