<div class="container">

<table style="width: 100%;"><tr>
<td>fit_3d_vfld</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a 3D potential landscape from a vector field</h2>

<h3>Description</h3>

<p>Two methods are available: <code>method = "pathB"</code> and <code>method = "simlandr"</code>. See <em>Details</em> section.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_3d_vfld(
  vf,
  method = c("simlandr", "pathB"),
  .pathB_options = pathB_options(vf),
  .sim_vf_options = sim_vf_options(vf),
  .simlandr_options = simlandr_options(vf),
  linear_interp = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vf</code></td>
<td>
<p>A <code>vectorfield</code> object estimated by <code>fit_2d_vf()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for landscape construction. Can be <code>pathB</code> or <code>simlandr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.pathB_options</code></td>
<td>
<p>Only for <code>method = "pathB"</code>. Options controlling the path-integral algorithm. Should be generated by <code>sim_vf_options()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.sim_vf_options</code></td>
<td>
<p>Only for <code>method = "simlandr"</code>. Options controlling the vector field simulation. Should be generated by <code>sim_vf_options()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.simlandr_options</code></td>
<td>
<p>Only for <code>method = "simlandr"</code>. Options controlling the landscape construction. Should be generated by <code>simlandr_options()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear_interp</code></td>
<td>
<p>Use linear interpolation method to estimate the drift vector (and the diffusion matrix). This can speed up the calculation. If <code>TRUE</code>, be sure that a linear grid was calculated for the vector field using <code style="white-space: pre;">⁠&lt;vf&gt; &lt;- add_interp_grid(&lt;vf&gt;)⁠</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>method = "simlandr"</code>, the landscape is constructed based on the generalized potential landscape by Wang et al. (2008), implemented by the <code>simlandr</code> package. This function is a wrapper of <code>sim_vf()</code> and <code>simlandr::make_3d_static()</code>. Use those two functions separately for more customization.
</p>
<p>For <code>method = "pathB"</code>, the landscape is constructed based on the deterministic path-integral quasi-potential defined by Bhattacharya et al. (2011).
</p>
<p>We recommend the <code>simlandr</code> method for psychological data because it is more stable.
</p>
<p>Parallel computing based on <code>future</code> is supported for both methods. Use <code>future::plan("multisession")</code> to enable this and speed up computation.
</p>


<h3>Value</h3>

<p>A <code>landscape</code> object as described in <code>simlandr::make_3d_static()</code>, or a <code style="white-space: pre;">⁠3d_static_landscape_B⁠</code> object, which inherits from the <code>landscape</code> class and contains the following elements: <code>dist</code>, the distribution estimation for landscapes; <code>plot</code>, a 3D plot using <code>plotly</code>; plot_2, a 2D plot using <code>ggplot2</code>; x, y, from <code>vf</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# generate data
single_output_grad &lt;- simlandr::sim_fun_grad(length = 200, seed = 1614)
# fit the vector field
v2 &lt;- fit_2d_vf(single_output_grad, x = "x", y = "y", method = "MVKE")
plot(v2)
# fit the landscape
future::plan("multisession")
set.seed(1614)
l2 &lt;- fit_3d_vfld(v2,
.sim_vf_options = sim_vf_options(chains = 16, stepsize = 1, forbid_overflow = TRUE),
.simlandr_options = simlandr_options(adjust = 5, Umax = 4))
plot(l2, 2)
future::plan("sequential")

</code></pre>


</div>