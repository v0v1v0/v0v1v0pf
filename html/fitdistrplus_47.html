<div class="container">

<table style="width: 100%;"><tr>
<td>msedist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum spacing estimation of univariate distributions</h2>

<h3>Description</h3>

<p>Fit of univariate distribution by maximizing (log) spacings for non censored data.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">msedist(data, distr, phidiv="KL", power.phidiv=NULL, start = NULL, fix.arg = NULL, 
  optim.method = "default", lower = -Inf, upper = Inf, custom.optim = NULL, 
  weights=NULL, silent = TRUE, gradient = NULL, checkstartfix=FALSE, calcvcov=FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A numeric vector for non censored data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p> A character string <code>"name"</code> naming a distribution  for which the corresponding 
quantile function 
<code>qname</code> and the corresponding density distribution <code>dname</code> must be classically defined. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phidiv</code></td>
<td>
<p>A character string coding for the name of the phi-divergence used : 
<code>"KL"</code> for Kullback-Leibler information (corresponds to classic maximum spacing estimation),
<code>"J"</code> for Jeffreys' divergence, <code>"R"</code> for Renyi's divergence,
<code>"H"</code> for Hellinger distance, <code>"V"</code> for Vajda's measure of information, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power.phidiv</code></td>
<td>
<p>If relevant, a numeric for the power used in some phi-divergence : 
should be <code>NULL</code> when <code>phidiv="KL"</code> or <code>phidiv="J"</code> ,
should be positive and different from 1 when <code>phidiv="R"</code>,
should be greater or equal to 1 when <code>phidiv="H"</code> or <code>phidiv="V"</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list giving the initial values of parameters of the named distribution
or a function of data computing initial values and returning a named list.
This argument may be omitted (default) for some distributions for which reasonable 
starting values are computed (see the 'details' section of  <code>mledist</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of the named distribution
or a function of data computing (fixed) parameter values and returning a named list. 
Parameters with fixed value are thus NOT estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
 <p><code>"default"</code> or optimization method to pass to <code>optim</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p> Left bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code>optim</code>).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p> Right bounds on the parameters for the <code>"L-BFGS-B"</code> method (see <code>optim</code>).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom.optim</code></td>
<td>
<p>a function carrying the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector with strictly positive integers 
(typically the number of occurences of each observation). If non-<code>NULL</code>, 
weighted MSE is used, otherwise ordinary MSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>A function to return the gradient of the gof distance for the <code>"BFGS"</code>, <code>"CG"</code> 
and <code>"L-BFGS-B"</code> methods. If it is <code>NULL</code>, a finite-difference approximation will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkstartfix</code></td>
<td>
<p>A logical to test starting and fixed values. Do not change it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calcvcov</code></td>
<td>
<p>A logical indicating if (asymptotic) covariance matrix is required.
(currently ignored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to the <code>optim</code>, <code>constrOptim</code> or <code>custom.optim</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>msedist</code> function numerically maximizes a phi-divergence function of spacings,
where spacings are the differences of the cumulative distribution function evaluated at
the sorted dataset.
The classical maximum spacing estimation (MSE) was introduced by Cheng and Amin (1986) 
and Ranneby (1984) independently where the phi-diverence is the logarithm,
see Anatolyev and Kosenok (2005) for a link between MSE and maximum likelihood estimation.
</p>
<p>MSE was generalized by Ranneby and Ekstrom (1997) by allowing different phi-divergence
function. Generalized MSE maximizes
</p>
<p style="text-align: center;"><code class="reqn">
      S_n(\theta)=\frac{1}{n+1}\sum_{i=1}^{n+1} \phi\left(F(x_{(i)}; \theta)-F(x_{(i-1)}; \theta) \right),
    </code>
</p>

<p>where <code class="reqn">F(;\theta)</code> is the parametric distribution function to be fitted,
<code class="reqn">\phi</code> is the phi-divergence function,
<code class="reqn">x_{(1)}&lt;\dots&lt;x_{(n)}</code> is the sorted sample, 
<code class="reqn">x_{(0)}=-\infty</code>
and  <code class="reqn">x_{(n+1)}=+\infty</code>.
The possible phi-divergence function is
</p>

<ul>
<li>
<p> Kullback-Leibler information (when <code>phidiv="KL"</code> and corresponds to classical MSE) 
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=\log(x)</code>
</p>

</li>
<li>
<p> Jeffreys' divergence (when <code>phidiv="J"</code>) 
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=(1-x)\log(x)</code>
</p>

</li>
<li>
<p> Renyi's divergence (when <code>phidiv="R"</code> and <code>power.phidiv=alpha</code>) 
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=x^\alpha\times\textrm{sign}(1-\alpha) \textrm{ with } \alpha&gt;0, \alpha\neq 1
      </code>
</p>
 
</li>
<li>
<p> Hellinger distance (when <code>phidiv="H"</code> and <code>power.phidiv=p</code>)
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=-|1-x^{1/p}|^p \textrm{ with } p\ge 1
      </code>
</p>
 
</li>
<li>
<p> Vajda's measure of information (when <code>phidiv="V"</code> and <code>power.phidiv=beta</code>)
</p>
<p style="text-align: center;"><code class="reqn">\phi(x)=-|1-x|^\beta \textrm{ with } \beta\ge 1
      </code>
</p>
 
</li>
</ul>
<p>The optimization process is the same as <code>mledist</code>, see the 'details' section 
of that function.
</p>
<p>This function is not intended to be called directly but is internally called in
<code>fitdist</code> and <code>bootdist</code>.
</p>
<p>This function is intended to be used only with non-censored data.
</p>
<p>NB: if your data values are particularly small or large, a scaling may be needed 
before the optimization process, see <code>mledist</code>'s examples. 
</p>


<h3>Value</h3>

 
<p><code>msedist</code> returns a list with following components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of <code>optim</code> defined as below
or defined by the user in the user-supplied optimization function. 
<code>0</code> indicates successful convergence.
<code>1</code> indicates that the iteration limit of <code>optim</code> has been reached.
<code>10</code> indicates degeneracy of the Nealder-Mead simplex.
<code>100</code> indicates that <code>optim</code> encountered an internal error.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>the minimal value reached for the criterion to minimize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p> a symmetric matrix computed by <code>optim</code> as an estimate of the Hessian
at the solution found or computed in the user-supplied optimization function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.function</code></td>
<td>
<p>the name of the optimization function used for maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>when <code>optim</code> is used, the name of the
algorithm used, the field <code>method</code> of the <code>custom.optim</code> function
otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg</code></td>
<td>
<p>the named list giving the values of parameters of the named distribution
that must kept fixed rather than estimated by maximum likelihood or <code>NULL</code> 
if there are no such parameters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls 
to the log-likelihood function and its gradient respectively. 
This excludes those calls needed to compute the Hessian, if requested, 
and any calls to log-likelihood function to compute a finite-difference
approximation to the gradient. <code>counts</code> is returned by <code>optim</code>
or the user-supplied function or set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the message,
see the source code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p> the log-likelihood value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phidiv</code></td>
<td>
<p>The character string coding for the name of the phi-divergence used
either <code>"KL"</code>, <code>"J"</code>, <code>"R"</code>, <code>"H"</code> or <code>"V"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power.phidiv</code></td>
<td>
<p>Either <code>NULL</code> or a numeric for the power used in the phi-divergence.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

<p>Anatolyev, S., and Kosenok, G. (2005). <em>An alternative to maximum likelihood
based on spacings</em>. Econometric Theory, 21(2), 472-476,
<a href="https://doi.org/10.1017/S0266466605050255">doi:10.1017/S0266466605050255</a>. 
</p>
<p>Cheng, R.C.H. and N.A.K. Amin (1983) <em>Estimating parameters in continuous univariate 
distributions with a shifted origin</em>. Journal of the Royal Statistical Society Series B 45, 394-403,
<a href="https://doi.org/10.1111/j.2517-6161.1983.tb01268.x">doi:10.1111/j.2517-6161.1983.tb01268.x</a>.
</p>
<p>Ranneby, B. (1984) <em>The maximum spacing method: An estimation method related to 
the maximum likelihood method</em>. Scandinavian Journal of Statistics 11, 93-112.
</p>
<p>Ranneby, B. and Ekstroem, M. (1997). <em>Maximum spacing estimates based
on different metrics</em>. Umea universitet.
</p>


<h3>See Also</h3>

 
<p><code>mmedist</code>, <code>mledist</code>, <code>qmedist</code>, <code>mgedist</code>, 
<code>fitdist</code> for other estimation methods.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# (1) Fit of a Weibull distribution to serving size data by maximum 
# spacing estimation
# 

data(groundbeef)
serving &lt;- groundbeef$serving
msedist(serving, "weibull")



# (2) Fit of an exponential distribution 
# 

set.seed(123)
x1 &lt;- rexp(1e3)
#the convergence is quick
msedist(x1, "exp", control=list(trace=0, REPORT=1))

</code></pre>


</div>