<div class="container">

<table style="width: 100%;"><tr>
<td>dev.S</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The deviance score</h2>

<h3>Description</h3>

<p>Returns the deviance of a fitted model object by GCV score.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dev.S(
  y,
  S,
  obs,
  family = gaussian(),
  off,
  offdf,
  criteria = "GCV",
  W = diag(1, ncol = ncol(S), nrow = nrow(S)),
  trim = 0,
  draw = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Matrix of set cases with dimension (<code>n</code> x <code>m</code>), where
<code>n</code> is the number of curves and <code>m</code> are the points observed in
each curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Smoothing matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>observed response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a family
function, a family function or the result of a call to a family function.
(See <code>family</code> for details of family functions.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>off</code></td>
<td>
<p>off</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offdf</code></td>
<td>
<p>off, degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>The penalizing function. By default <em>"Rice"</em> criteria.
Possible values are <em>"GCV"</em>, <em>"AIC"</em>, <em>"FPE"</em>,
<em>"Shibata"</em>, <em>"Rice"</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Matrix of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>The alpha of the trimming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>=TRUE, draw the curves, the sample median and trimmed mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Up to a constant, minus twice the maximized log-likelihood. Where sensible,
the constant is chosen so that a saturated model has deviance zero.
</p>
<p style="text-align: center;"><code class="reqn">GCV(h)=p(h) \Xi(n^{-1}h^{-1})</code>
</p>
 
<p>Where <br></p>
<p style="text-align: center;"><code class="reqn">p(h)=\frac{1}{n}
\sum_{i=1}^{n}{\Big(y_i-r_{i}(x_i)\Big)^{2}w(x_i)}</code>
</p>
 <p><br> and penalty
function </p>
<p style="text-align: center;"><code class="reqn">\Xi()</code>
</p>
<p> can be selected from the following criteria: <br></p>
<p>Generalized Cross-validation (GCV):
</p>
<p style="text-align: center;"><code class="reqn">\Xi_{GCV}(n^{-1}h^{-1})=(1-n^{-1}S_{ii})^{-2}</code>
</p>
 <p><br> Akaike's
Information Criterion (AIC): 
</p>
<p style="text-align: center;"><code class="reqn">\Xi_{AIC}(n^{-1}h^{-1})=exp(2n^{-1}S_{ii})</code>
</p>
 
<p>Finite Prediction Error (FPE) 
</p>
<p style="text-align: center;"><code class="reqn">\Xi_{FPE}(n^{-1}h^{-1})=\frac{(1+n^{-1}S_{ii})}{(1-n^{-1}S_{ii})}</code>
</p>

<p>Shibata's model selector (Shibata): 
</p>
<p style="text-align: center;"><code class="reqn">\Xi_{Shibata}(n^{-1}h^{-1})=(1+2n^{-1}S_{ii})</code>
</p>

<p>Rice's bandwidth selector (Rice):
</p>
<p style="text-align: center;"><code class="reqn">\Xi_{Rice}(n^{-1}h^{-1})=(1-2n^{-1}S_{ii})^{-1}</code>
</p>



<h3>Value</h3>

<p>Returns GCV score calculated for input parameters.
</p>


<h3>Author(s)</h3>

<p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a>
</p>


<h3>References</h3>

<p>Wasserman, L. <em>All of Nonparametric Statistics</em>. Springer
Texts in Statistics, 2006.
</p>
<p>Hardle, W. <em>Applied Nonparametric Regression</em>. Cambridge University
Press, 1994.
</p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/">https://www.jstatsoft.org/v51/i04/</a>
</p>


<h3>See Also</h3>

<p>See Also as <code>GCV.S</code>. <br> Alternative method:
<code>CV.S</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(phoneme)
mlearn&lt;-phoneme$learn
np&lt;-ncol(mlearn)
tt&lt;-mlearn[["argvals"]]
S1 &lt;- S.NW(tt,2.5)
gcv1 &lt;- dev.S(mlearn$data[1,],obs=(sample(150)), 
S1,off=rep(1,150),offdf=3)
gcv2 &lt;- dev.S(mlearn$data[1,],obs=sort(sample(150)), 
S1,off=rep(1,150),offdf=3)

</code></pre>


</div>