<div class="container">

<table style="width: 100%;"><tr>
<td>SimulateRegression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data simulation for multivariate regression</h2>

<h3>Description</h3>

<p>Simulates data with outcome(s) and predictors, where only a subset of the
predictors actually contributes to the definition of the outcome(s).
</p>


<h3>Usage</h3>

<pre><code class="language-R">SimulateRegression(
  n = 100,
  pk = 10,
  xdata = NULL,
  family = "gaussian",
  q = 1,
  theta = NULL,
  nu_xy = 0.2,
  beta_abs = c(0.1, 1),
  beta_sign = c(-1, 1),
  continuous = TRUE,
  ev_xy = 0.7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations in the simulated dataset. Not used if
<code>xdata</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pk</code></td>
<td>
<p>number of predictor variables. A subset of these variables
contribute to the outcome definition (see argument <code>nu_xy</code>). Not used
if <code>xdata</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>optional data matrix for the predictors with variables as
columns and observations as rows. A subset of these variables contribute to
the outcome definition (see argument <code>nu_xy</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>type of regression model. Possible values include
<code>"gaussian"</code> for continuous outcome(s) or <code>"binomial"</code> for binary
outcome(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>number of outcome variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>binary matrix with as many rows as predictors and as many
columns as outcomes. A nonzero entry on row <code class="reqn">i</code> and column <code class="reqn">j</code>
indicates that predictor <code class="reqn">i</code> contributes to the definition of outcome
<code class="reqn">j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu_xy</code></td>
<td>
<p>vector of length <code>q</code> with expected proportion of predictors
contributing to the definition of each of the <code>q</code> outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_abs</code></td>
<td>
<p>vector defining the range of nonzero regression coefficients
in absolute values. If <code>continuous=FALSE</code>, <code>beta_abs</code> is the set
of possible precision values. If <code>continuous=TRUE</code>, <code>beta_abs</code> is
the range of possible precision values. Note that regression coefficients
are re-scaled if <code>family="binomial"</code> to ensure that the desired
concordance statistic can be achieved (see argument <code>ev_xy</code>) so they
may not be in this range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_sign</code></td>
<td>
<p>vector of possible signs for regression coefficients.
Possible inputs are: <code>1</code> for positive coefficients, <code>-1</code> for
negative coefficients, or <code>c(-1, 1)</code> for both positive and negative
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>continuous</code></td>
<td>
<p>logical indicating whether to sample regression
coefficients from a uniform distribution between the minimum and maximum
values in <code>beta_abs</code> (if <code>continuous=TRUE</code>) or from proposed
values in <code>beta_abs</code> (if <code>continuous=FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ev_xy</code></td>
<td>
<p>vector of length <code>q</code> with expected goodness of fit measures
for each of the <code>q</code> outcomes. If <code>family="gaussian"</code>, the vector
contains expected proportions of variance in each of the <code>q</code> outcomes
that can be explained by the predictors. If <code>family="binomial"</code>, the
vector contains expected concordance statistics (i.e. area under the ROC
curve) given the true probabilities.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with: </p>
<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>input or simulated predictor data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydata</code></td>
<td>
<p>simulated outcome data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>matrix of true beta
coefficients used to generate outcomes in <code>ydata</code> from predictors in
<code>xdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>binary matrix indicating the predictors from
<code>xdata</code> contributing to the definition of each of the outcome
variables in <code>ydata</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bodinier B, Filippi S, Nost TH, Chiquet J, Chadeau-Hyam M (2021).
“Automated calibration for stability selection in penalised regression and graphical models: a multi-OMICs network application exploring the molecular response to tobacco smoking.”
<a href="https://arxiv.org/abs/2106.02521">https://arxiv.org/abs/2106.02521</a>.
</p>


<h3>See Also</h3>

<p>Other simulation functions: 
<code>SimulateAdjacency()</code>,
<code>SimulateClustering()</code>,
<code>SimulateComponents()</code>,
<code>SimulateCorrelation()</code>,
<code>SimulateGraphical()</code>,
<code>SimulateStructural()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Independent predictors

# Univariate continuous outcome
set.seed(1)
simul &lt;- SimulateRegression(pk = 15)
summary(simul)

# Univariate binary outcome
set.seed(1)
simul &lt;- SimulateRegression(pk = 15, family = "binomial")
table(simul$ydata)

# Multiple continuous outcomes
set.seed(1)
simul &lt;- SimulateRegression(pk = 15, q = 3)
summary(simul)


## Blocks of correlated predictors

# Simulation of predictor data
set.seed(1)
xsimul &lt;- SimulateGraphical(pk = rep(5, 3), nu_within = 0.8, nu_between = 0, v_sign = -1)
Heatmap(cor(xsimul$data),
  legend_range = c(-1, 1),
  col = c("navy", "white", "darkred")
)

# Simulation of outcome data
simul &lt;- SimulateRegression(xdata = xsimul$data)
print(simul)
summary(simul)


## Choosing expected proportion of explained variance

# Data simulation
set.seed(1)
simul &lt;- SimulateRegression(n = 1000, pk = 15, q = 3, ev_xy = c(0.9, 0.5, 0.2))
summary(simul)

# Comparing with estimated proportion of explained variance
summary(lm(simul$ydata[, 1] ~ simul$xdata))
summary(lm(simul$ydata[, 2] ~ simul$xdata))
summary(lm(simul$ydata[, 3] ~ simul$xdata))


## Choosing expected concordance (AUC)

# Data simulation
set.seed(1)
simul &lt;- SimulateRegression(
  n = 500, pk = 10,
  family = "binomial", ev_xy = 0.9
)

# Comparing with estimated concordance
fitted &lt;- glm(simul$ydata ~ simul$xdata,
  family = "binomial"
)$fitted.values
Concordance(observed = simul$ydata, predicted = fitted)

</code></pre>


</div>