<div class="container">

<table style="width: 100%;"><tr>
<td>mle.Factor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelhood estimation of factor copula models for mixed data</h2>

<h3>Description</h3>

<p>We use a two-stage etimation approach  toward the estimation  of  factor copula models for mixed continuous and discrete data.</p>


<h3>Usage</h3>

<pre><code class="language-R">mle1factor(continuous, ordinal, count, copF1, gl, hessian, print.level)
mle2factor(continuous, ordinal, count, copF1, copF2, gl, hessian, print.level)
mle2factor.bvn(continuous, ordinal, count, copF1, copF2, gl, SpC, print.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>continuous</code></td>
<td>
<p><code class="reqn">n \times d_1</code> matrix with the continuous reponse data, where <code class="reqn">n</code> and <code class="reqn">d_1</code> is the number of observations and continous  variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordinal</code></td>
<td>
<p><code class="reqn">n \times d_2</code> matrix with the ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d_2</code> is the number of observations and ordinal variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p><code class="reqn">n \times d_3</code> matrix with the count reponse data, where <code class="reqn">n</code> and <code class="reqn">d_3</code> is the number of observations and count variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copF1</code></td>
<td>
<p><code class="reqn">(d_1+d_2+d_3)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 1st factor. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel, “joe” for Joe, “rjoe” for reflected Joe, “1rjoe” for 1-reflected Joe, “2rjoe” for 2-reflected Joe, “BB1” for BB1, “rBB1” for reflected BB1, “BB7” for BB7, “rBB7” for reflected BB7, “BB8” for BB8, “rBB8” for reflected BB8, “BB10” for BB10, “rBB10” for reflected BB10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copF2</code></td>
<td>
<p><code class="reqn">(d_1+d_2+d_3)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 2nd factor. Choices are “bvn” for BVN, “bvt<code class="reqn">\nu</code>” with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, “frk” for Frank, “gum” for Gumbel, “rgum” for reflected Gumbel, “1rgum” for 1-reflected Gumbel, “2rgum” for 2-reflected Gumbel, “joe” for Joe, “rjoe” for reflected Joe, “1rjoe” for 1-reflected Joe, “2rjoe” for 2-reflected Joe, “BB1” for BB1, “rBB1” for reflected BB1, “BB7” for BB7, “rBB7” for reflected BB7, “BB8” for BB8, “rBB8” for reflected BB8, “BB10” for BB10, “rBB10” for reflected BB10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SpC</code></td>
<td>
<p>Special case for the 2-factor copula model with BVN copulas. Select a bivariate copula at the 2nd factor to be fixed to independence. e.g. "SpC = 1" to set the first copula at the 2nd factor to independence.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>If TRUE, the hessian of the negative log-likelihood is calculated during the minimization process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Determines the level of printing which is done during the minimization process; same as in <code>nlm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation is achieved by maximizing  the joint log-likelihood 
over the copula parameters  with the univariate parameters/distributions fixed as estimated at the first step of the proposed two-step estimation approach. 
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cutpoints</code></td>
<td>
<p>The estimated univariate cutpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negbinest</code></td>
<td>
<p>The estimated univariate parametes for the count responses (fitting the negative binomial distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpar</code></td>
<td>
<p>Estimated copula parameters in a list form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEs</code></td>
<td>
<p>The SEs of the Kendall's tau estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br>
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365–403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>
<p>Krupskii, P. and Joe, H. (2013)
Factor copula models for multivariate data.
<em>Journal of Multivariate Analysis</em>, <b>120</b>, 85–101. <a href="https://doi.org/10.1016/j.jmva.2013.05.001">doi:10.1016/j.jmva.2013.05.001</a>.
</p>
<p>Nikoloulopoulos, A.K. and Joe, H. (2015)
Factor copula models with item response data.
<em>Psychometrika</em>, <b>80</b>, 126–150. <a href="https://doi.org/10.1007/s11336-013-9387-4">doi:10.1007/s11336-013-9387-4</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25  
gl &lt;- gauss.quad.prob(nq) 
#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
continuous.PE1 = -PE[,1]
continuous.PE2 = PE[,2]
continuous.PE &lt;- cbind(continuous.PE1, continuous.PE2)

categorical.PE &lt;- PE[, 3:5]
#------------------------------------------------
#                   Estimation
#------------------             -----------------
#------------------ One-factor  -----------------
# one-factor copula model
cop1f.PE &lt;- c("joe", "joe", "rjoe", "joe", "gum")
est1factor.PE &lt;- mle1factor(continuous.PE, categorical.PE, 
                            count=NULL, copF1=cop1f.PE, gl, hessian = TRUE)
est1factor.PE                    
#------------------------------------------------
#------------------------------------------------
#                     GSS Data
#------------------             -----------------
data(GSS)
attach(GSS)
continuous.GSS &lt;- cbind(INCOME, AGE)
ordinal.GSS &lt;- cbind(DEGREE, PINCOME, PDEGREE) 
count.GSS &lt;- cbind(CHILDREN, PCHILDREN)

#------------------------------------------------
#                   Estimation
#------------------             -----------------
#------------------ One-factor  -----------------
# one-factor copula model
cop1f.GSS &lt;- c("joe","2rjoe","bvt3","bvt3",
          "rgum","2rjoe","2rgum")
est1factor.GSS &lt;- mle1factor(continuous.GSS, ordinal.GSS, 
                        count.GSS, copF1 = cop1f.GSS, gl, hessian = TRUE)

     

</code></pre>


</div>