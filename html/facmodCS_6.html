<div class="container">

<table style="width: 100%;"><tr>
<td>dCornishFisher</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cornish-Fisher expansion</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random 
generation using Cornish-Fisher approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dCornishFisher(x, n, skew, ekurt)

pCornishFisher(q, n, skew, ekurt)

qCornishFisher(p, n, skew, ekurt)

rCornishFisher(n, sigma, skew, ekurt, dp = NULL, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of standardized quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>scalar; number of simulated values in random simulation, sample 
length in density, distribution and quantile functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew</code></td>
<td>
<p>scalar; skewness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ekurt</code></td>
<td>
<p>scalar; excess kurtosis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>scalar standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p>a vector of length 3, whose elements represent sigma, skew and 
ekurt, respectively. If dp is specified, the individual parameters cannot be 
set. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>scalar; set seed. Default is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>CDF(q) = Pr(sqrt(n)*(x_bar-mu)/sigma &lt; q)
<code>dCornishFisher</code> Computes Cornish-Fisher density from two term Edgeworth 
expansion given mean, standard deviation, skewness and excess kurtosis.
<code>pCornishFisher</code> Computes Cornish-Fisher CDF from two term Edgeworth 
expansion given mean, standard deviation, skewness and excess kurtosis.
<code>qCornishFisher</code> Computes Cornish-Fisher quantiles from two term 
Edgeworth expansion given mean, standard deviation, skewness and excess 
kurtosis.
<code>rCornishFisher</code> simulates observations based on Cornish-Fisher quantile 
expansion given mean, standard deviation, skewness and excess kurtosis.
</p>


<h3>Value</h3>

<p><code>dCornishFisher</code> gives the density, <code>pCornishFisher</code> gives the 
distribution function, <code>qCornishFisher</code> gives the quantile function, 
and <code>rCornishFisher</code> generates <code>n</code> random simulations.
</p>


<h3>Author(s)</h3>

<p>Eric Zivot and Yi-An Chen.
</p>


<h3>References</h3>

<p>DasGupta, A. (2008). Asymptotic theory of statistics and probability. 
Springer.
Severini, T. A., (2000). Likelihood Methods in Statistics. Oxford University 
Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate 1000 observation from Cornish-Fisher distribution
rc &lt;- rCornishFisher(1000,1,0,5)
hist(rc, breaks=100, freq=FALSE, 
     main="simulation of Cornish Fisher Distribution", xlim=c(-10,10))
lines(seq(-10,10,0.1), dnorm(seq(-10,10,0.1), mean=0, sd=1), col=2)
# compare with standard normal curve

# exponential example from A.dasGupta p.188
# x is iid exp(1) distribution, sample size = 5
# then x_bar is Gamma(shape=5, scale=1/5) distribution
q &lt;- c(0,0.4,1,2)
# exact cdf
pgamma(q/sqrt(5)+1, shape=5, scale=1/5)
# use CLT
pnorm(q)
# use edgeworth expansion
pCornishFisher(q, n=5, skew=2, ekurt=6)

</code></pre>


</div>